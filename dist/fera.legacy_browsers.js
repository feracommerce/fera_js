!function(e,t){function r(e){if(1/e==-1/0&&(e=0),e>Math.pow(2,32)-1)throw new RangeError("Invalid array length");var t=[];return t.length=e,t}function i(e,t){var r=arguments.length>2?arguments[2]:[];if(!1===l(e))throw new TypeError(Object.prototype.toString.call(e)+"is not a function.");return e.apply(t,r)}function n(e,t){return e[t]}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e,t){return t in e}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(e){return"function"==typeof e}function c(e){if(null===e||e===t)throw TypeError(Object.prototype.toString.call(e)+" is not coercible to Object.");return e}function u(e,t){return e===t}function d(e){return Boolean(e)}function p(e){if(null===e||e===t)throw TypeError();return Object(e)}function h(e,t){return p(e)[t]}function f(e,r){var i=h(e,r);if(null===i||i===t)return t;if(!1===l(i))throw new TypeError("Method not callable: "+r);return i}function m(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";default:return null===t?"null":"Symbol"in e&&(t instanceof e.Symbol||t.constructor===e.Symbol)?"symbol":"object"}}function g(e,t){var r=n(e,"prototype");return"object"!==m(r)&&(r=t),r}function v(e){return"object"===m(e)&&"function"==typeof e&&!!e.prototype}function _(r){if("object"!==m(r))return!1;var i="Symbol"in e&&"match"in e.Symbol?n(r,e.Symbol.match):t;if(i!==t)return d(i);try{var a=r.lastIndex;return r.lastIndex=0,RegExp.prototype.exec.call(r),!0}catch(e){}finally{r.lastIndex=a}return!1}function w(e,r){if("object"!==m(e["[[Iterator]]"]))throw new Error(Object.prototype.toString.call(e["[[Iterator]]"])+"is not an Object.");var n=e["[[Iterator]]"],a=f(n,"return");if(a===t)return r;try{var o=i(a,n)}catch(e){var s=e}if(r)return r;if(s)throw s;if("object"!==m(o))throw new TypeError("Iterator's return method returned a non-object.");return r}function b(e){if("object"!==m(e))throw new Error(Object.prototype.toString.call(e)+"is not an Object.");return d(n(e,"done"))}function y(e){if(arguments.length<2)var t=i(e["[[NextMethod]]"],e["[[Iterator]]"]);else t=i(e["[[NextMethod]]"],e["[[Iterator]]"],[arguments[1]]);if("object"!==m(t))throw new TypeError("bad iterator");return t}function C(e){var t=y(e);return!0!==b(t)&&t}function S(e){if("object"!==m(e))throw new Error(Object.prototype.toString.call(e)+"is not an Object.");return n(e,"value")}function F(e,t){if("string"===t)var r=["toString","valueOf"];else r=["valueOf","toString"];for(var a=0;a<r.length;++a){var o=n(e,r[a]);if(l(o)){var s=i(o,e);if("object"!==m(s))return s}}throw new TypeError("Cannot convert to primitive.")}function x(e,t){return m(e)===m(t)&&("number"===m(e)?!(!isNaN(e)||!isNaN(t))||1/e==1/0&&1/t==-1/0||1/e==-1/0&&1/t==1/0||e===t:u(e,t))}function k(e){if("symbol"===m(e))throw new TypeError("Cannot convert a Symbol value to a number");var t=Number(e);return isNaN(t)?0:1/t==1/0||1/t==-1/0||t===1/0||t===-1/0?t:(t<0?-1:1)*Math.floor(Math.abs(t))}function $(e){var t=k(e);return t<=0?0:Math.min(t,Math.pow(2,53)-1)}function T(r){var n=arguments.length>1?arguments[1]:t;if("object"===m(r)){if(arguments.length<2)var a="default";else n===String?a="string":n===Number&&(a="number");var o="function"==typeof e.Symbol&&"symbol"==typeof e.Symbol.toPrimitive?f(r,e.Symbol.toPrimitive):t;if(o!==t){var s=i(o,r,[a]);if("object"!==m(s))return s;throw new TypeError("Cannot convert exotic object to primitive.")}return"default"===a&&(a="number"),F(r,a)}return r}function P(e){switch(m(e)){case"symbol":throw new TypeError("Cannot convert a Symbol value to a string");case"object":return P(T(e,String));default:return String(e)}}function I(e){var t=T(e,String);return"symbol"===m(t)?t:P(t)}function R(e,t){var r=P(c(e)),i=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/.source;if("start"===t)var n=String.prototype.replace.call(r,new RegExp("^"+i,"g"),"");else n="end"===t?String.prototype.replace.call(r,new RegExp(i+"$","g"),""):String.prototype.replace.call(r,new RegExp("^"+i+"|"+i+"$","g"),"");return n}function A(e,t,r){var i={value:r,writable:!0,enumerable:!0,configurable:!0};try{return Object.defineProperty(e,t,i),!0}catch(e){return!1}}function O(e,t,r){var i=A(e,t,r);if(!i)throw new TypeError("Cannot assign value `"+Object.prototype.toString.call(r)+"` to property `"+Object.prototype.toString.call(t)+"` on object `"+Object.prototype.toString.call(e)+"`");return i}function M(e,t,r,a,l){for(var c=arguments[5],u=arguments[6],d=a,p=0;p<r;){var h=P(p);if(!0===o(t,h)){var f=n(t,h);5 in arguments&&(f=i(c,u,[f,p,t]));var m=!1;if(l>0&&(m=s(f)),!0===m)d=M(e,f,$(n(f,"length")),d,l-1);else{if(d>=Math.pow(2,53)-1)throw new TypeError("targetIndex is greater than or equal to 2^53-1");O(e,P(d),f),d+=1}}p+=1}return d}function E(e,t,r){var i={value:r,writable:!0,enumerable:!1,configurable:!0};Object.defineProperty(e,t,i)}function L(e,t){var r=arguments[2]||{},i=g(e,t),n=Object.create(i);for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&Object.defineProperty(n,a,{configurable:!0,enumerable:!1,writable:!0,value:r[a]});return n}function D(e){var t=arguments.length>2?arguments[2]:e,r=arguments.length>1?arguments[1]:[];if(!v(e))throw new TypeError("F must be a constructor.");if(!v(t))throw new TypeError("newTarget must be a constructor.");return t===e?new(Function.prototype.bind.apply(e,[null].concat(r))):i(e,L(t,Object.prototype),r)}function j(i,a){if(0===a&&1/a==-1/0&&(a=0),!1===s(i))return r(a);var o=n(i,"constructor");if("object"===m(o)&&null===(o="Symbol"in e&&"species"in e.Symbol?n(o,e.Symbol.species):t)&&(o=t),o===t)return r(a);if(!v(o))throw new TypeError("C must be a constructor");return D(o,[a])}function q(e){var t=i(arguments.length>1?arguments[1]:f(e,Symbol.iterator),e);if("object"!==m(t))throw new TypeError("bad iterator");var r=h(t,"next"),n=Object.create(null);return n["[[Iterator]]"]=t,n["[[NextMethod]]"]=r,n["[[Done]]"]=!1,n}var B,U,V;B=Object.defineProperty,U=Object.prototype.hasOwnProperty.call(Object.prototype,"__defineGetter__"),V="A property cannot both have accessors and be writable or have a value",Object.defineProperty=function(e,r,i){if(B&&(e===window||e===document||e===Element.prototype||e instanceof Element))return B(e,r,i);if(null===e||!(e instanceof Object||"object"==typeof e))throw new TypeError("Object.defineProperty called on non-object");if(!(i instanceof Object))throw new TypeError("Property description must be an object");var n=String(r),a="value"in i||"writable"in i,o="get"in i&&typeof i.get,s="set"in i&&typeof i.set;if(o){if(o===t)return e;if("function"!==o)throw new TypeError("Getter must be a function");if(!U)throw new TypeError("Getters & setters cannot be defined on this javascript engine");if(a)throw new TypeError(V);Object.__defineGetter__.call(e,n,i.get)}else e[n]=i.value;if(s){if(s===t)return e;if("function"!==s)throw new TypeError("Setter must be a function");if(!U)throw new TypeError("Getters & setters cannot be defined on this javascript engine");if(a)throw new TypeError(V);Object.__defineSetter__.call(e,n,i.set)}return"value"in i&&(e[n]=i.value),e},E(Array.prototype,"forEach",(function(e){var r=p(this),a=r instanceof String?r.split(""):r,s=$(n(r,"length"));if(!1===l(e))throw new TypeError(e+" is not a function");for(var c=arguments.length>1?arguments[1]:t,u=0;u<s;){var d=P(u);if(o(a,d))i(e,c,[n(a,d),u,r]);u+=1}return t})),E(Array.prototype,"includes",(function(e){"use strict";var t=p(this),r=$(n(t,"length"));if(0===r)return!1;var i=k(arguments[1]);if(i>=0)var a=i;else(a=r+i)<0&&(a=0);for(;a<r;){if(x(e,n(t,P(a))))return!0;a+=1}return!1})),E(Array.prototype,"indexOf",(function(e){var t=p(this),r=$(n(t,"length"));if(0===r)return-1;var i=k(arguments[1]);if(i>=r)return-1;if(i>=0)var a=1/i==-1/0?0:i;else(a=r+i)<0&&(a=0);for(;a<r;){if(o(t,P(a))&&e===n(t,P(a)))return a;a+=1}return-1})),E(Function.prototype,"bind",(function(e){var t=Object,r=Array.prototype,i=function(){},n=r.slice,a=r.concat,o=r.push,s=Math.max,c=this;if(!l(c))throw new TypeError("Function.prototype.bind called on incompatible "+c);for(var u,d=n.call(arguments,1),p=function(){if(this instanceof u){var r=c.apply(this,a.call(d,n.call(arguments)));return t(r)===r?r:this}return c.apply(e,a.call(d,n.call(arguments)))},h=s(0,c.length-d.length),f=[],m=0;m<h;m++)o.call(f,"$"+m);return u=Function("binder","return function ("+f.join(",")+"){ return binder.apply(this, arguments); }")(p),c.prototype&&(i.prototype=c.prototype,u.prototype=new i,i.prototype=null),u})),E(Object,"freeze",(function(e){return e})),function(){var e=Object.getOwnPropertyDescriptor,t=function(){try{return 1===Object.defineProperty(document.createElement("div"),"one",{get:function(){return 1}}).one}catch(e){return!1}},r={}.toString,i="".split;E(Object,"getOwnPropertyDescriptor",(function(n,o){var s=p(n);s=("string"===m(s)||s instanceof String)&&"[object String]"==r.call(n)?i.call(n,""):Object(n);var l=I(o);if(t)try{return e(s,l)}catch(e){}if(a(s,l))return{enumerable:!0,configurable:!0,writable:!0,value:s[l]}}))}(),E(Object,"getPrototypeOf",(function(e){if(e!==Object(e))throw new TypeError("Object.getPrototypeOf called on non-object");var t=e.__proto__;return t||null===t?t:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Object.prototype:null})),E(Object,"keys",function(){"use strict";function e(){var e;try{e=Object.create({})}catch(e){return!0}return a.call(e,"__proto__")}function r(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}var i=Object.prototype.hasOwnProperty,n=Object.prototype.toString,a=Object.prototype.propertyIsEnumerable,o=!a.call({toString:null},"toString"),s=a.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(e){var t=e.constructor;return t&&t.prototype===e},u={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!u["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{c(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),p=function(e){if("undefined"==typeof window||!d)return c(e);try{return c(e)}catch(e){return!1}};return function(a){var c="[object Function]"===n.call(a),u=r(a),d="[object String]"===n.call(a),h=[];if(a===t||null===a)throw new TypeError("Cannot convert undefined or null to object");var f=s&&c;if(d&&a.length>0&&!i.call(a,0))for(var m=0;m<a.length;++m)h.push(String(m));if(u&&a.length>0)for(var g=0;g<a.length;++g)h.push(String(g));else for(var v in a)e()&&"__proto__"===v||f&&"prototype"===v||!i.call(a,v)||h.push(String(v));if(o)for(var _=p(a),w=0;w<l.length;++w)_&&"constructor"===l[w]||!i.call(a,l[w])||h.push(l[w]);return h}}()),E(Object,"assign",(function(e,r){var i=p(e);if(1===arguments.length)return i;var a,o,s,l,c=Array.prototype.slice.call(arguments,1);for(a=0;a<c.length;a++){var u=c[a];for(u===t||null===u?s=[]:(l="[object String]"===Object.prototype.toString.call(u)?String(u).split(""):p(u),s=Object.keys(l)),o=0;o<s.length;o++){var d,h=s[o];try{var f=Object.getOwnPropertyDescriptor(l,h);d=f!==t&&!0===f.enumerable}catch(e){d=Object.prototype.propertyIsEnumerable.call(l,h)}if(d){var m=n(l,h);i[h]=m}}}return i})),E(Object,"defineProperties",(function(e,r){if("object"!==m(e))throw new TypeError("Object.defineProperties called on non-object");for(var i=p(r),a=Object.keys(i),o=[],s=0;s<a.length;s++){var l=a[s],c=Object.getOwnPropertyDescriptor(i,l);if(c!==t&&c.enumerable){var u=n(i,l);o.push([l,u])}}for(var d=0;d<o.length;d++){var h=o[d][0];u=o[d][1],Object.defineProperty(e,h,u)}return e})),function(){function e(){}if({__proto__:null}instanceof Object)t=function(){var e=document.createElement("iframe");e.style.display="none";var r=document.body||document.documentElement;r.appendChild(e),e.src="javascript:";var i=e.contentWindow.Object.prototype;r.removeChild(e),e=null,delete i.constructor,delete i.hasOwnProperty,delete i.propertyIsEnumerable,delete i.isPrototypeOf,delete i.toLocaleString,delete i.toString,delete i.valueOf;var n=function(){};return n.prototype=i,t=function(){return new n},new n};else var t=function(){return{__proto__:null}};E(Object,"create",(function(r,i){if("object"!==m(r)&&"null"!==m(r))throw new TypeError("Object prototype may only be an Object or null");if("null"===m(r))var n=t();else e.prototype=r,(n=new e).__proto__=r,n.constructor.prototype=r,n.__proto__=r;return 1 in arguments?Object.defineProperties(n,i):n}))}(),E(Array.prototype,"filter",(function(e){var r=p(this),a=$(n(r,"length"));if(!1===l(e))throw new TypeError(e+" is not a function");for(var s=arguments.length>1?arguments[1]:t,c=j(r,0),u=0,h=0;u<a;){var f=P(u);if(o(r,f)){var m=n(r,f);d(i(e,s,[m,u,r]))&&(O(c,P(h),m),h+=1)}u+=1}return c})),E(Array.prototype,"flat",(function(){"use strict";var e=arguments[0],t=p(this),r=$(n(t,"length")),i=1;void 0!==e&&(i=k(e));var a=j(t,0);return M(a,t,r,0,i),a})),E(Array.prototype,"flatMap",(function(e){"use strict";var r,i=p(this),a=$(n(i,"length"));if(!1===l(e))throw new TypeError("mapperFunction is not callable.");r=1 in arguments?arguments[1]:t;var o=j(i,0);return M(o,i,a,0,1,e,r),o})),E(Array.prototype,"map",(function(e){var r=p(this),a=$(n(r,"length"));if(!1===l(e))throw new TypeError(e+" is not a function");for(var s=arguments.length>1?arguments[1]:t,c=j(r,a),u=0;u<a;){var d=P(u);if(o(r,d))O(c,d,i(e,s,[n(r,d),u,r]));u+=1}return c})),function(){var t={}.toString,r="".split,i=[].concat,n=Object.prototype.hasOwnProperty,a=Object.getOwnPropertyNames||Object.keys,o="object"==typeof e?a(e):[];E(Object,"getOwnPropertyNames",(function(e){var s=p(e);if("[object Window]"===t.call(s))try{return a(s)}catch(e){return i.call([],o)}s="[object String]"==t.call(s)?r.call(s,""):Object(s);for(var l=a(s),c=["length","prototype"],u=0;u<c.length;u++){var d=c[u];n.call(s,d)&&!l.includes(d)&&l.push(d)}if(l.includes("__proto__")){var h=l.indexOf("__proto__");l.splice(h,1)}return l}))}(),function(){if(!Object.setPrototypeOf){var e,t,r=Object.getOwnPropertyNames,i=Object.getOwnPropertyDescriptor,n=Object.create,a=Object.defineProperty,o=Object.getPrototypeOf,s=Object.prototype,l=function(e,t){return r(t).forEach((function(r){a(e,r,i(t,r))})),e},c=function(e,t){return l(n(t),e)};try{(e=i(s,"__proto__").set).call({},null),t=function(t,r){return e.call(t,r),t}}catch(r){(e={__proto__:null})instanceof Object?t=c:(e.__proto__=s,t=e instanceof Object?function(e,t){return e.__proto__=t,e}:function(e,t){return o(e)?(e.__proto__=t,e):c(e,t)})}E(Object,"setPrototypeOf",t)}}(),E(String.prototype,"includes",(function(e){"use strict";var r=arguments.length>1?arguments[1]:t,i=P(c(this));if(_(e))throw new TypeError("First argument to String.prototype.includes must not be a regular expression");var n=P(e),a=k(r),o=i.length,s=Math.min(Math.max(a,0),o);return-1!==String.prototype.indexOf.call(i,n,s)})),E(String.prototype,"trimEnd",(function(){"use strict";var e=this;return R(e,"end")})),E(String.prototype,"trimStart",(function(){"use strict";var e=this;return R(e,"start")})),function(r,i,n){"use strict";function a(e){if("symbol"===m(e))return e;throw TypeError(e+" is not a symbol")}var o,s=function(){try{var e={};return r.defineProperty(e,"t",{configurable:!0,enumerable:!1,get:function(){return!0},set:t}),!!e.t}catch(e){return!1}}(),l=0,c=""+Math.random(),u="__\x01symbol:",d=u.length,p="__\x01symbol@@"+c,h={},f="defineProperty",g="defineProperties",v="getOwnPropertyNames",_="getOwnPropertyDescriptor",w="propertyIsEnumerable",b=r.prototype,y=b.hasOwnProperty,C=b[w],S=b.toString,F=Array.prototype.concat,x=r.getOwnPropertyNames?r.getOwnPropertyNames(e):[],k=r[v],$=function(e){if("[object Window]"===S.call(e))try{return k(e)}catch(e){return F.call([],x)}return k(e)},T=r[_],P=r.create,I=r.keys,R=r.freeze||r,A=r[f],O=r[g],M=T(r,v),E=function(e,t,r){if(!y.call(e,p))try{A(e,p,{enumerable:!1,configurable:!1,writable:!1,value:{}})}catch(t){e[p]={}}e[p]["@@"+t]=r},L=function(e,t){var r=P(e);return $(t).forEach((function(e){U.call(t,e)&&G(r,e,t[e])})),r},D=function(e){var t=P(e);return t.enumerable=!1,t},j=function(){},q=function(e){return e!=p&&!y.call(z,e)},B=function(e){return e!=p&&y.call(z,e)},U=function(e){var t=""+e;return B(t)?y.call(this,t)&&this[p]&&this[p]["@@"+t]:C.call(this,e)},V=function(e){var t={enumerable:!1,configurable:!0,get:j,set:function(t){o(this,e,{enumerable:!1,configurable:!0,writable:!0,value:t}),E(this,e,!0)}};try{A(b,e,t)}catch(r){b[e]=t.value}z[e]=A(r(e),"constructor",H);var i=T(W.prototype,"description");return i&&A(z[e],"description",i),R(z[e])},N=function(e){var r=a(e);if(X){var i=K(r);if(""!==i)return i.slice(1,-1)}if(h[r]!==t)return h[r];var n=r.toString(),o=n.lastIndexOf("0.");return""===(n=n.slice(10,o))?t:n},W=function e(){var i=arguments[0];if(this instanceof e)throw new TypeError("Symbol is not a constructor");var n=u.concat(i||"",c,++l);i===t||null!==i&&!isNaN(i)&&""!==String(i)||(h[n]=String(i));var a=V(n);return s||r.defineProperty(a,"description",{configurable:!0,enumerable:!1,value:N(a)}),a},z=P(null),H={value:W},J=function(e){return z[e]},G=function(e,t,r){var i=""+t;return B(i)?(o(e,i,r.enumerable?D(r):r),E(e,i,!!r.enumerable)):A(e,t,r),e},Z=function(e){return function(t){return y.call(e,p)&&y.call(e[p],"@@"+t)}},Y=function(e){return $(e).filter(e===b?Z(e):B).map(J)};M.value=G,A(r,f,M),M.value=Y,A(r,"getOwnPropertySymbols",M),M.value=function(e){return $(e).filter(q)},A(r,v,M),M.value=function(e,t){var r=Y(t);return r.length?I(t).concat(r).forEach((function(r){U.call(t,r)&&G(e,r,t[r])})):O(e,t),e},A(r,g,M),M.value=U,A(b,w,M),M.value=W,A(n,"Symbol",M),M.value=function(e){var t=u.concat(u,e,c);return t in b?z[t]:V(t)},A(W,"for",M),M.value=function(e){if(q(e))throw new TypeError(e+" is not a symbol");return y.call(z,e)?e.slice(2*d,-c.length):void 0},A(W,"keyFor",M),M.value=function(e,t){var r=T(e,t);return r&&B(t)&&(r.enumerable=U.call(e,t)),r},A(r,_,M),M.value=function(e,t){return 1===arguments.length||void 0===t?P(e):L(e,t)},A(r,"create",M);var Q=null===function(){return this}.call(null);if(M.value=Q?function(){var e=S.call(this);return"[object String]"===e&&B(this)?"[object Symbol]":e}:function(){if(this===window)return"[object Null]";var e=S.call(this);return"[object String]"===e&&B(this)?"[object Symbol]":e},A(b,"toString",M),o=function(e,t,r){var i=T(b,t);delete b[t],A(e,t,r),e!==b&&A(b,t,i)},function(){try{var e={};return r.defineProperty(e,"t",{configurable:!0,enumerable:!1,get:function(){return!0},set:t}),!!e.t}catch(e){return!1}}()){var K;try{K=Function("s","var v = s.valueOf(); return { [v]() {} }[v].name;")}catch(e){}var X=K&&"inferred"===function(){}.name?K:null;r.defineProperty(n.Symbol.prototype,"description",{configurable:!0,enumerable:!1,get:function(){return N(this)}})}}(Object,0,e),Object.defineProperty(e.Symbol,"iterator",{value:e.Symbol("iterator")});var N=function(){var e={}.toString,t="".split;return function(r,a,o){if(!1===l(o))throw new TypeError("adder is not callable.");for(var s=q(a);;){var c=C(s);if(!1===c)return r;var u,d,p=S(c);if("object"!==m(p)){var h=new TypeError("nextItem is not an object");throw w(s,h),h}p=("string"===m(p)||p instanceof String)&&"[object String]"==e.call(p)?t.call(p,""):p;try{u=n(p,"0")}catch(u){return w(s,u)}try{d=n(p,"1")}catch(d){return w(s,d)}try{i(o,r,[u,d])}catch(e){return w(s,e)}}}}();Object.defineProperty(Symbol,"toStringTag",{value:Symbol("toStringTag")});var W=function(){var e=function(){return this.length=0,this},r=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},i=function(e,t){if(!(this instanceof i))return new i(e,t);Object.defineProperties(this,{__list__:{writable:!0,value:e},__context__:{writable:!0,value:t},__nextIndex__:{writable:!0,value:0}}),t&&(r(t.on),t.on("_add",this._onAdd.bind(this)),t.on("_delete",this._onDelete.bind(this)),t.on("_clear",this._onClear.bind(this)))};return Object.defineProperties(i.prototype,Object.assign({constructor:{value:i,configurable:!0,enumerable:!1,writable:!0},_next:{value:function(){var e;if(this.__list__)return this.__redo__&&(e=this.__redo__.shift())!==t?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()},configurable:!0,enumerable:!1,writable:!0},next:{value:function(){return this._createResult(this._next())},configurable:!0,enumerable:!1,writable:!0},_createResult:{value:function(e){return e===t?{done:!0,value:t}:{done:!1,value:this._resolve(e)}},configurable:!0,enumerable:!1,writable:!0},_resolve:{value:function(e){return this.__list__[e]},configurable:!0,enumerable:!1,writable:!0},_unBind:{value:function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd.bind(this)),this.__context__.off("_delete",this._onDelete.bind(this)),this.__context__.off("_clear",this._onClear.bind(this)),this.__context__=null)},configurable:!0,enumerable:!1,writable:!0},toString:{value:function(){return"[object Iterator]"},configurable:!0,enumerable:!1,writable:!0}},{_onAdd:{value:function(e){if(!(e>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__)return void Object.defineProperty(this,"__redo__",{value:[e],configurable:!0,enumerable:!1,writable:!1});this.__redo__.forEach((function(t,r){t>=e&&(this.__redo__[r]=++t)}),this),this.__redo__.push(e)}},configurable:!0,enumerable:!1,writable:!0},_onDelete:{value:function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(e))&&this.__redo__.splice(t,1),this.__redo__.forEach((function(t,r){t>e&&(this.__redo__[r]=--t)}),this)))},configurable:!0,enumerable:!1,writable:!0},_onClear:{value:function(){this.__redo__&&e.call(this.__redo__),this.__nextIndex__=0},configurable:!0,enumerable:!1,writable:!0}})),Object.defineProperty(i.prototype,Symbol.iterator,{value:function(){return this},configurable:!0,enumerable:!1,writable:!0}),Object.defineProperty(i.prototype,Symbol.toStringTag,{value:"Iterator",configurable:!1,enumerable:!1,writable:!0}),i}(),z=function(){var e=function(t,r){if(!(this instanceof e))return new e(t,r);W.call(this,t),r=r?String.prototype.includes.call(r,"key+value")?"key+value":String.prototype.includes.call(r,"key")?"key":"value":"value",Object.defineProperty(this,"__kind__",{value:r,configurable:!1,enumerable:!1,writable:!1})};return Object.setPrototypeOf&&Object.setPrototypeOf(e,W.prototype),e.prototype=Object.create(W.prototype,{constructor:{value:e,configurable:!0,enumerable:!1,writable:!0},_resolve:{value:function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e},configurable:!0,enumerable:!1,writable:!0},toString:{value:function(){return"[object Array Iterator]"},configurable:!0,enumerable:!1,writable:!0}}),e}();"Symbol"in e&&"iterator"in Symbol&&"function"==typeof Array.prototype[Symbol.iterator]?E(Array.prototype,"values",Array.prototype[Symbol.iterator]):E(Array.prototype,"values",(function(){var e=p(this);return new z(e,"value")})),E(Array.prototype,Symbol.iterator,Array.prototype.values),E(Object,"fromEntries",(function(e){return c(e),N({},e,(function(e,t){O(this,I(e),t)}))}))}("object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{});var Fera=Fera||{},BananaStand=BananaStand||Fera;Fera.App=function(opts){this.version="2.3.3.0";var self=this,containers,config,api,currProductId,customerId,visitorId,platformAdapter,section,containerAutoUpdateTimer,contentUpdatesStarted=!1,isViewingProductPage=!1,pushedViewEvent=!1,showedDevGreeting=!1,pushMethodReady=!1,currProduct,compiledCss="",variantId;opts=opts||{};var updateRequestInProgress=!1,eventListeners={"timers.reset":[],"feeds.reset":[],"cart.emptied":[],"cart.changed":[],"cart.add":[],"variant.change":[],"product.change":[],"product.set":[],"widget.create":[],"widget.create:before":[],"widget.create:after":[],"widget.update":[],"notification.show":[],init:[],ready:[],load:[],"skill.create":[],"skill.create:before":[],"skill.create:after":[],"skill.update":[]},init=function(){opts.app=self,self.parentWindow=opts.parentWindow,messageStatusToParent("fera_starting"),self.cookieJar=opts.cookieJar=new Fera.CookieJar,self.localStorage=opts.localStorage=new Fera.LocalStorageJar(opts),self.opts=opts.optionsParser=new Fera.OptionsParser(opts),parseModes(),self.logger=Fera.logger=opts.logger=new Fera.Logger(opts),self.timeTracker=opts.timeTracker=new Fera.TimeTracker(opts),self.engagementTracker=opts.engagementTracker=new Fera.EngagementRegistry(opts),self.abTests=new Fera.AbTests.Manager(opts),opts.optionsParser.hasUrlFlag("clear_cache")&&self.clearCache(),Fera.Util.ie()&&opts.logger.warn("Fera.ai is not optimized for Microsoft Internet Explorer. You should really update to a more modern browser!"),opts.logger.log("~~ Loaded app.js version "+self.version+" ~~"),waitFor$((function(){self.geo=opts.geo=new Fera.Geo(opts),self.inactivityDetector=opts.inactivityDetector=new Fera.InactivityDetector({logger:opts.logger}),self.deepLinker=new Fera.DeepLinker(opts),self.deepLinker.attachAndWatch(),self.geo.getLocationInfo((function(e){opts.shopperLocation=e,delete opts.shopperLocation.ip,loadSupportModules();var t=opts.sandboxMode?Fera.Preview_Api:Fera.Api;api=new t(opts),self.api=opts.api=api,loadPushBuffer({only:"configure"}),ensureVisitorId(),opts.visitorId=visitorId,ensureBodyContainersPresent(),loadPushBuffer({only:"loadPlatformAdapter"}),abortLoading()?loadAdmin(!1):(self.i18n=Fera.i18n=new Fera.I18n(opts),self.t=self.i18n.t,Fera.t=function(e){return Fera.i18n.t(e)},Fera.isSupportedLanguage=function(e){return Fera.i18n.isSupportedLanguage(e)},loadPushBuffer({only:"setLocale"}),loadPushBuffer({only:"setDefaultLocale"}),self.cart=new Fera.Cart(opts),platformAdapter&&platformAdapter.cartAdapter&&self.cart.setAdapter(platformAdapter.cartAdapter),self.api.checkConfig()?(self.verifier=new Fera.Verifier(opts),loadContainers(),loadPushBuffer({except:["loadPlatformAdapter","configure","setLocale","setDefaultLocale"]}),api.waitForApiConfig((function(){api.checkConfig()?(self.clickTracker=opts.clickTracker=new Fera.ClickRegistry(opts),contentUpdatesStarted||waitForSupportModules((function(){setTimeout(startServerUpdating,1)})),self.isReady=!0,self.trigger("init ready"),loadAdmin(!0)):loadAdmin(!1)}))):loadAdmin(!1))}),!0)}))},abortLoading=function(){if(window.location.pathname&&(0===window.location.pathname.indexOf("/password")||!self.api.validConfig()&&"undefined"!=typeof Shopify&&Shopify.Checkout&&Shopify.Checkout.isOrderStatusPage))return Fera.logger.log("Intentionally aborted loading, likely due to a missing API key on the page."),self.aborted=!0,!0;return self.opts.sandboxMode&&self.opts.sandboxError},loadAdmin=function(e){if(opts.adminMode){if((e=void 0===e||e)||opts.api.configure({api_url:decodeURIComponent(opts.cookieJar.getCookie("Fera.Admin.BaseApiUrl")),store_pk:opts.cookieJar.getCookie("Fera.Admin.Store.PublicKey")}),void 0!==Fera.AdminPanel)return setupAdmin(e);var t="";-1!==opts.api.baseAppPath.indexOf("app.")?t+=opts.api.baseAppPath.replace("app.","cdn.")+"/js/fera.admin.js?v="+self.version:t=-1!==opts.api.baseAppPath.indexOf("ngrok.")||-1!==opts.api.baseAppPath.indexOf("localhost")||-1!==opts.api.baseAppPath.indexOf("test-")||-1!==opts.api.baseAppPath.indexOf("127.0.0.1")?opts.api.baseAppPath+"/assets/public/fera.admin.js?v="+self.version:"https://cdn.jsdelivr.net/gh/feracommerce/ferajs@"+self.version+"/dist/fera.admin.js";var r=opts.debugMode?1:900;new FeraCachedAsset({name:"Fera.Admin.Js",url:t,expiresIn:r}).load((function(){setupAdmin(e)}))}},setupAdmin=function(e){try{opts.sandboxMode&&(messageStatusToParent("fera_admin_starting"),opts.app.previewer=opts.previewer=new Fera.AdminPreviewer(opts,e),self.parentWindow!==window.opener&&null!=self.parentWindow||(opts.adminPanel=new Fera.AdminPanel(opts),opts.adminPanel.managePreviewMode()));var t=opts.optionsParser.parseCheckIntegration();t&&new Fera.AdminIntegrationChecker(opts).check(t)}catch(e){if(opts.debugMode)throw e}},messageStatusToParent=function(e){try{var t=opts.api&&opts.api.baseAppPath?opts.api.baseAppPath:"*";opts.parentWindow&&opts.parentWindow.postMessage(JSON.stringify({methodName:"sandbox_previewer.status.update",params:{status:e}}),t)}catch(e){}};self.push=function(e,t){if(pushMethodReady){if(opts.debugMode)return _push(e,t);try{return _push(e,t)}catch(e){window.console&&!Fera.Util.ie()&&window.console.error(e)}}else opts.pushBuffer=opts.pushBuffer||[],opts.pushBuffer.push(e),void 0!==t&&opts.pushBuffer.push(t)},self.setSection=function(e){return section=e,self},self.getSection=function(){return section},self.dispatchEvent=function(e,t,r){r=r||function(){},containers.dispatchEvent(e,t,r)},self.loadPlatformAdapter=function(code,params){if(platformAdapter)return platformAdapter;var _opts=opts||{};if(_opts.params=params,_opts.addToCartCallback=self.pushAddToCartEvent,-1!==opts.supportedPlatforms.indexOf(code)){var adapterKlass=eval("Fera."+Fera.Util.capitalizeFirstLetter(code)+"Adapter");platformAdapter=new adapterKlass(_opts)}else{if("function"!=typeof code)return opts.logger.logWarning("Unknown platform code supplied: '"+code+"'. Valid codes are: "+opts.supportedPlatforms.join(",")),self.loadPlatformAdapter("custom",params);platformAdapter=code(_opts)}},self.setProduct=function(e){var t=currProduct;return void 0!==(currProduct=e).id&&self.setProductId(currProduct.id),isViewingProductPage=!0,t&&t!=currProduct&&(self.trigger("product.change",{old:t,new:currProduct}),self.refreshContent()),!t&&currProduct&&self.trigger("product.set"),self},self.setProductId=function(e){var t=currProductId;return isViewingProductPage=!0,t!=(currProductId=e)&&(contentUpdatesStarted&&self.trigger("product.change",{old:{id:t},new:{id:currProductId}}),self.getVariantId()&&t&&self.setVariantId(null,!1)),!t&&currProductId&&self.trigger("product.set"),self},self.getProductId=function(){return currProductId},self.getProduct=function(){return currProduct},self.setVariantId=function(e){var t=variantId;return variantId=e,t&&t!==variantId&&self.trigger("variant.change",{old:{id:t},new:{id:variantId}}),self},self.setDesignMode=function(e){return self.opts.designMode=!!e,e&&Fera.logger.log("Design mode activated."),this},self.isDesignMode=function(){return!!self.opts.designMode},self.showContentSubmission=function(e){return getContentSubmitter().show(e)},self.showContentSubmitter=self.showContentSubmission,self.showContentSubmit=self.showContentSubmission,self.writeReview=self.showContentSubmission,self.getVariantId=function(){return variantId},self.setCart=function(e){return self.cart.loadCartData(e),self},self.setShopper=function(e){if(Fera.Util.sizeOfParams(e)>1024)opts.logger.error("Error: parameter size is larger than 1024 bytes");else{var t=getShopperAttributes();opts.cookieJar.setCookieObject(shopperAttributesKey(),Object.assign({},t,e),1)}};var getShopperAttributes=function(){return opts.cookieJar.getCookieObject(shopperAttributesKey())},shopperAttributesKey=function(){return"Fera.App.currentShopper"};self.getVisitorId=function(){return visitorId},self.getShopperId=self.getVisitorId,self.pushOrder=function(e,t){var r;void 0!==e.data?r=e:(r={type:"order_create"},void 0!==e.order?r.data=e:r.data={order:e}),r.data.ab_tests=self.ab_tests,api.pushEvent(r,t)},self.pushConversion=self.pushOrderEvent=self.pushConversionEvent=self.pushOrder,self.setCustomerId=function(e){return customerId=e,self},self.getCustomerId=function(){return customerId},self.configure=function(e){config=e,api.configure(config)},self.pushAddToCartEvent=function(e){var t={type:"product_add_to_cart"};e&&(e.data?t.data=e.data:t.data=e),self.trigger("cart.add",e),self.pushEvent(t)},self.addProductToCart=function(e,t){platformAdapter&&"function"==typeof platformAdapter.addProductToCart&&platformAdapter.addProductToCart(e,t)},self.triggerWidget=function(e,t){containers.triggerSkill(e,t)},self.triggerSkill=self.triggerWidget,self.trigger=function(e,t){e=e.split(" ");for(var r=0;r<e.length;r++){var i=e[r],n=eventListeners[i]||[];/skill.\d+.(create|update)/.test(i)&&n.concat(eventListeners[i.replace(/skill.\d+./,"skill.")||[]]);for(var a=0;a<n.length;a++)n[a](t)}},self.on=function(e,t){e=e.split(" ")
;for(var r=0;r<e.length;r++){var i=e[r].trim();if(eventListeners[i])eventListeners[i].push(t);else if(/skill.\d+.(create|update)/.test(i))eventListeners[i]=[t];else{var n=Object.keys(eventListeners).join(", ");self.logger.warn("Invalid event code requested: '"+i+"'. Valid event codes are: "+n)}"ready"===i&&self.isReady&&self.trigger("ready")}},self.formatCurrency=function(e){if(!e)return"";if(e=parseFloat(e),platformAdapter&&platformAdapter.formatCurrency){var t=platformAdapter.formatCurrency(e);if(!1!==t&&null!=t)return t}var r=self.storeSettings.currency_template.replace(/{{[ ]?amount[ ]?}}/,e.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));return r=(r=r.replace(/{{[ ]?amount_no_decimals[ ]?}}/,Math.round(e).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(/^(.+)\.00$/,"$1"))).replace(/{{[ ]?amount_with_comma_separator[ ]?}}/,e.toFixed(2).toString().replace(".",","))},self.getState=function(e){if(!self.state){var t=opts.sandboxMode?Fera.Preview_State:Fera.State;self.state=new t(opts)}return self.state.getData(e)},self.updateContainers=function(e,t,r){var i={};t=t||function(){},void 0===e&&(e=!1);var n=$(".fera-view-container[data-product_id],.banana-view-container[data-product_id]");1===n.length&&n.data("product_id")&&(self.getProductId()||self.setProductId(n.data("product_id")));var a=loadContentRequestContexts();Object.keys(a).length>0&&(i.contexts=JSON.stringify(a)),self.getState((function(n){if(i.state=n,i.push_view_event=e,i.content_requests=void 0===r?containers.getContentRequest({defaultProductId:currProductId}):r,i.content_requests.length<1&&!e)return t();if(i.content_requests_json=JSON.stringify(i.content_requests),delete i.content_requests,pushedViewEvent||(i.push_view_event=!0,isViewingProductPage&&(i.associated_to="product"),pushedViewEvent=!0),updateRequestInProgress=!0,!opts.sandboxMode){var a=getShopperAttributes();a&&(i.shopper_attributes=a),loadCompiledCssFromCache(),!self.storeSettings&&self.localStorage.getObject("storeSettings")&&(self.storeSettings=self.localStorage.getObject("storeSettings",{}),setTranslationSettings(),containers.updateContentFromCache())}api.getContent(i,(function(e){e&&(updateRequestInProgress=!1,Fera.Util.isSpeedMode()?opts.inactivityDetector.afterFirstInteraction((function(){callBackFromGetContent(e,t)}),2e4):callBackFromGetContent(e,t))}),(function(){updateRequestInProgress=!1}))}))};var callBackFromGetContent=function(e,t){self.displayDevGreeting(),updateCompiledCssFromServer(e),e.store&&(self.storeSettings=e.store,setTranslationSettings(),opts.sandboxMode||self.localStorage.setObject("storeSettings",self.storeSettings)),!e.section||self.getSection()&&"other"!==self.getSection()||self.setSection(e.section),self.abTests.updateBuckets(e.ab_tests),containers.updateContent(e,currProductId,t),setTimeout((function(){self.trigger("load"),self.loaded=!0}),1)};self.clearCache=function(){new Fera.LocalStorageJar({namespace:"Fera.AssetCache"}).clear(),new Fera.LocalStorageJar({namespace:"BananaStand.AssetCache"}).clear(),new Fera.LocalStorageJar({namespace:"Fera.Cache"}).clear(),waitFor$((function(){Fera.Util.$()('script[src*="fera.js"],script[src*="fera.placeholder.js"],script[src*="bananastand.js"]').each((function(){var e=this.src.replace("https://cdn.jsdelivr.net/gh/feracommerce/ferajs@latest/dist/","https://cdn.fera.ai/js/");e+=-1===e.indexOf("?")?"?":"&",e=(e+="v="+self.version+"p").replace(".placeholder.","."),Fera.Util.$().ajax({method:"GET",type:"GET",url:e})}))})),Fera.logger.log("CLEARED Fera cache.")};var loadContentRequestContexts=function(){var e={},t=[];$("[data-fera-container]").each((function(){var r=$(this),i=parseInt(r.data("fera-container")),n=r.data("product-id")||r.data("productId")||r.data("product_id");if(n){if(e[i]=e[i]||[],n.toString&&n.toString().match(/{{\s*product\.id\s*}}/)){if(Fera.logger.warn("TAG NOT SETUP PROPERLY (product ID not rendered). Please contact our support team for help.",r),!self.getProductId())return;n=self.getProductId(),r.data("product-id",n)}e[i].push(n),-1===t.indexOf(i)&&t.push(i)}})),$(".banana-list-container").each((function(){var t=$(this),r=t.data("product-id")||t.data("productId")||t.data("product_id");r&&(e.list=e.list||[],e.list.push(r))})),$("[data-fera-context]").each((function(){e.list=e.list||[],e.list.push($(this).data("product-id"))}));for(var r=0;r<t.length;r++)e[t[r]]=e[t[r]].sort();return e};self.markAllContainersAsDirty=function(){containers&&containers.markAllContainersAsDirty()};var refreshContentNow=function(e){if(containers)return containers.markAllContainersAsDirty(),self.updateContainers(!1,e),self.refreshContentCount++,self},refreshContent=function(e){return self.opts.testMode||self.opts.adminMode||self.opts.previewMode||self.opts.sandboxMode?refreshContentNow(e):(self.refreshContentCount=self.refreshContentCount||0,self.refreshContentCount<3?refreshContentNow(e):self.refreshContentCount<10?(Fera.logger.log("Content refresh was throttled due to frequency (1s)"),refreshContentThrottle1(e)):self.refreshContentCount<50?(Fera.logger.log("Content refresh was throttled due to frequency (15s)"),refreshContentThrottle2(e)):self.refreshContentCount<100?(Fera.logger.log("Content refresh was throttled due to frequency (1min)"),refreshContentThrottle3(e)):self.refreshContentCount<250?(Fera.logger.log("Content refresh was throttled due to frequency (15min)"),refreshContentThrottle4(e)):(Fera.logger.log("Content refresh was throttled due to frequency (1hr)"),refreshContentThrottle5(e)))},refreshContentThrottle1=Fera.Util.throttle(refreshContentNow,1e3),refreshContentThrottle2=Fera.Util.throttle(refreshContentNow,15e3),refreshContentThrottle3=Fera.Util.throttle(refreshContentNow,6e4),refreshContentThrottle4=Fera.Util.throttle(refreshContentNow,9e5),refreshContentThrottle5=Fera.Util.throttle(refreshContentNow,36e5);self.refreshContent=Fera.Util.debounce(refreshContent,1),self.updateAllContainers=self.refreshContent,self.forceRefreshContent=function(e){containers.each((function(e){"function"==typeof e.removeAllBlocks&&e.removeAllBlocks()})),$("[data-fera-widget]").remove(),refreshContentNow(e)},self.clearSeenHistory=function(){containers.each((function(e){e.clearSeenHistory&&e.clearSeenHistory()}))},self.getContainers=function(){return containers},self.getContainerById=function(e){return containers.getContainerById(e)},self.pushEvent=function(e,t){return self.getState((function(r){e.state=r,e.visitor_id=visitorId,"add_to_cart"===e.type&&(e.type="product_add_to_cart"),e.shopper_attributes=getShopperAttributes();var i=opts.optionsParser.detectCustomerName();i&&(e.shopper_attributes||(e.shopper_attributes={}),e.shopper_attributes.name||(e.shopper_attributes.name=i)),"function"==typeof e.callback&&t&&"function"!=typeof t.callback&&(t.callback=e.callback,delete e.callback),"object"==typeof e.data&&"function"==typeof e.data.callback&&t&&"function"!=typeof t.callback&&(t.callback=e.data.callback,delete e.data.callback),api.pushEvent(e,t)})),self},self.checkIn=function(e,t){e=e||{};var r={callback:t||e.callback};api.checkIn(e,r)},self.getCurrentShopperId=function(e){return e&&"function"==typeof e.callback?e.callback(visitorId):visitorId},self.displayDevGreeting=function(){return!showedDevGreeting&&(!(!window.console||Fera.Util.ie())&&((!self.opts.feraParams||!self.opts.feraParams.quiet)&&(!self.localStorage.getItem("DevGreeting.shown",!1)&&((opts.debugMode?opts.logger.log:window.console.log)("\ud83d\udc4b Hello developer! We've optimized performance and encapsulated functionality to ensure our system never breaks anything. Shoot a message to dev"+String.fromCharCode(64)+"fera.ai if you've got any questions.\nLearn more about Fera @ https://fera.ai?dev=1\nHappy coding!\ud83d\udc4b"),self.localStorage&&self.localStorage.setItem("DevGreeting.shown",!0,9e5),showedDevGreeting=!0))))},self.getShopper=function(e){api.getShopper(visitorId,e)},self.deleteShopper=function(e){api.deleteShopper(visitorId,e)};var getContentSubmitter=function(){return self.contentSubmitter||(self.contentSubmitter=new Fera.ContentSubmission.Submitter(opts)),self.contentSubmitter},_push=function(e,t){var r,i="function"==typeof(r="object"==typeof e?e:{action:e,data:t,callback:"object"==typeof t?t.callback:void 0}).callback?r.callback:function(){};if("configure"==r.action)self.configure(r.data);else if("setCustomerId"==r.action)"string"==typeof r.customer_id||"number"==typeof r.customer_id?self.setCustomerId(r.customer_id):"string"==typeof r.id||"number"==typeof r.id?self.setCustomerId(r.id):void 0!==t?self.setCustomerId(t.id||t):opts.logger.error("Invalid syntax for method call setCustomerId: ",r);else if("setProduct"==e||"setCurrentProduct"==e)self.setProduct(t);else if("showContentSubmission"==e||"showContentSubmit"==e||"review"==e||"r"==e)self.showContentSubmission(t);else if("setProductId"===r.action)"string"==typeof t||"number"==typeof t?self.setProductId(t):r?void 0!==r.product_id?self.setProductId(r.product_id):void 0!==r.id?self.setProductId(r.id):void 0!==r.data?void 0!==r.data.product_id?self.setProductId(r.data.product_id):void 0!==r.data.id?self.setProductId(r.data.id):self.setProductId(r.data):self.setProductId(null):opts.logger.error("Invalid syntax for method call setProductId: ",r);else if("setVariantId"===r.action)"string"==typeof t||"number"==typeof t?self.setVariantId(t):r?void 0!==r.variant_id?self.setVariantId(r.variant_id):void 0!==r.id?self.setVariantId(r.id):void 0!==r.data?void 0!==r.data.variant_id?self.setVariantId(r.data.variant_id):void 0!==r.data.id?self.setVariantId(r.data.id):self.setVariantId(r.data):self.setVariantId(null):opts.logger.error("Invalid syntax for method call setVariantId: ",r);else if("getCurrentShopperId"==r.action||"getShopperId"==r.action)self.getCurrentShopperId(r.data);else if("triggerSkill"==r.action)self.triggerSkill(t.id||t.skill_id||t.widget_id||t.widgetId||t.skillId,t.data||t.optionalData||t.optional_data);else if("setCart"==r.action)self.setCart(r.cart||r.data||t||("object"==typeof t?t.cart:null));else if(-1!==["pushOrder","pushOrderEvent","order","orderEvent","conversion","conversionEvent","pushConversion","pushConversionEvent"].indexOf(e))self.pushOrder(t);else if(-1!==["pushAddToCart","pushAddToCartEvent","addToCart","add_to_cart","product_add_to_cart"].indexOf(e))self.pushAddToCartEvent(t);else if("pushEvent"==r.action||"event"==r.action)self.pushEvent(t);else if("loadPlatformAdapter"==r.action)"string"==typeof e&&"string"==typeof t?self.loadPlatformAdapter(t,{}):self.loadPlatformAdapter(r.code||r.adapter,r);else if("updateContainers"==r.action)self.updateContainers(!1,i);else if("startProductPageViewing"==r.action)self.startProductPageViewing(i);else if("dispatchEvent"==r.action)self.dispatchEvent(r.code,r.data,i);else if("getShopper"==r.action)self.getShopper(i);else if("deleteShopper"==r.action)self.deleteShopper(i);else if("on"===r.action)self.on(r.data.event,r.data.callback);else if("setShopper"==r.action){r.data||r.shopper;self.setShopper(r.data||r.shopper)}else self[r.action],self[r.action](r.data)},$=function(e){return Fera.Util.$()(e)},addBodyContainers=function(){document.getElementsByClassName("banana-globalBottom-container").length>0||$("body").append('<div class="banana-container banana-globalBottom-container" data-container_type="global_bottom" style="display: none;"></div>')},ensureBodyContainersPresent=function(){setInterval(addBodyContainers,10),addBodyContainers()},updateCompiledCssFromServer=function(e){if(e&&e.content_responses){var t=e.compiled_css;t&&(compiledCss.replace(/\s/gi,"").indexOf(t.replace(/\s/gi,""))&&(compiledCss=self.opts.testMode||self.opts.previewMode?t:(compiledCss+" "+t).trim(),updateCompiledCss(compiledCss)),saveCompiledCssToCache(compiledCss))}},saveCompiledCssToCache=function(e){self.localStorage.setItem("Cache.CompiledCss",e,36e5)},loadCompiledCssFromCache=function(){if(self.opts.testMode||self.opts.adminMode||self.opts.previewMode)return!1;var e=self.localStorage.getItem("Cache.CompiledCss","");return!!e&&(updateCompiledCss(e),!0)},updateCompiledCss=function(e){var t=$("#feraCompiledCss");t.length<1&&(t=$('<span style="display: none" id="feraCompiledCss"></span>'),$("body").append(t)),t.html("<style>"+e+"</style>")},startServerUpdating=function(e){opts.logger.log("Starting server update timer..."),e=e||function(){},contentUpdatesStarted?opts.logger.log("startServerUpdating was already called, so returning..."):(startCheckIns(),contentUpdatesStarted=!0,self.updateContainers(!pushedViewEvent,e),self.on("cart.changed",(function(){self.markAllContainersAsDirty()})))},startCheckIns=function(){var e=config.page_view_check_interval||3e5,t=e;if(Fera.Util.isSpeedMode())return!1;setInterval((function(){(t-=1e3)<=0&&opts.inactivityDetector.isActive()&&(isViewingProductPage&&currProductId&&self.checkIn(),t=e)}),1e3)},parseModes=function(){self.opts.debugMode=opts.debugMode=opts.optionsParser.parseDebugMode(),self.opts.testMode=opts.testMode=opts.optionsParser.parseTestMode(),self.opts.adminMode=opts.adminMode=opts.optionsParser.parseAdminMode(),self.opts.sandboxMode=opts.sandboxMode=opts.optionsParser.parseSandboxMode(),self.opts.showErrors=opts.showErrors=self.opts.debugMode||opts.optionsParser.parseShowErrors(),(self.opts.adminMode||self.opts.testMode||self.opts.debugMode||self.opts.sandboxMode||self.opts.feraParams&&self.opts.feraParams.quiet)&&(Fera.Util.setIsBot(!1),Fera.Util.setIsSpeedMode(!1))},loadContainers=function(){(containers=new Fera.ContainerCollection(opts)).updateContainers=self.updateContainers,containers.getContext=loadContentRequestContexts,opts.contentUpdater=containers,opts.containers=containers},waitFor$=function(e){var t=0,r=Fera.Util.isSpeedMode()?1:10,i=100,n=!1;if(opts.standaloneMode)Fera.Util.addZepto(opts),n=!0,i+=1e3,r=1;else if(Fera.Util.hasValid$(!0))return e();opts.logger.log("Waiting for jQuery or Zepto to load...");var a=setInterval((function(){if(Fera.Util.hasValid$()&&(window.Zepto&&window.Zepto.expr&&window.Zepto.expr[":"]&&!window.Zepto.expr[":"].input&&(Zepto.expr[":"].input=function(){if("disabled"in this||"true"===this.contentEditable)return this}),clearInterval(a),e()),(t+=r)==i){if(n)throw clearInterval(a),"Fera requires jQuery or Zepto and neither was found, plus we were not able to be dynamically load Zepto.";i+=5e3,Fera.Util.addZepto(opts),n=!0,opts.logger.log("Loading Zepto library because jQuery was not found within "+t+" milliseconds.")}}),r)},loadPushBuffer=function(e){var t=void 0!==(e=e||{}).except&&e.except,r=void 0!==e.only&&e.only;if(opts.pushBuffer=opts.pushBuffer||[],pushMethodReady=!0,"object"==typeof opts.pushBuffer&&opts.pushBuffer.length&&opts.pushBuffer.length>0)for(var i=!1,n=0;n<opts.pushBuffer.length;n++)if(i)i=!1;else{var a=opts.pushBuffer[n];if(t){for(var o=!1,s=0;s<e.except.length;s++)if("string"==typeof a){if(a===e.except[s]){o=!0,i=!0;break}}else if(a.action===e.except[s]){o=!0;break}if(o)continue}if("string"==typeof a){if(r&&a!==e.only)continue;self.push(a,opts.pushBuffer[n+1]),i=!0}else{if(r&&a.action!==e.only)continue;self.push(a)}}},ensureVisitorId=function(){self.visitorManager=new Fera.VisitorManager(opts),visitorId=self.visitorManager.ensureVisitorId()},loadSupportModules=function(){self.supportModules={instant_click:new Fera.InstantClickSupport(opts),shogun:new Fera.ShogunSupport(opts),weglot:new Fera.WeglotSupport(opts)}},allSupportModulesReady=function(){for(var e=Object.keys(self.supportModules),t=0;t<e.length;t++)if(!1===self.supportModules[e[t]].isReady)return!1;return!0},waitForSupportModules=function(e){if(allSupportModulesReady())return e();var t=0,r=setInterval((function(){if(allSupportModulesReady())return clearInterval(r),e();1e3===(t+=10)&&Fera.logger.warn("Support modules too longer than 1s to load and are blocking Fera from loading.")}),10)};self.startProductPageViewing=function(){};var setTranslationSettings=function(){self.storeSettings.language&&(self.locale||self.setLocale(self.storeSettings.language),self.locale!==self.storeSettings.language&&self.setDefaultLocale(self.storeSettings.language)),self.storeSettings.translated_strings&&self.i18n&&self.i18n.setTranslatedStrings(self.storeSettings.translated_strings)};self.setLocale=function(e){if(!e)return this;var t=e.split("-");t.length>1&&(e="zh"==t[0]?"zh-TW":t[0]),self.locale=e,self.i18n&&(self.i18n.locale=e)},self.setDefaultLocale=function(e){self.locale!==e&&self.i18n&&self.i18n.setDefaultLocale(e)},self.getLocaleWithFallback=function(){return self.i18n?self.i18n.localeWithFallback:self.locale},self.isUsingDefaultLocale=function(){return!self.i18n||self.i18n.usingDefaultLocale},init()},Fera.Api=class{constructor(e){this._opts=e||{},this._$=Fera.Util.$(),this._config={},this._app=this._opts.app,this.requestFailCount=0,this._pageLoaded=!1,this._apiClientDescriptor="fera.js-"+this._opts.app.version,this._DEFAULT_BASE_URL="https://app.fera.ai",this._$(document).ready((()=>this._pageLoaded=!0)),this._requestCache={}}configure(e){this._config=e;var t=this._opts.cookieJar.getCookie("Fera.Api.ServerNum",Math.random()<.5?1:2);this._opts.cookieJar.setCookie("Fera.Api.ServerNum",t,30);var r=`api${t&&t>1?t:""}.`;(!this._config.api_url||this._config.api_url.length<=0)&&(this._config.api_url=this._DEFAULT_BASE_URL.replace("//app.","//"+r)),this._config.api_url=this._config.api_url.replace("/api/v1/","/api/"),"/"!==this._config.api_url[this._config.api_url.length-1]&&(this._config.api_url=this._config.api_url+"/"),this.baseApiUrl=this._config.api_url,this.baseApiUrl=Fera.Util.htmlDecode(this.baseApiUrl),this.baseAppPath=this.baseApiUrl.replace(/^(https?:\/\/.*)\/api(\/v[0-9])?/i,"$1").replace(/(https?:\/\/)api[0-9]?\./i,"$1app.").replace(/\/$/,""),this.baseAppPath.match(/https?:\/\/app\./)?(this.baseCdnPath=this.baseAppPath.replace("app.","cdn."),this.baseFrontendPath=this.baseAppPath.replace("app.","www.")):(this._opts.debugMode?this.baseCdnPath=this.baseAppPath+"/cdn":this.baseCdnPath="https://cdn.fera.ai",this.baseFrontendPath="https://www.fera.ai"),this._isBot=Fera.Util.isBot()&&this.baseApiUrl.match(/\.fera\.ai/i)&&!this.baseApiUrl.match(/staging|test/i)}get _shopperDisabled(){return this._isBot||Fera.Util.isSpeedMode()}checkConfig(){return!!this.validConfig()||(this._opts.logger.error("Missing Fera API key. This usually means the footer script is missing (usually because your store theme was changed by someone or something).\nTry navigating to "+this._DEFAULT_BASE_URL+"/installation?reinstall=1 to fix this or contact our support team for help."),!1)}waitForApiConfig(e){var t,r=1e4,i=0,n=1,a=()=>this.validConfig()?(t&&clearInterval(t),e(),!0):((i+=n)===r&&this._opts.logger.warn("Waited more than "+r/1e3+" seconds for Fera api credentials and still don't have them. Please contact our support team for help if this is unexpected."),!1);a()||(t=setInterval(a,n))}validConfig(){return!(!this._config||!this._config.store_pk)}checkIn(e,t={}){var r=void 0===t.callback?()=>{}:t.callback;if(this._shopperDisabled)return r&&r();var i=JSON.parse(JSON.stringify(e));i.id=this._opts.visitorId,e.productId&&(i.product_id=e.productId,delete i.productId),e.customerId&&(i.customer_id=e.customerId,delete i.customerId),this._opts.testMode?this._opts.logger.warn("[TEST MODE] Not checking in because test mode is enabled, but the rest of the JS will think we did..",i):this._performImageRequest("check.gif",i,r)}mergeShoppers(e,t){return!this._shopperDisabled&&this._$.ajax({method:"POST",type:"POST",data:{},headers:{"API-CLIENT":this._apiClientDescriptor},dataType:"html",url:this._url("shoppers/"+e+"/merge",{other_id:t})})}pushEvent(e,t={}){var r=t.callback||t.then||(()=>{});if(this._shopperDisabled)return r&&r();"view"===e.type&&(void 0!==e.state.product_id&&(e.associated_to="product"),e.state=e.state||{},e.state.event_history=this._trackAndReturnHistory(e)),this._opts.testMode?this._opts.logger.warn("[TEST MODE] Not pushing event to the api because test mode is enabled, but the rest of the JS will think we did.",e):("object"==typeof e.state&&(e.state_json=JSON.stringify(e.state),delete e.state),"object"==typeof e.data&&(e.data_json=JSON.stringify(e.data),delete e.data),this._pageLoaded?this._sendEventData(e,r):this._$(document).ready((()=>this._sendEventData(e,r))))}getFeeds(e,t,r){this._opts.testMode?(e.test_mode=this._opts.testMode,this._cachedTestFeedResponse?t(this._cachedTestFeed(e.types)):this._request("GET",this._url("feeds.json",e),(r=>{this._cachedTestFeedResponse=r,t(this._cachedTestFeed(e.types))}),r)):this._request("GET",this._url("feeds.json",e),t,r)}_cachedTestFeed(e){for(var t=[],r=0;r<this._cachedTestFeedResponse.length;r++)e&&!e.includes(this._cachedTestFeedResponse[r].type)||t.push(this._$.extend(!0,{},this._cachedTestFeedResponse[r]));return t}getReviews(e,t,r){if(this._opts.testMode){e.test_mode=!this._opts.app.opts.hasUrlFlagOff("fera_use_samples"),e.page=e.page||1,e.limit=e.limit||5,e.samples=!this._opts.app.opts.hasUrlFlagOff("fera_use_samples");var i=JSON.stringify(e);let n=this._app.storeSettings.cache_data.last_updated.customer_review||"0";if(this._requestCache.customer_reviews=this._requestCache.customer_reviews||{},this._requestCache.customer_reviews[n]=this._requestCache.customer_reviews[n]||{},this._requestCache.customer_reviews[n]&&this._requestCache.customer_reviews[n][i]){if(void 0===this._requestCache.customer_reviews[n][i].result)return this._requestCache.customer_reviews[n][i].onSuccess.push((e=>t(e.result,e.count)));{let e=this._requestCache.customer_reviews[n][i];return t(e.result,e.count)}}this._requestCache.customer_reviews[n][i]={result:void 0,onSuccess:[e=>t(e.result,e.count)],onError:[e=>r(e.result,e.count)],count:null},this._request("GET",this._url("reviews.json",e),((e,t,r)=>{this._requestCache.customer_reviews[n][i].result=e,this._requestCache.customer_reviews[n][i].count=this.cachedTestReviewTotalCount=parseInt(r.getResponseHeader("Total-Count"))||0,this._requestCache.customer_reviews[n][i].onSuccess.forEach((e=>e(this._requestCache.customer_reviews[n][i]))),this._requestCache.customer_reviews[n][i].onSuccess=[]}),(e=>{this._requestCache.customer_reviews[n][i].onError.forEach((t=>t(e))),delete this._requestCache.customer_reviews[n][i]}))}else this._request("GET",this._url("reviews.json",e),((e,r,i)=>{var n=parseInt(i.getResponseHeader("Total-Count"))||0;return t&&t(e,n)}),r)}getPhotos(e,t,r){let i=this._app.storeSettings.cache_data.last_updated.customer_photo||"0";if(this._requestCache.customer_photos=this._requestCache.customer_photos||{},this._requestCache.customer_photos[i]=this._requestCache.customer_photos[i]||{},this._requestCache.customer_photos[i][e]){let r=this._requestCache.customer_photos[i][e];return t(r.result,r.totalCount)}this._request("GET",this._url("photos.json",e),((r,n,a)=>{var o=parseInt(a.getResponseHeader("Total-Count"))||0;return this._requestCache.customer_photos[i][e]={totalCount:o,result:r},t&&t(r,o)}),r)}getTestimonials(e,t,r){return e.type="store",this.getReviews(e,t,r)}getCustomerMedia(e,t,r){var i=t=>e.only_photos?t.filter((function(e){return"photo"===e.type})):e.only_videos?t.filter((function(e){return"video"===e.type})):t;if(e.media_ids&&e.media_ids.length>0&&(e.media_ids=e.media_ids.filter((e=>!!e))),this._opts.testMode){e.test_mode=this._opts.testMode;var n=(e.page||e.offset)+"x"+e.limit;if(this._cachedTestCustomerMediaResponse&&this._cachedTestCustomerMediaResponse[n]&&!e.media_ids)return t(i(this._cachedTestCustomerMediaResponse[n]),this._cachedTestCustomerMediaTotalCount[n]);this._request("GET",this._url("customer_media.json",e),((r,a,o)=>{var s=parseInt(o.getResponseHeader("Total-Count"))||0;if(e.media_ids)return t(r,s);this._cachedTestCustomerMediaResponse=this._cachedTestCustomerMediaResponse||{},this._cachedTestCustomerMediaTotalCount=this._cachedTestCustomerMediaTotalCount||{},this._cachedTestCustomerMediaResponse[n]=r,this._cachedTestCustomerMediaTotalCount[n]=s,t(i(this._cachedTestCustomerMediaResponse[n]),this._cachedTestCustomerMediaTotalCount[n])}),r)}else{let i=this._app.storeSettings.cache_data.last_updated.customer_photo||"0";i+=this._app.storeSettings.cache_data.last_updated.customer_video||"0",this._requestCache.customer_media=this._requestCache.customer_media||{},this._requestCache.customer_media[i]=this._requestCache.customer_media[i]||{};let n=e.cache_key+(e.page||e.offset)+"x"+e.limit;if(delete e.cache_key,this._requestCache.customer_media[i][n]){let e=this._requestCache.customer_media[i][n];return t(e.result,e.totalCount)}this._request("GET",this._url("customer_media.json",e),((e,r,a)=>{var o=parseInt(a.getResponseHeader("Total-Count"))||0;return this._requestCache.customer_media[i][n]={totalCount:o,result:e},t&&t(e,o)}),r)}}getContent(e,t,r){if(t=t||(()=>{}),e.visitor_id=this._opts.visitorId,e.api_client=encodeURIComponent(this._apiClientDescriptor),e.state=e.state||{},e.push_view_event){var i=this._$.extend(e,{type:"view"});e.state.event_history=this._trackAndReturnHistory(i)}this._opts.testMode&&(e.test_mode=this._opts.testMode),this._opts.optionsParser.hasPreviewFilterById()&&(e.fera_preview=this._opts.optionsParser.getPreviewId());var n=this._url("content.json");e.state_json=JSON.stringify(e.state),delete e.state;var a=Fera.Util.sizeOfParams(e)>Fera.Util.maxGetRequestChars()?"POST":"GET";return this._$.ajax({method:a,type:a,data:e,url:n,success:(e,r,i)=>{i.getResponseHeader("api-client-outdated")&&this._opts.app.clearCache(),this.requestFailCount=0,t(e,r,i)},error:e=>{this.requestFailCount+=1,r&&r(e)}})}getSection(e,t){let r={visitor_id:this._opts.visitorId,api_client:encodeURIComponent(this._apiClientDescriptor),test_mode:this._opts.testMode};return this._$.ajax({method:"GET",type:"GET",data:r,url:this._url("section.json"),success:(t,r,i)=>{i.getResponseHeader("api-client-outdated")&&this._opts.app.clearCache(),e(t.section,r,i)},error:e=>{t&&t(e)}})}getProducts(e,t,r){this._requestCache.getProducts=this._requestCache.getProducts||{},this._requestCache.getProducts[e]=this._requestCache.getProducts[e]||{successCallbacks:[],errorCallbacks:[]};let i=this._requestCache.getProducts[e];if(i.response){if(!0===i.response.success)return t(i.response.data);if(!1===i.response.success)return r(i.response.data)}this._requestCache.getProducts[e].successCallbacks.push(t),this._requestCache.getProducts[e].errorCallbacks.push(r),this._requestCache.getProducts[e].called||(this._requestCache.getProducts[e].called=!0,this._request("GET",this._url("products.json",e),(t=>{this._requestCache.getProducts[e].response={data:t,success:!0},this._requestCache.getProducts[e].successCallbacks.forEach((e=>e(t)))}),(t=>{this._requestCache.getProducts[e].response={data:t,success:!1},this._requestCache.getProducts[e].errorCallbacks.forEach((e=>e(t)))})))}contentSubmission(e,t=""){this._$.ajax({url:this._url("content_submissions"+t,e.params),method:"POST",type:"POST",data:e.data,contentType:!1,processData:!1,success:e.success,error:e.error})}requestContentSubmissionTemplate(e){let t=this._$.extend({visitor_id:this._opts.app.getVisitorId(),language:this._opts.app.locale},e.params);var r=this._url("content_submissions/template",t);this._request("GET",r,e.success,e.error)}triggerActions(e={},t={}){this._opts.app.getState((r=>((e=this._$.extend({},r,e)).visitor_id=this._opts.visitorId,this._opts.testMode&&(e.test_mode=this._opts.testMode),this._opts.optionsParser.hasPreviewFilterById()&&(e.fera_preview=this._opts.optionsParser.getPreviewId()),this._$.ajax({method:"POST",type:"POST",data:e,url:this._url("shoppers/"+this._opts.visitorId+"/trigger_skill_actions"),success:(e,r,i)=>{this.requestFailCount=0,t.success&&t.success&&t.success(e,r,i)},error:e=>{this.requestFailCount+=1,t.error&&t.error&&t.error(e)}}))))}getShopper(e,t){return this._request("GET",this._url("shoppers/"+e),t,t)}deleteShopper(e,t){return this._request("DELETE",this._url("shoppers/"+e),t,t)}_url(e,t={},r=this.baseApiUrl){return t.public_key=this._config.store_pk,this._opts.adminMode&&(t.adminSessionToken&&(t.admin_session_token=this._opts.adminSessionToken),t.admin=this._opts.adminMode),this._opts.debugMode&&(t.debug_mode=!0),this._opts.app.visitorManager.isNew&&(t.first=!0),(this._opts.app.opts.hasUrlFlag("cache")||this._opts.app.opts.hasUrlFlagOff("cache"))&&(t.cache=this._opts.app.opts.hasUrlFlag("cache")),(r+="public/")+(e=e||"")+"?"+this._$.param(t)}_trackAndReturnHistory(e){var t=this._opts.localStorage.getObject("EventHistory",{}),r=(new Date).getTime(),i=e.associated_to||(void 0!==e.state.product_id?"product":"any"),n="any"===i?"any":i+"-"+e.state.product_id;return t[e.type]=t[e.type]||{},t[e.type][n]=t[e.type][n]||[],t[e.type][n].push(r/1e3),t[e.type][n].length>2&&t[e.type][n].splice(1,1),this._opts.localStorage.setObject("EventHistory",t),t[e.type][n]}_performImageRequest(e,t,r){var i=document.createElement("img");t.api_client=this._apiClientDescriptor,i.src=this._url(e,t),this._$(i).on("load error",(()=>r(this._$(i))))}_sendEventData(e,t){t=t||(()=>{});var r=this._opts.debugMode?"POST":Fera.Util.httpMethodToUse(e);if("GET"!==r)return this._$.ajax({method:r,type:r,headers:{"API-CLIENT":this._apiClientDescriptor},data:JSON.stringify(e),url:this._url("events.json"),dataType:"html",success:t=>{this._opts.logger.log("Successfully sent event",e,t)},error:r=>{if(r.status<300)return t&&t(r);var i="unknown error";try{i=JSON.parse(r.responseText).error_message}catch(e){}this._opts.logger.warn("Event failed to send: "+i,e,r)},complete:t});this._performImageRequest("e.gif",e,t)}_request(e,t,r,i){this._$.ajax({method:e,type:e,headers:{"API-CLIENT":this._apiClientDescriptor},url:t,success:r,error:i})}},Fera.State=class{constructor(e){this._opts=e,this._app=e.app}getData(e){var t={current_page:{url:window.location.toString(),referrer:document.referrer,title:document.title},location:this._opts.shopperLocation||{}};return(this._app.opts.debugMode||this._app.opts.adminMode)&&(t.device={width:window.screen&&window.screen.width,height:window.screen&&window.screen.height,agent:navigator&&navigator.userAgent,language:navigator&&navigator.language,is_bot:Fera.Util.isBot(),is_speed_mode:Fera.Util.isSpeedMode()}),Fera.Util.isBot()||(t.customer_id=this._app.getCustomerId()||"",t.interaction_time=this._opts.timeTracker.getTotalInteractionTime(),t.time_since_first_seen=this._opts.timeTracker.getTimeSinceFirstSeen(),t.session_time=this._opts.timeTracker.getSessionTime(),t.time_on_current_page=this._opts.timeTracker.getTimeOnCurrentPage(),t.inactive_time_on_current_page=this._opts.timeTracker.getInactiveTimeOnPage()),this._app.getSection()&&(t.section=this._app.getSection()),this._app.getProductId()&&(t.product_id=this._app.getProductId()),this._app.getProduct()&&(t.product=this._app.getProduct()),this._app.getVariantId()&&(t.variant_id=this._app.getVariantId()),Fera.Util.isBot()||(this._app.cart&&this._app.cart.hasData()&&(this._app.cart.validateData()?t.cart=this._app.cart.getData():Fera.logger.warn("Invalid cart data",this._app.cart)),this._app.abTests.present()&&(t.test_buckets=this._app.abTests.getBuckets())),e(t),t}},Fera.VisitorManager=function(e){var t,r=this,i=(e=e||{}).cookieJar,n=1825,a=function(){};r.ensureVisitorId=function(){return t=r.getId(),o(),t?(r.isNew=!1,s()):(r.isNew=!0,l()),t},r.setId=function(e){-1!==(t=e).indexOf(" path=/")&&(t=t.replace(" path=/","")),i.setCookie("banana_stand_visitor_id",t,n)},r.getId=function(){return i.getCookie("banana_stand_visitor_id")};var o=function(){var r=e.optionsParser.feraParams.shopper;r&&(r=r.toLowerCase(),t?t!==r&&(Fera.logger.log("Shopper (visitor) ID was changed from URL. Merge operation impending.",t,r),e.api.mergeShoppers(t,r)):Fera.logger.log("Shopper (visitor) ID was set from URL.",t),t=r)},s=function(){r.setId(t)},l=function(){var e=Fera.Util.generateUUID();r.setId(e)};a()},Fera.Notification=function(e,t){var r,i,n=this,a=t.app.geo,o=Fera.Util.$(),s=function(){n.data=e,e.rendered_html&&(r=e.rendered_html)};this.getId=function(){return parseInt(e.id)},this.getHtml=function(){return r||(h()?r:"")},this.getEl=function(){return i||(i=o(n.getHtml()),c()),i};var l=function(e){if(e.split(",").length<2)return e;if(window.__feraTestMode)return e;if(!a.hasStoredInfo()||!a.ipResult||!a.ipResult.country_name)return e;var t=new RegExp("^(.+,\\s?)?(.+?),\\s?"+a.ipResult.country_code+"$","i");e=e.replace(t,"$1$2");var r=[a.ipResult.country_name];"US"===a.ipResult.country_code&&r.push("U\\.S\\.A","United States","United States of America","U\\.S\\.A\\.","U\\.S","U\\.S\\.","USA","US");var i=new RegExp("^(.+)?,\\s?("+r.join("|")+")$","i");return e=e.replace(i,"$1")},c=function(){i.find(".banana-product-caption, .fera-product-caption").each((function(){var e=o(this),t=e.find(".banana-product-link, .fera-product-link");0===t.length&&(t=e)
;var r=e.data("max_product_name_length")||30,n=t.text();if(r<3)Fera.logger.warn("Max product name length was entered in as less than 3, so may have been a mistake. Product name was not truncated.",e,r);else if(n.length>r+3){var a,s=n.substr(0,r)+"...";t.text(s),i.on("mouseenter",(function(){t.text(n)})),i.on("mouseleave",(function(){a&&clearTimeout(a),a=setTimeout((function(){t.text(s)}),1e3)}))}}))},u=function(){var r=o.extend(!0,{},t.settings,e);r.customer_name_display=e.shopper.name,r.show_name=!("Someone"===e.shopper.name||!e.shopper.name)&&t.settings.show_name;var i=t.isPreview&&Math.random()<.3,n="Someone"==r.customer_name_display||!r.show_name||r.customer_name_display==t.settings.string_templates.someone||i,a=t.app.getLocaleWithFallback();r.cust_profile_img=e.shopper.picture,r.cust_profile_img&&(n&&("female_only"===r.profile_pic_fallback_mode?-1===r.cust_profile_img.indexOf("female")&&(r.cust_profile_img=r.cust_profile_img.replace("male","female")):"male_only"===r.profile_pic_fallback_mode?r.cust_profile_img=r.cust_profile_img.replace("female","male"):"user_defined"===r.profile_pic_fallback_mode?r.cust_profile_img=r.profile_pic_custom_url:"none"===r.profile_pic_fallback_mode&&(r.cust_profile_img="",r.display_picture_html="",r.cust_profile_tag=null)),r.cust_profile_img&&(r.cust_profile_tag='<img src="'+r.cust_profile_img+'" alt="'+(n?"Anonymous profile picture":r.customer_name_display)+'" class="fera-profileImage">',"shopper_profile_pic"===t.settings.picture_mode?r.display_picture_html=r.cust_profile_tag:"product_image"===t.settings.picture_mode&&e.product&&e.product.thumbnail?r.display_picture_html='<img src="'+e.product.thumbnail+'" alt="'+e.product.name+'" class="banana-profile-image banana-profile-image-product fera-profile-image fera-profile-image-product">':r.display_picture_html=""));var s,c=new Fera.TimeAgo({language:a,time:r.created_at});if("Someone"!==r.customer_name_display&&r.show_name&&(r.customer_name_display=Fera.Util.toTitleCase(r.customer_name_display)),r.location_string=e.shopper.location,r.location_string&&(r.location_string=Fera.Util.toTitleCase(r.location_string),r.location_string=l(r.location_string)),e.shopper.location_details&&(r.shopper.location=e.shopper.location_details),r.seconds_ago=c.toSeconds(),r.product_display=e.product?e.product.name:"",r.event_time=c.toString(),r.use_product_name=!(t.app.getProductId()&&r.product&&t.app.getProductId()==r.product.id),r.action_type="product_order"===e.type?"customer_ordered_product":"customer_added_to_cart",r.event_type=e.type,t.settings.popout&&(r.popout=!0),r.options=t.settings,r.shopper_name=n?t.settings.string_templates.someone||"Someone":'<span class="banana-customer-name fera-customer-name">'+r.customer_name_display+"</span>",r.shopper_location='<span class="banana-location fera-location">'+r.location_string+"</span>",r.product_name='<span class="banana-product-caption fera-product-caption" data-max_product_name_length="'+r.max_product_name_length+'">',r.product&&r.product.name?(r.product.url&&(r.product_name+='<a href="'+r.product.url+'" target="'+r.product.id+'" class="banana-product-link fera-product-link">'),r.product_name+=r.product.name,r.product.url&&(r.product_name+="</a>")):r.product_name+="a product",t.app.isUsingDefaultLocale()&&t.settings.string_templates&&t.settings.string_templates.actions)s=t.settings.string_templates.actions[r.event_type];else if(t.settings.event_types){var u;(u=d(r.event_type))&&u[a]&&(s=u[a])}return s&&(r.statement=p(s,r).trim().replace(/\.$/,"")),r},d=function(e){for(var r,i,n=0;n<t.settings.event_types.length;n++)if((r=t.settings.event_types[n]).name===e){i=r.social_proof_templates;break}return i},p=function(e,t){var r=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!r)return Fera.logger.error("Template is empty or not valid.",e,t),"";var i=Fera.Liquid.parse(r);return i?i.render(t):(Fera.logger.error("Failed to parse template: ",i,t),"")},h=function(){var e=u();return""!==(r=p(t.settings.notification_template,e))};s()},Fera.Base=class{constructor(){this.$=Fera.Util.$()}_log(){return Fera.logger.log.apply(this,arguments)}_warn(){return Fera.logger.warn.apply(this,arguments)}_error(){return Fera.logger.error.apply(this,arguments)}_logWarning(){return Fera.logger.logWarning.apply(this,arguments)}};var FeraCachedAsset=function(e){var t=this;this.version="0.2.3";var r=e.name||e.url.split("?")[0].split("#")[0],i="Fera.AssetCache."+r,n=(new Date).getTime()/1e3,a=e.type||(-1!==e.url.indexOf(".html")?"text/template":-1!==e.url.indexOf(".css")?"text/css":"text/javascript");t.load=function(r){return r=r||function(){},t.content?r(t.content):(o()?r(t.content):l(e.url,(function(e){t.content=e,s(e),t.save(e),r(e)})),!0)},t.save=function(t){var a=n+(e.expiresIn||900);if(!c()||!t)return!1;var o={name:r,url:e.url,expires:a,content:t};return window.localStorage.setItem(i,JSON.stringify(o)),!0},t.clear=function(){return window.localStorage.removeItem(i),!1};var o=function(){if(!c())return!1;var r=window.localStorage.getItem(i);if(!r||"string"!=typeof r)return null;var a=JSON.parse(r);return a.expires<n||a.url!==e.url?t.clear():(t.content=a.content,s(t.content),!0)},s=function(e){if(!document.getElementById(i)){var t=document.createElement("text/css"===a?"style":"script");t.type=a,t.id=i,t.async=!0,t.innerHTML=e,document.body.appendChild(t)}},l=function(e,t){var r=new XMLHttpRequest;r.async=!0,r.onreadystatechange=function(){4==r.readyState&&r.status<300&&t(r.responseText)},r.open("GET",e,!0),r.send()},c=function(){var e="test";try{return window.localStorage.setItem(e,"t"),window.localStorage.removeItem(e),1}catch(e){return 0}}},BananaStandCachedAsset=FeraCachedAsset;Fera.Cart=function(e){var t,r,i=this,n=!1,a=!1,o=e.app.localStorage,s=[],l="Cart",c=6048e4,u=function(){h(),setTimeout((function(){a||i.update(!0)}),5e3)};i.setAdapter=function(e){r=e},i.addProductIfEmpty=function(e,t,r){i.ifEmpty((function(){"function"==typeof r.beforeAdd&&r.beforeAdd(),i.addProduct(e,t,r)}),r.afterAdd)},i.removeProduct=function(e,t,n){return t=t||{},n=n||{},!!i.containsProduct(e,t)&&r.removeProduct(e,t,n)},i.ifEmpty=function(e,r){i.update((function(){t&&0!==t.item_count?r&&r():e&&e()}),!0)},i.containsProducts=function(e){for(var t=0;t<e.length;t++)if(i.containsProduct(e[t]))return!0;return!1},i.containsProduct=function(e){if(!t||!t.items||t.items.length<1)return!1;for(var r=0;r<t.items.length;r++)if(t.items[r].product_id+""==e+"")return!0;return!1},i.getProductQuantity=function(e){if(!t||!t.items||t.items.length<1)return 0;for(var r=0,i=0;i<t.items.length;i++)t.items[i].product_id+""==e+""&&(r+=t.items[i].quantity||0);return r},i.update=function(e,t){if("boolean"==typeof e&&void 0===t&&(t=e,e=null),e=e||function(){},void 0===t&&(t=!1),t&&n||!r)return e();r.downloadData((function(t){i.loadData(t),n=!0,setTimeout((function(){n=!1}),5e3),e()}))},i.startCheckout=function(){if(!r)throw"No cart adapter specified so checkout cannot be triggered.";return r.startCheckout()},i.hasData=function(){return t},i.getData=function(){return t},i.loadItemData=function(e){var t=r?r.parseItemData(e):e;return i.addItem(t),i},i.loadData=function(n){return t=r?r.parseCartData(n):n,a=!0,d(t)&&(s.push({event:"change",at:(new Date).getTime()}),e.app.trigger("cart.changed")),p(),i},i.loadCartData=i.loadData,i.addProduct=function(e,t,i){if(!r)throw"No cart adapter specified so can't add product to the cart.";if(t=t||{},"function"==typeof(i=i||{})){var n=i;(i={}).afterAdd=n}return r.addProduct(e,t,i)},i.validateData=function(){if(!t)return e.logger.error("Cart data is empty."),!1;t.items||(e.logger.log("cart.items should be an array of items."),t.items=[]),t.total_weight||(t.total_weight=0),t.total_discount||(t.total_discount=0),t.currency||(e.logger.log("Missing cart.currency, assumed USD"),t.currency="USD");for(var r=0,i=0,n=0;n<t.items.length;n++){var a=t.items[n];if((!a.quantity||parseInt(a.quantity)<=0)&&(t.items[n].quantity=1),a.total||(a.price?t.items[n].total=t.items[n].quantity*a.price:t.items[n].total=0),!a.product_id){if(!a.id){e.logger.warn("Missing product_id, cannot track entry in cart",a),t.items.splice(n,1),n--;continue}a.product_id=a.id}a.variant_id||(t.items[n].variant_id=null),r+=t.items[n].quantity,i+=t.items[n].total}return t.item_count||(t.item_count=r),t.total||(t.total=i),t.grand_total||(t.grand_total=t.total),!0},i.addItem=function(e){t.item_count=t.item_count+e.quantity,t.total=t.total+e.total,t.total_weight=t.total_weight+e.weight,t.total_discount=t.total_discount+e.total_discount,delete e.weight,delete e.total_discount,t.items.push(e),s.push({event:"add",at:(new Date).getTime()}),p()},i.isEmpty=function(){return!t||0===Object.keys(t).length&&t.constructor===Object||0===t.item_count},i.getItemsString=function(){for(var e=[],r=0;r<t.items.length;r++)e.push(t.items[r].product_id+"x"+t.items[r].quantity);return e.join(",")},i.getHistory=function(){return s||[]},i.reset=function(){t=null,o&&o.removeItem(l),a=!0,s.push({event:"empty",at:(new Date).getTime()}),p(),e.app.trigger("cart.emptied")},i.clear=function(){r.clear((function(){i.reset()}))};var d=function(e){var t=f();if(!t)return!1;if(!e&&t)return!0;if(void 0!==e.item_count&&e.item_count!=t.item_count)return!0;if(void 0!==e.total&&e.total!=t.total)return!0;for(var r=0;r<t.items.length;r++)if(void 0===e.items[r]){if(void 0!==e.items[r].total&&e.items[r].total!=t.items[r].total)return!0;if(void 0!==e.items[r].product_id&&e.items[r].product_id!=t.items[r].product_id)return!0;if(void 0!==e.items[r].variant_id&&e.items[r].variant_id!=t.items[r].variant_id)return!0}return!1},p=function(){o&&o.setObject(l,{data:t,history:s},c)},h=function(){if(o){var e=o.getObject(l,{});t=e.data||e,s=e.history||[]}},f=function(){if(o)return o.getObject(l,{}).data};u()},Fera.CookieJar=function(e){var t=this;e="string"==typeof e?{namespace:e}:e||{};var r=function(){t.namespace=e.prefix||e.namespace||""};t.setCookie=function(e,r,i){var n="";if(i){var a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3),n="; expires="+a.toUTCString()}var o=t.namespace+e+"="+r+n+"; path=/; SameSite=None";0===window.location.toString().indexOf("https")&&(o+="; Secure"),document.cookie=o},t.getCookie=function(e,r){r=r||null;for(var i=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(i))return o.substring(i.length,o.length)}return 0===e.indexOf("Fera.")?t.getCookie(e.replace("Fera.","BananaStand."),r):0===e.indexOf("fera_")?t.getCookie(e.replace("fera_","bs_"),r):0===e.indexOf("fera-")?t.getCookie(e.replace("fera-","banana_stand-"),r):r},t.getCookieObject=function(e,r){var i=t.getCookie(e,r);return"string"==typeof i&&(i=JSON.parse(decodeURIComponent(atob(i)))),i},t.setCookieObject=function(e,r,i){return r=btoa(encodeURIComponent(JSON.stringify(r))),t.setCookie(e,r,i)},r()},Fera.DeepLinker=class{constructor(e){this._opts=e,this.$=Fera.Util.$(),this.app=this._opts.app}attachAndWatch(){setInterval((()=>this.locateAndAttachLinks()),1e3),Fera.Util.isSpeedMode()||this.locateAndAttachLinks()}locateAndAttachLinks(){this.$("[data-fera-action]").each(((e,t)=>this._attachDeepLink(this.$(t))))}_attachDeepLink(e){if(!e.data("fera-deep-link-attached")){var t=e.data("fera-action");if(-1!==["writeReview","submitPhotos","submitVideos","submitContent","submitMedia","showContentSubmission"].indexOf(t)&&(t="showContentSubmitter"),!t)throw"No action specified for fera deep link. Please refer to docs.fera.ai for help.";if(!this.app[t])throw"Invalid action specified. Please refer to docs.fera.ai for help.";this._attachClickListener(e,t)}}_attachClickListener(e,t){e.on("click",(r=>{r.preventDefault(),r.stopPropagation();var i=e.data()||{};this.app[t](i)})),e.data("fera-deep-link-attached",!0)}},Fera.EngagementRegistry=function(e){e=e||{};var t,r=this,i=[],n=[],a=[],o=function(){c()},s=function(){return!e.sandboxMode&&(!e.designMode&&(!Fera.Util.isBot()&&!Fera.Util.isSpeedMode()))};r.register=function(e){if(!e)throw"Campaign ID can't be blank";s()&&(l(e)?-1===i.indexOf(e)&&-1===n.indexOf(e)&&n.push(e):i.push(e),a.push(e),d())},r.pushEvent=function(){if(!(i.length<1&&n.length<1)){var t={type:"campaign_engagement",data:{engagements:{first_time:i,recurring:n}}};e.app.pushEvent(t),r.flush()}},r.state=function(){return{firstTime:i,recurring:n,historicalEngagements:a}},r.reset=function(){i=[],n=[],a=[],u()},r.flush=function(){i=[],n=[],u()};var l=function(e){return-1!==a.indexOf(e)},c=function(){a=e.localStorage.getObject("Fera.EngagementRegistry.historicalEngagements")||[]},u=function(){e.localStorage.setObject("Fera.EngagementRegistry.historicalEngagements",a)},d=function(){t&&clearTimeout(t),t=setTimeout((function(){try{r.pushEvent()}catch(r){throw t&&clearTimeout(t),e.logger.warn("Aborted watching for engagements since we got an error: ",r.message),r}}),1500)};o()},Fera.ExitIntentDetector=function(e){e=e||{};var t,r=Fera.Util.$(),i=e.sensitivity||300,n=function(){r(window).on("mouseleave",a),r(window).on("mouseenter",o)},a=function(r){r.clientY>0||(t&&clearTimeout(t),i<=0?e.onExitIntent&&(Fera.logger.log("Exit intent detected."),e.onExitIntent()):t=setTimeout((function(){t=null,e.onExitIntent&&(Fera.logger.log("Exit intent detected."),e.onExitIntent())}),i))},o=function(){t&&(clearTimeout(t),t=null)};n()},Fera.Geo=function(e){var t=this,r="https://geo.bananastand.io/json/",i=Fera.Util.$(),n=e.localStorage||new Fera.LocalStorageJar(e),a=function(){t.ipResult=null,o()||s()},o=function(){return!(!Fera.Util.isSpeedMode()&&!Fera.Util.isBot())&&(t.ipResult={ip:"99.250.99.99",continent:"NA",country_code:"CA",country_name:"Canada",region_code:"ON",region_name:"Ontario",city:"Waterloo",zip_code:"N2A",time_zone:"America/Toronto",latitude:43.4551002,longitude:-80.5413999},!0)};this.hasStoredInfo=function(){return null!==t.ipResult},this.getLocationInfo=function(e){t.ipResult?e(t.ipResult):t.geolocateIp(e)},this.geolocateIp=function(e,n){e=e||function(){},i.ajax({method:"GET",type:"GET",url:r,success:function(r){l(r),e(t.ipResult)},dataType:window.location.toString().indexOf("/checkouts")?"json":"jsonp",error:function(){n&&e({})}})};var s=function(){if(void 0!==n)try{t.ipResult=n.getObject(c())}catch(e){}},l=function(e){t.ipResult=e,void 0!==n&&n.setObject&&n.setObject(c(),t.ipResult,72e5)},c=function(){return"Geo.geolocateIp.result"};a()},Fera.I18n=class{constructor(e){this.locale=e.app.locale||document.documentElement.lang||"en"}get translations(){let e=this.localeWithFallback.split("-")[0];return this.constructor.TRANSLATIONS[e]}get localeWithFallback(){return this.isSupportedLanguage(this.locale)?this.locale:this.defaultLocale&&this.isSupportedLanguage(this.defaultLocale)?this.defaultLocale:"en"}get usingDefaultLocale(){return this.defaultLocale?this.localeWithFallback===this.defaultLocale:this.isSupportedLanguage(this.locale)}setTranslatedStrings(e){this.translatedStrings=e}setDefaultLocale(e){this.locale!==e&&(this.defaultLocale=e)}isSupportedLanguage(e){let t=e.split("-")[0];return this.supportedLanguages().includes(t)}supportedLanguages(){return["en",...Object.keys(this.constructor.TRANSLATIONS)]}t(e){let t=e;if(this.translations&&(t=this.translations[e]||e),this.translatedStrings){let e=this.translatedStrings[this.localeWithFallback];if(e&&e[t])return e[t]}return t}customTranslate(e,t){let r=this.t(e),i=t[this.localeWithFallback];return i&&i[r]?i[r]:r}static _getShopifyLocale(){let e=document.getElementById("shopify-features");if(e)return e=JSON.parse(e.innerHTML),e.locale}static get TRANSLATIONS(){return{fr:{"Real shoppers":"De vrais acheteurs","verified by Fera.ai":"v\xe9rifi\xe9 par Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} critique{% if review_count != 1 %}s{% endif %}","Product Reviews":"Avis sur les produits","Product:":"Produit:","Write a review":"\xc9crire une critique","Reviews From Similar Products":"Commentaires de produits similaires","Show More":"Montre Plus","No reviews for this product yet.":"Il n'y a pas encore de commentaire pour ce produit.","{{ store_name }} replied:":"{{ store_name }} a r\xe9pondu:","We're adding a 2nd item to your cart now!":"Nous ajoutons un deuxi\xe8me article \xe0 votre panier maintenant!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de {{ store.name }}","{{ num }} second ago":"Il y a {{ num }} seconde","{{ num }} minute ago":"il y a {{ num }} minute","{{ num }} hour ago":"Il ya {{ num }} heure","{{ num }} day ago":"il y a {{ num }} jour","{{ num }} week ago":"Il ya {{ num }} semaine","{{ num }} month ago":"Il ya {{ num }} mois","{{ num }} year ago":"il y a {{ num }} an","{{ num }} seconds ago":"Il y a {{ num }} secondes","{{ num }} minutes ago":"Il y a {{ num }} minutes","{{ num }} hours ago":"il y a {{ num }} heures","{{ num }} days ago":"il y a {{ num }} jours","{{ num }} weeks ago":"Il y a {{ num }} semaines","{{ num }} months ago":"il y a {{ num }} mois","{{ num }} years ago":"il y a {{ num }} ans","Loading...":"chargement en cours...",Submit:"Soumettre",Testimonials:"T\xe9moignages"},pt:{"Real shoppers":"Compradores reais","verified by Fera.ai":"verificado por Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} an\xe1lise{% if review_count != 1 %}s{% endif %}","Product Reviews":"Revis\xe3o de Produtos","Product:":"Produtos:","Write a review":"Escreva uma cr\xedtica","Reviews From Similar Products":"Avalia\xe7\xf5es de produtos semelhantes","Show More":"Mostre Mais","No reviews for this product yet.":"Ainda n\xe3o h\xe1 coment\xe1rios para este produto.","{{ store_name }} replied:":"{{ store_name }} respondeu","We're adding a 2nd item to your cart now!":"Estamos adicionando um segundo item ao seu carrinho agora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de {{ store.name }}","{{ num }} second ago":"{{ num }} segundo atr\xe1s","{{ num }} minute ago":"{{ num }} minuto atr\xe1s","{{ num }} hour ago":"{{ num }} hora atr\xe1s","{{ num }} day ago":"{{ num }} dia atr\xe1s","{{ num }} week ago":"{{ num }} semana atr\xe1s","{{ num }} month ago":"{{ num }} m\xeas atr\xe1s","{{ num }} year ago":"{{ num }} ano atr\xe1s","{{ num }} seconds ago":"{{ num }} segundos atr\xe1s","{{ num }} minutes ago":"{{ num }} minutos atr\xe1s","{{ num }} hours ago":"{{ num }} horas atr\xe1s","{{ num }} days ago":"{{ num }} dias atr\xe1s","{{ num }} weeks ago":"{{ num }} semanas atr\xe1s","{{ num }} months ago":"{{ num }} meses atr\xe1s","{{ num }} years ago":"{{ num }} anos atr\xe1s","Loading...":"carregando...",Submit:"Enviar",Testimonials:"Testemunhos"},nl:{"Real shoppers":"Echte kopers","verified by Fera.ai":"geverifieerd door Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} productbeoordeling{% if review_count != 1 %}en{% endif %}","Product Reviews":"Productrecensies","Product:":"Product:","Write a review":"Schrijf een recensie","Reviews From Similar Products":"Recensies van vergelijkbare producten","Show More":"Laat Meer Zien","No reviews for this product yet.":"Er zijn nog geen beoordelingen voor dit product.","{{ store_name }} replied:":"{{ store_name }} respondeu:","We're adding a 2nd item to your cart now!":"We voegen nu een tweede artikel toe aan uw winkelwagen!","{{ user.name }} from {{ store.name }}":"{{ user.name }} van {{ store.name }}","{{ num }} second ago":"{{ num }} seconde geleden","{{ num }} minute ago":"{{ num }} minuut geleden","{{ num }} hour ago":"{{ num }} uur geleden","{{ num }} day ago":"{{ num }} dag geleden","{{ num }} week ago":"{{ num }} week geleden","{{ num }} month ago":"{{ num }} maand geleden","{{ num }} year ago":"{{ num }} jaar geleden","{{ num }} seconds ago":"{{ num }} seconden geleden","{{ num }} minutes ago":"{{ num }} minuten geleden","{{ num }} hours ago":"{{ num }} uur geleden","{{ num }} days ago":"{{ num }} dagen geleden","{{ num }} weeks ago":"{{ num }} weken geleden","{{ num }} months ago":"{{ num }} maanden geleden","{{ num }} years ago":"{{ num }} jaar geleden","Loading...":"bezig met laden...",Submit:"Verzenden",Testimonials:"Getuigenissen"},de:{"Real shoppers":"Echter K\xe4ufer","verified by Fera.ai":"verifiziert von Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} Produktbewertung{% if review_count != 1 %}en{% endif %}","Product Reviews":"Produktrezensionen","Product:":"Produkt:","Write a review":"Eine Rezension schreiben","Reviews From Similar Products":"Bewertungen von \xe4hnlichen Produkten","Show More":"Zeig Mehr","No reviews for this product yet.":"Es gibt noch keine Bewertungen f\xfcr dieses Produkt.","{{ store_name }} replied:":"{{ store_name }} antwortete:","We're adding a 2nd item to your cart now!":"Wir legen jetzt einen zweiten Artikel in Ihren Warenkorb!","{{ user.name }} from {{ store.name }}":"{{ user.name }} von {{ store.name }}","{{ num }} second ago":"vor {{ num }} Sekunde","{{ num }} minute ago":"vor {{ num }} Minute","{{ num }} hour ago":"vor {{ num }} Stunde","{{ num }} day ago":"vor {{ num }} Tag","{{ num }} week ago":"vor {{ num }} Woche","{{ num }} month ago":"vor {{ num }} Monat","{{ num }} year ago":"vor {{ num }} Jahr","{{ num }} seconds ago":"vor {{ num }} Sekunden","{{ num }} minutes ago":"vor {{ num }} Minuten","{{ num }} hours ago":"vor {{ num }} Stunden","{{ num }} days ago":"vor {{ num }} Tagen","{{ num }} weeks ago":"vor {{ num }} Wochen","{{ num }} months ago":"vor {{ num }} Monaten","{{ num }} years ago":"vor {{ num }} Jahren","Loading...":"wird geladen...",Submit:"Einreichen",Testimonials:"Referenzen"},id:{"Real shoppers":"Pembeli sungguhan","verified by Fera.ai":"diverifikasi oleh Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} ulasan","Product Reviews":"Ulasan produk","Product:":"Produk:","Write a review":"Menulis review","Reviews From Similar Products":"Review Dari Produk Sejenis","Show More":"Menampilkan Lebih Banyak","No reviews for this product yet.":"Belum ada review untuk produk ini.","{{ store_name }} replied:":"{{ store_name }} menjawab:","We're adding a 2nd item to your cart now!":"Kami menambahkan item kedua ke keranjang Anda sekarang!","{{ user.name }} from {{ store.name }}":"{{ user.name }} dari {{ store.name }}","{{ num }} second ago":"{{ num }} detik yang lalu","{{ num }} minute ago":"{{ num }} menit yang lalu","{{ num }} hour ago":"{{ num }} jam yang lalu","{{ num }} day ago":"{{ num }} hari yang lalu","{{ num }} week ago":"{{ num }} minggu yang lalu","{{ num }} month ago":"{{ num }} bulan yang lalu","{{ num }} year ago":"{{ num }} tahun yang lalu","{{ num }} seconds ago":"{{ num }} detik yang lalu","{{ num }} minutes ago":"{{ num }} menit yang lalu","{{ num }} hours ago":"{{ num }} jam lalu","{{ num }} days ago":"{{ num }} hari yang lalu","{{ num }} weeks ago":"{{ num }} minggu yang lalu","{{ num }} months ago":"{{ num }} bulan yang lalu","{{ num }} years ago":"{{ num }} tahun yang lalu","Loading...":"memuat...",Submit:"Kirimkan",Testimonials:"Testimonial"},it:{"Real shoppers":"Veri clienti","verified by Fera.ai":"verificato da Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} recension{% if review_count == 1 %}e{% else %}i{% endif %}","Product Reviews":"Recensioni dei prodotti","Product:":"Prodotto:","Write a review":"Scrivi una recensione","Reviews From Similar Products":"Recensioni di prodotti simili","Show More":"Mostra Di Pi\xf9","No reviews for this product yet.":"Nessuna recensione per questo prodotto ancora.","{{ store_name }} replied:":"{{ store_name }} ha risposto:","We're adding a 2nd item to your cart now!":"Stiamo aggiungendo un secondo articolo al tuo carrello ora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} da {{ store.name }}","{{ num }} second ago":"{{ num }} secondo fa","{{ num }} minute ago":"{{ num }} minuto fa","{{ num }} hour ago":"{{ num }} ora fa","{{ num }} day ago":"{{ num }} giorno fa","{{ num }} week ago":"{{ num }} settimana fa","{{ num }} month ago":"{{ num }} mese fa","{{ num }} year ago":"{{ num }} anno fa","{{ num }} seconds ago":"{{ num }} secondi fa","{{ num }} minutes ago":"{{ num }} minuti fa","{{ num }} hours ago":"{{ num }} ore fa","{{ num }} days ago":"{{ num }} giorni fa","{{ num }} weeks ago":"{{ num }} settimane fa","{{ num }} months ago":"{{ num }} mesi fa","{{ num }} years ago":"{{ num }} anni fa","Loading...":"caricamento in corso...",Submit:"Invia",Testimonials:"Testimonianze"},no:{"Real shoppers":"Ekte shoppere","verified by Fera.ai":"bekreftet av Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} produktanmeldelse{% if review_count != 1 %}r{% endif %}","Product Reviews":"Produktomtaler","Product:":"Produkt:","Write a review":"Skrive en omtale","Reviews From Similar Products":"Anmeldelser Fra Lignende Produkter","Show More":"Vis Mer","No reviews for this product yet.":"Ingen anmeldelser for dette produktet enn\xe5.","{{ store_name }} replied:":"{{ store_name }} svarte:","We're adding a 2nd item to your cart now!":"Vi legger til en ny vare i handlekurven din n\xe5!","{{ user.name }} from {{ store.name }}":"{{ user.name }} fra {{ store.name }}","{{ num }} second ago":"For {{ num }} sekund siden","{{ num }} minute ago":"For {{ num }} minutt siden","{{ num }} hour ago":"{{ num }} time siden","{{ num }} day ago":"For {{ num }} dag siden","{{ num }} week ago":"{{ num }} uke siden","{{ num }} month ago":"{{ num }} m\xe5ned siden","{{ num }} year ago":"{{ num }} \xe5r siden","{{ num }} seconds ago":"{{ num }} sekunder siden","{{ num }} minutes ago":"{{ num }} minutter siden","{{ num }} hours ago":"{{ num }} timer siden","{{ num }} days ago":"{{ num }} dager siden","{{ num }} weeks ago":"{{ num }} uker siden","{{ num }} months ago":"{{ num }} m\xe5neder siden","{{ num }} years ago":"{{ num }} \xe5r siden","Loading...":"laster inn ...",Submit:"Sende inn",Testimonials:"Attester"},ro:{"Real shoppers":"Cump\u0103r\u0103tori adev\u0103ra\u021bi","verified by Fera.ai":"verificat de Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} recenzi{% if review_count == 1 %}e{% else %}i{% endif %}","Product Reviews":"Recenzii despre produs","Product:":"Produs:","Write a review":"Scrie o recenzie","Reviews From Similar Products":"Recenzii de la produse similare","Show More":"Afi\u0219a\u021bi Mai Multe","No reviews for this product yet.":"Nu exist\u0103 \xeenc\u0103 recenzii pentru acest produs.","{{ store_name }} replied:":"{{ store_name }} a r\u0103spuns:","We're adding a 2nd item to your cart now!":"Acum ad\u0103ug\u0103m un al doilea articol \xeen co\u0219!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de la {{ store.name }}","{{ num }} second ago":"Acum {{ num }} secund\u0103","{{ num }} minute ago":"Acum {{ num }} minut","{{ num }} hour ago":"{{ num }} or\u0103 \xeen urm\u0103","{{ num }} day ago":"Acum o zi","{{ num }} week ago":"{{ num }} s\u0103pt\u0103m\xe2n\u0103 \xeen urm\u0103","{{ num }} month ago":"Acum o lun\u0103","{{ num }} year ago":"{{ num }} an in urma","{{ num }} seconds ago":"Acum {{ num }} secunde","{{ num }} minutes ago":"acum {{ num }} minute","{{ num }} hours ago":"{{ num }} ore \xeen urm\u0103","{{ num }} days ago":"{{ num }} zile \xeen urm\u0103","{{ num }} weeks ago":"acum {{ num }} saptamani","{{ num }} months ago":"acum {{ num }} luni","{{ num }} years ago":"Acum {{ num }} ani","Loading...":"se \xeencarc\u0103...",Submit:"Trimite",Testimonials:"M\u0103rturii"},ru:{"Real shoppers":"\u041d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0435 \u043f\u043e\u043a\u0443\u043f\u0430\u0442\u0435\u043b\u0438","verified by Fera.ai":"\u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043e Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{% assign mod_t = review_count | modulo: 10 %}{{ review_count }} \u043e\u0442\u0437\u044b\u0432{% if mod_t > 1 and mod_t < 5 and review_count < 12 or review_count > 14 %}\u0430{% elsif mod_t != 1 or review_count == 11 %}\u043e\u0432{% endif %}","Product Reviews":"\u041e\u0431\u0437\u043e\u0440\u044b \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432","Product:":"\u041f\u0440\u043e\u0434\u0443\u043a\u0442:","Write a review":"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0440\u0435\u0446\u0435\u043d\u0437\u0438\u044e","Reviews From Similar Products":"\u041e\u0442\u0437\u044b\u0432\u044b \u043e \u043f\u043e\u0445\u043e\u0436\u0438\u0445 \u0442\u043e\u0432\u0430\u0440\u0430\u0445","Show More":"\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435","No reviews for this product yet.":"\u041d\u0435\u0442 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043e\u0431 \u044d\u0442\u043e\u043c \u0442\u043e\u0432\u0430\u0440\u0435 \u0435\u0449\u0435.","{{ store_name }} replied:":"{{ store_name }} \u043e\u0442\u0432\u0435\u0442\u0438\u043b:","We're adding a 2nd item to your cart now!":"\u041c\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432 \u0432\u0430\u0448\u0443 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0432\u0442\u043e\u0440\u043e\u0439 \u0442\u043e\u0432\u0430\u0440!","{{ user.name }} from {{ store.name }}":"{{ user.name }} \u0438\u0437 {{ store.name }}","{{ num }} second ago":"{{ num }} \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u043d\u0430\u0437\u0430\u0434","{{ num }} minute ago":"{{ num }} \u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434","{{ num }} hour ago":"{{ num }} \u0447\u0430\u0441 \u043d\u0430\u0437\u0430\u0434","{{ num }} day ago":"{{ num }} \u0434\u0435\u043d\u044c \u043d\u0430\u0437\u0430\u0434","{{ num }} week ago":"{{ num }} \u043d\u0435\u0434\u0435\u043b\u044e \u043d\u0430\u0437\u0430\u0434","{{ num }} month ago":"{{ num }} \u043c\u0435\u0441\u044f\u0446 \u043d\u0430\u0437\u0430\u0434","{{ num }} year ago":"{{ num }} \u0433\u043e\u0434 \u043d\u0430\u0437\u0430\u0434","{{ num }} seconds ago":"{{ num }} \u0441\u0435\u043a\u0443\u043d\u0434\u044b \u043d\u0430\u0437\u0430\u0434","{{ num }} minutes ago":"{{ num }} \u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434","{{ num }} hours ago":"{{ num }} \u0447\u0430\u0441\u0430 \u043d\u0430\u0437\u0430\u0434","{{ num }} days ago":"{{ num }} \u0434\u043d\u044f \u0441\u043f\u0443\u0441\u0442\u044f","{{ num }} weeks ago":"{{ num }} \u043d\u0435\u0434\u0435\u043b\u0438 \u043d\u0430\u0437\u0430\u0434","{{ num }} months ago":"{{ num }} \u043c\u0435\u0441\u044f\u0446\u0430 \u043d\u0430\u0437\u0430\u0434","{{ num }} years ago":"{{ num }} \u0433\u043e\u0434\u0430 \u043d\u0430\u0437\u0430\u0434","Loading...":"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 ...",Submit:"\u0420\u0430\u0437\u043c\u0435\u0441\u0442\u0438\u0442\u044c",Testimonials:"\u041e\u0442\u0437\u044b\u0432\u044b"},es:{"Real shoppers":"Compradores reales","verified by Fera.ai":"verificado por Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} opini{% if review_count == 1 %}\xf3n{% else %}ones{% endif %}","Product Reviews":"Rese\xf1as de productos","Product:":"Producto:","Write a review":"Escribe una rese\xf1a","Reviews From Similar Products":"Rese\xf1as de productos similares","Show More":"Mostrar M\xe1s","No reviews for this product yet.":"No hay comentarios para este producto todav\xeda.","{{ store_name }} replied:":"{{ store_name }} respondi\xf3:","We're adding a 2nd item to your cart now!":"\xa1Estamos agregando un segundo art\xedculo a su carrito ahora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} para {{ store.name }}","{{ num }} second ago":"hace {{ num }} segundo","{{ num }} minute ago":"Hace {{ num }} minuto","{{ num }} hour ago":"{{ num }} hora antes","{{ num }} day ago":"Hace {{ num }} d\xeda","{{ num }} week ago":"Hace {{ num }} semana","{{ num }} month ago":"Hace {{ num }} mes","{{ num }} year ago":"hace {{ num }} a\xf1o","{{ num }} seconds ago":"Hace {{ num }} segundos","{{ num }} minutes ago":"hace {{ num }} minutos","{{ num }} hours ago":"Hace {{ num }} horas","{{ num }} days ago":"hace {{ num }} d\xedas","{{ num }} weeks ago":"hace {{ num }} semanas","{{ num }} months ago":"hace {{ num }} meses","{{ num }} years ago":"hace {{ num }} a\xf1os","Loading...":"cargando...",Submit:"Enviar",Testimonials:"Testimonios"},sk:{"Real shoppers":"Skuto\u010dn\xed kupuj\xfaci","verified by Fera.ai":"overen\xe9 Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} recenzi{% if review_count == 1 %}a{% elsif review_count > 1 and review_count < 5 %}e{% else %}\xed{% endif %}","Product Reviews":"Recenzie produktu","Product:":"V\xfdrobok:","Write a review":"Nap\xedsa\u0165 recenziu",
"Reviews From Similar Products":"Recenzie z podobn\xfdch produktov","Show More":"Zobrazi\u0165 Viac","No reviews for this product yet.":"Zatia\u013e nie s\xfa k tomuto produktu \u017eiadne recenzie.","{{ store_name }} replied:":"{{ store_name }} je odgovoril:","We're adding a 2nd item to your cart now!":"Teraz do v\xe1\u0161ho ko\u0161\xedka prid\xe1vame druh\xfa polo\u017eku!","{{ user.name }} from {{ store.name }}":"{{ user.name }} z {{ store.name }}","{{ num }} second ago":"Pred {{ num }} sekundou","{{ num }} minute ago":"Pred {{ num }} min\xfatou","{{ num }} hour ago":"pred {{ num }} hodinou","{{ num }} day ago":"Pred {{ num }} d\u0148om","{{ num }} week ago":"Pred {{ num }} t\xfd\u017ed\u0148om","{{ num }} month ago":"Pred {{ num }} mesiacom","{{ num }} year ago":"Pred {{ num }} rokom","{{ num }} seconds ago":"Pred {{ num }} sekundami","{{ num }} minutes ago":"Pred {{ num }} min\xfatami","{{ num }} hours ago":"pred {{ num }} hodinami","{{ num }} days ago":"pred {{ num }} d\u0148ami","{{ num }} weeks ago":"Pred {{ num }} tyzdnami","{{ num }} months ago":"Pred {{ num }} mesiacmi","{{ num }} years ago":"Pred {{ num }} rokmi","Loading...":"na\u010d\xedtava...",Submit:"Predlo\u017ei\u0165",Testimonials:"Ohlasy"},sv:{"Real shoppers":"Riktiga shoppare","verified by Fera.ai":"verifierad av Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} produktrecension{% if review_count != 1 %}er{% endif %}","Product Reviews":"Produktrecensioner","Product:":"Produkt:","Write a review":"Skriva en recension","Reviews From Similar Products":"Recensioner fr\xe5n liknande produkter","Show More":"Visa Mer","No reviews for this product yet.":"Inga recensioner f\xf6r denna produkt \xe4nnu.","{{ store_name }} replied:":"{{ store_name }} svarade:","We're adding a 2nd item to your cart now!":"Vi l\xe4gger till en andra artikel i din kundvagn nu!","{{ user.name }} from {{ store.name }}":"{{ user.name }} fr\xe5n {{ store.name }}","{{ num }} second ago":"{{ num }} sekund sedan","{{ num }} minute ago":"{{ num }} minut sedan","{{ num }} hour ago":"{{ num }} timme sedan","{{ num }} day ago":"{{ num }} dag sedan","{{ num }} week ago":"{{ num }} vecka sedan","{{ num }} month ago":"{{ num }} m\xe5nad sedan","{{ num }} year ago":"{{ num }} \xe5r sedan","{{ num }} seconds ago":"{{ num }} sekunder sedan","{{ num }} minutes ago":"f\xf6r {{ num }} minuter sedan","{{ num }} hours ago":"{{ num }} timmar sedan","{{ num }} days ago":"{{ num }} dagar sedan","{{ num }} weeks ago":"{{ num }} veckor sedan","{{ num }} months ago":"{{ num }} m\xe5nader sedan","{{ num }} years ago":"{{ num }} \xe5r sedan","Loading...":"l\xe4ser in...",Submit:"Skicka in",Testimonials:"Vittnesm\xe5l"},th:{"Real shoppers":"\u0e1c\u0e39\u0e49\u0e0b\u0e37\u0e49\u0e2d\u0e08\u0e23\u0e34\u0e07","verified by Fera.ai":"\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e42\u0e14\u0e22 Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} \u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19\u0e15\u0e48\u0e2d\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32","Product Reviews":"\u0e1a\u0e17\u0e27\u0e34\u0e08\u0e32\u0e23\u0e13\u0e4c\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32","Product:":"\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32:","Write a review":"\u0e41\u0e2a\u0e14\u0e07\u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19","Reviews From Similar Products":"\u0e1a\u0e17\u0e27\u0e34\u0e08\u0e32\u0e23\u0e13\u0e4c\u0e08\u0e32\u0e01\u0e1c\u0e25\u0e34\u0e15\u0e20\u0e31\u0e13\u0e11\u0e4c\u0e17\u0e35\u0e48\u0e04\u0e25\u0e49\u0e32\u0e22\u0e04\u0e25\u0e36\u0e07\u0e01\u0e31\u0e19","Show More":"\u0e41\u0e2a\u0e14\u0e07\u0e21\u0e32\u0e01\u0e02\u0e36\u0e49\u0e19","No reviews for this product yet.":"\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e21\u0e35\u0e01\u0e32\u0e23\u0e23\u0e35\u0e27\u0e34\u0e27\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32\u0e19\u0e35\u0e49","{{ store_name }} replied:":"{{ store_name }} \u0e15\u0e2d\u0e1a\u0e01\u0e25\u0e31\u0e1a:","We're adding a 2nd item to your cart now!":"\u0e40\u0e23\u0e32\u0e01\u0e33\u0e25\u0e31\u0e07\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32\u0e0a\u0e34\u0e49\u0e19\u0e17\u0e35\u0e48\u0e2a\u0e2d\u0e07\u0e43\u0e19\u0e23\u0e16\u0e40\u0e02\u0e47\u0e19\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13\u0e15\u0e2d\u0e19\u0e19\u0e35\u0e49!","{{ user.name }} from {{ store.name }}":"{{ user.name }} \u0e08\u0e32\u0e01 {{ store.name }}","{{ num }} second ago":"{{ num }} \u0e27\u0e34\u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} minute ago":"{{ num }} \u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} hour ago":"{{ num }} \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} day ago":"{{ num }} \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} week ago":"{{ num }} \u0e2a\u0e31\u0e1b\u0e14\u0e32\u0e2b\u0e4c\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} month ago":"{{ num }} \u0e40\u0e14\u0e37\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} year ago":"{{ num }} \u0e1b\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} seconds ago":"{{ num }} \u0e27\u0e34\u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} minutes ago":"{{ num }} \u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} hours ago":"{{ num }} \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} days ago":"{{ num }} \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} weeks ago":"{{ num }} \u0e2a\u0e31\u0e1b\u0e14\u0e32\u0e2b\u0e4c\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} months ago":"{{ num }} \u0e40\u0e14\u0e37\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} years ago":"{{ num }} \u0e1b\u0e35\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","Loading...":"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e42\u0e2b\u0e25\u0e14 ...",Submit:"\u0e2a\u0e48\u0e07",Testimonials:"\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e23\u0e31\u0e1a\u0e23\u0e2d\u0e07"},zh:{"Real shoppers":"\u771f\u6b63\u7684\u8d2d\u7269\u8005","verified by Fera.ai":"\u7531Fera.ai\u9a8c\u8bc1","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} {% if review_count == 1 %}\u4e2a\u4ea7{% else %}\u4ef6\u5546{% endif %}\u54c1\u8bc4\u8bba","Product Reviews":"\u7522\u54c1\u8a55\u8ad6","Product:":"\u7522\u54c1\uff1a","Write a review":"\u5beb\u4e00\u7bc7\u8a55\u8ad6","Reviews From Similar Products":"\u4f86\u81ea\u985e\u4f3c\u7522\u54c1\u7684\u8a55\u8ad6","Show More":"\u986f\u793a\u66f4\u591a","No reviews for this product yet.":"\u8fd9\u4ef6\u5546\u54c1\u8fd8\u6ca1\u6709\u4efb\u4f55\u8bc4\u8bba\u3002","{{ store_name }} replied:":"{{ store_name }} \u56de\u7b54\uff1a","We're adding a 2nd item to your cart now!":"\u6211\u5011\u73fe\u5728\u5c07\u7b2c\u4e8c\u4ef6\u5546\u54c1\u6dfb\u52a0\u5230\u60a8\u7684\u8cfc\u7269\u8eca\uff01","{{ user.name }} from {{ store.name }}":"\u4ee3\u8868 {{ store.name }} \u7684 {{ user.name }}","{{ num }} second ago":"{{ num }}\u79d2\u524d","{{ num }} minute ago":"{{ num }}\u5206\u9418\u524d","{{ num }} hour ago":"{{ num }}\u5c0f\u6642\u524d","{{ num }} day ago":"{{ num }}\u5929\u524d","{{ num }} week ago":"{{ num }}\u9031\u524d","{{ num }} month ago":"{{ num }}\u500b\u6708\u524d","{{ num }} year ago":"{{ num }}\u5e74\u524d","{{ num }} seconds ago":"{{ num }}\u79d2\u524d","{{ num }} minutes ago":"{{ num }}\u5206\u9418\u524d","{{ num }} hours ago":"{{ num }}\u5c0f\u6642\u524d","{{ num }} days ago":"{{ num }}\u5929\u524d","{{ num }} weeks ago":"{{ num }}\u500b\u661f\u671f\u524d","{{ num }} months ago":"{{ num }}\u500b\u6708\u524d","{{ num }} years ago":"{{ num }}\u5e74\u524d","Loading...":"\u8f09\u5165\u4e2d...",Submit:"\u63d0\u4ea4",Testimonials:"\u611f\u8a00"}}}},Fera.ImageViewer=class{init(e){this.$=Fera.Util.$(),this.$el=this.$(this.selector),this.$el.length<1&&(this._render(),this.$el=this.$(this.selector),this.$el.find(".fera-imageViewer-container").on("click",this._hide.bind(this))),e.on("click",this._show.bind(this))}get selector(){return".fera-imageViewer-overlay"}_show(e){let t=this.$(e.target).clone().removeClass();if(t.data("imageUrl")){const e=t.data("imageUrl");t=this.$(`<img src="${e}" />`)}const r=this.$('<a href="#" class="fera-imageViewer-close-btn">&times;</a>');this.$el.removeClass("fera-hidden"),this.$el.find(".fera-imageViewer").html(t),this.$el.find(".fera-imageViewer").append(r),this.$("body").addClass("fera-modal--open"),r.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._hide()})),this.$(document).on("keydown",(e=>{27===(e.keyCode||e.which)&&this._hide()}))}_hide(e){if(e){if(!this.$(e.target).is(".fera-imageViewer-container"))return}this.$el.addClass("fera-hidden"),this.$("body").removeClass("fera-modal--open")}_render(){this.$("body").append(this._tpl()).append(`<style>${this._css()}</style>`)}_tpl(){return'\n<div class="fera-imageViewer-overlay fera-hidden">\n    <div class="fera-imageViewer-container">\n        <div class="fera-imageViewer"></div>\n    </div>\n</div>\n        '}_css(){return"\n.fera-modal--open {\n    overflow: hidden !important;\n}\n\n.fera-hidden {\n    display: none !important;\n}\n\n.fera-imageViewer-overlay {\n    position: fixed;\n    background: rgba(0,0,0,0.4);\n    z-index: 9999999;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fera-imageViewer-container {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.fera-imageViewer {\n    max-width: 100%;\n    max-height: 100%;\n    line-height: 0;\n    position: relative;\n    margin-left: 1%;\n    margin-right: 1%;\n    text-align: center;\n    text-shadow: 0 0 1px white, 0 0 1px white, 0 0 1px white;\n}\n\n.fera-imageViewer-close-btn {\n    color: #000000;\n    font-weight: 100;\n    font-size: 1.5rem;\n    line-height: 0.75rem;\n    position: absolute;\n    right: 14px;\n    top: 14px;\n}\n\n.fera-imageViewer img {\n    width: auto !important;\n    max-width: 100%;\n    max-height: 768px; /* fallback */\n    max-height: 98vh;\n    background-color: #ffffff;\n}\n\n.fera-imageViewer-viewable {\n    cursor: pointer;\n}\n        "}},Fera.InactivityDetector=function(e){e=e||{};var t,r=this,i=!1,n=Fera.Util.$(),a=void 0===e.reactToWindowBlurs||e.reactToWindowBlurs,o=[],s=[],l=[],c=!0;r.hadInteraction=!1;var u=function(){e.timeLimit=e.timeLimit||6e4,f()};r.attachToFrames=function(){for(var t=0;t<window.frames.length;t++)try{m(window.frames[t],window.frames[t].document)}catch(r){e.logger.log("Failed to attach to frame. Likely due to it being of a different origin than the main frame.",t)}},r.afterFirstInteraction=function(e,t){r.hadInteraction?e():(l.push(e),t&&setTimeout((function(){if(!r.hadInteraction){for(var t=0;t<l.length;t++)if(l[t]===e){l.splice(t,1);break}e()}}),t))},r.addInactivityListener=function(e){o.push(e)},r.addReactivityListener=function(e){s.push(e)},r.isActive=function(){return c};var d=function(){for(var e=0;e<s.length;e++)s[e](r);c=!0},p=function(){for(var e=0;e<o.length;e++)o[e](r);c=!1},h=function(){r.hadInteraction=!0;for(var e=0;e<l.length;e++)l[e](r)},f=function(){m(window,document),r.attachToFrames()},m=function(e,t){n(t).on("mousemove keypress mousedown touchstart click scroll",g),a&&(n(e).on("blur",v),n(e).on("focus",_)),n(e).on("scroll",(function(){i&&_()}))},g=function(){_(),t=setTimeout(v,e.timeLimit)},v=function(){var e=i;i=!0,e||p()},_=function(){t&&clearTimeout(t),r.hadInteraction||h();var e=i;i=!1,e&&d()};u()},Fera.Liquid={registerFilters:function(e){Fera.Liquid.Template.registerFilter(e)},parse:function(e){return Fera.Liquid.Template.parse(e)}},Fera.Liquid.extensions={},Fera.Liquid.extensions.object={},Fera.Liquid.extensions.object.update=function(e){for(var t in e)this[t]=e[t];return this},Fera.Liquid.extensions.object.hasKey=function(e){return!!this[e]},Fera.Liquid.extensions.object.hasValue=function(e){for(var t in this)if(this[t]==e)return!0;return!1},Fera.Liquid.extensions.object.isEmpty=function(e){if(!e||""===Fera.Liquid.extensions.stringTools.strip(e.toString()))return!0;if(e.length&&e.length>0)return!1;if("number"==typeof e)return!1;for(var t in e)if(e[t])return!1;return!0},Fera.Liquid.extensions.stringTools={},Fera.Liquid.extensions.stringTools.capitalize=function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},Fera.Liquid.extensions.stringTools.strip=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},Fera.Liquid.extensions.arrayTools={},Fera.Liquid.extensions.arrayTools.last=function(e){return e[e.length-1]},Fera.Liquid.extensions.arrayTools.indexOf=function(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return r;return-1},Fera.Liquid.extensions.arrayTools.map=function(e,t){var r=e.length;if("function"!=typeof t)throw"Fera.Liquid.extensions.arrayTools.map requires first argument to be a function";for(var i=new Array(r),n=arguments[2],a=0;a<r;a++)a in e&&(i[a]=t.call(n,e[a],a,e));return i},Fera.Liquid.extensions.arrayTools.flatten=function(e){for(var t=e.length,r=[],i=0;i<t;i++)e[i]instanceof Array?r=r.concat(e[i]):r.push(e[i]);return r},Fera.Liquid.extensions.arrayTools.each=function(e,t){var r=e.length;if("function"!=typeof t)throw"Fera.Liquid.extensions.arrayTools.each requires first argument to be a function";for(var i=arguments[2],n=0;n<r;n++)n in e&&t.call(i,e[n],n,e);return null},Fera.Liquid.extensions.arrayTools.include=function(e,t){e.length;return Fera.Liquid.extensions.arrayTools.indexOf(e,t)>=0},function(){var e=!1,t=/xyz/.test((function(){xyz}))?/\b_super\b/:/.*/;this.Class=function(){},this.Class.extend=function(r){function i(){!e&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;e=!0;var a=new this;for(var o in e=!1,r)a[o]="function"==typeof r[o]&&"function"==typeof n[o]&&t.test(r[o])?function(e,t){return function(){var r=this._super;this._super=n[e];var i=t.apply(this,arguments);return this._super=r,i}}(o,r[o]):r[o];return i.prototype=a,i.prototype.constructor=i,i.extend=arguments.callee,i}}.call(Fera.Liquid),Fera.Liquid.Tag=Fera.Liquid.Class.extend({init:function(e,t,r){this.tagName=e,this.markup=t,this.nodelist=this.nodelist||[],this.parse(r)},parse:function(){},render:function(){return""}}),Fera.Liquid.Block=Fera.Liquid.Tag.extend({init:function(e,t,r){this.blockName=e,this.blockDelimiter="end"+this.blockName,this._super(e,t,r)},parse:function(e){this.nodelist||(this.nodelist=[]),this.nodelist.length=0;var t=e.shift();for(e.push("");e.length;){if(/^\{\%/.test(t)){this.whitespaceHandler(t,e);var r=t.match(/^\{\%-?\s*(\w+)\s*(.*?)-?\%\}$/);if(!r)throw"Tag '"+t+"' was not properly terminated with: %}";if(this.blockDelimiter==r[1])return void this.endTag();r[1]in Fera.Liquid.Template.tags?this.nodelist.push(new Fera.Liquid.Template.tags[r[1]](r[1],r[2],e)):this.unknownTag(r[1],r[2],e)}else/^\{\{/.test(t)?(this.whitespaceHandler(t,e),this.nodelist.push(this.createVariable(t))):this.nodelist.push(t);t=e.shift()}this.assertMissingDelimitation()},endTag:function(){},unknownTag:function(e){switch(e){case"else":throw this.blockName+" tag does not expect else tag";case"end":throw"'end' is not a valid delimiter for "+this.blockName+" tags. use "+this.blockDelimiter;default:throw"Unknown tag: "+e}},createVariable:function(e){var t=e.match(/^\{\{-?(.*?)-?\}\}$/);if(t)return new Fera.Liquid.Variable(t[1]);throw"Variable '"+e+"' was not properly terminated with: }}"},render:function(e){return this.renderAll(this.nodelist,e)},renderAll:function(e,t){return Fera.Liquid.extensions.arrayTools.map(e||[],(function(e){var r="";try{r=e.render?e.render(t):e}catch(e){r=t.handleError(e)}return r}))},assertMissingDelimitation:function(){throw this.blockName+" tag was never closed"},whitespaceHandler:function(e,t){"-"==e[2]&&this.nodelist.length>0&&""===this.nodelist[this.nodelist.length-1].trim()&&this.nodelist.pop(),"-"===e[e.length-3]&&t.length>0&&""===t[0].trim()&&t.shift()}}),Fera.Liquid.Document=Fera.Liquid.Block.extend({init:function(e){this.blockDelimiter=[],this.parse(e)},assertMissingDelimitation:function(){}}),Fera.Liquid.Strainer=Fera.Liquid.Class.extend({init:function(e){this.context=e},respondTo:function(e){return!(e=e.toString()).match(/^__/)&&(!Fera.Liquid.extensions.arrayTools.include(Fera.Liquid.Strainer.requiredMethods,e)&&e in this)}}),Fera.Liquid.Strainer.filters={},Fera.Liquid.Strainer.globalFilter=function(e){for(var t in e)Fera.Liquid.Strainer.filters[t]=e[t]},Fera.Liquid.Strainer.requiredMethods=["respondTo","context"],Fera.Liquid.Strainer.create=function(e){var t=new Fera.Liquid.Strainer(e);for(var r in Fera.Liquid.Strainer.filters)t[r]=Fera.Liquid.Strainer.filters[r];return t},Fera.Liquid.Context=Fera.Liquid.Class.extend({init:function(e,t,r){this.scopes=[e||{}],this.registers=t||{},this.errors=[],this.rethrowErrors=r,this.strainer=Fera.Liquid.Strainer.create(this)},get:function(e){return this.resolve(e)},set:function(e,t){this.scopes[0][e]=t},hasKey:function(e){return!!this.resolve(e)},push:function(){var e={};return this.scopes.unshift(e),e},merge:function(e){return Fera.Liquid.extensions.object.update.call(this.scopes[0],e)},pop:function(){if(1==this.scopes.length)throw"Context stack error";return this.scopes.shift()},stack:function(e,t){var r=null;this.push();try{r=e.apply(t||this.strainer)}finally{this.pop()}return r},invoke:function(e,t){return this.strainer.respondTo(e)?this.strainer[e].apply(this.strainer,t):0==t.length?null:t[0]},resolve:function(e){switch(e){case null:case"nil":case"null":case"":return null;case"true":return!0;case"false":return!1;case"blank":case"empty":return"";default:if(/^'(.*)'$/.test(e))return e.replace(/^'(.*)'$/,"$1");if(/^"(.*)"$/.test(e))return e.replace(/^"(.*)"$/,"$1");if(/^(\d+)$/.test(e))return parseInt(e.replace(/^(\d+)$/,"$1"));if(/^(\d[\d\.]+)$/.test(e))return parseFloat(e.replace(/^(\d[\d\.]+)$/,"$1"));if(/^\((\S+)\.\.(\S+)\)$/.test(e)){var t=e.match(/^\((\S+)\.\.(\S+)\)$/),r=parseInt(t[1]),i=parseInt(t[2]),n=[];if(isNaN(r)){var a=this.resolve(t[1]);if(r=parseInt(a),isNaN(r))throw new Error("Incorrect param for range: "+e)}if(isNaN(i)){var o=this.resolve(t[2]);if(i=parseInt(o),isNaN(i))throw new Error("Incorrect param for range: "+e)}for(var s=i-r+1,l=0;l<s;l++)n.push(l+r);return n}return this.variable(e)}},findVariable:function(e){for(var t=0;t<this.scopes.length;t++){var r=this.scopes[t];if(r&&void 0!==r[e]){var i=r[e];return"function"==typeof i&&(i=i.apply(this),r[e]=i),i&&this._isObject(i)&&"toFera.Liquid"in i&&(i=i.toFera.Liquid()),i&&this._isObject(i)&&"setContext"in i&&i.setContext(self),i}}return null},variable:function(e){if("string"!=typeof e)return null;var t=e.match(/\[[^\]]+\]|(?:[\w\-]\??)+/g),r=t.shift(),i=r.match(/^\[(.*)\]$/);i&&(r=this.resolve(i[1]));var n=this.findVariable(r),a=this;return n&&Fera.Liquid.extensions.arrayTools.each(t,(function(e){var t=e.match(/^\[(.*)\]$/);if(t){e=a.resolve(t[1]);"function"==typeof n[e]&&(n[e]=n[e].apply(this)),n=n[e],a._isObject(n)&&"toFera.Liquid"in n&&(n=n.toFera.Liquid())}else{if((a._isObject(n)||"hash"==typeof n)&&e in n){var r=n[e];"function"==typeof r&&(r=n[e]=r.apply(a)),n=a._isObject(r)&&"toFera.Liquid"in r?r.toFera.Liquid():r}else if(/^\d+$/.test(e)){var i=parseInt(e);"function"==typeof n[i]&&(n[i]=n[i].apply(a)),n=a._isObject(n)&&a._isObject(n[i])&&"toFera.Liquid"in n[i]?n[i].toFera.Liquid():n[i]}else{if(!n||"function"!=typeof n[e]||!Fera.Liquid.extensions.arrayTools.include(["length","size","first","last"],e))return n=null;"toFera.Liquid"in(n=n[e].apply(e))&&(n=n.toFera.Liquid())}a._isObject(n)&&"setContext"in n&&n.setContext(a)}})),n},addFilters:function(e){e=Fera.Liquid.extensions.arrayTools.flatten(e),Fera.Liquid.extensions.arrayTools.each(e,(function(e){if(!this._isObject(e))throw"Expected object but got: "+typeof e;this.strainer.addMethods(e)}))},handleError:function(e){if(this.errors.push(e),this.rethrowErrors)throw e;return"Fera.Liquid error: "+(e.message?e.message:e.description?e.description:e)},_isObject:function(e){return null!=e&&"object"==typeof e}}),Fera.Liquid.Template=Fera.Liquid.Class.extend({init:function(){this.root=null,this.registers={},this.assigns={},this.errors=[],this.rethrowErrors=!1},parse:function(e){return this.root=new Fera.Liquid.Document(Fera.Liquid.Template.tokenize(e)),this},render:function(){if(!this.root)return"";var e={ctx:arguments[0],filters:arguments[1],registers:arguments[2]},t=null;e.ctx instanceof Fera.Liquid.Context?(t=e.ctx,this.assigns=t.assigns,this.registers=t.registers):(e.ctx&&Fera.Liquid.extensions.object.update.call(this.assigns,e.ctx),e.registers&&Fera.Liquid.extensions.object.update.call(this.registers,e.registers),t=new Fera.Liquid.Context(this.assigns,this.registers,this.rethrowErrors)),e.filters&&t.addFilters(arg.filters);try{return this.root.render(t).join("")}finally{this.errors=t.errors}},renderWithErrors:function(){var e=this.rethrowErrors;this.rethrowErrors=!0;var t=this.render.apply(this,arguments);return this.rethrowErrors=e,t}}),Fera.Liquid.Template.tags={},Fera.Liquid.Template.registerTag=function(e,t){Fera.Liquid.Template.tags[e]=t},Fera.Liquid.Template.registerFilter=function(e){Fera.Liquid.Strainer.globalFilter(e)},Fera.Liquid.Template.tokenize=function(e){var t=e.split(/(\{\%.*?\%\}|\{\{.*?\}\}?)/);return""==t[0]&&t.shift(),t},Fera.Liquid.Template.parse=function(e){return(new Fera.Liquid.Template).parse(e)},Fera.Liquid.Variable=Fera.Liquid.Class.extend({init:function(e){this.markup=e,this.name=null,this.filters=[];var t=this,r=e.match(/\s*("[^"]+"|'[^']+'|[^\s,|]+)/);if(r){this.name=r[1];var i=e.match(/\|\s*(.*)/);if(i){var n=i[1].split(/\|/);Fera.Liquid.extensions.arrayTools.each(n,(function(e){var r=e.match(/\s*(\w+)/);if(r){var i=r[1],n=[];Fera.Liquid.extensions.arrayTools.each(Fera.Liquid.extensions.arrayTools.flatten(e.match(/(?:[:|,]\s*)("[^"]+"|'[^']+'|[^\s,|]+)/g)||[]),(function(e){var t=e.match(/^[\s|:|,]*(.*?)[\s]*$/);t&&n.push(t[1])})),t.filters.push([i,n])}}))}}},render:function(e){if(null==this.name)return"";var t=e.get(this.name);return Fera.Liquid.extensions.arrayTools.each(this.filters,(function(r){var i=r[0],n=Fera.Liquid.extensions.arrayTools.map(r[1]||[],(function(t){return e.get(t)}));n.unshift(t),t=e.invoke(i,n)})),t}}),Fera.Liquid.Condition=Fera.Liquid.Class.extend({init:function(e,t,r){this.left=e,this.operator=t,this.right=r,this.childRelation=null,this.childCondition=null,this.attachment=null},evaluate:function(e){e=e||new Fera.Liquid.Context;var t=this.interpretCondition(this.left,this.right,this.operator,e);switch(this.childRelation){case"or":return t||this.childCondition.evaluate(e);case"and":return t&&this.childCondition.evaluate(e);default:return t}},or:function(e){this.childRelation="or",this.childCondition=e},and:function(e){this.childRelation="and",this.childCondition=e},attach:function(e){return this.attachment=e,this.attachment},isElse:!1,interpretCondition:function(e,t,r,i){if(!r)return i.get(e);if(e=i.get(e),t=i.get(t),!(r=Fera.Liquid.Condition.operators[r]))throw"Unknown operator "+r;return r(e,t)},toString:function(){return"<Condition "+this.left+" "+this.operator+" "+this.right+">"}}),Fera.Liquid.Condition.operators={"==":function(e,t){return e==t},"=":function(e,t){return e==t},"!=":function(e,t){return e!=t},"<>":function(e,t){return e!=t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},contains:function(e,t){return"[object Array]"===Object.prototype.toString.call(e)?Fera.Liquid.extensions.arrayTools.indexOf(e,t)>=0:e.match(t)},hasKey:function(e,t){return Fera.Liquid.extensions.object.hasKey.call(e,t)},hasValue:function(e,t){return Fera.Liquid.extensions.object.hasValue.call(e,t)}},Fera.Liquid.ElseCondition=Fera.Liquid.Condition.extend({isElse:!0,evaluate:function(){return!0},toString:function(){return"<ElseCondition>"}}),Fera.Liquid.Drop=Fera.Liquid.Class.extend({setContext:function(e){this.context=e},beforeMethod:function(){},invokeDrop:function(e){var t=this.beforeMethod();return!t&&e in this&&(t=this[e].apply(this)),t},hasKey:function(){return!0}});var hackObjectEach=function(e){if("function"!=typeof e)throw"Object.each requires first argument to be a function";var t=0,r=arguments[1];for(var i in this){var n=this[i],a=[i,n];a.key=i,a.value=n,e.call(r,a,t,this),t++}return null},split;Fera.Liquid.Template.registerTag("assign",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)\s*=\s*(.+)/,init:function(e,t,r){var i=t.match(this.tagSyntax);if(!i)throw"Syntax error in 'assign' - Valid syntax: assign [var] = [source]";this.to=i[1],this.from=i[2],this._super(e,t,r)},render:function(e){var t=new Fera.Liquid.Variable(this.from);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to.toString()]=t.render(e),""}})),Fera.Liquid.Template.registerTag("cache",Fera.Liquid.Block.extend({tagSyntax:/(\w+)/,init:function(e,t,r){var i=t.match(this.tagSyntax);if(!i)throw"Syntax error in 'cache' - Valid syntax: cache [var]";this.to=i[1],this._super(e,t,r)},render:function(e){var t=this._super(e);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to]=Fera.Liquid.extensions.arrayTools.flatten([t]).join(""),""}})),Fera.Liquid.Template.registerTag("capture",Fera.Liquid.Block.extend({tagSyntax:/(\w+)/,init:function(e,t,r){var i=t.match(this.tagSyntax);if(!i)throw"Syntax error in 'capture' - Valid syntax: capture [var]";this.to=i[1],this._super(e,t,r)},render:function(e){var t=this._super(e);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to.toString()]=Fera.Liquid.extensions.arrayTools.flatten([t]).join(""),""}})),Fera.Liquid.Template.registerTag("case",Fera.Liquid.Block.extend({tagSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)/,tagWhenSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)(?:(?:\s+or\s+|\s*\,\s*)("[^"]+"|'[^']+'|[^\s,|]+.*))?/,init:function(e,t,r){this.blocks=[],this.nodelist=[];var i=t.match(this.tagSyntax);if(!i)throw"Syntax error in 'case' - Valid syntax: case [condition]";this.left=i[1],this._super(e,t,r)},unknownTag:function(e,t,r){switch(e){case"when":this.recordWhenCondition(t);break;case"else":this.recordElseCondition(t);break;default:this._super(e,t,r)}},render:function(e){var t=this,r=[],i=!0;return e.stack((function(){for(var n=0;n<t.blocks.length;n++){var a=t.blocks[n];if(a.isElse)return 1==i&&(r=Fera.Liquid.extensions.arrayTools.flatten([r,t.renderAll(a.attachment,e)])),r;a.evaluate(e)&&(i=!1,r=Fera.Liquid.extensions.arrayTools.flatten([r,t.renderAll(a.attachment,e)]))}})),r},recordWhenCondition:function(e){for(;e;){var t=e.match(this.tagWhenSyntax);if(!t)throw"Syntax error in tag 'case' - Valid when condition: {% when [condition] [or condition2...] %} ";e=t[2];var r=new Fera.Liquid.Condition(this.left,"==",t[1]);this.blocks.push(r),this.nodelist=r.attach([])}},recordElseCondition:function(e){if(""!=Fera.Liquid.extensions.stringTools.strip(e||""))throw"Syntax error in tag 'case' - Valid else condition: {% else %} (no parameters) ";var t=new Fera.Liquid.ElseCondition;this.blocks.push(t),this.nodelist=t.attach([])}})),Fera.Liquid.Template.registerTag("comment",Fera.Liquid.Block.extend({render:function(){return""}})),Fera.Liquid.Template.registerTag("cycle",Fera.Liquid.Tag.extend({tagSimpleSyntax:/"[^"]+"|'[^']+'|[^\s,|]+/,tagNamedSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)\s*\:\s*(.*)/,init:function(e,t,r){var i;if(i=t.match(this.tagNamedSyntax))this.variables=this.variablesFromString(i[2]),this.name=i[1];else{if(!(i=t.match(this.tagSimpleSyntax)))throw"Syntax error in 'cycle' - Valid syntax: cycle [name :] var [, var2, var3 ...]";this.variables=this.variablesFromString(t),this.name="'"+this.variables.toString()+"'"}this._super(e,t,r)},render:function(e){var t=this,r=e.get(t.name),i="";return e.registers.cycle||(e.registers.cycle={}),e.registers.cycle[r]||(e.registers.cycle[r]=0),e.stack((function(){var n=e.registers.cycle[r],a=e.get(t.variables[n]);(n+=1)==t.variables.length&&(n=0),e.registers.cycle[r]=n,i=a})),i},variablesFromString:function(e){return Fera.Liquid.extensions.arrayTools.map(e.split(","),(function(e){var t=e.match(/\s*("[^"]+"|'[^']+'|[^\s,|]+)\s*/);return t[1]?t[1]:null}))}})),Fera.Liquid.Template.registerTag("for",Fera.Liquid.Block.extend({tagSyntax:/(\w+)\s+in\s+((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,r){var i=t.match(this.tagSyntax);if(!i)throw"Syntax error in 'for loop' - Valid syntax: for [item] in [collection]";this.variableName=i[1],this.collectionName=i[2],this.name=this.variableName+"-"+this.collectionName,this.attributes={};t.replace(this.tagSyntax,"");var n=t.match(/(\w*?)\s*\:\s*("[^"]+"|'[^']+'|[^\s,|]+)/g);n&&Fera.Liquid.extensions.arrayTools.each(n,(function(e){e=e.split(":"),this.attributes[Fera.Liquid.extensions.stringTools.strip(e[0])]=Fera.Liquid.extensions.stringTools.strip(e[1])}),this),this._super(e,t,r)},render:function(e){var t=this,r=[],i=e.get(this.collectionName)||[],n=[0,i.length];if(e.registers.for||(e.registers.for={}),this.attributes.limit||this.attributes.offset){var a=0,o=0,s=0,l=null;n=[a="continue"==this.attributes.offset?e.registers.for[this.name]:e.get(this.attributes.offset)||0,(s=(o=e.get(this.attributes.limit))?a+o+1:i.length)-1],e.registers.for[this.name]=s}return(l=i.slice(n[0],n[1]))&&0!=l.length?(e.stack((function(){var i=l.length;Fera.Liquid.extensions.arrayTools.each(l,(function(n,a){e.set(t.variableName,n),e.set("forloop",{name:t.name,length:i,index:a+1,index0:a,rindex:i-a,rindex0:i-a-1,first:0==a,last:a==i-1}),r.push((t.renderAll(t.nodelist,e)||[]).join(""))}))})),Fera.Liquid.extensions.arrayTools.flatten([r]).join("")):""}})),Fera.Liquid.Template.registerTag("if",Fera.Liquid.Block.extend({tagSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)\s*([=!<>a-z_]+)?\s*("[^"]+"|'[^']+'|[^\s,|]+)?/,init:function(e,t,r){this.nodelist=[],this.blocks=[],this.pushBlock("if",t),this._super(e,t,r)},unknownTag:function(e,t,r){Fera.Liquid.extensions.arrayTools.include(["elsif","else"],e)?this.pushBlock(e,t):this._super(e,t,r)},render:function(e){var t=this,r="";return e.stack((function(){for(var i=0;i<t.blocks.length;i++){var n=t.blocks[i];if(n.evaluate(e))return void(r=t.renderAll(n.attachment,e))}})),Fera.Liquid.extensions.arrayTools.flatten([r]).join("")},pushBlock:function(e,t){var r;if("else"==e)r=new Fera.Liquid.ElseCondition;else{var i=t.split(/\b(and|or)\b/).reverse();if(!(a=i.shift().match(this.tagSyntax)))throw"Syntax Error in tag '"+e+"' - Valid syntax: "+e+" [expression]";for(var n=new Fera.Liquid.Condition(a[1],a[2],a[3]);i.length>0;){var a,o=i.shift();if(!(a=i.shift().match(this.tagSyntax)))throw"Syntax Error in tag '"+e+"' - Valid syntax: "+e+" [expression]";var s=new Fera.Liquid.Condition(a[1],a[2],a[3]);s[o](n),n=s}r=n}r.attach([]),this.blocks.push(r),this.nodelist=r.attachment}})),Fera.Liquid.Template.registerTag("ifchanged",Fera.Liquid.Block.extend({render:function(e){var t=this,r="";return e.stack((function(){var i=t.renderAll(t.nodelist,e).join("");i!=e.registers.ifchanged&&(r=i,e.registers.ifchanged=r)})),r}})),Fera.Liquid.Template.registerTag("include",Fera.Liquid.Tag.extend({tagSyntax:/((?:"[^"]+"|'[^']+'|[^\s,|]+)+)(\s+(?:with|for)\s+((?:"[^"]+"|'[^']+'|[^\s,|]+)+))?/,init:function(e,t,r){var i=(t||"").match(this.tagSyntax);if(!i)throw"Error in tag 'include' - Valid syntax: include '[template]' (with|for) [object|collection]";this.templateName=i[1],this.templateNameVar=this.templateName.substring(1,this.templateName.length-1),this.variableName=i[3],this.attributes={};var n=t.match(/(\w*?)\s*\:\s*("[^"]+"|'[^']+'|[^\s,|]+)/g);n&&Fera.Liquid.extensions.arrayTools.each(n,(function(e){e=e.split(":"),this.attributes[Fera.Liquid.extensions.stringTools.strip(e[0])]=Fera.Liquid.extensions.stringTools.strip(e[1])}),this),this._super(e,t,r)},render:function(e){var t=this,r=Fera.Liquid.readTemplateFile(e.get(this.templateName)),i=Fera.Liquid.parse(r),n=e.get(this.variableName||this.templateNameVar),a="";return e.stack((function(){t.attributes.each=hackObjectEach,t.attributes.each((function(t){e.set(t.key,e.get(t.value))})),n instanceof Array?a=Fera.Liquid.extensions.arrayTools.map(n,(function(r){return e.set(t.templateNameVar,r),i.render(e)})):(e.set(t.templateNameVar,n),a=i.render(e))})),a=Fera.Liquid.extensions.arrayTools.flatten([a]).join("")}})),Fera.Liquid.Template.registerTag("unless",Fera.Liquid.Template.tags.if.extend({render:function(e){var t=this,r="";return e.stack((function(){if((n=t.blocks[0]).evaluate(e))for(var i=1;i<t.blocks.length;i++){var n;if((n=t.blocks[i]).evaluate(e))return void(r=t.renderAll(n.attachment,e))}else r=t.renderAll(n.attachment,e)})),
Fera.Liquid.extensions.arrayTools.flatten([r]).join("")}})),Fera.Liquid.Template.registerTag("raw",Fera.Liquid.Block.extend({parse:function(e){this.nodelist||(this.nodelist=[]),this.nodelist.length=0;var t=e.shift();for(e.push("");e.length;){if(/^\{\%/.test(t)){var r=t.match(/^\{\%\s*(\w+)\s*(.*)?\%\}$/);if(r&&this.blockDelimiter==r[1])return void this.endTag()}this.nodelist.push(t||""),t=e.shift()}this.assertMissingDelimitation()},render:function(){return this.nodelist.join("")}})),Fera.Liquid.Template.registerTag("increment",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,r){var i=t.match(this.tagSyntax);if(console.log(e,t,r),console.log(i[1]),!i)throw"Syntax error in 'assign' - Valid syntax: increment [var]";this.name=i[1],this._super(e,t,r)},render:function(e){var t=this.name,r="";return e.registers.increment||(e.registers.increment={}),e.registers.increment[t]||(e.registers.increment[t]=0),r=String(e.registers.increment[t]),e.registers.increment[t]++,r}})),Fera.Liquid.Template.registerTag("decrement",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,r){var i=t.match(this.tagSyntax);if(console.log(e,t,r),console.log(i[1]),!i)throw"Syntax error in 'assign' - Valid syntax: decrement [var]";this.name=i[1],this._super(e,t,r)},render:function(e){var t=this.name,r="";return e.registers.decrement||(e.registers.decrement={}),e.registers.decrement[t]||(e.registers.decrement[t]=-1),r=String(e.registers.decrement[t]),e.registers.decrement[t]--,r}})),Fera.Liquid.Template.registerFilter({_HTML_ESCAPE_MAP:{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"},size:function(e){return e.length?e.length:0},downcase:function(e){return e.toString().toLowerCase()},upcase:function(e){return e.toString().toUpperCase()},capitalize:function(e){return Fera.Liquid.extensions.stringTools.capitalize(e.toString())},escape:function(e){var t=this;return e.replace(/[&<>"']/g,(function(e){return t._HTML_ESCAPE_MAP[e]}))},h:function(e){var t=this;return e.replace(/[&<>"']/g,(function(e){return t._HTML_ESCAPE_MAP[e]}))},default:function(e,t){return Fera.Liquid.extensions.object.isEmpty(e)?t:e},truncate:function(e,t,r){if(!e||""==e)return"";t=t||50,r=r||"...";e.slice(0,t);return e.length>t?e.slice(0,t)+r:e},truncatewords:function(e,t,r){if(!e||""==e)return"";t=parseInt(t||15),r=r||"...";var i=e.toString().split(" "),n=Math.max(t,0);return i.length>n?i.slice(0,n).join(" ")+r:e},truncate_words:function(e,t,r){if(!e||""==e)return"";t=parseInt(t||15),r=r||"...";var i=e.toString().split(" "),n=Math.max(t,0);return i.length>n?i.slice(0,n).join(" ")+r:e},strip_html:function(e){return e.toString().replace(/<.*?>/g,"")},strip_newlines:function(e){return e.toString().replace(/\n/g,"")},join:function(e,t){return t=t||" ",e.join(t)},split:function(e,t){return t=t||" ",e.split(t)},sort:function(e){return e.sort()},reverse:function(e){return e.reverse()},replace:function(e,t,r){return r=r||"",e.toString().replace(new RegExp(t,"g"),r)},replace_first:function(e,t,r){return r=r||"",e.toString().replace(new RegExp(t,""),r)},newline_to_br:function(e){return e.toString().replace(/\n/g,"<br/>\n")},date:function(e,t){var r;return e instanceof Date&&(r=e),r instanceof Date||"now"!=e||(r=new Date),r instanceof Date||"number"!=typeof e||(r=new Date(1e3*e)),r instanceof Date||"string"!=typeof e||(r=new Date(Date.parse(e))),r instanceof Date?r.strftime(t):e},first:function(e){return e[0]},last:function(e){return(e=e)[e.length-1]},minus:function(e,t){return(Number(e)||0)-(Number(t)||0)},plus:function(e,t){return(Number(e)||0)+(Number(t)||0)},times:function(e,t){return(Number(e)||0)*(Number(t)||0)},divided_by:function(e,t){return(Number(e)||0)/(Number(t)||0)},modulo:function(e,t){return(Number(e)||0)%(Number(t)||0)},map:function(e,t){e=e||[];for(var r=[],i=0;i<e.length;i++)r.push(e[i][t]);return r},escape_once:function(e){var t=this;return e.replace(/["><']|&(?!([a-zA-Z]+|(#\d+));)/g,(function(e){return t._HTML_ESCAPE_MAP[e]}))},remove:function(e,t){return e.toString().replace(new RegExp(t,"g"),"")},remove_first:function(e,t){return e.toString().replace(t,"")},prepend:function(e,t){return""+(t||"").toString()+(e||"").toString()},append:function(e,t){return""+(e||"").toString()+(t||"").toString()}}),(new Date).strftime||(Date.ext={},Date.ext.util={},Date.ext.util.xPad=function(e,t,r){for(void 0===r&&(r=10);parseInt(e,10)<r&&r>1;r/=10)e=t.toString()+e;return e.toString()},Date.prototype.locale="en-GB",document.getElementsByTagName("html")&&document.getElementsByTagName("html")[0].lang&&(Date.prototype.locale=document.getElementsByTagName("html")[0].lang),Date.ext.locales={},Date.ext.locales.en={a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a %d %b %Y %T %Z",p:["AM","PM"],P:["am","pm"],x:"%d/%m/%y",X:"%T"},"undefined"!=typeof JSON?Date.ext.locales["en-US"]=JSON.parse(JSON.stringify(Date.ext.locales.en)):Date.ext.locales["en-US"]=Date.ext.locales.en,Date.ext.locales["en-US"].c="%a %d %b %Y %r %Z",Date.ext.locales["en-US"].x="%D",Date.ext.locales["en-US"].X="%r",Date.ext.locales["en-GB"]=Date.ext.locales.en,Date.ext.locales["en-AU"]=Date.ext.locales["en-GB"],Date.ext.formats={a:function(e){return Date.ext.locales[e.locale].a[e.getDay()]},A:function(e){return Date.ext.locales[e.locale].A[e.getDay()]},b:function(e){return Date.ext.locales[e.locale].b[e.getMonth()]},B:function(e){return Date.ext.locales[e.locale].B[e.getMonth()]},c:"toLocaleString",C:function(e){return Date.ext.util.xPad(parseInt(e.getFullYear()/100,10),0)},d:["getDate","0"],e:["getDate"," "],g:function(e){return Date.ext.util.xPad(parseInt(Date.ext.util.G(e)/100,10),0)},G:function(e){var t=e.getFullYear(),r=parseInt(Date.ext.formats.V(e),10),i=parseInt(Date.ext.formats.W(e),10);return i>r?t++:0===i&&r>=52&&t--,t},H:["getHours","0"],I:function(e){var t=e.getHours()%12;return Date.ext.util.xPad(0===t?12:t,0)},j:function(e){var t=e-new Date(e.getFullYear()+"/1/1 GMT");t+=6e4*e.getTimezoneOffset();var r=parseInt(t/6e4/60/24,10)+1;return Date.ext.util.xPad(r,0,100)},m:function(e){return Date.ext.util.xPad(e.getMonth()+1,0)},M:["getMinutes","0"],p:function(e){return Date.ext.locales[e.locale].p[e.getHours()>=12?1:0]},P:function(e){return Date.ext.locales[e.locale].P[e.getHours()>=12?1:0]},S:["getSeconds","0"],u:function(e){var t=e.getDay();return 0===t?7:t},U:function(e){var t=parseInt(Date.ext.formats.j(e),10),r=6-e.getDay(),i=parseInt((t+r)/7,10);return Date.ext.util.xPad(i,0)},V:function(e){var t=parseInt(Date.ext.formats.W(e),10),r=new Date(e.getFullYear()+"/1/1").getDay(),i=t+(r>4||r<=1?0:1);return 53==i&&new Date(e.getFullYear()+"/12/31").getDay()<4?i=1:0===i&&(i=Date.ext.formats.V(new Date(e.getFullYear()-1+"/12/31"))),Date.ext.util.xPad(i,0)},w:"getDay",W:function(e){var t=parseInt(Date.ext.formats.j(e),10),r=7-Date.ext.formats.u(e),i=parseInt((t+r)/7,10);return Date.ext.util.xPad(i,0,10)},y:function(e){return Date.ext.util.xPad(e.getFullYear()%100,0)},Y:"getFullYear",z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+Date.ext.util.xPad(parseInt(Math.abs(t/60),10),0)+Date.ext.util.xPad(t%60,0)},Z:function(e){return e.toString().replace(/^.*\(([^)]+)\)$/,"$1")},"%":function(){return"%"}},Date.ext.aggregates={c:"locale",D:"%m/%d/%y",h:"%b",n:"\n",r:"%I:%M:%S %p",R:"%H:%M",t:"\t",T:"%H:%M:%S",x:"locale",X:"locale"},Date.ext.aggregates.z=Date.ext.formats.z(new Date),Date.ext.aggregates.Z=Date.ext.formats.Z(new Date),Date.ext.unsupported={},Date.prototype.strftime=function(e){this.locale in Date.ext.locales||(this.locale.replace(/-[a-zA-Z]+$/,"")in Date.ext.locales?this.locale=this.locale.replace(/-[a-zA-Z]+$/,""):this.locale="en-GB");for(var t=this;e.match(/%[cDhnrRtTxXzZ]/);)e=e.replace(/%([cDhnrRtTxXzZ])/g,(function(e,r){var i=Date.ext.aggregates[r];return"locale"==i?Date.ext.locales[t.locale][r]:i}));var r=e.replace(/%([aAbBCdegGHIjmMpPSuUVwWyY%])/g,(function(e,r){var i=Date.ext.formats[r];return"string"==typeof i?t[i]():"function"==typeof i?i.call(t,t):"object"==typeof i&&"string"==typeof i[0]?Date.ext.util.xPad(t[i[0]](),i[1]):r}));return t=null,r}),split=split||function(e){var t,r=String.prototype.split,i=/()??/.exec("")[1]===e;return t=function(t,n,a){if("[object RegExp]"!==Object.prototype.toString.call(n))return r.call(t,n,a);var o,s,l,c,u=[],d=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.extended?"x":"")+(n.sticky?"y":""),p=0;n=new RegExp(n.source,d+"g");for(t+="",i||(o=new RegExp("^"+n.source+"$(?!\\s)",d)),a=a===e?-1>>>0:a>>>0;(s=n.exec(t))&&!((l=s.index+s[0].length)>p&&(u.push(t.slice(p,s.index)),!i&&s.length>1&&s[0].replace(o,(function(){for(var t=1;t<arguments.length-2;t++)arguments[t]===e&&(s[t]=e)})),s.length>1&&s.index<t.length&&Array.prototype.push.apply(u,s.slice(1)),c=s[0].length,p=l,u.length>=a));)n.lastIndex===s.index&&n.lastIndex++;return p===t.length?!c&&n.test("")||u.push(""):u.push(t.slice(p)),u.length>a?u.slice(0,a):u},String.prototype.split=function(e,r){return t(this,e,r)},t}(),Fera.LocalStorageJar=function(e){var t=this;t.localStorageEnabled=!1,e="string"==typeof e?{namespace:e}:e||{};var r=function(){t.localStorageEnabled=n(),t.cookieJar=e.cookieJar||new Fera.CookieJar,t.namespace=e.namespace||"Fera"};t.clear=function(){if(!t.localStorageEnabled)return!0;for(var e=Object.keys(window.localStorage),r=0;r<e.length;r++)0===e[r].indexOf(t.namespace)&&window.localStorage.removeItem(e[r])},t.setItem=function(e,r,n){t.localStorageEnabled?(e=i(e),r={value:r,timestamp:n?(new Date).getTime()+n:null},r=Fera.Util.encode(JSON.stringify(r)),window.localStorage.setItem(e,r)):n?t.cookieJar.setCookie(e,r,n/24*60*60*1e3):t.cookieJar.setCookie(e,r)},t.getItem=function(e,r){try{if(e=i(e),r=r||null,t.localStorageEnabled){var n=window.localStorage.getItem(e);return!n&&e.match(/widget/i)&&(n=window.localStorage.getItem(e.replace("Widget","Skill").replace("widget","Skill"))),n?(n=JSON.parse(Fera.Util.decode(n))).timestamp?(new Date).getTime()<n.timestamp?n.value:r:n.value:r}return t.cookieJar.getCookie(e)}catch(e){return null}},t.setObject=function(e,r,i){return t.setItem(e,r,i)},t.getObject=function(e,r){return t.getItem(e,r)},t.removeItem=function(e){e=i(e),t.localStorageEnabled&&(window.localStorage.removeItem(e),window.localStorage.removeItem(e.replace("Fera.","BananaStand.")),window.localStorage.removeItem(e.replace("Fera.","Fera-Fera.")),window.localStorage.removeItem(e.replace("Fera.","Fera.Fera.")),window.localStorage.removeItem(e.replace("Skill","Widget")))};var i=function(e){return""!==t.namespace&&(e=t.namespace+"."+e),e},n=function(){var e="Fera.LocalStorageJar.test";try{return window.localStorage.setItem(e,"test"),window.localStorage.removeItem(e),!0}catch(e){return!1}};r()},Fera.Logger=function(e){e=e||{};var t=this,r=function(){};t.info=function(){!e.optionsParser.hasUrlFlag("fera_quiet")&&e.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.info.apply(this,arguments))},t.log=function(){!e.optionsParser.hasUrlFlag("fera_quiet")&&e.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.log.apply(this,arguments))},t.logWarning=function(){!e.optionsParser.hasUrlFlag("fera_quiet")&&e.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.warn.apply(this,arguments))},t.warn=function(){e.optionsParser.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.warn.apply(this,arguments))},t.error=function(){window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.error.apply(this,arguments))},r()},Fera.OptionsParser=function(e){e=e||{};var t=this,r=function(){t.urlParams=t.getJsonFromUrl(),t.previewMode=t.hasPreviewFilterById(),t.feraParams=n();var r=t.urlParams.fera||t.urlParams.f;r&&e.app.push(r,t.getFeraActionParams()),i()};t.getFeraActionParams=function(){for(var e=Object.keys(t.feraParams),r={},i=0;i<e.length;i++){var n=e[i];-1===["debug","test","preview","admin","shopper"].indexOf(n)&&(r[n]=t.feraParams[n])}return r},t.getJsonFromUrl=function(e){var t;if(e){var r=location.href.indexOf("?");if(-1==r)return[];t=location.href.substr(r+1)}else t=location.search.substr(1);var i={};return t.split("&").forEach((function(e){if(e&&-1===e.indexOf("__")){var t=(e=e.split("+").join(" ")).indexOf("="),r=t>-1?e.substr(0,t):e,n=t>-1?decodeURIComponent(e.substr(t+1)):"",a=r.indexOf("[");if(-1==a)i[decodeURIComponent(r)]=n;else{var o=r.indexOf("]",a),s=decodeURIComponent(r.substring(a+1,o));r=decodeURIComponent(r.substring(0,a)),i[r]||(i[r]=[]),s?i[r][s]=n:i[r].push(n)}}})),i},t.showContainer=function(e,r){var i=t.urlParams.fera_preview||t.urlParams.preview;return!i||(t.hasPreviewFilterById()?parseInt(i)===r:i===e)},t.getPreviewId=function(){return parseInt(t.urlParams.fera_preview||t.urlParams.preview)},t.hasPreviewFilterById=function(){var e=t.urlParams.fera_preview||t.urlParams.preview;return/^[0-9]+$/i.test(e)},t.hasUrlFlag=function(e){var t=new RegExp("((.*)(([?&])"+e+"=)(t|1|y|true|yes|on))(.*)","i");return-1!==window.location.toString().search(t)},t.hasUrlFlagOff=function(e){var t=new RegExp("((.*)(([?&])"+e+"=)(f|0|n|false|no|off))(.*)","i");return-1!==window.location.toString().search(t)},t.parseTestMode=function(){return t.hasUrlFlag("test_mode")||t.hasUrlFlag("fera_test")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via URL params."),!0):e.testMode?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via initialization options."),!0):"t"===e.cookieJar.getCookie("Fera.SandboxTest.Enabled")&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via sandbox cookie."),!0)},t.parseSandboxMode=function(){return t.hasUrlFlag("fera_sandbox")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("SANDBOX Mode activated via URL params."),t.extendSandboxCookie(),!0):-1!==["yes","true","1","t","on",!0,1].indexOf(e.cookieJar.getCookie("Fera.SandboxTest.Enabled",!1))?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("SANDBOX Mode activated via sandbox cookie."),!0):void 0},t.extendSandboxCookie=function(){e.cookieJar.setCookie("Fera.SandboxTest.Enabled","t",2/24/60)},t.parseShowErrors=function(){return!!window.feraShowErrors||(!!e.cookieJar.getCookie("Fera.ShowErrors",!1)||t.feraParams.show_errors)},t.parseDebugMode=function(){return!(!window.__bsioDebugMode&&!window.feraDebugMode)||(!!e.cookieJar.getCookie("Fera.DebugMode",!1)||(t.hasUrlFlag("debug_mode")||t.hasUrlFlag("fera_debug")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("DEBUG Mode activated via URL params."),!0):!!e.debugMode&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("DEBUG Mode activated via initialization options."),!0)))},t.parseAdminMode=function(){var r=t.isAdminMode();return e.adminSessionToken=t.urlParams.fera_site_com_token||t.urlParams.fera_admin_session,e.adminSessionToken?e.cookieJar.setCookie("Fera.Admin.SessionToken",e.adminSessionToken,30):e.adminSessionToken=e.cookieJar.getCookie("Fera.Admin.SessionToken"),r},t.parseCheckIntegration=function(){return!(!t.urlParams||!t.urlParams.check_integration_type)&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("Integration Checking enabled: "+t.urlParams.check_integration_type),t.urlParams.check_integration_type)},t.detectProductId=function(){return t.urlParams.product||t.urlParams.product_id||t.urlParams.productId||t.urlParams.p||t.feraParams&&(t.feraParams.product||t.feraParams.productId||t.feraParams.product_id||t.feraParams.pid||t.feraParams.p)},t.detectCustomerName=function(){return t.urlParams.customer_name||t.urlParams.customerName||t.urlParams.shopper_name||t.urlParams.shopperName||t.urlParams.name||t.urlParams.customer&&!t.urlParams.customer.match(/@/)&&t.urlParams.customer||t.feraParams&&(t.feraParams.customer_name||t.feraParams.customerName||t.feraParams.shopper_name||t.feraParams.shopperName||t.feraParams.name)},t.detectCustomerEmail=function(){return t.urlParams.customer_email||t.urlParams.customerEmail||t.urlParams.shopper_email||t.urlParams.shopperEmail||t.urlParams.email||t.feraParams&&(t.feraParams.customer_email||t.feraParams.customerEmail||t.feraParams.shopper_email||t.feraParams.shopperEmail||t.feraParams.email)};var i=function(){t.sandboxMode=t.parseSandboxMode();var e=window.feraAdminSandboxStatus;t.sandboxStatus=e?parseInt(e):200,t.sandboxError=t.sandboxMode&&t.sandboxStatus>=400},n=function(){for(var e=Object.keys(t.urlParams),r={},i=0;i<e.length;i++){var n=e[i];if(n.match(/^f(era)?_(.+)/i)){var a=n.replace(/^f(era)?_(.+)/i,"$2");r[a]=t.urlParams[n],-1!==["yes","true","1","t","on"].indexOf(r[a])&&(r[a]=!0),-1!==["no","false","","off"].indexOf(r[a])&&(r[a]=!1)}}return r};t.isAdminMode=function(){return!!t.urlParams.show_element_selector||(!!t.urlParams.ensure_loaded_cart||(t.hasUrlFlag("admin_mode")||t.hasUrlFlag("fera_admin")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode activated via URL params."),e.cookieJar.setCookie("Fera.Admin.Enabled","t",1),!0):t.hasUrlFlagOff("admin_mode")||t.hasUrlFlagOff("fera_admin")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode DEactivated via URL params."),e.cookieJar.setCookie("Fera.Admin.Enabled","f",1),!1):"t"===e.cookieJar.getCookie("Fera.Admin.Enabled")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode active via cookie."),!0):!!e.adminMode&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode activated via initialization options."),e.cookieJar.setCookie("Fera.Admin.Enabled","t",1),!0)))},r()},Fera.PopupNotification=function(e){var t,r=this,i=e.$,n=!1,a=function(){r.notif=e.notif,r.$el=e.$el,r.$container=e.container,r.$el.on("mouseenter",(function(){!0})),r.$el.on("mouseleave",(function(){!1}))};r.attach=function(){return!(n||!r.$el)&&(r.$el.hide(),r.$container.append(r.$el),n=!0,!0)},r.detach=function(){return!(!n||!r.$el)&&(r.$el.hide(),r.$el.remove(),n=!1,!0)},r.destroy=function(){r.detach(),r.$el=null},r.hideAndDetach=function(e,t,i){r.hide(e,t,(function(){r.detach(),i&&i()}))},r.hide=function(e,t,i){i=i||function(){};var n=-1===t.indexOf("top")?"bottom":"top";"slide_and_fade"===e?(r.$el.css("opacity",1),r.$el.css(n,""),r.$el.css("-webkit-transition",n+" 1s ease, opacity 1s ease"),r.$el.css("opacity",0),r.$el.css(n,o()),setTimeout(i,1e3)):"fade"===e?(r.$el.css("opacity",1),r.$el.css("-webkit-transition","opacity 1s ease"),r.$el.css("opacity",0),setTimeout(i,1e3)):"slide"===e?(r.$el.css(n,""),r.$el.css("-webkit-transition",n+" 1s ease"),r.$el.css(n,o()),setTimeout(i,1e3)):i()},r.attached=function(){return n},r.ensureLoadThenShow=function(e,t,n){var a=r.$el.find("img").attr("src");a&&"string"==typeof a?i("<img>").on("load",(function(){s(e,t,n)})).on("error",(function(){s(e,t,n)})).attr("src",a):s(e,t,n)},r.initiateCountdown=function(e){t&&clearInterval(t),r.$el.find(".banana-notification-countdown, .fera-notification-countdown").each((function(){var r=i(this);r.data("seconds",e),r.text(e),t=setInterval((function(){r.data("seconds",r.data("seconds")-1),0==r.data("seconds")?(clearInterval(t),r.text("")):r.text(r.data("seconds"))}),1e3)}))};var o=function(){return-100},s=function(e,t,i){i=i||function(){};var n=-1===t.indexOf("top")?"bottom":"top";"slide_and_fade"===e?(r.$el.css(n,o()),r.$el.css("opacity",0),r.$el.css("-webkit-transition",n+" 1s ease, opacity 1s ease"),r.$el.show(),r.$el.css("opacity",1),r.$el.css(n,"")):"fade"===e?(r.$el.css("opacity",0),r.$el.css("-webkit-transition","opacity 1s ease"),r.$el.show(),r.$el.css("opacity",1)):"slide"===e?(r.$el.css(n,o()),r.$el.css("-webkit-transition",n+" 1s ease"),r.$el.show(),r.$el.css(n,"")):r.$el.show(),i()};a()},Fera.SeenNotifTracker=function(e){var t,r=this,i=e.localStorage,n=e.storageKey,a=[],o=e.expireAfter||864e5,s=function(e){return Fera.Util.$()(e)},l=function(){p(),u(),d(),c()&&(r.clear(),e.logger.info("Clear notification history flag was detected, so no seen notifications will be assumed."))};r.getSeenIds=function(){return u(),s(a).map((function(){return this.id})).toArray()},r.updateExpiryTime=function(e){return t!=(o=1e3*e)&&(r.clear(),t=o),r},r.hasSeen=function(e){var t;u(),t="number"==typeof t?e:e.getId();for(var r=0;r<a.length;r++)if(a[r].id===t)return!0;return!1},r.markSeen=function(e){var t;(t="number"==typeof t?e:e.getId())<0||(a.push({id:t,expiresAt:(new Date).getTime()+o}),u(),d())},r.clear=function(){a=[],d()};var c=function(){return-1!==window.location.toString().search(/(.*)((\?|&)clear_notification_history=(t|1|y))/i)},u=function(){for(var e=[],t=0;t<a.length;t++){var r=a[t];r.expiresAt<=(new Date).getTime()||e.push(r)}a=e},d=function(){i.setItem(n,h())},p=function(){var e=i.getItem(n,{notifs:[],expireAfter:o});a=e.notifs,t=e.expireAfter},h=function(){return{notifs:a,expireAfter:o}};l()},Fera.TimeAgo=function(e){var t,r=this,i=e.language||"en",n=function(){t=o()};this.toSeconds=function(){var e=new Date;return Math.floor((e.getTime()-t.getTime())/1e3)},this.toDays=function(){var e=this.toSeconds();return Math.floor(e/60/60/24)},this.toString=function(){var e,t=r.toSeconds();return(e=a(t,31536e3,"year"))||(e=a(t,2628e3,"month"))||(e=a(t,604800,"week"))||(e=a(t,86400,"day"))||(e=a(t,3600,"hour"))||(e=a(t,60,"minute"))?e:e=a(Math.max(t,1),1,"second")};var a=function(e,t,r){if(e/t>=1){var n=Math.round(e/t);try{var a=new Intl.RelativeTimeFormat(i,{numeric:"always"});return n*=-1,a.format(n,r)}catch(e){var o=n>1?"{{ num }} "+r+"s ago":"{{ num }} "+r+" ago";return Fera.t(o).replace("{{ num }}",n)}}return!1},o=function(){if("string"==typeof e.time){var t;t=e.time.indexOf("Z")===e.time.length-1?e.time.replace("Z"," GMT").replace("T"," ").replace(".000","").replace(/-/g,"/"):e.time;var i=Date.parse(t);return i||(i=(new Date).getTime()-36e5,Fera.logger.error("Failed to parse time: ",e.time,e,r)),new Date(i)}return e.time};n()},Fera.TimeTracker=function(e){var t=this;e=e||{};var r=3e4,i=0,n=1e3,a=!1,o=!1,s="default-page-name",l=[],c=[],u=[],d={},p=0,h=null,f=function(){h=e.localStorage;var t=r||30,i=i||window.location.pathname;t=e.idleTimeoutInSeconds||t,i=e.currentPageName||i,m(),R(),A(t),O(i),B(),F(),setInterval(E,1e3)},m=function(){t.data=h.getObject("TimeTracker",{})};t.getTimeOnCurrentPage=function(){return $(T(s))},t.getSessionTime=function(){var e=v()||(new Date).getTime();return Math.round(((new Date).getTime()-e)/1e3)},t.getTotalInteractionTime=function(){return Math.round(parseFloat(g()||0))},t.setTotalInteractionTime=function(e){b(e)},t.getTimeSinceFirstSeen=function(){var e=0;return t.data.timeFirstSeen&&(e=(new Date).getTime()-t.data.timeFirstSeen),$(e)},t.setTimeFirstSeen=function(e){w(e)},t.setTimeSinceFirstSeen=function(e){w((new Date).getTime()-1e3*e)},t.reset=function(){x(),h.removeItem("TimeTracker"),d={},F()};var g=function(){return t.data.totalInteractionTime||0},v=function(){var e=new Date;return t.data.sessionStartTime||e.getTime()},_=function(){var e=new Date;return t.data.sessionLastUpdateTime||e.getTime()},w=function(e){t.data.timeFirstSeen=e,S()},b=function(e){t.data.totalInteractionTime=e,S()},y=function(e){t.data.sessionStartTime=e,S()},C=function(e){t.data.sessionLastUpdateTime=e,S()},S=function(){h.setObject("TimeTracker",t.data)},F=function(e){if(e||(e=s),void 0===d[e])d[e]=[];else{var t=d[e],r=t[t.length-1];if(void 0!==r&&void 0===r.stopTime)return}d[e].push({startTime:new Date,stopTime:void 0}),a=!0},x=function(){for(var e=Object.keys(d),t=0;t<e.length;t++)k(e[t])},k=function(e){e||(e=s);var t=d[e];void 0!==t&&0!==t.length&&(void 0===t[t.length-1].stopTime&&(t[t.length-1].stopTime=new Date),a=!1)},$=function(e){return void 0===e?void 0:Math.round(e/1e3)},T=function(e){var t=d[e];if(void 0!==t){for(var r=0,i=0;i<t.length;i++){var n=t[i].startTime,a=t[i].stopTime;void 0===a&&(a=new Date),r+=a-n}return Number(r)}};t.getInactiveTimeOnPage=function(){var e=d[s];if(void 0===e||e.length<1)return 0;var t=e[e.length-1].stopTime;return t?$(Number(new Date-t)):0};var P,I,R=function(){if(!t.data.timeFirstSeen){var e=Math.max(t.getTimeSinceFirstSeen()||0,t.getTotalInteractionTime()||0,t.getTimeOnCurrentPage()||0,t.getSessionTime()||0);w((new Date).getTime()-1e3*e)}},A=function(e){var i=parseFloat(e);if(!1!==isNaN(i))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};return r=1e3*e,t},O=function(e){return s=e,t},M=function(){if(a){var e=t.getTimeOnCurrentPage(),r=e-p;if(!(r<=.1)){var i=t.getTotalInteractionTime();return b(i+=r),p=e,i}}},E=function(){var e=_(),r=(new Date).getTime();!t.data.sessionStartTime||r-e>3e3?y(r):r-(v()||r)>864e5&&y(r);C(r)},L=function(){o&&D(),o=!1,i=0},D=function(){if(!a)for(var e=0;e<u.length;e++){var t=u[e],r=t.numberOfTimesToInvoke;(isNaN(r)||void 0===r||r>0)&&(t.numberOfTimesToInvoke-=1,t.callback())}F()},j=function(){if(a)for(var e=0;e<c.length;e++){var t=c[e],r=t.numberOfTimesToInvoke;(isNaN(r)||void 0===r||r>0)&&(t.numberOfTimesToInvoke-=1,t.callback())}x()},q=function(){for(var e=M(),t=0;t<l.length;t++)l[t].pending&&e>l[t].timeInSeconds&&(l[t].callback(),l[t].pending=!1);!1===o&&i>r?(o=!0,j()):i+=n},B=function(){void 0!==document.hidden?(I="hidden",P="visibilitychange"):void 0!==document.mozHidden?(I="mozHidden",P="mozvisibilitychange"):void 0!==document.msHidden?(I="msHidden",P="msvisibilitychange"):void 0!==document.webkitHidden&&(I="webkitHidden",P="webkitvisibilitychange"),document.addEventListener(P,(function(){document[I]?j():D()}),!1),window.addEventListener("blur",(function(){j()})),window.addEventListener("focus",(function(){D()})),document.addEventListener("mousemove",(function(){L()})),document.addEventListener("keyup",(function(){L()})),document.addEventListener("touchstart",(function(){L()})),window.addEventListener("scroll",(function(){L()})),setInterval(q,n)};t.callAfterTimeElapsedInSeconds=function(e,t){l.push({timeInSeconds:e,callback:t,pending:!0})},t.callWhenUserLeaves=function(e,t){c.push({callback:e,numberOfTimesToInvoke:t})},t.callWhenUserReturns=function(e,t){u.push({callback:e,numberOfTimesToInvoke:t})},f()},Fera.Timer=function(e){var t,r,i,n,a,o,s,l=this,c=(Fera.Util.$(),null),u=null,d=function(){l.timerTemplate=new Fera.TimerTemplate({template:e.timerTemplate,logger:e.logger}),e.padTimes=void 0===e.padTimes||e.padTimes,s=e.finishCallback||function(){},o=e.countCallback||function(){}};this.setTemplate=function(e){e&&(l.timerTemplate.template=e)},this.getTimeLeft=function(){return c},this.start=function(e,t){a=e,c=parseInt(t)||0==t?t:a,l.resume(),h()},this.reset=function(){c=a,p(),o(f(),c)},this.restart=function(){l.reset(),l.resume()},this.stop=function(){u&&clearInterval(u),!1},this.pause=l.stop,this.resume=function(){u&&clearInterval(u),u=setInterval(h,1e3),!0};var p=function(){t=e.showDays&&l.timerTemplate.templateHasDays()?Math.floor(c/86400):0,r=Math.floor(c/3600-24*t),i=Math.floor(c%3600/60),n=Math.floor(c%60)},h=function(){c-=1,p(),o(f(),c),c<=0&&(c=0,clearInterval(u),s())},f=function(){var a,o,s,c;return a=t<1?"":t,e.sentenceFormat?(a=t<1?"":m(t,"day"),o=r<1?"":m(r,"hour"),s=m(i,"minute"),c=m(n,"second")):e.padTimes?(o=r<10?"0"+r:r,s=i<10?"0"+i:i,c=n<10?"0"+n:n):(o=r,s=i,c=n),l.timerTemplate.render(a,o,s,c)},m=function(e,t){return e+" "+t+(1===e?"":"s")};d()},Fera.TimerTemplate=function(e){e=e||{};var t=this,r="[[%DAYS%:]][[%HOURS%:]]%MINUTES%:%SECONDS%",i=Fera.Util.$(),n=function(){t.template=e.template||r};this.templateHasDays=function(){return-1!==t.template.indexOf("%DAYS%")},this.render=function(e,r,n,c){var u,d,p,h=t.template,f=h.match(/(\[\[.*%DAYS%.*\]\])(\[\[.*%HOURS%.*\]\])(.*)/);return f?(u=f[1],d=f[2],p=f[3]):h.match(/(\[\[.*%HOURS%.*\]\])(.*)/)?(u="",d=(f=h.match(/(\[\[.*%HOURS%.*\]\])(.*)/))[1],p=f[2]):(u="",d="",p=h),h=(h=(u=s(u,e))+(d=l(d,r))+p).replace("%DAYS%",e).replace("%HOURS%",r).replace("%MINUTES%",n).replace("%SECONDS%",c),h=a(h,n),h=o(h,c),t.template.indexOf(":")>0&&(h=i(h.split(":")).map((function(e){return e>0&&this.match(/^[0-9]$/)?"0"+this:this})).toArray().join(":")),h};var a=function(e,t){return e=1==t?e.replace(/\[m\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[m\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")},o=function(e,t){return e=1==t?e.replace(/\[s\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[s\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")},s=function(e,t){return 0==t?e="":(e=e.replace("[[","").replace("]]",""),e=1===t?e.replace(/\[d\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[d\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")),e},l=function(e,t){return 0==t?e="":(e=e.replace("[[","").replace("]]",""),e=1==t?e.replace(/\[h\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[h\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")),e};n()},Fera.TitleBarManager=function(e){e=e||{};var t,r=this,i=function(){t=document.title,t};r.setTitle=function(e){document.title,document.title=e,e},r.resetToOriginal=function(){document.title,document.title=t,t},i()},Fera.Util={toTitleCase:function(e){return e.replace(/\w\S*/g,(function(e,t,r){return e.indexOf(".")>0&&e.indexOf(".")<e.length-1||e.length<=3&&(","===e.trim().substr(-1)||e.length+t===r.length)&&(t>0&&","===r.substr(t-1,1)||t>1&&","===r.substr(t-2,1))?e.toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},truncateTextToMaxWidth:function(e){var t=this.$();e.each((function(){var e=t(this),r=parseFloat(e.css("max-width"));if(e.width()>r)for(var i=e.html().trim();e.width()>r;)i=i.slice(0,-1),e.html(i+"...")}))},debounce:function(e,t,r){var i;return function(){var n=this,a=arguments;clearTimeout(i),i=setTimeout((function(){i=null,r||e.apply(n,a)}),t),r&&!i&&e.apply(n,a)}},throttle:function(e,t,r){var i,n;return function(){var a=this,o=arguments,s=(new Date).getTime();if(!n||s>n+t)return n=(new Date).getTime(),e.apply(a,o);r&&(i=i||setTimeout((function(){i=null,n=(new Date).getTime(),e.apply(a,o)}),t-(s-n)))}},generateUUID:function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)}))},isFullyVisible:function(e){return this._checkVisibility(e,!0)},isVisible:function(e){return this._checkVisibility(e,!1)},_checkVisibility:function(e,t){if(e.data("always_visible"))return!0;if((Object&&Object.getPrototypeOf?Object.getPrototypeOf(e).jquery:$&&$.zepto)&&!e.is(":visible"))return!1;if(t&&!this.isScrolledIntoView(e))return!1;if("none"==e.css("display")||"hidden"==e.css("visibility")||0==e.css("opacity"))return!1;for(var r=e.parent();"BODY"!==r.prop("tagName");){if("hidden"==r.css("visibility")||0==r.css("opacity"))return!1;r=r.parent()}return!0},parseBool:function(e){return void 0!==e&&-1!==[1,"1","true","t","yes",!0,2].indexOf(e)},outerHeight:function(e){var t,r,i=e.get(0);if(navigator&&navigator.appVersion&&-1!==navigator.appVersion.indexOf("MSIE 9.")){var n=i.offsetHeight,a=getComputedStyle(i);return n+parseInt(a.marginTop)+parseInt(a.marginBottom)}return void 0!==i.offsetHeight?i.offsetHeight:("number"!=typeof(t=document.defaultView.getComputedStyle(i,"").getPropertyValue("height"))&&(t=0),r=parseInt(document.defaultView.getComputedStyle(i,"").getPropertyValue("margin-top"))+parseInt(document.defaultView.getComputedStyle(i,"").getPropertyValue("margin-bottom")),parseFloat(t)+parseFloat(r))},isHome:function(){return-1===window.location.toString().replace(/^https?:\/\/([a-zA-Z0-9_\-.]+)\/?([?#][#a-z=\-_A-Z0-9&]+)?$/i,"$1").indexOf("/")},updateURLParameter:function(e,t,r){
var i="",n=e.split("?"),a=n[0],o=n[1],s="";if(o){n=o.split("&");for(var l=0;l<n.length;l++)n[l].split("=")[0]!=t&&(i+=s+n[l],s="&")}var c=a+"?"+i;return null!==r&&(c+=s+t+"="+r),c===a+"?"?a:c},isFullyInvisible:function(e){return!this.isFullyVisible(e)},isScrolledIntoView:function(e){var t=Fera.Util.$()(window).scrollTop(),r=t+Fera.Util.$()(window).height(),i=e.offset().top;return i+e.height()<=r&&i>=t},scrollToElement:function(e,t){(t="object"==typeof t?t:{}).duration=void 0===t.duration?200:t.duration,t.callback=t.callback||function(){},t.position=void 0===t.position?"center":t.position;var r,i=Fera.Util.$()(window),n=t.duration,a=10,o=(new Date).getTime(),s=this,l=function(){var r=e.offset().top,n=window.innerHeight||i.height(),a=s.outerHeight(e);return"center"===t.position&&a<n&&(r-=n/2,r+=a/2),r},c=setInterval((function(){if(r=(new Date).getTime(),n-=a=r-o,!e.offset()||0===e.offset().top)return clearInterval(c),t.callback(e);var s=l();if(n<=0)return i.scrollTop(s),clearInterval(c),t.callback(e);var u,d=i.scrollTop()-s;u=t.duration-n<100?d/(n/a*2):n<100?d/(n/a):d/((n-50)/a),i.scrollTop(i.scrollTop()-u),o=(new Date).getTime()}),10)},addZepto:function(e,t){t=t||function(){},new FeraCachedAsset({name:"zepto",version:"1.2.0",expiresIn:(e=e||{}).devMode?15:900,url:"https://cdn.fera.ai/js/lib/zepto"+(e.debugMode?"":".min")+".js"}).load(t)},$:function(){return this._$&&"function"==typeof this._$?this._$:this._hasValidJQueryInstalled()?this._$=jQuery:this._hasValidZeptoInstalled()?this._$=Zepto:(Fera.logger.warn("Something must have removed jQuery/Zepto because it is no longer present after the application has already started. Zepto will be added in now."),this.addZepto(),null)},hasValid$:function(e){return this._hasValidJQueryInstalled()?"jquery":this._hasValidZeptoInstalled()?"zepto":(this._isUsingIncompatibleJQuery()&&e&&Fera.logger.warn("You're running an outdated version of jQuery that may cause problems on the site (v "+$.fn.jquery+"). We highly recommend you upgrade to a newer version."),!1)},_isUsingIncompatibleJQuery:function(){return"undefined"!=typeof jQuery&&jQuery&&jQuery.fn&&(-1!==jQuery.fn.jquery.indexOf("-ajax")||jQuery.fn.jquery.match(/1\.[0-9]\./))},_hasValidZeptoInstalled:function(){return"undefined"!=typeof Zepto&&Zepto},_hasValidJQueryInstalled:function(){return!("undefined"==typeof jQuery||!jQuery.fn||!jQuery.fn.jquery||this._isUsingIncompatibleJQuery())},showWithoutTransform:function(e){e.show().css({"-webkit-transform":"","-moz-transform":"","-ms-transform":"","-o-transform":"",transform:""})},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},shuffleArray:function(e){var t,r,i;for(i=e.length-1;i>0;i--)t=Math.floor(Math.random()*(i+1)),r=e[i],e[i]=e[t],e[t]=r;return e},isNullOrEmpty:function(e){return!e||void 0===e||""===e||0===e.length},maxGetRequestChars:function(){return-1!==this.detectBrowser().indexOf("MSIE")?2e3:6e3},sizeOfParams:function(e){return encodeURI(Fera.Util.$().param(e)).split(/%..|./).length-1},_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,i,n,a,o,s,l="",c=0;for(e=this._utf8_encode(e);c<e.length;)n=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(i=e.charCodeAt(c++))>>6,s=63&i,isNaN(r)?o=s=64:isNaN(i)&&(s=64),l=l+this._keyStr.charAt(n)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return l},decode:function(e){var t,r,i,n,a,o,s="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(n=this._keyStr.indexOf(e.charAt(l++)))>>4,r=(15&n)<<4|(a=this._keyStr.indexOf(e.charAt(l++)))>>2,i=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(r)),64!=o&&(s+=String.fromCharCode(i));return s=this._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){for(var t="",r=0,i=c1=c2=0;r<e.length;)(i=e.charCodeAt(r))<128?(t+=String.fromCharCode(i),r++):i>191&&i<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&i)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),r+=3);return t},jsonHasArray:function(e){for(var t in e)if(e[t]&&"object"==typeof e[t]&&e[t].constructor===Array)return!0;return!1},httpMethodToUse:function(e){return this.sizeOfParams(e)>this.maxGetRequestChars()||this.jsonHasArray(e)?"POST":"GET"},onRemove:function(e,t){var r=Fera.Util.$()(e),i=new MutationObserver((function(){var e=function(t){return t.parentNode!==document&&(null===t.parentNode||void 0===t.parentNode||e(t.parentNode))};e(r[0])&&(i.disconnect(),t(r))}));i.observe(document,{childList:!0,subtree:!0});var n=r.data("removeObservers")||[];return n.push(i),r.data("removeObservers",n),i},disconnectRemoveHandlers:function(e){var t=Fera.Util.$()(e),r=t.data("removeObservers");return!!r&&(Fera.Util.$().each(r,(function(e,t){t.disconnect()})),t.data("removeObservers",[]),!0)},abbreviateNumber:function(e,t){if(null===e)return null;if(0===e)return"0";t=!t||t<0?0:t;var r=e.toPrecision(2).split("e"),i=1===r.length?0:Math.floor(Math.min(r[1].slice(1),14)/3),n=i<1?e.toFixed(0+t):(e/Math.pow(10,3*i)).toFixed(1+t);return(n<0?n:Math.abs(n))+["","K","M","B","T"][i]},arrayToSentence:function(e){return 0===e.length?"":1===e.length?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},formatFullName:function(e,t){var r=e.trim().split(/\s+/);switch(t){case"first_name":return r[0];case"last_name":return r[r.length-1];case"initials":for(var i=[],n=0;n<r.length;n++)i.push(r[n][0].toUpperCase()+".");return i.join(" ");case"first_name_and_last_initial":var a=r[0];return r.length>1&&(a+=" "+r[r.length-1][0].toUpperCase()+"."),a;default:return e}},htmlDecode:function(e){try{return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}catch(t){return e}},detectBrowser:function(){var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===r[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),r.join(" "))},ie:function(){return 0===this.detectBrowser().indexOf("IE")||-1!==this.detectBrowser().indexOf("MSIE")},isBot:function(){return void 0!==this._isBot?this._isBot:"undefined"!=typeof navigator&&(!!navigator.webdriver||!!navigator.userAgent&&(this._isBot=!!/bot|googlebot|crawl|spider|robot|headless/i.test(navigator.userAgent),this._isBot))},setIsBot:function(e){return this._isBot=e,this},isSpeedMode:function(){return void 0!==this._isSpeedMode||(navigator&&navigator.webdriver?this._isSpeedMode=!0:"undefined"!=typeof navigator&&navigator.userAgent?this._isSpeedMode=!!navigator.userAgent.match(/lighthouse|metrix|(speed.*test)|pingdom/i):this._isSpeedMode=!1),this._isSpeedMode},setIsSpeedMode:function(e){return this._isSpeedMode=e,this}},Fera.VariantLoader=function(e){var t=this;e=e||{};var r=Fera.Util.$(),i=function(){t.$form=r('form[action~="/cart/add"]'),t.variantId=null,t.loadVariant(),t.$form.find("select,input,textarea").on("change",(function(){setTimeout((function(){t.loadVariant(!0)}),1)})),t.onUrlChange((function(){t.loadVariant(!0)}))};t.onUrlChange=function(e){r(window).on("hashchange",e);var t=window.location.toString();setInterval((function(){var r=window.location.toString();r!==t&&(t=r,e())}),100)},t.loadVariant=function(r){void 0===r&&(r=!1),t.findVariantId(),e.app.getVariantId()!==t.variantId&&(e.app.setVariantId(t.variantId),r&&e.app.refreshContent())},t.findVariantId=function(){if(t.variantId=n(),t.variantId&&""!==t.variantId)return t.variantId;var r=t.$form.serializeArray().find((function(e){return"id"===e.name}));if(r)return t.variantId=r.value,t.variantId;var i=e.app.getProduct();return i?i.variants[0].id:null};var n=function(){var e=/variant=(.*?)(&|$)/,t=window.location.href.match(e);return t?parseInt(t[1]):null};i()},Fera.Verifier=class{constructor(e){this._opts=e,this.$=Fera.Util.$(),this._skillSelectorsToVerify=[],this._popovers=[],this.app=this._opts.app,this._opts.app.on("widget.create",this._onSkillCreate.bind(this)),this._opts.app.on("notification.show",this._onNotifShow.bind(this)),this._opts.debugMode&&(window.verifier=this)}_onSkillCreate(e){e.settings&&e.settings.show_verification&&e.$el&&(e.$el.length<1||("product_detail_counter"!=e.type||e.$el.is(".fera-recentOrderCount")?"product_list_counter"==e.type&&this._skillSelectorsToVerify.push(e.$el):this._skillSelectorsToVerify.push(e.$el.find(".banana-sentence,.fera-sentence")),this._attachPopovers()))}addVerificationIcon(e,t={}){let r=this.$(this.constructor._iconTpl(t));return e.append(r),this._attachPopover(e),r}addVerificationPopover(e){return this._attachPopover(e),e}_attachPopovers(){this._skillSelectorsToVerify.forEach((e=>{this.$(e).each(((e,t)=>{this._attachPopover(this.$(t))}))}))}_onNotifShow(e){e.settings.show_verification&&this.addNotifIcon(e.popup.$el)}addNotifIcon(e){this._loadAssets((()=>{this._notifIcon=new Fera.Verification.Icon({$target:e.find(".fera-event-time-ago"),iconTpl:this.constructor._iconTpl()}),this._notifIcon.show()}))}_attachPopover(e){e.data("fera-verifier-attached")||e.on("mouseenter",(()=>{this._loadAssets((()=>{if(e.data("fera-verifier-attached"))return;let t=new Fera.Verification.Popover(e);if(t.show(),this._popovers.push(t),this._popovers.length>1){let e=this._popovers.map((e=>e.getInstance()));e=e.filter((e=>{if(e)return e})),this._popovers[0].createOrUpdateSingleton(e)}e.addClass("fera-verified"),e.data("fera-verifier-attached",!0)}))}))}_setupListeners(){var e;new MutationObserver((t=>{t.forEach((t=>{t.addedNodes&&(e||(e=setTimeout((()=>{clearTimeout(e),this._attachPopovers()}),10)))}))})).observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}_loadAssets(e){if(e=e||(()=>{}),this._loadedAssets)return e();if(this._loadingAssets)return setTimeout((()=>this._loadAssets(e)),50);this._loadingAssets=!0;var t="";t=this._opts.api.baseAppPath&&this._opts.api.baseAppPath.match(/((test|ngrok|localhost|dev|development)[.-]|127\.0\.0\.1)/i)?this._opts.api.baseAppPath+"/assets/public/fera.verification.js?v="+this.app.version:`https://cdn.jsdelivr.net/gh/feracommerce/ferajs@${this.app.version}/dist/fera.verification.js`;var r=this._opts.debugMode?1:900;new FeraCachedAsset({name:"Fera.Verifcation.Js",url:t,expiresIn:r}).load((()=>{try{this._setupListeners(),this._loadedAssets=!0,this._loadingAssets=!1,e()}catch(e){if(this._opts.debugMode)throw e}}))}static _iconTpl(e={}){return`<svg height="${e.height||16}" viewBox="0 0 28 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="fera-validation-icon fera-validation-icon--sm">\n            <path d="M8.08787 1.53793C8.08787 2.38731 7.39477 3.07586 6.53979 3.07586C5.68481 3.07586 4.99171 2.38731 4.99171 1.53793C4.99171 0.688554 5.68481 0 6.53979 0C7.39477 0 8.08787 0.688554 8.08787 1.53793Z" fill="#EF4323" class="fera-verification-icon-sm-1"></path>\n            <path d="M16.3635 1.66374C16.3635 2.51312 15.6704 3.20167 14.8155 3.20167C13.9605 3.20167 13.2674 2.51312 13.2674 1.66374C13.2674 0.814365 13.9605 0.125811 14.8155 0.125811C15.6704 0.125811 16.3635 0.814365 16.3635 1.66374Z" fill="#EF4323" class="fera-verification-icon-sm-2"></path>\n            <path d="M20.5 5.54887C20.5 6.39825 19.8069 7.0868 18.9519 7.0868C18.0969 7.0868 17.4038 6.39825 17.4038 5.54887C17.4038 4.69949 18.0969 4.01094 18.9519 4.01094C19.8069 4.01094 20.5 4.69949 20.5 5.54887Z" fill="#EF4323" class="fera-verification-icon-sm-3"></path>\n            <path d="M3.54806 5.44971C3.54806 6.29908 2.85496 6.98763 1.99998 6.98763C1.145 6.98763 0.451904 6.29908 0.451904 5.44971C0.451904 4.60033 1.145 3.91178 1.99998 3.91178C2.85496 3.91178 3.54806 4.60033 3.54806 5.44971Z" fill="#EF4323" class="fera-verification-icon-sm-4"></path>\n            <path d="M12.3526 5.54888C12.3526 6.39826 11.6595 7.08681 10.8045 7.08681C9.94953 7.08681 9.25643 6.39826 9.25643 5.54888C9.25643 4.6995 9.94953 4.01095 10.8045 4.01095C11.6595 4.01095 12.3526 4.6995 12.3526 5.54888Z" fill="#EF4323" class="fera-verification-icon-sm-5"></path>\n            <path d="M6.64421 10.5C6.64421 11.3494 5.95111 12.0379 5.09614 12.0379C4.24116 12.0379 3.54806 11.3494 3.54806 10.5C3.54806 9.65062 4.24116 8.96207 5.09614 8.96207C5.95111 8.96207 6.64421 9.65062 6.64421 10.5Z" fill="#EF4323" class="fera-verification-icon-sm-6"></path>\n            <path d="M12.3526 14.4621C12.3526 15.3115 11.6595 16 10.8045 16C9.94953 16 9.25643 15.3115 9.25643 14.4621C9.25643 13.6127 9.94953 12.9241 10.8045 12.9241C11.6595 12.9241 12.3526 13.6127 12.3526 14.4621Z" fill="#EF4323" class="fera-verification-icon-sm-7"></path>\n            <path d="M19 5.5L14.8155 1.53796L10.8045 6L6.34792 1.53796L2 5.5L5 10.5L10.8045 14.4621" stroke="#EF4323" class="fera-verification-icon-sm-8"></path>\n            <path d="M13.5872 9.66042L18.0438 14.4621L27 5" stroke="#00C48D" stroke-width="2" stroke-linejoin="round" class="fera-verification-icon-sm-9"></path>\n        </svg>`}},Fera.VideoViewer=class{init(e){this.$=Fera.Util.$(),this.$el=this.$(this.selector),this.$el.length<1&&(this._render(),this.$el=this.$(this.selector),this.$el.find(".fera-videoViewer-container").on("click",this._hide.bind(this))),e.on("click",this._show.bind(this))}get selector(){return".fera-videoViewer-overlay"}_show(e){let t=this.$(e.target).clone().removeClass();if(t.data("videoUrl")){const e=t.data("videoUrl");t=t.data("videoIsImported")&&"url"!==t.data("videoType")?this.$(this.setImportedVideoTpl(e,t.data("videoType"))):this.$(`<video src="${e}" controls>`)}const r=this.$('<a href="#" class="fera-videoViewer-close-btn">&times;</a>');this.$el.removeClass("fera-hidden"),this.$el.find(".fera-videoViewer").html(t.attr("controls",!0)),this.$el.find(".fera-videoViewer").append(r),this.$("body").addClass("fera-modal--open"),r.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._hide()})),this.$(document).on("keydown",(e=>{27===(e.keyCode||e.which)&&this._hide()})),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}setImportedVideoTpl(e,t){const r=this._prepareImportedVideoUrl(e,t);return["youtube","vimeo","instagram"].includes(t)?`<iframe src="${r}" width="640" height="480"\n                    frameborder="0" allow="accelerometer; autoplay; picture-in-picture"\n                    allowfullscreen></iframe>`:`<video src="${r}" controls>`}_prepareImportedVideoUrl(e,t){if("url"===t)return e;({youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9\.]+\/videos\/(?:[a-zA-Z0-9\.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/})[t].test(e);return"youtube"===t?e=`https://www.youtube.com/embed/${RegExp.$5}`:"vimeo"===t?e=`https://player.vimeo.com/video/${RegExp.$5}`:"instagram"===t&&(e=`https://www.instagram.com/p/${RegExp.$2}/embed`),e}_hide(e){if(e){if(!this.$(e.target).is(".fera-videoViewer-container"))return}this.$el.find("video").trigger("pause"),this.$el.addClass("fera-hidden"),this.$("body").removeClass("fera-modal--open"),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_render(){this.$("body").append(this._tpl()).append(`<style>${this._css()}</style>`)}_tpl(){return'\n<div class="fera-videoViewer-overlay fera-hidden">\n    <div class="fera-videoViewer-container">\n        <div class="fera-videoViewer"></div>\n    </div>\n</div>\n        '}_css(){return"\n.fera-modal--open {\n    overflow: hidden !important;\n}\n\n.fera-hidden {\n    display: none !important;\n}\n\n.fera-videoViewer-overlay {\n    position: fixed;\n    background: rgba(0,0,0,0.4);\n    z-index: 9999999;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fera-videoViewer-container {\n    height: 100vh;\n    width: 100vw;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.fera-videoViewer {\n    max-width: 900px;\n    position: relative;\n    margin: 15px;\n}\n\n.fera-videoViewer-close-btn {\n    color: #000000;\n    font-weight: 100;\n    font-size: 1.5rem;\n    line-height: 0.75rem;\n    position: absolute;\n    right: 14px;\n    top: 14px;\n}\n\n.fera-videoViewer video {\n    width: 100% !important;\n    max-height: 100vh;\n}\n\n.fera-videoViewer-viewable {\n    cursor: pointer;\n}\n        "}},Fera.BaseContainer=function(e){e=e||{};var t=this,r=Fera.Util.$();t.id=e.id;var i=function(){t.$container=e.el,t.dataAttr=n(t.$container)};this.dispatchEvent=function(e,r,i){i=i||function(){},t.each((function(t){"function"==typeof t.dispatchEvent&&t.dispatchEvent(e,r,i)}))},this.selector=function(){return t.$container},this.hasDataAttr=function(e){return t.dataAttr[e]&&""!=t.dataAttr[e]},this.getDataAttr=function(e){return t.dataAttr[e]};var n=function(e){var t={},i=/^data\-(.+)$/;return r.each(e.get(0).attributes,(function(e,r){if(i.test(r.nodeName)){var n=r.nodeName.match(i)[1];t[n]=r.nodeValue}})),t};i()},Fera.ContainerCollection=function(e){e=e||{};var t,r=this,i=Fera.Util.$(),n=[],a=0,o=!1,s=function(){r.locateNewContainers(),l(),setTimeout((function(){m(),u()}),100)};this.updateContentFromCache=function(){r.globalBottom&&r.globalBottom.updateContentFromCache()},this.locateNewContainers=function(){var t=[];return i(".banana-container").each((function(){var a=e;if(a.el=i(this),!a.el.data("bsio-container-id")){var o=Fera.ContainerFactory.create(a.el.data("container_type"),a);o&&(n.push(o),t.push(o),o.constructor===Fera.GlobalBottomContainer&&(r.globalBottom=o))}})),r.length=n.length,t},this.triggerWidget=function(e,t){this.each((function(r){void 0!==r.triggerWidget&&r.triggerWidget(e,t)}))},this.triggerSkill=this.triggerWidget;var l=function(){r.length>20&&(o=!0)};this.size=function(){return n.length},this.updateContent=function(t,i,n){if(n=n||function(){},!t.content_responses)return e.logger.logWarning("Content responses result was empty so content couldn't be updated.",t),n();for(var a=t.content_responses.length,o=0,s=function(){o++},l=Date.now(),c=setInterval((function(){(o>=a||Date.now()-l>1e4)&&(clearInterval(c),c=null,n())}),1),u=0;u<t.content_responses.length;u++){var d=t.content_responses[u];if(d){var p=r.getContainerById(d.container_id);if(!p){s();continue}try{p.updateContent(d,s)}catch(t){e.logger.error(t),s()}p.needsUpdate=!1}else e.logger.logWarning("Fera did not receive persistent content for container so nothing was displayed for that container.",d),s()}},this.markAllContainersAsDirty=function(){n&&r.each((function(e){e.needsUpdate=!0}))},this.getContainerById=function(e){for(var t=0;t<n.length;t++)if(n[t].id==e)return n[t];return null},this.getContentRequest=function(e,t){for(var r=[],i=void 0===t?n:t,a=0;a<i.length;a++){var o=i[a];if(o.needsUpdate){if(c(o))continue;var s=o.getContentRequest(e);if(!s){o.needsUpdate=!1;continue}s.container_id=o.id,r.push(s)}}return r};var c=function(e){return!!o&&(!e.isVisible()&&!e.alwaysVisible&&(a/1e3<(new Date).getTime()/1e3-60&&(a=(new Date).getTime()),!0))};this.each=function(e){for(var t=0;t<n.length;t++)e(n[t],t);return this},this.find=function(e){for(var t=0;t<n.length;t++)if(e(n[t],t))return n[t];return null},this.toArray=function(){return n},this.indexOf=function(e){for(var t="number"==typeof e?e:e.id,r=0;r<n.length;r++)if(n[r].id==t)return r;return-1},this.removeByIndex=function(t){return n[t]?n.splice(t,1):(e.logger.logWarning("Could not remove container at index because it does not exist.",t),null)},this.remove=function(e){return r.removeByIndex(r.indexOf(e))},this.removeAll=function(e){for(var t=0;t<e.length;t++)r.remove(e[t]);return e},this.forceRefresh=function(){f(),r.globalBottom.needsUpdate=!0;var e=r.getContentRequest({});r.updateContainers(!1,(function(){m()}),e)},this.refresh=Fera.Util.throttle(this.forceRefresh,100),this.dispatchEvent=function(e,t,i){i=i||function(){},r.each((function(r){r.dispatchEvent&&r.dispatchEvent(e,t,i)}))};var u=function(){r.each((function(e){e.wasVisible=e.isVisible()}))},d=function(){var e=[],t=[];r.each((function(r){!r.isVisible()||r.wasVisible||r.alwaysVisible?r.isVisible()||!r.wasVisible||r.alwaysVisible||(t.push(r),r.wasVisible=!1):(e.push(r),r.wasVisible=!0)})),e.length>0&&u();var i=0;for(i=0;i<e.length;i++)e[i].onBecomeVisible&&e[i].onBecomeVisible();for(i=0;i<t.length;i++)t[i].onBecomeVisible&&t[i].onBecomeInvisible()},p=function(){var e=r.locateNewContainers();if(e.length>0){f();var t=r.getContentRequest({},e);return r.updateContainers(!1,(function(){m()}),t),!0}return!1};r.checkForNewContexts=function(){var e=r.context||{};return r.context=r.getContext()||{},JSON.stringify(r.context)!==JSON.stringify(e)&&(Fera.logger.log("New context detected:",e,r.context),r.refresh(),!0)};var h=function(){var e=[];return r.each((function(t){i.contains(document.documentElement,t.$container[0])||e.push(t)})),r.removeAll(e),e},f=function(){clearInterval(t)},m=function(){t&&clearInterval(t),t=setInterval((function(){h(),p()?u():(r.checkForNewContexts(),d())}),100)};s()},Fera.ContainerFactory={create:function(e,t){t.id=Fera.ContainerFactory.nextContainerId();var r=!1;return"global_bottom"==e&&(r=new Fera.GlobalBottomContainer(t)),r&&(r.$container.data("bsio-container-id",t.id),r.$container.data("fera-container-id",t.id)),r},nextContainerId:function(){return window.__bsioLastContainerId=window.__bsioLastContainerId||0,window.__bsioLastContainerId++,window.__bsioLastContainerId}},Fera.GlobalBottomContainer=function(e){e=e||{};var t=this;t.baseContainer=new Fera.BaseContainer(e),t.id=e.id;var r,i=1,n="global_bottom";t.alwaysVisible=!0;var a=[],o=!1,s=Fera.Util.$(),l=function(){t.needsUpdate=!0,(r={container:t,cookieJar:e.cookieJar,debugMode:e.debugMode,testMode:e.testMode,logger:e.logger,localStorage:e.localStorage,adminMode:e.adminMode,optionsParser:e.optionsParser,app:e.app,api:e.api,timeTracker:e.timeTracker}).engagementTracker=e.engagementTracker,t.abstractBlocks={},u()};this.updateContentFromCache=function(){return!(e.app.opts.sandboxMode||e.app.opts.testMode||e.app.opts.adminMode||e.app.opts.previewMode)&&(o=!0,d(a),o=!1,!0)},this.triggerWidget=function(e,r){this.each((function(i,n){parseInt(e)===parseInt(n)&&void 0!==i.triggerWidget&&(i.triggerWidget(r)||"manual"!==i.settings.trigger||"custom_popup"!==i.type||(i.remove(),t.abstractBlocks[i.skillId]=m(i.lastDisplayerResponse),t.abstractBlocks[i.skillId].triggerWidget(r)))}))},this.triggerSkill=this.triggerWidget,this.each=function(e){for(var r=Object.keys(t.abstractBlocks),i=0;i<r.length;i++)e(t.abstractBlocks[r[i]],r[i],i);return t},this.removeAllBlocks=function(){return this.each((function(e,r){e&&e.remove(),delete t.abstractBlocks[r]})),t};var c=function(r){if(!e.sandboxMode&&!t.hasPreview&&!o){for(var i=[],n=864e5,a=0;a<r.length;a++){var s=r[a];s.cacheable&&i.push(s)}e.app.localStorage.setObject("Cache.DisplayerResponses",i,n)}},u=function(){if(e.app.opts.sandboxMode||e.app.opts.testMode||e.app.opts.adminMode||e.app.opts.previewMode)return!1;a=e.app.localStorage.getObject("Cache.DisplayerResponses",[])},d=function(e,r,i){r=r||[];var n=!1,a={},o=e.length,l=0,u=0,d=3e3;c(e);for(var m=function(){l++},g=setInterval((function(){u+=1,l>=o?(clearInterval(g),g=null,i&&i(n)):u>d&&(clearInterval(g),i&&i(!1),g=null)}),1),v=0;v<o;v++){var _=e[v],w=_.campaign_id;t.hasPreview=t.hasPreview||_.isPreview,s.isArray(_.contexts)?p(a,_,w,m)&&(n=!0):h(a,_,w,m)&&(n=!0)}return f(r),n},p=function(e,t,r,i){for(var n=!1,a=Object.keys(t.html),o=0;o<a.length;o++){var l=a[o],c=s.extend({},t,{html:t.html[l],context:String(l)});c.settings=s.extend({},t.settings),h(e,c,[r,l].join("."),i)&&(n=!0)}return n},h=function(r,i,n,a){try{if(t.abstractBlocks[n]){if(t.abstractBlocks[n].isPreview){var o=t.abstractBlocks[n];t.abstractBlocks[n]=m(i,(function(e){o.remove(),a(e)}),(function(){o.remove()}))}else t.abstractBlocks[n].settings&&!t.abstractBlocks[n].settings.needs_updates||t.abstractBlocks[n].update(i,a);r[n]=!0}else t.abstractBlocks[n]=m(i,a);return Fera.Util.showWithoutTransform(t.$container),!0}catch(t){e.logger.error(t)}return!1},f=function(r){if(t.abstractBlocks)for(var i=Object.keys(t.abstractBlocks),n=0;n<r.length;n++)try{for(var a=r[n],o=0;o<i.length;o++){var s=i[o];s.split(".")[0]==a&&t.abstractBlocks[s].settings&&t.abstractBlocks[s].settings.needs_updates&&(t.abstractBlocks[s].remove(),t.abstractBlocks[s]=null)}}catch(t){e.logger.error(t)}},m=function(e,n,a){var o=new Fera.CustomContainer(r);return o.id=t.id.toString()+"_"+i++,o.create(e,(function(){o.remove(),o.removed||(t.abstractBlocks[o.widgetId]=m(o.lastDisplayerResponse))}),n,a),o};this.updateContent=function(e,r){return r=r||function(){},e.abstract_blocks?d(e.abstract_blocks,e.hidden_blocks,r):(t.$container.hide(),r(!1),!1)},this.getContentRequest=function(e){e=e||{};var r=t.dataAttr;return r.container_type=n,r},this.getDataAttr=t.baseContainer.getDataAttr,this.hasDataAttr=t.baseContainer.hasDataAttr,this.dataAttr=t.baseContainer.dataAttr,this.selector=t.baseContainer.selector,this.$container=t.baseContainer.$container,this.isVisible=function(){return Fera.Util.isFullyVisible(t.$container)},l()},Fera.Actions=Fera.Actions||{},Fera.Actions.Base=class extends Fera.Base{run(e){this._error("isStillThere must be implemented by Fera.Actions.CustomBlocks.Base")}update(e){}},Fera.Actions.ChangeBlockAction=class extends Fera.Base{constructor(e){super(),this.skill=e,this.action=null}run(){if(this.$target=this.$(this.skill.settings.target_selector),"hide"===this.skill.settings.target_action)this.action=this._createNewAction(this.$target,"hide");else if("move"===this.skill.settings.target_action){this.$destination=this.$(this.skill.settings.integration_selector);var e=this.skill.settings.integration_selector_action;this.action=this._createNewAction(this.$destination,e)}else this.action=this._createNewAction(this.$target,"replace");this.action&&this.action.run(this.skill)}update(){this.action&&this.action.update(this.skill)}_createNewAction(e,t){return"insert_after"===t?new Fera.Actions.CustomBlocks.InsertAfterAction(e):"insert_before"===t?new Fera.Actions.CustomBlocks.InsertBeforeAction(e):"append_to"===t?new Fera.Actions.CustomBlocks.AppendAction(e):"prepend_to"===t?new Fera.Actions.CustomBlocks.PrependAction(e):"replace"===t?new Fera.Actions.CustomBlocks.ReplaceAction(e):"hide"===t?new Fera.Actions.CustomBlocks.HideAction(e):(this._error("Unknown integration selector location configured.",this.skill.settings,e),null)}remove(){this.action&&this.action.remove()}},Fera.Actions.CustomBlocks=Fera.Actions.CustomBlocks||{},Fera.Actions.CustomBlocks.Base=class extends Fera.Actions.Base{constructor(e){super(),this.$targetEl=e}isStillThere(){return this.$.contains(document.documentElement,this.$el.get(0))}makeChange(){this._error("#makeChange must be implemented by Fera.Actions.CustomBlocks.Base")}run(e){if(this.$el&&this.isStillThere())return!1;this._setElement(e),this.makeChange()}refreshOnTargetChange(){return!1}_setElement(e){"hide"===e.settings.target_action?this.$el=this.$targetEl:"move"===e.settings.target_action?(this.$movePlaceHolder=this.$("<div></div>"),this.$el=this.$(e.settings.target_selector).replaceWith(this.$movePlaceHolder)):(this.$el=this.$(e.html.replace(/<!--[\s\S]*?-->/g,"").trim()),this.$el.attr("data-fera-widget",e.widgetId),this.$el.attr("data-fera-skill",e.widgetId))}update(e){return this.isStillThere()?this._updateBlock(e):this.run(e),!0}remove(){this.$el.remove(),this.$movePlaceHolder&&this.$movePlaceHolder.replaceWith(this.$el)}_updateBlock(e){"move"!==e.settings.target_action&&"hide"!==e.settings.target_action&&this.$el.html(this.$(e.html.replace(/<!--[\s\S]*?-->/g,"").trim()).html())}},Fera.Actions.CustomBlocks.AppendAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.append(this.$el)}isStillThere(){return this.$.contains(this.$targetEl.get(0),this.$el.get(0))}},Fera.Actions.CustomBlocks.HideAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.hide()}isStillThere(){return"none"==this.$targetEl.css("display")}remove(){this.$targetEl.show()}},Fera.Actions.CustomBlocks.InsertAfterAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.after(this.$el)}isStillThere(){return this.$.contains(this.$targetEl.parent().get(0),this.$el.get(0))}refreshOnTargetChange(){return!0}},Fera.Actions.CustomBlocks.InsertBeforeAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.before(this.$el)}isStillThere(){return this.$.contains(this.$targetEl.parent().get(0),this.$el.get(0))}refreshOnTargetChange(){return!0}},Fera.Actions.CustomBlocks.PrependAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.prepend(this.$el)}},Fera.Actions.CustomBlocks.ReplaceAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$oldElement=this.$targetEl.replaceWith(this.$el)}remove(){this.$el.replaceWith(this.$oldElement),super.remove()}},Fera.Actions.CustomBlocks.ReplaceContentAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.empty(),this.$targetEl.append(this.$el)}},Fera.CustomContainer=function FeraCustomContainer(opts){opts=opts||{};var self=this,$=Fera.Util.$(),campaignSettings,ran=!1,registeredEngagement=!1,keyNamespace,feraSkill,eventPrefix,previousSection,previousProductIdOrContext,actions=new Fera.ActionCollection,triggered=!1,triggerDelay,init=function(){self.$globalTopContainer=opts.container.$container,self.$container=$('<div class="banana-container-row banana-custom-container" style="display: none;"></div>'),self.$container.appendTo(self.$globalTopContainer)};this.create=function(jsonResponse,removeCallback,afterCreate,beforeRun){ran=!1;var continueCreate=!0;assignLocalVarsFromServer(jsonResponse),triggerBeforeCreateEvents(eventPrefix),eval(self.lastDisplayerResponse.js),"function"==typeof FeraWidget?feraSkill=new FeraWidget(self):"function"==typeof FeraSkill&&(feraSkill=new FeraSkill(self)),prepare(feraSkill,(function(e,t){return self.removed?(afterCreate&&afterCreate(!1),!1):!1===e?(Fera.logger.log("Widget hidden by beforeRender",t,self),self.createInProgress=!1,afterCreate&&afterCreate(!1),!1):void generateStateVars((function(){if(self.removed)return afterCreate&&afterCreate(!1),!1;if(!self.isPreview&&opts.app.storeSettings.use_client_side_processing){if(!checkConditions())return self.createInProgress=!1,afterCreate&&afterCreate(!1),!1;if(!checkAbTests())return self.createInProgress=!1,afterCreate&&afterCreate(!1),!1}!self.html&&self.lastDisplayerResponse.renders_template_client_side&&_renderTemplate(),setupShopperActionTriggers(),setupTriggerDelays(),waitForRun((function(){if(self.removed)return afterCreate&&afterCreate(!1),!1;beforeRun&&beforeRun(),feraSkill&&feraSkill.run&&(continueCreate=feraSkill.run()),!1!==continueCreate?(Fera.Util.showWithoutTransform(self.$container),campaignSettings.target_selector&&pullElementsFromTarget(),self.isPreview||(markSeen(),self.registerEngagement(jsonResponse.campaign_id)),triggerAfterCreateEvents(eventPrefix),feraSkill&&feraSkill.afterCreate&&feraSkill.afterCreate(),self.$el&&-1===["replace","replace_content"].indexOf(campaignSettings.integration_selector_action)&&self.$el.each((function(e,t){Fera.Util.onRemove(t,removeCallback||function(){})})),afterCreate&&afterCreate(!0)):(opts.logger.log("Creation blocked by Fera widget returned response.",feraSkill),afterCreate&&afterCreate(!1)),self.createInProgress=!1}))}))}))};var assignLocalVarsFromServer=function(e){self.lastDisplayerResponse=e,(campaignSettings=self.lastDisplayerResponse.settings).id=self.lastDisplayerResponse.campaign_id,self.app=opts.app,self.api=opts.api,self.adminMode=opts.adminMode,self.memory=new Fera.SkillsLocalStorage({logger:opts.logger,cookieJar:opts.cookieJar,namespace:keyNamespace}),self.localStorage=self.memory,self.lastDisplayerResponse.html&&(self.html=self.lastDisplayerResponse.html),self.options=self.settings=campaignSettings,self.storeSettings=self.app.storeSettings||self.lastDisplayerResponse.store||self.lastDisplayerResponse.store_settings||{},self.widgetId=self.skillId=self.lastDisplayerResponse.campaign_id,
self.isPreview=e.isPreview||opts.optionsParser.getPreviewId()==self.widgetId,self.type=self.lastDisplayerResponse.type,self.context=self.lastDisplayerResponse.context,previousSection=opts.app.getSection(),previousProductIdOrContext=opts.app.getProductId()||self.context,keyNamespace="Fera.Widget."+self.widgetId,eventPrefix="widget."+self.widgetId};self.needsUpdate=function(){return!(self.settings&&!self.settings.needs_updates)||(opts.app.getSection()!=previousSection||(opts.app.getProductId()||self.context)!=previousProductIdOrContext)};var triggerBeforeCreateEvents=function(e){triggerFeraEvent(e+".create:before"),triggerFeraEvent("widget.create:before"),triggerEvent("Fera.Skill."+self.widgetId+"-create-before"),triggerEvent("fera-skill-create-before"),triggerFeraEvent(e.replace("widget","skill")+".create:before"),triggerFeraEvent("skill.create:before")},triggerAfterCreateEvents=function(e){triggerFeraEvent(e+".create"),triggerFeraEvent(e+".create:after"),triggerFeraEvent("widget.create"),triggerFeraEvent("widget.create:after"),triggerEvent("Fera.Skill."+self.widgetId+"-create-after"),triggerEvent("fera-skill-create-after"),triggerFeraEvent("skill.create"),triggerFeraEvent("skill.create:after"),triggerFeraEvent(e.replace("widget","skill")+".create"),triggerFeraEvent(e.replace("widget","skill")+".create:after")},prepare=function(e,t){return self.lastDisplayerResponse.renders_template_client_side&&e?e.beforeRender?(self.renderInProgress=new Date,e.beforeRender((function(e,r){delete self.renderInProgress,!1===e?t(!1,r):(self.vars=e,t())}))):void t():t()},checkConditions=function(){return!self.lastDisplayerResponse.conditions||new Fera.Conditions_Evaluator(self.lastDisplayerResponse.conditions,self.vars).isTrue()},checkAbTests=function(){return!!self.app.abTests.onFor(self.skillId)||(opts.logger.log("Widget blocked by AB Test running (wait 15min if recently changed).",self),!1)},generateStateVars=function(e){opts.app.getState((function(t){self.vars=$.extend({},{options:self.options,store:self.storeSettings,shopper:{location:t.location,customer_id:t.customer_id}},t,self.vars||{}),e(self.vars)}))},_renderTemplate=function(){var e=self.options.template;if(!e||""===e.trim())return"";try{var t=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}");self.lastDisplayerResponse.html=self.html=Fera.Liquid.parse(t).render(self.vars)}catch(t){if(opts.debugMode)throw t;console.error(t),self.lastDisplayerResponse.html=self.html=e}};this.registerEngagement=function(e){return e=e||self.widgetId,!registeredEngagement&&!0!==self.skipRegisterEngagement&&!opts.testMode&&(opts.engagementTracker.register(e),registeredEngagement=!0,!0)};var canRunWithoutRepeating=function(){if(self.isPreview)return!0;if(!campaignSettings.trigger_repeat)return!0;var e=self.memory.get("last_seen");if(!e)return!0;var t=parseInt(e)+1e3*parseInt(campaignSettings.trigger_repeat);return(new Date).getTime()>t},markSeen=function(){self.memory.set("last_seen",(new Date).getTime())};this.getState=opts.app.getState,this.update=function(e,t){if(!self.removed)if(ran){self.lastDisplayerResponse=e,campaignSettings=self.lastDisplayerResponse.settings,self.lastDisplayerResponse.html&&(self.html=self.lastDisplayerResponse.html),self.settings=self.options=campaignSettings,triggerEvent("Fera.Skill."+e.campaign_id+"-update-before"),triggerEvent("fera-skill-update-before");var r=!0;waitForRun((function(){if(self.removed)return t&&t(!1),!1;generateStateVars((function(){if(self.removed)return t&&t(!1),!1;if(!self.isPreview&&opts.app.storeSettings.use_client_side_processing){if(!checkConditions())return t&&t(!1),!1;if(!checkAbTests())return t&&t(!1),!1}!self.lastDisplayerResponse.html&&self.lastDisplayerResponse.renders_template_client_side&&_renderTemplate(),updateActions(),feraSkill&&feraSkill.update&&(r=feraSkill.update()),!1!==r?(triggerFeraEvent(eventPrefix+".update"),triggerEvent("Fera.Skill."+e.campaign_id+"-update-after"),triggerEvent("fera-skill-update-after"),triggerFeraEvent(eventPrefix.replace("widget","skill")+".update"),feraSkill&&feraSkill.afterUpdate&&feraSkill.afterUpdate(),t&&t(!0)):(opts.logger.log("Update blocked by Fera Widget",feraSkill),t&&t(!1))}))}))}else t&&t(!1)},this.hide=function(){self.$container&&self.$container.hide()},this.remove=function(){self.removed||(self.removed=!0,self.$el&&self.$el.each((function(e,t){Fera.Util.disconnectRemoveHandlers(t)})),feraSkill&&feraSkill.remove&&feraSkill.remove(),actions.remove(),self.$container.remove())},this.triggerWidget=function(){return!triggered&&(!self.removed&&(triggered=!0,!0))},this.triggerSkill=this.triggerWidget;var setupTriggerDelays=function(){if(campaignSettings.trigger_value&&-1!==["after_time_on_page","after_time_on_site","after_inactive_time_on_page","after_time_since_first_seen"].indexOf(campaignSettings.trigger))if("string"==typeof campaignSettings.trigger_value)if(campaignSettings.trigger_value.match(/^[0-9]+$/))triggerDelay=parseInt(campaignSettings.trigger_value);else{var e=0,t=15;"random_1_to_15_sec"===campaignSettings.trigger_value||("random_15_to_60_sec"===campaignSettings.trigger_value?(e=15,t=60):"random_1_to_5_min"===campaignSettings.trigger_value?(e=60,t=900):Fera.logger.warn("Widget settings for trigger random range are invalid. Fell back on 1-15 seconds range.",campaignSettings)),(triggerDelay=Math.round(Math.random()*t)+e)<1&&(triggerDelay=1)}else triggerDelay=parseInt(campaignSettings.trigger_value)},setupShopperActionTriggers=function(){if("on_exit_intent"===campaignSettings.trigger)new Fera.ExitIntentDetector({onExitIntent:self.triggerWidget});else if(-1!==["on_click","on_mouseenter","on_mouseleave"].indexOf(campaignSettings.trigger)){var e=campaignSettings.trigger.replace("on_","");$(campaignSettings.trigger_value).on(e,self.triggerWidget)}},waitForRun=function(e){if(ran)return e();if("custom_action"==self.type||"change_block"==self.type)return e();if(!1===runActions())return self.remove(),e();if(ran)return e();var t=setInterval((function(){if(!self.removed)return runActions(),ran?(clearInterval(t),e()):void 0;clearInterval(t)}),10)},updateActions=function(){foreachTargetEl((function(e,t){if(!self.removed){var r=actions.get(t);if(r){if(r.$targetEl.get(0)!==e.get(0)){if(!r.refreshOnTargetChange())return;r.$targetEl=e}r.update(self),e.data("feraFoundExisting",!0)}}})),foreachTargetEl((function(e){if(e.data("feraFoundExisting"));else{var t=createNewAction(e);actions.add(t),t.run(self.lastDisplayerResponse)}e.data("feraFoundExisting",null)})),pullElementsFromActions()},triggerConditionsMet=function(){if(triggered)return!0;if(self.isPreview&&opts.app.sandboxMode)return!0;if(!campaignSettings.trigger||"on_load"===campaignSettings.trigger)return!0;if("after_time_on_page"===campaignSettings.trigger){if(opts.timeTracker.getTimeOnCurrentPage()>=triggerDelay)return!0}else if("after_time_on_site"===campaignSettings.trigger){if(opts.timeTracker.getSessionTime()>=triggerDelay)return!0}else if("after_inactive_time_on_page"===campaignSettings.trigger){if(opts.timeTracker.getInactiveTimeOnPage()>=triggerDelay)return!0}else{if("after_time_since_first_seen"!==campaignSettings.trigger)return-1===["manual","on_click","on_mouseenter","on_mouseleave","on_exit_intent"].indexOf(campaignSettings.trigger)&&(Fera.logger.logWarning("Unknown trigger conditions so triggering now.",campaignSettings,self),!0);if(opts.timeTracker.getTimeSinceFirstSeen()>=triggerDelay)return!0}return!1},runActions=function(){if(triggerConditionsMet()&&canRunWithoutRepeating()){if(new Fera.IntegrationLocator(opts.app).repositionWidget(campaignSettings,self.context),"tag"==campaignSettings.integration_mode&&(campaignSettings.integration_selector_action="replace_content"),campaignSettings.integration_selector&&campaignSettings.integration_selector_action){if(!1===createActions())return!1}else{if(!campaignSettings.has_location_on_page&&"custom_popup"!=self.type&&"custom_push_notif"!=self.type)return!1;ran=!0}actions.run(self),pullElementsFromActions()}},pullElementsFromActions=function(){self.$el=$([]),actions.each((function(e){e.$el&&(self.$el=self.$el.add(e.$el))})),self.$el.data("fera-preview-container")&&1===self.$el.children().length&&(self.$el=self.$el.children()),self.$el.attr("data-fera-widget",self.widgetId),self.$el.attr("data-fera-skill",self.widgetId)},pullElementsFromTarget=function(){var e=$(campaignSettings.target_selector);e&&(self.$el=self.$el||$([]),self.$el=self.$el.add(e),self.$el.attr("data-fera-widget",self.widgetId),self.$el.attr("data-fera-skill",self.widgetId))},foreachTargetEl=function(e){var t=$(campaignSettings.integration_selector);if(t.length<1)return!1;t.each((function(t){var r=$(this);e(r,t)}))},createActions=function(){if(!self.lastDisplayerResponse.html)return!1;var e=!1;if(!1===foreachTargetEl((function(t){var r=createNewAction(t);r&&(actions.add(r),e=!0)}))&&self.isPreview)return!1;e&&(ran=!0)},createNewAction=function(e){var t=campaignSettings.integration_selector_action;return"insert_after"===t?new Fera.Actions.CustomBlocks.InsertAfterAction(e):"insert_before"===t?new Fera.Actions.CustomBlocks.InsertBeforeAction(e):"append_to"===t?new Fera.Actions.CustomBlocks.AppendAction(e):"prepend_to"===t?new Fera.Actions.CustomBlocks.PrependAction(e):"replace"===t?new Fera.Actions.CustomBlocks.ReplaceAction(e):"replace_content"===t?new Fera.Actions.CustomBlocks.ReplaceContentAction(e):(opts.logger.error("Unknown integration selector location configured.",campaignSettings),null)},triggerEvent=function(e){!function(t){try{t(document).trigger(e,self)}catch(e){opts.logger.error(e),opts.adminMode&&opts.optionsParser.hasPreviewFilterById()&&alert("Your custom widget produced an error: "+e.message+" (see console for more info).\n\n**THIS MESSAGE WILL NOT APPEAR TO YOUR SHOPPERS ***")}}($)},triggerFeraEvent=function(e){try{opts.app.trigger(e,self)}catch(e){opts.logger.error(e),opts.adminMode&&opts.optionsParser.hasPreviewFilterById()&&alert("Your custom widget produced an error: "+e.message+" (see console for more info).\n\n**THIS MESSAGE WILL NOT APPEAR TO YOUR SHOPPERS ***")}};init()},Fera.IntegrationLocator=class{constructor(e){this.$=Fera.Util.$(),this.app=e}repositionWidget(e,t){const r=new Date(e.updated_at),i=new Date("2021-02-18T19:10:00.000Z");let n=null==e.integration_mode&&null==e.integration_selector;if(n=n||"preset"===e.integration_mode&&r>i,n){const r=this.findBestLocation(e.presets,t);r?(e.designer_css=this._applyDefaultDesignerCss(e,r),"product_view"==this.app.getSection()&&t&&this.app.getProductId()==t?e.integration_selector=r.selector:e.integration_selector=this._applyContext(r.selector,t),e.integration_selector_action=r.action||"insert_after"):e.integration_selector=this._applyContext(e.integration_selector,t)}else if("chooser"==e.integration_mode){let r=(e.integration_selector||"").split(",").map((e=>e.trim()));if("product_view"==this.app.getSection()&&t&&this.app.getProductId()==t);else{const i=this._applyContext(e.integration_selector,t)||"";i.split(",").map((e=>e.trim())).forEach((e=>{r.some((t=>e==t))||r.push(i)}))}e.integration_selector=r.join(", ")}else e.integration_selector=this._applyContext(e.integration_selector,t,!1)}findBestLocation(e,t){if(!e)return null;let r=e[this.app.getSection()]||[];r=r.concat(e.any||[]);const i=this.constructor.PRESET_LOCATIONS;for(const e of r)for(const r of i[e]){let e=r.selector;"product_view"==this.app.getSection()&&this.app.getProductId()==t||(e=this._applyContext(e,t));const i=this.$(e);if(1===i.length||i.length>0&&r.multi)return r}return null}_applyDefaultDesignerCss(e,t){if(null!=e.integration_mode&&"preset"!=e.integration_mode)return e.designer_css;if(null!=e.integration_selector&&"preset"!=e.integration_mode)return e.designer_css;if(null!=e.designer_css)return e.designer_css;if(null==t.custom_styler)return null;let r=t.custom_styler.map((t=>""+(0===t.id.indexOf("container_")?`.fera-widget-${e.id} { ${t.values.map((e=>`${e.attribute}: ${e.value};`)).join("\n")} }`:""))).join("\n");if(this.$(`#widget-${e.id}-defaultDesignerCss`).length>0)return r;let i=`<style id="widget-${e.id}-defaultDesignerCss">${r}</style>`;return this.$("body").append(i),r}_applyContext(e,t,r=!0){if(!t||e.includes("[data-product_id='"))return e;let i=[`${e}[data-product_id='${t}']`];return r&&(i.push(`[data-product='${t}'] ${e}`),i.push(`[data-product-id='${t}'] ${e}`)),i.join(", ")}static selectorIsPreset(e){const t=this.PRESET_LOCATIONS;for(const r in t)for(const i of t[r])if(e===i.selector)return!0;return!1}static get PRESET_LOCATIONS(){const e={id:"container_margin",values:[{id:"campaign_container_margin_margin_top",value:"6px",attribute:"margin-top"},{value:"inline-block",attribute:"display"}]},t={id:"container_margin",values:[{id:"campaign_container_margin_margin_top",value:"32px",attribute:"margin-top"},{id:"campaign_container_margin_margin_left",value:"auto",attribute:"margin-left"},{id:"campaign_container_margin_margin_right",value:"auto",attribute:"margin-right"}]},r={id:"container_padding",values:[{id:"campaign_container_padding_padding_left",value:"16px",attribute:"padding-left"},{id:"campaign_container_padding_padding_right",value:"16px",attribute:"padding-right"}]},i={id:"container_margin",values:[{id:"campaign_container_margin_margin_bottom",value:"60px",attribute:"margin-bottom"}]},n={id:"container_margin",values:[{id:"campaign_container_margin_margin_bottom",value:"32px",attribute:"margin-bottom"}]},a={id:"container_margin",values:[{id:"campaign_container_margin_margin_top",value:"72px",attribute:"margin-top"},{id:"campaign_container_margin_margin_left",value:"auto",attribute:"margin-left"},{id:"campaign_container_margin_margin_right",value:"auto",attribute:"margin-right"}]},o={id:"container_max_width",values:[{id:"campaign_container_width_max_width",value:"1200px",attribute:"max-width"}]};return{page:[{selector:"main",action:"append_to",custom_styler:[o,r,a]},{selector:"body",action:"append_to",custom_styler:[o,r,a]}],"add to cart button":[{selector:'form[action~="/cart/add"] .product-single__add-to-cart',action:"insert_before",custom_styler:[e]},{selector:'form[action~="/cart/add"] button[type=submit]',action:"insert_before",custom_styler:[e]},{selector:'form[action~="/cart/add"] input[type=submit]',action:"insert_before",custom_styler:[e]},{selector:".product-form__cart-submit",action:"insert_before",custom_styler:[e]},{selector:".add-to-cart",action:"insert_before",custom_styler:[e]},{selector:".addToCart",action:"insert_before",custom_styler:[e]},{selector:".add_to_cart",action:"insert_before",custom_styler:[e]},{selector:"#addToCart",action:"insert_before",custom_styler:[e]},{selector:"#add-to-cart",action:"insert_before",custom_styler:[e]},{selector:"#add_to_cart",action:"insert_before",custom_styler:[e]},{selector:".add-to-cart input.button",action:"insert_before",custom_styler:[e]},{selector:".btn-addtocart",action:"insert_before",custom_styler:[e]},{selector:'[data-hook="add-to-cart"]',action:"insert_before",custom_styler:[e]}],"first shopify section":[{selector:".template-index > #PageContainer.drawer-page-content",action:"insert_after",custom_styler:[i,a]},{selector:"main > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):first",action:"insert_before",custom_styler:[i,a]},{selector:"body > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):first",action:"insert_before",custom_styler:[i,a]},{selector:"#shopify-section-header",action:"insert_after",custom_styler:[i,a]},{selector:"main#MainContent",action:"prepend_to",custom_styler:[i,a]},{selector:"main section:first-of-type",action:"insert_after",custom_styler:[i,a]}],"last shopify section":[{selector:".template-index .drawer-page-content main",action:"insert_after",custom_styler:[i,a]},{selector:"main > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):last",action:"insert_after",custom_styler:[i,a]},{selector:"body > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):last",action:"insert_after",custom_styler:[i,a]},{selector:"main#MainContent",action:"append_to",custom_styler:[i,a]},{selector:"#shopify-section-footer",action:"insert_before",custom_styler:[i,a]},{selector:"main section:last-of-type",action:"insert_after",custom_styler:[i,a]},{selector:"#SITE_PAGES",action:"append_to",custom_styler:[o,r,a]}],"first header":[{selector:"h1",custom_styler:[e,n,{id:"container_margin",values:[{id:"campaign_container_margin_margin_left",value:"auto",attribute:"margin-left"},{id:"campaign_container_margin_margin_right",value:"auto",attribute:"margin-right"}]}]}],"cart form":[{selector:'form[action~="/cart"]'}],"cart footer":[{selector:".cart__footer",action:"insert_before"}],"cart header":[{selector:".cart-header",action:"insert_before",custom_styler:[n]}],"checkout button":[{selector:'form[action~="/cart"] .cart-footer .btn-group'},{selector:" .cart__submit-controls"}],"checkout footer":[{selector:".edit_checkout .step__footer"}],"checkout total":[{selector:".sidebar .total-line-table"}],"product title":[{selector:'[data-hook="product-title"]',action:"insert_after"}],"product content":[{selector:".product__content .grid",action:"insert_after",custom_styler:[t]},{selector:".product__content .grid .grid__item",action:"append_to",custom_styler:[t]},{selector:'[data-section-id="product-template"] .product-single + .product-single__description',custom_styler:[a]},{selector:'[data-section-id="product-template"] .product-single',custom_styler:[a]},{selector:".shopify-section .product.grid",custom_styler:[a]},{selector:".product-page > .wrapper > .grid.product-single",custom_styler:[a]},{selector:".grid.product-single",custom_styler:[a]},{selector:"#shopify-section-product-template",action:"insert_after",custom_styler:[{id:"container_padding",values:[{id:"campaign_container_padding_padding_bottom",value:"60px",attribute:"padding-bottom"}]},a]},{selector:".index-section--featured-product",custom_styler:[a]},{selector:'[data-section-id="product"]',action:"insert_after",custom_styler:[t]},{selector:'[data-hook="product-page"]',action:"append_to",custom_styler:[a]},{selector:'[data-hook="bottom-placeholder"]',action:"append_to",custom_styler:[o,r,a]}],"product description":[{selector:"#shopify-product-reviews",action:"replace"},{selector:" .product-single__description",action:"insert_before"},{selector:'[data-hook="description"]',action:"insert_before"}],"before footer":[{selector:"#SITE_PAGES > div:last-child",action:"append_to",custom_styler:[o,r,a]},{selector:"main section:last-of-type",action:"insert_after",custom_styler:[o,r,a]},{selector:"body > section:last-of-type",action:"insert_after",custom_styler:[o,r,a]},{selector:"footer",action:"insert_before",custom_styler:[o,r,a]},{selector:"#SITE_PAGES",action:"append_to",custom_styler:[o,r,a]}],footer:[{selector:'[data-section-id="footer"] .site-footer__content',action:"insert_after"},{selector:"footer > .site-footer__linklist",action:"insert_after"},{selector:"footer .grid-uniform",action:"insert_before"},{selector:"footer .footer__content",action:"insert_before"},{selector:"footer .hr--small",action:"insert_before"},{selector:"footer .site-footer__bottom",action:"insert_before"},{selector:"footer .flex-footer",action:"insert_before"},{selector:'[data-section-id="footer"] .grid:last',action:"insert_before"},{selector:"footer .footer__blocks-wrapper",action:"insert_before"},{selector:"#SITE_FOOTERinlineContent",action:"prepend_to"}],"bottom of product list items":[{selector:'[data-container_type="list"]',action:"append_to",multi:!0},{selector:'[data-hook="product-item-product-details"]',action:"append_to",multi:!0}],"bottom of product content":[{selector:'#shopify-section-product-template [data-section-id="product-template"][itemscope][itemtype="http://schema.org/Product"]',action:"append_to"},{selector:'[data-hook="bottom-placeholder"]',action:"append_to",custom_styler:[o,r,a]},{selector:"#SITE_PAGES > div:last-child",action:"append_to",custom_styler:[o,r,a]}]}}},Fera.InstantClickSupport=function(e){var t=Fera.Util.$();e=e||{};var r=function(){"undefined"!=typeof InstantClick&&(e.logger.log("Instant Click was detected, so support module was loaded."),i())},i=function(){InstantClick.on("change",(function(){var r=t(".banana-view-container").first(),i=e.app.getProductId();if(r&&r.length>0){var n=r.data("product_id");e.app.push("setProductId",{id:n})}else i&&e.app.push("setProductId",{id:null});e.app.refreshContent()}))};r()},Fera.ShogunSupport=class{constructor(e){return this._opts=e,this.$=Fera.Util.$(),this.isReady=!1,"undefined"==typeof __shgProductInits?this._ready():(Fera.logger.log("Shogun page was detected, so support module was loaded."),__shgProductInits.length<1?this._ready():(this._shogunProductData=__shgProductInits[0],void this._fetchProductData()))}_ready(){this.isReady=!0}_fetchProductData(){if(!this._shogunProductData)return this._ready();var e="/products/"+this._shogunProductData.productHandle+".js";this.$.ajax({url:e,method:"GET",type:"GET",dataType:"json",success:e=>{e&&e.id&&(this._opts.app.setProductId(e.id),this._opts.app.setSection("product_view")),this._ready()},error:()=>{this._ready()}})}},Fera.WeglotSupport=function(e){Fera.Util.$();e=e||{};var t=function(){"undefined"!=typeof Weglot&&(e.logger.log("Weglot was detected, so support module was loaded."),r())},r=function(){Weglot.on("languageChanged",(function(t){e.app.setLocale(t),e.app.forceRefreshContent()}))};t()},Fera.SkillsLocalStorage=function(e){var t,r=this,i=function(){t=new Fera.LocalStorageJar(e),r.memory=t.getObject("memory")||{}};r.set=function(e,t,i){return r.memory[e]={value:t,expiry:s(i)},n(),r},r.get=function(e,t){return void 0===r.memory[e]||o(e)?t:r.memory[e].value},r.reset=function(){return r.memory={},n(),a("Local storage was reset.",e.namespace),r};var n=function(){t.setObject("memory",r.memory)},a=function(){e.logger&&e.logger.log&&-1===Fera.Util.detectBrowser().indexOf("MSIE")&&e.logger.log.apply(this,arguments)},o=function(e){return null!==r.memory[e].expiry&&Date.now()>r.memory[e].expiry},s=function(e){return"number"!=typeof e?null:Date.now()+e};i()},Fera.ActionCollection=class{constructor(){this._actions=[]}add(e){this._actions.push(e)}run(...e){this._actions.forEach((t=>{t.run&&t.run(...e)}))}update(...e){this._actions.forEach((t=>{t.update&&t.update(...e)}))}each(e){this._actions.forEach(e)}remove(...e){this._actions.forEach((t=>{t.remove&&t.remove(...e)}))}get(e){return this._actions[e]}},Fera.Components=Fera.Components||{},Fera.Components.Base=class{constructor(e={}){this._opts=e,this._listeners=e.listeners||e.on||{},this.$globalTopContainer=Fera.Util.$()(".banana-globalTop-container")}on(e,t){return(-1===e.indexOf(" ")?[e]:e.split(" ")).forEach((e=>{this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t)})),this}render(){setTimeout((()=>this._afterRenderComplete()),1)}_afterRenderComplete(){}triggerOnce(e,t){this.trigger(e,t),this.clearListeners(e)}clearListeners(e){this._listeners[e]=[]}trigger(e,t){return(-1===e.indexOf(" ")?[e]:e.split(" ")).forEach((e=>{let r=this._listeners[e];!r||r.length<1||r.forEach((e=>{e(this,t)}))})),this}_log(){Fera.logger.log.apply(this,arguments)}_warn(){Fera.logger.warn.apply(this,arguments)}_error(){Fera.logger.error.apply(this,arguments)}_logWarning(){Fera.logger.logWarning.apply(this,arguments)}},Fera.Components.BaseModal=class extends Fera.Components.Base{constructor(e){super(e),this.$=Fera.Util.$(),this.titleCaption=e.titleCaption||"",this.classPrefix=e.classPrefix||"fera"}show(){this.rendered||this._render();let e=this.$("body");e.find(`.${this.classPrefix}-fera-modal`).length<1&&e.append(this.$el),this.$el.show()}hide(){this.$el.hide()}_render(){this.$el=this.$(this._tpl()),this.$modal=this.$el.find(".fera-modal"),this.$closeButton=this.$el.find(".fera-modal-close"),this.$modalBody=this.$el.find(".fera-modal-body"),this._setupCloseListeners(),this.rendered=!0}_setupCloseListeners(){this.$closeButton.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.hide()})),window.onclick=e=>{this.$(e.target).hasClass("fera-modal")&&(e.stopPropagation(),this.hide())}}_tpl(){return`<div class="fera-modal ${this.classPrefix}-fera-modal" style="display: none;">\n            <div class="fera-modal-dialog">\n                <div class="fera-modal-content">\n                    <div class="fera-modal-header">\n                        <span class="fera-modal-close" data-dismiss="fera-modal">\xd7</span>\n                        <h2 class="fera-modal-title">${this.titleCaption}</h2>\n                    </div>\n                    <div class="fera-modal-body"></div>\n                </div>\n            </div>\n        </div>`}},Fera.Components.CustomNotif=class extends Fera.Components.Base{constructor(e){super(),this.widget=e,this.$=Fera.Util.$(),this.$globalBottomContainer=this.$(".banana-globalBottom-container"),this.campaignSettings=this.widget.settings,this._create(),this.show()}update(){this.campaignSettings=this.widget.settings,this.show()}_create(){this.$el=this.widget.$el||this.$(this.widget.html.replace(/<!--[\s\S]*?-->/g,"").trim());var e='<div class="banana-container-row fera-customNotif-container fera-notif-popup-container"></div>';this.widget.options.integration_selector?(this.$container=$(e),this.$container=this.$container.appendTo(this.widget.$el.parent())):(this.$globalBottomContainer.append(e),this.$container=this.$globalBottomContainer.find(".fera-customNotif-container"),this.$container.append(this.$el))}_adminMode(){return this.widget.adminMode}show(){if(this._seen())return!1;this.popup=new Fera.PopupNotification({$el:this.$el,container:this.$container,logger:Fera.logger,$:this.$}),this.popup.attach(),this.popup.ensureLoadThenShow(this.campaignSettings.animation_in,this.campaignSettings.popout_position,(()=>{this._setUpCountDown()})),this._attachListeners()}hide(){this.popup&&this.popup.attached()&&this.popup.hideAndDetach(this.campaignSettings.animation_out,this.campaignSettings.popout_position,(()=>{}))}remove(){this.popup&&this.popup.hideAndDetach(this.campaignSettings.animation_out,this.campaignSettings.popout_position,(()=>{this.$container.remove()}))}_attachListeners(){this.popup.$el.find(".fera-notification-close").on("click touch",(()=>{this.hide()})),this.$el.attr("data-fera-widget",this.widget.widgetId)}_getShowTime(){var e=5;return this.campaignSettings&&this.campaignSettings.time_to_show_for&&(e=parseInt(this.campaignSettings.time_to_show_for)),e}_setUpCountDown(){this.popup.initiateCountdown(this._getShowTime()),setTimeout((()=>{this.hide()}),1e3*this._getShowTime())}_markSeen(){this.widget.memory.set("CustomNotifSeen",!0,6e4)}_seen(){return!(this.widget.app.timeTracker.getSessionTime()<5||void 0===this.widget.memory.get("CustomNotifSeen"))&&this.widget.memory.get("CustomNotifSeen")}},Fera.Components.CustomPopup=class extends Fera.Components.Base{constructor(e){super(),this.widget=e,this.$=Fera.Util.$(),this.$globalBottomContainer=this.$(".banana-globalBottom-container"),this.campaignSettings=this.widget.settings,this.stringTemplates=this.campaignSettings.string_templates,this._create()}update(){this.campaignSettings=this.widget.settings}_create(){this.$el=this.widget.$el&&0!==this.widget.$el.length?this.widget.$el:this.$(this.widget.html),this._define$variables(),this.$el.hide(),this.widget.$el&&0!==this.widget.$el.length?this.$container=this.widget.$container:(this.widget.$container&&0!==this.widget.$container.length?this.$container=this.widget.$container:(this.$container=$('<div class="banana-container-row fera-customPopup-container"></div>'),this.$container.appendTo(this.$globalBottomContainer)),this.$container.append(this.$el),this.widget.$el=this.$el)}show(){Fera.Util.showWithoutTransform(this.$el),this._attachListeners()}hide(){this.$el.hide()}remove(){this.$el.remove()}_define$variables(){this.$title=this.$el.find(".fera-popup-header h3.fera-popup-title"),this.$subtitle=this.$el.find(".fera-popup-header h5.fera-popup-title"),this.$body=this.$el.find(".fera-popup-body"),this.$btn=this.$el.find(".fera-popup-footer .fera-popup-btn")}_attachListeners(){this.$el.find('[data-dismiss="fera-popup"]').on("click touch",(()=>{this.hide()})),this.campaignSettings.close_on_outside_click&&this.$container.find(".fera-popup").on("click",(e=>{this.$(e.target).hasClass("fera-popup")&&(e.stopPropagation(),this.hide())})),this.$btn.on("click",(()=>{this.startLoading()})),this.$el.attr("data-fera-widget",this.widget.widgetId),this.$el.attr("data-fera-skill",this.widget.widgetId)}startLoading(){this.$btn.animate({opacity:.3}),this.$btn.addClass("fera-btn-loading"),this.originalBtnHtml=this.$btn.html(),this.$btn.html(this.stringTemplates.please_wait)}stopLoading(){this.$btn.removeClass("fera-btn-loading"),this.$btn.html(this.originalBtnHtml)}},Fera.Feed=function(e){var t,r=this,i=e.settings.use_product_context,n=Fera.Util.$(),a=function(){t=new Fera.SeenNotifTracker({logger:Fera.logger,localStorage:e.app.localStorage,storageKey:"SocialProof.seenTracker"}),e.app.on("feeds.reset",t.clear),r.clearSeen=t.clear,r.items=[],r.notifQueue=[],r.markSeen=t.markSeen};this.load=function(a){e.app.geo.getLocationInfo((function(l){e.app.api.getFeeds(n.extend(s(),{country_code:l.country_code}),(function(n){t.updateExpiryTime(parseInt(e.settings.expire_seen_memory_every||86400));for(var s=!1,l=0;l<n.length;l++){var c=new Fera.Notification(n[l],e);t.hasSeen(c)||(o(c),s=!0)}if(s)Fera.Util.shuffleArray(r.notifQueue);else if(i&&"show_others"===e.settings.product_context_fallback)return i=!1,r.load(a);a(s)}))}))};var o=function(e){r.notifQueue.push(e)},s=function(){var r={not_ids:t.getSeenIds().sort((function(e,t){return parseInt(t)-parseInt(e)})).reverse().slice(0,100).join(",")};if(i){var a=e.app.getProductId();a&&e.settings.use_product_context&&(r.product_id=a)}return e.settings.feed_params?r.feed_params=Fera.Util.encode(JSON.stringify(e.settings.feed_params)):r=n.extend(r,l()),e.settings.max_to_show&&(r.limit=parseInt(e.settings.max_to_show),r.limit<1&&(r.limit=1)),r},l=function(){var t={},r=[];return e.settings.orders_enabled&&(r.push("product_order"),e.settings.order_lookback&&(t.product_order_lookback=e.settings.order_lookback)),e.settings.carts_enabled&&(r.push("product_add_to_cart"),e.settings.cart_lookback&&(t.product_add_to_cart_lookback=e.settings.cart_lookback)),t.types=r.join(","),t};a()},Fera.Components.Pagination=class extends Fera.Components.Base{constructor(e){super(e),this.$=Fera.Util.$(),this.app=e.app,this.suffix=e.suffix,this._hideIfOnePage=!1!==this._opts.hideIfOnePage,this._onClick=this._opts.onClick||(()=>{}),this._noNavHelpers=this._opts.noNavHelpers,this.update(this._opts)}render(){return this.prerendered||(this.$el=this.$(this._tpl()),this.rendered=!0,this._initialize()),this.$el}_initialize(){this.$items=this.$el.find(".pagination"),this._updateView()}update(e){this.currentPage=e.currentPage||0,this.totalCount=e.totalCount||0,this.pageSize=e.pageSize||10,this.numPages=this.totalCount>0?Math.ceil(this.totalCount/this.pageSize):0,this.rendered&&this._updateView()}isVisible(){return this.$el.is(":visible")}_updateView(){this.totalCount<1||this._hideIfOnePage&&1==this.numPages?this.$el.hide():this.$el.show(),this._renderItems()}_renderItems(){this.$items.children().remove();const e=2;if(this._noNavHelpers){for(let e=1;e<=this.numPages;e++)this.$items.append(this._renderItem(e,e));return}this.currentPage>e&&this.numPages>e&&this.$items.append(this._renderItem(1,this._first(),"first")),this.currentPage>1&&this.$items.append(this._renderItem(this.currentPage-1,this._prev(),"prev"));let t=Math.max(this.currentPage-e,1),r=Math.min(this.currentPage+e,this.numPages);for(let e=t;e<=r;e++)this.$items.append(this._renderItem(e,e));this.currentPage<this.numPages&&this.$items.append(this._renderItem(this.currentPage+1,this._next(),"next")),this.currentPage<=this.numPages-e&&this.numPages>e&&this.$items.append(this._renderItem(this.numPages,this._last(),"last"))}_renderItem(e,t,r){r=r||"basic";let i=this.currentPage==e?"active":"",n=this.$(this._itemTpl(e,t,r,i));return n.find("a").on("click",(t=>{t.preventDefault(),t.stopPropagation(),n.hasClass("active")||this._onClick(e)})),n}_first(){return this._iconTpl(this._firstIcon())}_last(){return this._iconTpl(this._lastIcon())}_prev(){return this._iconTpl(this._prevIcon())}_next(){return this._iconTpl(this._nextIcon())}_iconTpl(e,t=""){return`<span class="pagination-icon ${t}">${e}</span>`}_firstIcon(){
return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M20.2 247.5L167 99.5c4.7-4.7 12.3-4.7 17 0l19.8 19.8c4.7 4.7 4.7 12.3 0 17L85.3 256l118.5 119.7c4.7 4.7 4.7 12.3 0 17L184 412.5c-4.7 4.7-12.3 4.7-17 0l-146.8-148c-4.7-4.7-4.7-12.3 0-17zm160 17l146.8 148c4.7 4.7 12.3 4.7 17 0l19.8-19.8c4.7-4.7 4.7-12.3 0-17L245.3 256l118.5-119.7c4.7-4.7 4.7-12.3 0-17L344 99.5c-4.7-4.7-12.3-4.7-17 0l-146.8 148c-4.7 4.7-4.7 12.3 0 17z"></path></svg>'}_lastIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M363.8 264.5L217 412.5c-4.7 4.7-12.3 4.7-17 0l-19.8-19.8c-4.7-4.7-4.7-12.3 0-17L298.7 256 180.2 136.3c-4.7-4.7-4.7-12.3 0-17L200 99.5c4.7-4.7 12.3-4.7 17 0l146.8 148c4.7 4.7 4.7 12.3 0 17zm-160-17L57 99.5c-4.7-4.7-12.3-4.7-17 0l-19.8 19.8c-4.7 4.7-4.7 12.3 0 17L138.7 256 20.2 375.7c-4.7 4.7-4.7 12.3 0 17L40 412.5c4.7 4.7 12.3 4.7 17 0l146.8-148c4.7-4.7 4.7-12.3 0-17z"></path></svg>'}_prevIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" data-fa-i2svg=""><path fill="currentColor" d="M4.2 247.5L151 99.5c4.7-4.7 12.3-4.7 17 0l19.8 19.8c4.7 4.7 4.7 12.3 0 17L69.3 256l118.5 119.7c4.7 4.7 4.7 12.3 0 17L168 412.5c-4.7 4.7-12.3 4.7-17 0L4.2 264.5c-4.7-4.7-4.7-12.3 0-17z"></path></svg>'}_nextIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" data-fa-i2svg=""><path fill="currentColor" d="M187.8 264.5L41 412.5c-4.7 4.7-12.3 4.7-17 0L4.2 392.7c-4.7-4.7-4.7-12.3 0-17L122.7 256 4.2 136.3c-4.7-4.7-4.7-12.3 0-17L24 99.5c4.7-4.7 12.3-4.7 17 0l146.8 148c4.7 4.7 4.7 12.3 0 17z"></path></svg>'}_itemTpl(e,t,r,i){return`<li class="page-item ${i}">\n            <a href="#" class="page-link ${i} ${r}" data-page="${e}"> ${t}</a>\n        </li>`}_tpl(){return`\n<nav aria-label="Pagination" class="${this.suffix}-pagination">\n    <ul class="pagination justify-content-center">\n        <li class="page-item first"><a href="#" class="page-link">First</a></li>\n        <li class="page-item prev"><a href="#" class="page-link">Previous</a></li>\n        <li class="page-item"><a href="#" class="page-link">1</a></li>\n        <li class="page-item active"><a href="#" class="page-link">2</a></li>\n        <li class="page-item next"><a href="#" class="page-link">Next</a></li>\n        <li class="page-item last"><a href="#" class="page-link">Last</a></li>\n    </ul>\n</nav>\n        `}},Fera.Components.PromoBar=class extends Fera.Components.Base{constructor(e){super(),this.skill=e,this.$=BananaStand.Util.$(),this._create(),this.hidden=!1,this._visibleInitially()&&this.show()}update(){this.$el.html(this.$(this.skill.html.replace(/<!--[\s\S]*?-->/g,"").trim()).html()),this._attachListeners(),this._hidden()||this.show()}_attachListeners(){this.$el.find("[data-fera-promo-bar-close],[data-fera-promobar-close]").on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.hide()})),this.$el.attr("data-fera-widget",this.skill.widgetId),this.$el.attr("data-fera-skill",this.skill.widgetId)}_create(){this.skill.$el&&this.skill.$el.length>0?this.$el=this.skill.$el:(this.$el=this.$(this.skill.html.replace(/<!--[\s\S]*?-->/g,"").trim()),this.$globalTopContainer.append(this.$el)),this.$el.hide(),this._attachListeners()}hide(){this._adminMode()?alert("Since you're an admin, it will appear again when you refresh the page. For your shoppers, it will be hidden permanently. \n\n NOTE: This message will NOT show to your customers."):this.skill.localStorage.set("hidden","1"),this.$el.hide(),this._unapplyFixedHeaderAdjustments()}_visibleInitially(){return!!this._adminMode()||!this._hidden()}_hidden(){return"1"==this.skill.localStorage.get("hidden")}_adminMode(){return this.skill.adminMode}_unapplyFixedHeaderAdjustments(){if(!this._$fixedHeaderStyle)return!0;this._$fixedHeaderStyle.remove()}_applyFixedHeaderAdjustments(){if(this._$fixedHeaderStyle)return!0;this._$fixedHeaderStyle=this.$("<style>.fera-themeWithFixedHeader--adjust { margin-top: "+this.height()+"px; } </style>"),this._$fixedHeaderStyle.appendTo("body")}height(){return Fera.Util.outerHeight(this.$el)}show(){this.$globalTopContainer.show(),this.$el.show(),this._applyFixedHeaderAdjustments()}},Fera.Components.PushNotification=class extends Fera.Components.Base{constructor(e){super(),this._skill=e,this.subscriberToken=null,this._loadSubscriberToken()}run(){var e={};if(!this.subscriberToken)return"undefined"==typeof pushowl?(this._warn("Cannot run pushowl integration without pushowl.js installed."),!1):void pushowl.subscribe(!1,null,!1).then((function(){}),(function(){}));(this._skill.isPreview||this._checkIsAllowed())&&(e.skill_id=this._skill.skillId,e.subscriber_token=this.subscriberToken,this._skill.api.triggerActions(e),this._skill.memory.set("last_pushed_at",(new Date).getTime()))}_checkIsAllowed(){var e=this._skill.settings.max_notif_period;if(!e)return!0;var t=this._skill.memory.get("last_pushed_at"),r=1e3*e+(new Date).getTime();return!(t&&parseInt(t)<r)||(this._log("Skipping push notification because the last one sent was",t),!1)}_loadSubscriberToken(){"undefined"!=typeof localStorage&&localStorage.pushowl_subscriber_token&&(this.subscriberToken=localStorage.pushowl_subscriber_token)}},Fera.ClickRegistry=function(e){e=e||{};var t=this,r=Fera.Util.$(),i="ClickEvent",n=!0,a=null,o=["iframe","lang","body","!doctype","doctype","applet","article","aside","audio","basefont","body","br","colgroup","frame","frameset","head","header","html","iframe","p","main","meta","ol","param","script","tr","ul"],s=function(){e.sandboxMode||e.designMode||Fera.Util.isBot()||Fera.Util.isSpeedMode()||(t.register(),window.onunload=l)};t.register=function(){r(document).on("mousedown","*",(function(e){if(void 0!==e.originalEvent&&2!==e.button&&e.target!==a&&-1===o.indexOf(e.target.tagName.toLowerCase())){var i=r(e.target);i.hasClass("fera-highlight-placeholder")||i.find("* > * > * > *").length>0||(c(t.getEventData(e)),a=e.target)}})),setInterval(u,1),setInterval((function(){a=null}),1500)},t.sendElementClick=function(t){e.app.pushEvent({type:"element_click",data:t})},t.getEventData=function(e){var t={};return p(e.target,t),t.client_x=e.pageX,t.client_y=e.pageY,t};var l=function(){n=!1},c=function(t){e.localStorage&&t&&e.localStorage.setObject(i,t)},u=function(){if(n){var r=e.localStorage.getObject(i);r&&(e.localStorage.removeItem(i),t.sendElementClick(r))}},d=function(e){var t=r(e).parents();return!(t.length<1)&&-1!==(t=t.map((function(){return this.tagName})).get()).indexOf("BUTTON")},p=function(e,t){d(e)&&(e=r(e).parents("button")[0]);var i=r(e);g(i,t),t.element_attributes=v(e),t.element_text=w(h(i)),t.element_tag_name=e.tagName,t.element_html=w(f(i)),i.is("select")&&(t.select_options=_(e)),t.element_css_path=m(e)},h=function(e){var t=e.clone();return t.find("style, svg").remove(),t.find(":hidden").remove(),t.text()},f=function(e){var t=e.clone();return t.find(":hidden").remove(),t.html()},m=function(e){var t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0,skipAttributes:!0,skipTags:!0}).getPath();return""!==t||""===(t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0,skipAttributes:!0}).getPath())||""===(t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0}).getPath())?t:t=new Fera.CssPathGenerator(e).getPath()},g=function(e,t){var r=e.data("fera-widget")||e.data("fera-skill");void 0===r&&(r=(r=e.parents("[data-fera-widget],[data-fera-skill]").data("fera-widget"))||e.parents("[data-fera-widget],[data-fera-skill]").data("fera-skill")),void 0!==r&&(t.campaign_id=r,t.created_by="campaign")},v=function(e){var t={};return r.each(e.attributes,(function(){t[w(this.name,50)]=w(this.value)})),t},_=function(e){var t=[];return r.each(e.options,(function(){t.push(this.text)})),t},w=function(e,t){return t=t||300,e.replace(/\s\s+/gm," ").trim().substring(0,t)};s()},Fera.CssPathGenerator=function(e,t){var r=this;t=t||{};var i=Fera.Util.$(),n=i(e).parents(),a=[],o=t.maxDataAttrSize||50,s=function(){};r.getPath=function(){a=[];var t=l(e);return t&&""!==t&&a.push(t),n.each((function(){(t=l(this))&&""!==t&&a.push(t)})),a.slice(0,5).join(" > ")};var l=function(e){var r=i(e),n=t.skipTags?"":e.tagName;n+=c(r.attr("id")),n+=u(r.attr("class"));var a=[];return t.skipAttributes||d(e.attributes,a),t.skipDataAttributes||p(r.data(),a),a.length>0&&(n+=a.slice(0,5).join("")),n},c=function(e){return f(e)?"":"#"+e},u=function(e){return f(e)?"":e.replace(/\s\s+/gm," ").trim().split(" ").map((function(e){if(e)return"."+e})).join("")},d=function(e,t){for(var r=0;r<e.length;r++){var i=e[r];h(i.name)&&m(i.value)&&t.push("["+i.name+'="'+i.value+'"]')}},p=function(e,t){i.each(e,(function(e,r){m(r)&&t.push("[data-"+e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()+'="'+r+'"]')}))},h=function(e){return!e.match(/id|class|style|(data-.*)|(on.+)|(xml:.*)/i)},f=function(e){return null==e||""===e},m=function(e){return!!f(e)||(!e.trim||0!==e.trim().indexOf("{")&&(-1===e.indexOf("\n")&&e.length<=o))};s()},Fera.ContentSubmission=Fera.ContentSubmission||{},Fera.ContentSubmission.Customer=class{constructor(e={}){this.opts=e,this.$=Fera.Util.$(),this.localStorage=e.localStorage,this.$container=e.$container,this.$translationContainer=e.$translationContainer,this._loadFromLocalStorage(),this._extractTranslations(),this.name=this.opts.optionsParser.detectCustomerName()||"",this.email=this.opts.optionsParser.detectCustomerEmail()||""}isPresent(){return this.name&&this.email}update(e,t){this.token=e,this.successCallback=t}requestDetails(){this.$container.find(".fera-contentSubmission-title").text(this.translatedStrings.justAFewThings),this.$form=this.$container.find("form"),this.$form.html(this._tpl()),this.$customerEmail=this.$form.find('[name="fera-customer-email"]'),this.$customerName=this.$form.find('[name="fera-customer-name"]'),!this.$customerName.val()&&this.name&&this.$customerName.val(this.name),!this.$customerEmail.val()&&this.email&&this.$customerEmail.val(this.email),this.$form.on("submit",this._handleSubmit.bind(this))}_loadFromLocalStorage(){if(!this.localStorage)return;const e=this.localStorage.getObject(Fera.ContentSubmission.Customer.KEY,{});this.name=e.name,this.email=e.email}_saveToLocalStorage(){if(!this.localStorage)return;const e={name:this.name,email:this.email};this.localStorage.setObject(Fera.ContentSubmission.Customer.KEY,e)}_extractTranslations(){this.translatedStrings={},this.translatedStrings.justAFewThings=this.$translationContainer.data("caption-just-a-few-more-things")||"Just a couple more things...",this.translatedStrings.name=this.$translationContainer.data("caption-name")||"Name",this.translatedStrings.email=this.$translationContainer.data("caption-email")||"Email",this.translatedStrings.emailAddress=this.$translationContainer.data("caption-email-address")||"Email address"}_handleSubmit(e){e.preventDefault(),this.$errorContainer=this.$form.find(".fera-errorContainer"),this.$submitBtn=this.$form.find("[data-fera-contentSubmission-submitBtn]"),this.name=this.$customerName.val(),this.email=this.$customerEmail.val(),this.name.trim()&&this.email.trim()?this._submit():this.$errorContainer.text(Fera.t("Your name and email is required")).removeClass("fera-hidden")}_submit(){this.$errorContainer.addClass("fera-hidden"),this.$submitBtn.text(Fera.t("Loading...")),this.$submitBtn.prop("disabled",!0);const e="/update_customer";this.opts.api.contentSubmission({params:{customer_name:this.name,customer_email:this.email,content_submission_token:this.token,visitor_id:this.opts.visitorId},success:this._onCustomerUpdated.bind(this),error:e=>{this.$errorContainer.text(Fera.t("There was an unexpected error. Please try again")).removeClass("fera-hidden"),this.$submitBtn.text(Fera.t("Submit")),this.$submitBtn.prop("disabled",!1),this.opts.app.opts.debugMode&&console.error(e)}},e)}_onCustomerUpdated(e){this.name=e.customer_name,this.email=e.customer_email,this._saveToLocalStorage(),this.successCallback()}_tpl(){return`\n<div class="fera-contentSubmission-customer">\n    <div class="fera-errorContainer fera-hidden"></div>\n    <div class="fera-contentSubmission-row">\n        <label class="fera-contentSubmission-formControl-label">${this.translatedStrings.name}:</label>\n        <input class="fera-contentSubmission-formControl" type="text" placeholder="${this.translatedStrings.name}" name="fera-customer-name" required>\n    </div>\n    <div class="fera-contentSubmission-row">\n        <label class="fera-contentSubmission-formControl-label">${this.translatedStrings.email}:</label>\n        <input class="fera-contentSubmission-formControl" type="email" placeholder="${this.translatedStrings.emailAddress}" name="fera-customer-email" required>\n    </div>\n\n    <input type="submit" class="fera-contentSubmission-submitBtn" data-fera-contentsubmission-submitbtn="" value="${Fera.t("Submit")}" />\n</div>\n        `}},Fera.ContentSubmission.Customer.KEY="ContentSubmission_Customer",Fera.ContentSubmission=Fera.ContentSubmission||{},Fera.ContentSubmission.Submitter=class{constructor(e={}){this._opts=e,this.$=Fera.Util.$(),this.urlParams=this._opts.app.opts.urlParams||{},this.$body=this.$("body")}show(e={}){this.customerMessageToken=e.cmt||e.customer_message_token||e.customerMessageToken||this.urlParams.cmt||this.urlParams.customer_message_token||this.urlParams.customerMessageToken,this.contentCampaignToken=e.cct||e.content_campaign_token||e.contentCampaignToken||this.urlParams.cct||this.urlParams.content_campaign_token||this.urlParams.contentCampaignToken,this.productId=e.product||e.product_id||e.productId||this._opts.app.opts.detectProductId(),this.prefilledRating=e.rating||this.urlParams.rating,this.prefilledRating=Number(this.prefilledRating);let t=this._showLoadingState();this.$loadingStateContainer=t.find(".fera-contentSubmission--loading"),this._requestTemplate()}hide(e){this._closeWindow(e)}_requestTemplate(){let e={};this.customerMessageToken||this.contentCampaignToken?(e.customer_message_token=this.customerMessageToken,e.content_campaign_token=this.contentCampaignToken):e.product_id=this.productId||this._opts.app.getProductId(),this.prefilledRating&&(e.rating=this.prefilledRating,e.visitor_id=this._opts.visitorId,e.customer_message_token=this.customerMessageToken,e.content_campaign_token=this.contentCampaignToken),this._opts.api.requestContentSubmissionTemplate({params:e,success:e=>this._processTemplateRequest(e),error:()=>this._handleTemplateRequestError()})}_processTemplateRequest(e){if(e.reviewed){const t=this.$(this._getHtml(e.template)),r=this.$loadingStateContainer.find(".fera-container");return r.html(`\n                <div>${t.data("caption-already-submitted-feedback")}</div>\n                <button>${t.data("caption-close-window")}</button>\n            `),void r.find("button").on("click",(()=>this._hideLoadingState()))}e.draft_created&&(this.draft_mode=e.draft_created),this._html=this._getHtml(e.template);const t=e.compiled_css;this._products=e.products,this._totalCount=this._products.length,this._previewReviewDate=new Date(e.previous_review.date);let r=this._previewReviewDate&&this._previewReviewDate.getTime()>(new Date).getTime()-864e5;this._previousReview=r?e.previous_review:{},this._requestReview=e.request_review,this._requiredReviewFields=e.required_review_fields,this._requestPhoto=(e.request_media||this._requestReview)&&e.allow_photo,this._requestVideo=(e.request_media||this._requestReview)&&e.allow_video,this.videoFiles=[];let i=this._renderTemplate(this._html,t);this._loadCustomTitle(i),this._hideLoadingState(!1),this._initElementsAndListeners(i)}_handleTemplateRequestError(){const e=this.$loadingStateContainer.find(".fera-container"),t="We're unable to accept your feedback at this time because of an unexpected error. <br>Our engineers have been notified and we'll have it fixed in no time. Sorry about that! :(";e.html(`<div>${t}</div><button>Close Window</button>`),e.find("button").on("click",(()=>this._hideLoadingState()))}_loadCustomTitle(e){let t=this._opts.app.opts.feraParams.title||this._opts.app.opts.feraParams.heading||this._opts.app.opts.urlParams.title||this._opts.app.opts.urlParams.heading;t&&e.find(".fera-submissionForm .fera-contentSubmission-title").text(t)}_getHtml(e,t={}){if(!e||""===e.trim())return"";try{const r=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}");return t&&Object.keys(t).length>0?Fera.Liquid.parse(r).render(t):r}catch(t){if(this._opts.app.opts.debugMode)throw t;return console.error(t),e}}_renderTemplate(e,t){this.$body.addClass("fera-modal--open");let r=this.$(`<div>${e}</div>`);return this.$body.append(r),this.$body.append(`<style>${t}</style>`),r}_initElementsAndListeners(e=null){e&&(this.$submissionFormContainer=e.find(".fera-submissionForm"),this.$submissionRewardContainer=e.find(".fera-submissionReward"),this.$submissionSuccessContainer=e.find(".fera-submissionSuccess")),this.$submissionForm=this.$submissionFormContainer.find("form"),this.$submissionFormTitle=this.$submissionFormContainer.find(".fera-contentSubmission-title"),this.$viewTermContainer=this.$submissionFormContainer.find(".fera-contentSubmission-termPreview"),this.$viewTermTitle=this.$submissionFormContainer.find(".fera-contentSubmission-termTitle"),this.$ratingInput=this.$submissionForm.find('[name="fera-rating"]'),this.$summaryInput=this.$submissionForm.find('[name="fera-summary"]'),this.$agreedTermInput=this.$submissionForm.find('[name="fera-agreed-terms"]'),this.$bodyInput=this.$submissionForm.find('[name="fera-body"]'),this.$filesInput=this.$submissionForm.find('[name="fera-files"]'),this.$errorContainer=this.$submissionForm.find(".fera-errorContainer"),this.$translationContainer=this.$submissionForm.find(".fera-tranlatedStringContainer"),this.$viewTermBtn=this.$submissionForm.find(".fera-viewTerm-Btn"),this.$closeTermBtn=this.$viewTermContainer.find(".fera-contentSubmission-termPreview-closeBtn"),this.$summaryInput.on("change",(()=>{this.$summaryInput.data("fera-modified",!0)})),this.$agreedTermInput.data("term-enabled")&&this.$agreedTermInput.prop("checked",this.$agreedTermInput.data("checked-by-default")),this.$viewTermBtn.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.showTermModal()})),this.$closeTermBtn.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.closeTermModal()})),this.$totalCount=this.$submissionFormContainer.find("[data-fera-contentSubmission-info]"),this.$totalCount.html(`${this._totalCount-this._products.length+1} / ${this._totalCount}`),this._totalCount<=1&&this.$totalCount.hide(),this._initReviewSections(),this._initUploadArea(),this._initSubmitAndReviewNextBtns(),this.prefilledRating&&this._applyRating(null,this.prefilledRating),this.draft_mode&&!this._opts.testMode&&this._initDraftTracking(),this.customer=new Fera.ContentSubmission.Customer(this.$.extend({},this._opts,{$container:this.$submissionFormContainer,$translationContainer:this.$translationContainer})),this.$submissionFormContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",(e=>this._closeWindow(e))),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",(e=>this._closeWindow(e)))}_initUploadArea(){if(!this._requestPhoto&&!this._requestVideo)return void this.$filesInput.closest(".fera-contentSubmission-formControl-uploadRow").remove();let e=this.$submissionForm.find(".fera-uploadLabel");this._requestVideo&&this._requestPhoto?e.text(e.data("caption-photos-or-videos")):this._requestPhoto?e.text(e.data("caption-photos")):e.text(e.data("caption-videos")),this.$filesInput.on("change",(e=>this._onFileChange(e))),this._initDropArea()}_initDropArea(){const e=this.$submissionForm.find(".fera-contentSubmission-formControl-uploadArea");e.on("dragenter dragover",(t=>{t.preventDefault();(t.dataTransfer||t.originalEvent&&t.originalEvent.dataTransfer).dropEffect="copy",e.addClass("fera-dropzone")})),e.on("dragleave drop",(t=>{if(t.preventDefault(),e.removeClass("fera-dropzone"),"drop"===t.type){const e=t.dataTransfer||t.originalEvent&&t.originalEvent.dataTransfer,r=e&&e.files||[];[...r].every((e=>e.type.match(/image|video/)))?(this.$filesInput.prop("files",r).trigger("change"),this.$errorContainer.addClass("fera-hidden")):this.$errorContainer.text(this.$errorContainer.data("caption-only-certain-files-allowed")).removeClass("fera-hidden")}}))}_onFileChange(e){let t="";const r=e.target.files;if(this.videoFiles=Array.from(this.$filesInput.prop("files")||[]).filter((e=>e.type.match(/video/))),r.length>1){const e=this.$filesInput.data("caption-files-selected");t=Fera.Liquid.parse(e).render({count:r.length})}else t=r[0].name;1===this.videoFiles.length&&this._loadVideoFileMeta(),this.$submissionForm.find(".fera-uploadLabel").text(t),this.$(".fera-contentSubmission-termRow").removeClass("fera-hidden")}_initReviewSections(){if(!this._requestReview)return void this.$submissionForm.find(".fera-contentSubmission-row").remove();const e=this._products[0];if(e&&e.name){const e=this._products[0],t=`<a class="fera-link" target="_blank" href="${e.url}">${e.name.length<=27?e.name:e.name.substr(0,27)+"..."}</a>`;this.$submissionForm.find(".fera-productTitle").html(t)}else this.$submissionForm.find(".fera-productTitle").closest(".fera-contentSubmission-row").hide();this.$submissionForm.find("[data-fera-contentsubmission-star]").on("click",(e=>this._applyRating(e))),this.$summaryInput.focus(),this._previousReview&&this._populatePreviousReview()}_initDraftTracking(){var e=Fera.Util.debounce((()=>{this._updateDraft()}),5e3);this.$ratingInput.on("change",(()=>e())),this.$summaryInput.on("keypress change",(()=>e())),this.$bodyInput.on("keypress change",(()=>e()))}_updateDraft(){if(this.submitting)return;const e=new FormData,t=this._products[0],r=this.$ratingInput.val(),i=this.$bodyInput.val(),n=this.$summaryInput.val();e.append("customer_review[rating]",r||""),e.append("customer_review[heading]",n||""),e.append("customer_review[body]",i||""),this._opts.api.contentSubmission({data:e,params:{customer_message_token:this.customerMessageToken,content_campaign_token:this.contentCampaignToken,product_id:t?t.id:null,visitor_id:this._opts.visitorId,customer_name:this.customer.name,customer_email:this.customer.email,update_draft:!0}})}showTermModal(){this.$submissionForm.addClass("fera-hidden"),this.$submissionFormTitle.addClass("fera-hidden"),this.$viewTermContainer.removeClass("fera-hidden"),this.$viewTermTitle.removeClass("fera-hidden")}closeTermModal(){this.$submissionForm.removeClass("fera-hidden"),this.$submissionFormTitle.removeClass("fera-hidden"),this.$viewTermContainer.addClass("fera-hidden"),this.$viewTermTitle.addClass("fera-hidden")}_applyRating(e,t=null){t=t||this.$(e.target).data("rating"),this.$ratingInput.val(t).trigger("change"),this.$submissionForm.find("[data-fera-contentSubmission-star]").each(((e,r)=>{e<t?this.$(r).addClass("fera-star--starred"):this.$(r).removeClass("fera-star--starred")})),this.$(".fera-contentSubmission-termRow").removeClass("fera-hidden"),this._prefillDefaultMessages(t),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_prefillDefaultMessages(e){if(this._opts.app.storeSettings&&this._opts.app.storeSettings.autofill_review_headings_disabled)return;if(this._previousReview.heading)return;if(this.$summaryInput.data("fera-modified")&&this.$summaryInput.val())return;if(this._opts.app.locale&&"en"!=this._opts.app.locale)return;const t={1:["Really not happy.","No good.","Pretty bad.","No thanks.","Awful","No good.","Not recommended at all!"],2:["Not happy.","Nah.","Probably not again.","Not the best.","Not for me."],3:["Meh.","Not amazing.","Pretty ok.","It's fine.","Mostly good, but...","Decent."],4:["Pretty good!","I dig it!","Solid!","Recommended!","Really, really good.","A very positive experience.","Really nice!","Glad I got this.","Really good!","Quite nice!"],5:["Great!","Fantastic!","Excellent!","Highly recommended!","How great!","Really loved it!","Terrific!","Incredible!","Wonderful!","Marvelous!","Remarkable!","Phenomenal!","Spectacular!","Definitely recommended!","You should get this!"]};this.$summaryInput.val(t[e][Math.floor(4*Math.random())]),this.$summaryInput.data("fera-modified",!1)}_populatePreviousReview(){const{rating:e,heading:t,body:r,agreed_to_terms:i}=this._previousReview;e&&this._applyRating(null,e),t&&this.$summaryInput.val(t),r&&this.$bodyInput.val(r),i&&this.$agreedTermInput.prop("checked",i)}_initSubmitAndReviewNextBtns(){this.$submissionForm.find("[data-fera-contentSubmission-submitBtn]").on("click",(e=>this._submitForm(e))),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-reviewNextBtn]").on("click",(e=>this._reviewNextProduct(e)))}_submitForm(e){e.preventDefault(),this.$errorContainer.addClass("fera-hidden"),this.submitting=!0;const t=this.$(e.target),r=new FormData,i=Array.from(this.$filesInput.prop("files")||[]),n=this._products[0],a=this.$ratingInput.val(),o=this.$bodyInput.val(),s=!!o,l=this.$summaryInput.val(),c=!!l,u=this.$agreedTermInput.data("term-enabled"),d=this.$agreedTermInput.is(":checked"),p=5,h=1;if(i.length>p){const e=Fera.Liquid.parse(this.$errorContainer.data("caption-max-files-reached")).render({limit:p});return this.$errorContainer.text(e).removeClass("fera-hidden")}if(this.videoFiles.length>h){const e=Fera.Liquid.parse(this.$errorContainer.data("caption-one-video-allowed")).render({limit:h});return this.$errorContainer.text(e).removeClass("fera-hidden")}if(this.videoFiles.length){const e=this._getVideoDurationValidationErrorMsg(this.videoFiles[0]);if(e)return this.$errorContainer.text(e).removeClass("fera-hidden")}return this._requestReview&&!a?this.$errorContainer.text(this.$errorContainer.data("caption-rating-required")).removeClass("fera-hidden"):this._requestReview&&this._requiredReviewFields&&this._requiredReviewFields.heading&&!c?this.$errorContainer.text(this.$errorContainer.data("caption-heading-required")).removeClass("fera-hidden"):this._requestReview&&this._requiredReviewFields&&this._requiredReviewFields.body&&!s?this.$errorContainer.text(this.$errorContainer.data("caption-body-required")).removeClass("fera-hidden"):this._requestReview&&u&&!d?this.$errorContainer.text(this.$errorContainer.data("caption-agreed-terms-required")).removeClass("fera-hidden"):!this._requestReview&&(this._requestVideo||this._requestPhoto)&&i.length<=0?this.$errorContainer.text(this.$errorContainer.data("caption-files-required")).removeClass("fera-hidden"):(t.text(Fera.t("Loading...")),t.prop("disabled",!0),r.append("customer_review[rating]",a||""),r.append("customer_review[heading]",l||""),r.append("customer_review[body]",o||""),u&&r.append("customer_review[agreed_to_terms]",d),i.forEach((e=>{r.append("customer_review[files][]",e,e.name.replace(/\s+/g,"-"))})),this._opts.testMode?(alert("NOTE:\nThe review will not be submitted since you are in preview mode."),void setTimeout((()=>this._checkForNextReview()),500)):void this._opts.api.contentSubmission({data:r,params:{customer_message_token:this.customerMessageToken,content_campaign_token:this.contentCampaignToken,product_id:n?n.id:null,visitor_id:this._opts.visitorId,customer_name:this.customer.name,customer_email:this.customer.email},success:this._onContentSubmitted.bind(this),error:e=>{e.responseJSON&&e.responseJSON.duration&&"must be longer than 3 seconds"===e.responseJSON.duration?this.$errorContainer.text(this.$errorContainer.data("caption-video-min-duration-required")).removeClass("fera-hidden"):this.$errorContainer.text(this.$errorContainer.data("caption-server-error")).removeClass("fera-hidden"),t.text(Fera.t("Submit")),t.prop("disabled",!1)}}))}_getVideoDurationValidationErrorMsg(e){return e.duration<5?Fera.Liquid.parse(this.$errorContainer.data("caption-video-min-duration-required")).render({duration:5}):e.duration>300?Fera.Liquid.parse(this.$errorContainer.data("caption-video-max-duration-exceeded")).render({duration:5}):null}_loadVideoFileMeta(){const e=document.createElement("video");e.preload="metadata",e.onloadedmetadata=()=>{window.URL.revokeObjectURL(e.src),this.videoFiles[0].duration=e.duration},e.src=URL.createObjectURL(this.videoFiles[0])}_onContentSubmitted(e){e.has_customer||this.customer.isPresent()?this._checkForNextReview():(this.customer.update(e.content_submission_token,this._checkForNextReview.bind(this)),this.customer.requestDetails())}_checkForNextReview(){this._products.shift(),this._products.length>0&&this.$ratingInput.val()>1?(this.$submissionRewardContainer.fadeOut(),this.$submissionFormContainer.fadeOut(),this.$submissionSuccessContainer.removeClass("fera-hidden").fadeIn()):this._closeFormAndShowReward()}_closeFormAndShowReward(){this.$submissionFormContainer.fadeOut(),this.$submissionRewardContainer.removeClass("fera-hidden").fadeIn(),this.$submissionRewardContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",(e=>this._closeWindow(e))),this.$submissionRewardContainer.find("[data-fera-contentSubmission-closeWindowBtn]").on("click",(e=>this._closeWindow(e)))}_closeWindow(e){this.$submissionFormContainer.remove(),this.$submissionRewardContainer.remove(),this.$submissionSuccessContainer.remove(),this.$loadingStateContainer.remove(),this.$(".fera-contentSubmission--overlay").remove(),this.$body.removeClass("fera-modal--open"),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_reviewNextProduct(e){this.$submissionSuccessContainer.fadeOut(),this.$submissionFormContainer.fadeIn();const t=this.$(this._html).find("form");this.$submissionForm.replaceWith(t),this._initElementsAndListeners(),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_redirectToHomeOrProductPage(){let e="/";this._products&&this._products.length>0&&(e=this._products[0].url),location.href=e}_showLoadingState(){
let e='\n      <div class="fera-contentSubmission--overlay"></div>\n      <div class="fera-contentSubmission--loading">\n        <div class="fera-contentSubmission-modal">\n            <div class="fera-contentSubmission-loading">\n                <div class="fera-container">\n                    <div>\n                        <svg aria-hidden="true" height="20" focusable="false" data-prefix="fad" data-icon="spinner-third" class="fera-spinner" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g class="fa-group"><path class="fa-secondary" fill="currentColor" d="M478.71 364.58zm-22 6.11l-27.83-15.9a15.92 15.92 0 0 1-6.94-19.2A184 184 0 1 1 256 72c5.89 0 11.71.29 17.46.83-.74-.07-1.48-.15-2.23-.21-8.49-.69-15.23-7.31-15.23-15.83v-32a16 16 0 0 1 15.34-16C266.24 8.46 261.18 8 256 8 119 8 8 119 8 256s111 248 248 248c98 0 182.42-56.95 222.71-139.42-4.13 7.86-14.23 10.55-22 6.11z" opacity="0.4"></path><path class="fa-primary" fill="currentColor" d="M271.23 72.62c-8.49-.69-15.23-7.31-15.23-15.83V24.73c0-9.11 7.67-16.78 16.77-16.17C401.92 17.18 504 124.67 504 256a246 246 0 0 1-25 108.24c-4 8.17-14.37 11-22.26 6.45l-27.84-15.9c-7.41-4.23-9.83-13.35-6.2-21.07A182.53 182.53 0 0 0 440 256c0-96.49-74.27-175.63-168.77-183.38z"></path></g></svg>\n                    <div>\n                </div>\n            </div>\n        </div>\n      </div>\n    ',t="\n       body.fera-modal--open {\n         overflow: hidden !important;\n       }\n       @keyframes fera-spin {\n         from { transform:rotate(0deg); }\n         to { transform:rotate(360deg); }\n       }\n      .fera-spinner {\n        animation-name: fera-spin;\n        animation-duration: 1500ms;\n        animation-iteration-count: infinite;\n        animation-timing-function: linear;\n      }\n      .fera-contentSubmission-modal {\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 10px;\n        color: #1E2139;\n      }\n      .fera-contentSubmission-loading,\n      .fera-contentSubmission {\n        position: relative;\n        background-color: white;\n        padding: 50px 45px 50px;\n        border-radius: 5px;\n        box-shadow: 0px 3px 20px rgba(0, 0, 0, 0.2);\n        width: 100%;\n        max-width: 500px;\n        max-height: 90vh;\n        display: flex;\n        justify-content: center;\n        flex-direction: column;\n        z-index: 9999999;\n      }\n      .fera-contentSubmission--overlay,\n      .fera-submissionForm,\n      .fera-submissionReward,\n      .fera-submissionSuccess,\n      .fera-contentSubmission--loading {\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        position: fixed;\n        z-index: 9999999;\n      }\n\n      .fera-contentSubmission-termTitle {\n        font-size: 29px;\n        font-weight: bold;\n        letter-spacing: 1px;\n      }\n\n      .fera-contentSubmission-termPreview-content {\n        overflow-y: scroll;\n        max-height: 45vh;\n      }\n\n      .fera-contentSubmission-termPreview-content h1,\n      .fera-contentSubmission-termPreview-content h2,\n      .fera-contentSubmission-termPreview-content h3,\n      .fera-contentSubmission-termPreview-content h4,\n      .fera-contentSubmission-termPreview-content h5,\n      .fera-contentSubmission-termPreview-content h6,\n      .fera-contentSubmission-termPreview-content p,\n      .fera-contentSubmission-termPreview-content li {\n        margin: 0 0 16px;\n        padding: 0;\n        font-size: 16px;\n      }\n      .fera-contentSubmission-termPreview-content ul {\n        list-style-type: disc;\n        margin: 0 0 16px;\n      }\n\n      .fera-contentSubmission-termPreview-closeBtn {\n        background: #00070c;\n        color: white;\n        margin-top: 32px;\n        width: 112px;\n        height: 40px;\n        outline: none;\n        border: none;\n        border-radius: 3px;\n        text-align: center;\n        font-weight: bold;\n        letter-spacing: 1px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .fera-contentSubmission-termPreview-closeBtn span {\n        margin-left: 6px;\n      }\n\n      .fera-contentSubmission--overlay {\n        background: rgba(0,0,0,0.3);\n        z-index: 9999998;\n      }\n\n      .fera-contentSubmission-loading .fera-container {\n        text-align: center;\n        font-size: 20px;\n      }\n      .fera-contentSubmission-loading button {\n        color: white;\n        border: none;\n        padding: 12px 20px;\n        border-radius: 5px;\n        font-size: 14px;\n        background-color: #1E2139;\n        margin-top: 40px;\n      }\n      .fera-contentSubmission-loading button:hover {\n        background-color: black;\n      }\n      .fera-hidden {\n        display: none !important;\n      }\n      @media(max-width: 480px) {\n        .fera-contentSubmission {\n            width: 100%;\n            margin: 0;\n            max-height: 100%;\n            border-radius: 0;\n            padding: 42px 32px 42px;\n        }\n\n        .fera-contentSubmission-termTitle {\n            font-size: 24px;\n        }\n    }\n    ";return this._renderTemplate(e,t)}_hideLoadingState(e=!0){this.$loadingStateContainer.addClass("fera-hidden"),e&&this._redirectToHomeOrProductPage()}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.Base=class extends Fera.Components.Base{constructor(e){super(e),this.app=e.app,this.$=Fera.Util.$(),this.totalReviewCount=e.totalReviewCount||0,this.isSubmitHidden=void 0!==e.isSubmitHidden&&e.isSubmitHidden,this.pageSize=e.pageSize||5,this.paginationMode=e.paginationMode,this.sortBy=e.sortBy||"most_recent",this.tplVars=e.tplVars||{},this.reviewOptions=e.reviewOptions||{},this.translatedStrings=e.translatedStrings||{},e.template&&(this.prerendered=!0,this.$el=e.template,this._initialize()),this._triggerDebouncedResize=Fera.Util.debounce((()=>this._updateWidthClass()),100),this.$(window).on("resize",(()=>this._triggerDebouncedResize())),setInterval((()=>this._updateWidthClass(!0)),500)}render(){if(this.prerendered)return this.$el;this.tplVars.header&&(this.tplVars.header=Fera.t(this.tplVars.header));var e=this._renderTpl(this._tpl(),this.tplVars);return this.$el=this.$(e),this._initialize(),this.$el}clear(){this.reviewList.clear()}refresh(){this.reviewList.refresh()}forceInitialLoad(){this.reviewList.forceInitialLoad()}_updateWidthClass(e=!1){if(e&&this._resizedByTimer)return!1;this.$el&&this.$el.length>0&&(this.$el.toggleClass("fera-container--thin",this.$el.width()<576),this.$el.toggleClass("fera-container--wide",this.$el.width()>1440),this._resizedByTimer=e)}_initialize(){this.$totalReviewCount=this.$el.find(`.${this._suffix()}-count-total`),this._setupWriteReview(),this._setupReviewList(),this._updateCountDependentDisplays(this.totalReviewCount),this._updateWidthClass()}_setupWriteReview(){this.$writeReview=this.$el.find('[data-fera-action="showContentSubmission"]'),this.$writeReview.text(Fera.t(this.$writeReview.text())),this.$writeReview.data("fera-deep-link-attached")||(this.$writeReview.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.app.showContentSubmission()})),this.$writeReview.data("fera-deep-link-attached",!0)),this.$el.toggleClass(`${this._suffix()}--submitHidden`,!!this.isSubmitHidden)}_setupReviewList(){this.reviewListOpts=this.reviewListOpts||{},this.prerendered&&(this.reviewListOpts.template=this.$el),this.reviewList=new Fera.CustomerResources.CustomerReviews.List(this.reviewListOpts),this.reviewList.on("listUpdate",((e,t)=>{this._updateCountDependentDisplays(t)})),this.prerendered||(this.$body=this.$el.find(`.${this._suffix()}-content`),this.$body.append(this.reviewList.render()))}_updateCountDependentDisplays(e){this._updateReviewCountStr(e),this._updateSeoAttributes(e)}_updateSeoAttributes(e){}static removeSeoAttributes(e){var t=Fera.Util.$();e.removeAttr("itemprop").removeAttr("itemtype").removeAttr("itemscope"),e.find("[itemprop],[itemtype],[itemscope]").each(((e,r)=>{t(r).removeAttr("itemprop").removeAttr("itemtype").removeAttr("itemscope")}))}_updateReviewCountStr(e){var t;if(!(this.$totalReviewCount.length<1||(this.$countStr?(this.$countStr.remove(),t=this.$countStr.find(`.${this._suffix()}-reviewCount,[itemprop="reviewCount"]`)):t=this.$totalReviewCount.find(`.${this._suffix()}-reviewCount,[itemprop="reviewCount"]`),t.length<1))){t.get(0).innerHTML=e;var r=Fera.Liquid.parse(Fera.t("{{ review_count }} review{% if review_count != 1 %}s{% endif %}")).render({review_count:e});this.$countStr=this.$(`<span class="${this._suffix()}-count-total-str">${r.replace(e,t.get(0).outerHTML)}</span>`),t.remove(),this.$totalReviewCount.append(this.$countStr)}}_renderTpl(e,t){var r=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!r)return Fera.logger.error("Template is empty or not valid.",e,t),"";var i=Fera.Liquid.parse(r);return i?i.render(t):(Fera.logger.error("Failed to parse template: ",i,t),"")}_tpl(){console.error("Fera.CustomerResources.CustomerReviews.Base template was not implemented.")}_suffix(){return"fera-productReviews"}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.AllReviews=class extends Fera.CustomerResources.CustomerReviews.Base{constructor(e){super(e)}_setupReviewList(){this.reviewListOpts={app:this.app,singleProduct:!1,viewMode:"grid",pageSize:this.pageSize,paginationMode:this.paginationMode,sortBy:this.sortBy,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings,typesToShow:this._opts.typesToShow,suffix:"fera-allReviews"},super._setupReviewList()}_suffix(){return"fera-allReviews"}_updateSeoAttributes(e){this.$el&&this.constructor.removeSeoAttributes(this.$el)}_tpl(){return'<div class="fera-storeReview-block">\n            <div class="fera-allReviews-heading">\n                <div class="fera-allReviews-heading-col1">\n                    <h2 class="fera-allReviews-heading-header">{{ header }}</h2>\n                    <a href="#" class="text-link fera-allReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n                <div class="fera-allReviews-heading-col2" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">\n                    <div class="fera-allReviews-totals-col1">\n                        <div class="fera-allReviews-avgRating">\n                            <span itemprop="ratingValue" class="h1 fera-allReviews-avgRating-val" data-value="{{ average_rating }}">{{ average_rating }}</span>\n                        </div>\n                    </div>\n                    <div class="fera-allReviews-totals-col2">\n                        <div class="fera-allReviews-avgRating-stars">\n                            {% if ratings_enabled %}\n                            <div class="fera-stars fera-allReviews-stars"\n                                 data-rating="{{ average_rating }}">\n                                <div class="fera-stars-rating fera-allReviews-stars-rating" style="width: {{ average_rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>\n                                <div class="fera-stars-bg fera-allReviews-stars-bg"></div>\n                            </div>\n                            {% endif %}\n                        </div>\n                        <div class="fera-allReviews-count">\n                            <div class="fera-allReviews-count-total" data-value="{{ review_count }}">\n                                <span itemprop="reviewCount">{{ review_count || 0 }}</span>\n                                <span itemprop="ratingCount" style="display: none;">{{ review_count || 0 }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="fera-allReviews-content"></div>\n        </div>'}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=class extends Fera.Components.Base{constructor(e={}){super(e),this.app=e.app,this.singleProduct=!!e.singleProduct,this.$=Fera.Util.$(),this.options=e.options,this.translatedStrings=e.translatedStrings||{},this.$el=e.$template,this._initialize()}refresh(){this.offset=0,this._setLimit(),this.customerMedia=[],this.clear(),this._fetchNextPage()}_setLimit(){this.isMobile=this.$el.width()<=500,this.limit=this.isMobile?this.options.max_to_show_on_mobile:this.options.max_to_show_on_desktop,this.limit=this.limit||6}clear(){this.$customerMediaContent.empty(),this.renderer.reset()}_initialize(){this._setupHeader(),this._setupCustomerMediaContent(),this._setupLoadMore(),this.renderer=new Fera.CustomerResources.CustomerMedia.Renderer({$el:this.$customerMediaContent,themeCode:this.options.theme_code}),this.renderer.on("limit:change",((e,t)=>{if(this.isMobile)return this.limit=4;this.limit=t})),this._refreshOnWindowResize()}_refreshOnWindowResize(){this.previousWidth=this.windowWidth;const e=Fera.Util.debounce((()=>{const e=this.windowWidth;Math.abs(this.previousWidth-e)>20&&this.refresh(),this.previousWidth=e}),300);this.$(window).on("resize",(()=>e()))}get windowWidth(){return document.body.offsetWidth||this.$(window).width()}get _headers(){return{media:"Customer Photos & Videos",photos:"Customer Photos",videos:"Customer Videos"}}_setupHeader(){this.$header=this.$el.find(".fera-customerMedia-header"),this.$header.toggleClass("fera-hidden",!this.options.header_enabled);let e="";this.options.images_enabled&&this.options.videos_enabled?e="media":this.options.images_enabled?e="photos":this.options.videos_enabled&&(e="videos"),Object.values(this._headers).includes(this.options.header)?this.$header.text(this._headers[e]):this.$header.text(this.options.header)}_setupCustomerMediaContent(){this.$customerMediaContent=this.$el.find(".fera-customerMedia-content"),this.$noCustomerMedia=this.$el.find(".fera-customerMedia-noCustomerMedia")}_setupLoadMore(){this.$footer=this.$el.find(".fera-customerMedia-footer"),this.$spinner=this.$el.find(".fera-loading-spinner").clone().removeClass("fera-hidden"),this.$loadMoreBtn=this.$el.find(".fera-customerMedia-loadMoreBtn"),this.$loadMoreBtn.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._fetchNextPage()}))}_fetchNextPage(){let e={offset:this.offset,limit:this.limit,only_photos:this.options.images_enabled&&!this.options.videos_enabled,only_videos:this.options.videos_enabled&&!this.options.images_enabled,media_source:this.options.media_source,cache_key:this.singleProduct?"product":"store"};const t=this.app.getProductId();if(this.singleProduct&&void 0!==t&&t.trim().length>0&&(e.product_id=t),"choose"===this.options.media_source){let t=this.options.media_ids;t="string"==typeof t?JSON.parse(t):t,e.media_ids=t.length>0?t:[-1],e.product_id=null}this.$loadMoreBtn.html(this.$spinner).append(Fera.t("Loading...")).prop("disabled",!0),this.app.api.getCustomerMedia(e,((e,t)=>{if(this.totalCount=t,this.totalCount<1)this.clear(),this.$noCustomerMedia.removeClass("fera-hidden"),"hide"!==this.options.when_no_media||this.app.opts.testMode||this.$el.hide();else{this.customerMedia=[...this.customerMedia,...e],this.offset=this.customerMedia.length;const t=this.totalCount>this.customerMedia.length;this.renderer.render(e,t)}this.$loadMoreBtn.text(Fera.t("Show More")).prop("disabled",null),this.$footer.toggleClass("fera-hidden",!this._showLoadMore())}))}_showLoadMore(){return!!this.customerMedia&&this.customerMedia.length<this.totalCount}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=Fera.CustomerResources.CustomerMedia||{},Fera.CustomerResources.CustomerMedia.Item=class extends Fera.Components.Base{constructor(e={}){super(e),this.$=Fera.Util.$(),this.caption=e.caption,this.type=e.type,this.isImported=e.isImported,this.isImported&&(this.integrationType=e.integrationType),this.imageViewer=e.imageViewer,this.videoViewer=e.videoViewer,this._isPhoto?(this.imageUrl=e.imageUrl,this.imageThumbnailUrl=e.imageThumbnailUrl):(this.videoUrl=e.videoUrl,this.videoThumbnailUrl=e.videoThumbnailUrl)}get _isPhoto(){return"photo"===this.type}render(){return super.render(),this.$el=this.$(this._tpl()),this.$el}_afterRenderComplete(){let e=this.$el;this._isPhoto?this.imageViewer.init(e):(e=this.$el.find(".fera-customerMedia-videoThumbnail-clickableArea"),this.videoViewer.init(e))}_imageTpl(){return`<img class="fera-customerMedia-imageThumbnail fera-customerMedia-thumbnail" src="${this.imageThumbnailUrl}" alt="${this.caption}" data-image-url="${this.imageUrl}" itemscope itemtype="https://schema.org/Photograph" />`}videoThumbnailOrPlaceholderTpl(){return!this.videoThumbnailUrl&&this.isImported?this._importedVideoTpl(this.integrationType):`\n            <img class="fera-customerMedia-videoThumbnail" src="${this.videoThumbnailUrl}" alt="${this.caption}" itemscope itemtype="https://schema.org/Photograph" />\n        `}_importedVideoTpl(e){const t=this._prepareImportedVideoUrl(this.videoUrl,e);return["youtube","vimeo","instagram"].includes(e)?`<iframe class="fera-customerMedia-videoThumbnail fera-customerMedia-video" width="100" height="100" src="${t}"\n                    frameborder="0" allow="accelerometer; autoplay; picture-in-picture"\n                    allowfullscreen></iframe>`:`<video class="fera-customerMedia-videoThumbnail fera-customerMedia-video" width="100" height="100" src="${t}#t=0.001" alt="${this.caption}"></video>`}_prepareImportedVideoUrl(e,t){if("url"===t)return e;({youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9\.]+\/videos\/(?:[a-zA-Z0-9\.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/})[t].test(e);return"youtube"===t?e=`https://www.youtube.com/embed/${RegExp.$5}`:"vimeo"===t?e=`https://player.vimeo.com/video/${RegExp.$5}`:"instagram"===t&&(e=`https://www.instagram.com/p/${RegExp.$2}/embed`),e}_videoTpl(){return`\n            <figure class="fera-customerMedia-videoThumbnailWrapper fera-customerMedia-thumbnail">\n                <div\n                    class="fera-customerMedia-videoThumbnail-clickableArea"\n                    data-video-url="${this.videoUrl}"\n                    ${this.integrationType?`data-video-type="${this.integrationType}"`:""}\n                    data-video-is-imported="${this.isImported}"\n                ></div>\n                ${this.videoThumbnailOrPlaceholderTpl()}\n                <div class="fera-customerMedia-videoThumbnail-playButtonWrapper ${this.integrationType||""}">\n                    <svg class="fera-customerMedia-videoThumbnail-playButton" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M0 15.223V1.77702C0 0.99739 0.852556 0.517624 1.51898 0.922237L12.5921 7.64521C13.2335 8.03461 13.2335 8.96539 12.5921 9.35479L1.51898 16.0778C0.852556 16.4824 0 16.0026 0 15.223Z" fill="black" fill-opacity="0.8"/>\n                    </svg>\n                </div>\n            </figure>\n        `}_tpl(){return"photo"===this.type?this._imageTpl():this._videoTpl()}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=Fera.CustomerResources.CustomerMedia||{},Fera.CustomerResources.CustomerMedia.Renderer=class extends Fera.Components.Base{constructor(e={}){super(e),this.$el=e.$el,this.$=Fera.Util.$(),this.themeCode=e.themeCode,this.customerMedia=[],this.previousCustomerMedia=[],this.imageViewer=new Fera.ImageViewer,this.videoViewer=new Fera.VideoViewer,this.hasMoreItems=!0}render(e,t){this.customerMedia=e,this.hasMoreItems=t,this._usePreviousAndCurrentMedia(),this._renderItems()}reset(){this.$el.empty(),this.previousItemsCountPerRow=null,this.firstRowFilled=!1,this.hasMoreItems=!0,this.previousCustomerMedia=[]}_usePreviousAndCurrentMedia(){this.firstRowFilled||(this.customerMedia=[...this.previousCustomerMedia,...this.customerMedia],this.previousCustomerMedia=[...this.customerMedia],this.$el.empty())}get _minItemWidths(){return{"customer_media.default":121,"customer_media.padded":170,"customer_media.rounded":145,"customer_media.circles":145}}_renderItems(){if(this.customerMedia&&!(this.customerMedia.length<1)){for(this.containerWidth=this.$el[0].offsetWidth||this.$el.width(),this.itemsCount=this.customerMedia.length,this.minItemWidth=this._minItemWidths[this.themeCode]||121,this.itemSpacing=this._getItemSpacing()||0,this.itemSpacing&&(this.minItemWidth+=this.itemSpacing),this.rowsCount=1,this.itemsCountPerRow=Math.round(this.itemsCount/this.rowsCount);this.containerWidth/this.itemsCountPerRow<this.minItemWidth;)this.rowsCount+=1,this.itemsCountPerRow=Math.round(this.itemsCount/this.rowsCount);[...Array(this.rowsCount).keys()].forEach((e=>this._renderRow(e)))}}_renderRow(e){const t=e*this.itemsCountPerRow,r=t+this.itemsCountPerRow;let i=this.customerMedia.slice(t,r);e+1===this.rowsCount&&(i=this.customerMedia.slice(t),this.itemsCountPerRow=this.hasMoreItems||i.length>this.previousItemsCountPerRow?i.length:this.previousItemsCountPerRow);let n=this.$(this._rowTpl());this._render(i,n),this.itemSpacing&&n.find(".fera-customerMedia-thumbnail").css({marginRight:this.itemSpacing}),this._resizeRowItems(n),this.$el.append(n),this.previousItemsCountPerRow=this.itemsCountPerRow}_resizeRowItems(e){let t=this.containerWidth/this.itemsCountPerRow;this.firstRowFilled||(t>2*this.minItemWidth&&(t=2*this.minItemWidth),t*this.itemsCountPerRow>=this.containerWidth&&(this.firstRowFilled=!0,this.trigger("limit:change",this.itemsCountPerRow))),this.itemSpacing&&(t-=this.itemSpacing,e.css({marginTop:this.itemSpacing})),e.find(".fera-customerMedia-thumbnail").css({width:`${t}px`,height:`${t}px`})}_getItemSpacing(){const e=this.$el.css("grid-gap");if(!e)return;const t=e.split("px")[0];return t?parseInt(t):void 0}_render(e,t){e.forEach((e=>{const r=new Fera.CustomerResources.CustomerMedia.Item({caption:e.caption,type:e.type,imageUrl:e.image_url,imageThumbnailUrl:e.image_thumbnail_url,isImported:e.is_imported,integrationType:e.integration_type,videoUrl:e.video_url,videoThumbnailUrl:e.video_thumbnail_url,imageViewer:this.imageViewer,videoViewer:this.videoViewer});t.append(r.render())}))}_rowTpl(){return'<div class="fera-customerMedia-content-row"></div>'}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.ProductReviews=class extends Fera.CustomerResources.CustomerReviews.Base{constructor(e){super(e),this.prerendered&&this._tryToTranslateHeader()}_setupReviewList(){this.reviewListOpts={app:this.app,singleProduct:!0,productId:this._opts.productId,pageSize:this.pageSize,sortBy:this.sortBy,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,paginationMode:this.paginationMode,translatedStrings:this.translatedStrings,suffix:"fera-productReviews",typesToShow:"product"},super._setupReviewList()}_tryToTranslateHeader(){if(this.$header=this.$el.find(".fera-productReviews-heading-header"),this.$header.length<1)return;let e=this.$header.text();e&&this.$header.text(Fera.t(e.trim()))}_updateSeoAttributes(e){if(super._updateSeoAttributes(e),e>0){let e=this.$el.parents("[itemType]");(e.length<1||!e.first().attr("itemType").match(/\/Product$/))&&(this.constructor.copySeoAttributesToProductContext(this.$el),Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)),this.constructor.removeDuplicateAggregateRatingSeoAttr()}else Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)}static copySeoAttributesToProductContext(e){e=e.first();let t=Fera.Util.$(),r=t('[itemType*="/Product"]'),i=t('script[type="application/ld+json"]');if(r.length>0){let t=e.clone();t.hide(),t.removeAttr("class").removeAttr("data-fera-skill").removeAttr("data-fera-widget").removeAttr("id"),t.find("[class]").removeAttr("class").removeAttr("id"),r.first().append(t)}else{if(!(i.length>0))return Fera.logger.log("Tried to copy object to optimize for SEO but could not find parent product SEO item type or script definitions."),!1;i.each(((r,i)=>{let n,a=t(i);try{n=JSON.parse(a.html().replace(/\n/g," "))}catch(e){Fera.logger.log("Encountered an error while trying to parse JSON for application/ld+json. Reading will be skipped.",a)}if(!n)return void Fera.logger.warn("Failed to properly parse your application/ld+json. This could indicate that your site code/theme is not properly handling SEO elements. Contact our team for help.");if(!n["@type"])return;if(!n["@type"].match(/Product$/))return;n.aggregateRating=n.aggregateRating||{},n.aggregateRating["@type"]="AggregateRating";let o=e.find('[itemprop="aggregateRating"] '),s=o.find('[itemprop="ratingValue"]').text(),l=o.find('[itemprop="ratingCount"]').text(),c=o.find('[itemprop="reviewCount"]').text();return s&&(n.aggregateRating.ratingValue=s.trim()),l&&(n.aggregateRating.ratingCount=l.trim()),c&&(n.aggregateRating.reviewCount=c.trim()),n.review=n.review||[],e.find('[itemprop="review"]').each(((e,r)=>{let i=t(r),a=i.find('[itemprop="datePublished"]').attr("content"),o=i.find('[itemprop="author"]').text(),s=i.find('[itemprop="ratingValue"]').text(),l=i.find('[itemprop="description"]').text();if(!a||!o)return;if(n.review.find((e=>e.datePublished==a.trim()&&e.author==o.trim())))return;let c={"@context":"https://schema.org/","@type":"Review",datePublished:a,author:{"@type":"Person",name:o},reviewBody:l.trim(),reviewRating:{"@type":"Rating"}};s&&(c.reviewRating.ratingValue=s.trim()),n.review.push(c)})),a.html(JSON.stringify(n)),!1}))}return!0}static removeDuplicateAggregateRatingSeoAttr(){let e=Fera.Util.$(),t=e('[itemType*="Product"]').find('[itemType*="AggregateRating"]'),r=e('script[type="application/ld+json"]');if(t.length>0){let r;t.each(((t,i)=>{let n=e(i),a=n.parents("[itemType]").first();a&&a.attr("itemType").match(/\/Product$/)&&!r?r=n:Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(n)}))}else{if(!(r.length>0))return!1;{let t=!1;r.each(((r,i)=>{let n,a=e(i);try{n=JSON.parse(a.html().replace(/\n/g," "))}catch(e){Fera.logger.log("Encountered an error while trying to parse JSON for application/ld+json. Reading will be skipped.",a)}n?n["@type"]&&n["@type"].match(/Product$/)&&(t?(delete n.aggregateRating,a.html(JSON.stringify(n))):t=!0):Fera.logger.log("Failed to properly parse your application/ld+json. This could indicate that your site code/theme is not properly handling SEO elements. Contact our team for help.")}))}}return!0}_tpl(){return'<div class="fera-productReviews">\n            <div class="fera-productReviews-heading">\n                <div class="fera-productReviews-heading-col1">\n                    <h2 class="fera-productReviews-heading-header">{{ header }}</h2>\n                    <a href="#" class="text-link fera-productReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n                <div class="fera-productReviews-heading-col2" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">\n                    <div class="fera-productReviews-totals-col1">\n                        <div class="fera-productReviews-avgRating">\n                            <span itemprop="ratingValue" class="h1 fera-productReviews-avgRating-val" data-value="{{ average_rating | default: 0.0 }}">{{ average_rating }}</span>\n                        </div>\n                    </div>\n                    <div class="fera-productReviews-totals-col2">\n                        <div class="fera-productReviews-avgRating-stars">\n                            {% if ratings_enabled %}\n                            <div class="fera-stars fera-productReviews-stars"\n                                 data-rating="{{ average_rating | default: 0.0 }}">\n                                <div class="fera-stars-rating fera-productReviews-stars-rating" style="width: {{ average_rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>\n                                <div class="fera-stars-bg fera-productReviews-stars-bg"></div>\n                            </div>\n                            {% endif %}\n                        </div>\n                        <div class="fera-productReviews-count">\n                            <div class="fera-productReviews-count-total" data-value="{{ review_count | default: 0 }}">\n                                <span itemprop="reviewCount" class="fera-productReviews-reviewCount"">{{ review_count | default: 0 }}</span>\n                                <span itemprop="ratingCount" style="display: none;">{{ review_count | default: 0 }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="fera-productReviews-content"></div>\n        </div>'}},Fera.CustomerResources.ProductReviewsModal=class extends Fera.Components.BaseModal{constructor(e){super(e),this.classPrefix=e.classPrefix||"reviews",this.app=e.app,this.totalReviewCount=e.totalReviewCount,this.tplVars=e.tplVars||{},this.reviewOptions=e.reviewOptions||{},this.translatedStrings=e.translatedStrings||{}}show(e=!1){super.show(),this._setupReviewBlock(),this.reviewBlock.refresh()}hide(){super.hide(),this.reviewBlock.clear(),this.$el&&this.$el.remove(),this.reviewBlock&&delete this.reviewBlock,this.rendered=!1}_setupReviewBlock(){this.reviewBlock||(this.reviewBlock=new Fera.CustomerResources.CustomerReviews.ProductReviews({productId:this._opts.productId,app:this.app,totalReviewCount:this.totalReviewCount,tplVars:this.tplVars,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings}),this.$modalBody.append(this.reviewBlock.render()))}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.RelatedReviews=class extends Fera.CustomerResources.CustomerReviews.Base{constructor(e){super(e)}refresh(){super.refresh(),this.reviewList.forceInitialLoad()}_initialize(){super._initialize(),this.relatedHeader=Fera.t(this._opts.relatedHeader)||Fera.t("Reviews From Similar Products"),this.$header=this.$el.find(".fera-productReviews-heading-header"),this.$header.html(this.relatedHeader),this.$el.toggleClass("fera-productReviews--showingRelated",!0)}_setupReviewList(){this.reviewListOpts={app:this.app,singleProduct:!1,pageSize:this.pageSize,paginationMode:this.paginationMode,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings,suffix:"fera-productReviews",typesToShow:this._opts.typesToShow,showProducts:this._opts.showProducts},super._setupReviewList(),this.reviewList.clearListeners("listUpdate"),this.reviewList.on("listUpdate",((e,t)=>{this._updateCountDependentDisplays(t),t>1&&this.trigger("reviewsFound",!0)}))}_updateSeoAttributes(e){Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)}_tpl(){return'<div class="fera-productReview-block">\n            <div class="fera-productReviews-heading">\n                <div class="fera-productReviews-heading-col1">\n                    <h2 class="fera-productReviews-heading-header"></h2>\n                    <a href="#" class="text-link fera-productReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n            </div>\n            <div class="fera-productReviews-content"></div>\n        </div>'}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.ProductReview=function(e){var t=this,r="https://cdn.fera.ai/img/shoppers/placeholder2.png",i=Fera.Util.$(),n=function(){t.viewMode=e.viewMode||"list",a()},a=function(){"grid"===t.viewMode?t.suffix="fera-allReviews":t.suffix="fera-productReviews"};this.render=function(){var r=f(P(),e);return t.$el=i(r),s(),l(),c(),"grid"===t.viewMode&&(e.options&&e.options.headings_enabled&&u(),e.options&&e.options.bodies_enabled&&d("fera-allReviews-review-body",92),e.options&&e.options.show_replies&&d("fera-allReviews-reply-body",72)),t.$el.toggleClass("noHeading",!e.review.heading),
t.$el.toggleClass("noBody",!e.review.body),t.$el.toggleClass("noRating",!e.review.rating),t.$el.toggleClass("noReply",!e.review.store_reply),t.$el.toggleClass("noAvatar",!e.options.avatar_images_enabled),t.$el.toggleClass("verified",!!e.review.verified),t._hasLocation=e.review.customer_location&&e.review.customer_location!=e.review.customer_name,t.$el.toggleClass("hasLocation",!!t._hasLocation),t.$el.toggleClass("noLocation",!t._hasLocation),p(),h(),o(),t.$el};var o=function(){!1===e.itemProp&&(t.$el.removeAttr("itemprop"),t.$el.find("[itemprop],[itemscope],[itemtype]").each((function(){i(this).removeAttr("itemprop"),i(this).removeAttr("itemscope"),i(this).removeAttr("itemtype")})))},s=function(){var r=!e.options||void 0===e.options.show_verification||e.options.show_verification;t.$verifications=t.$el.find('[data-fera-verified="true"].'+t.suffix+"-review-customer-verification"),e.options&&!r&&t.$verifications.addClass("fera-verified-hidden"),t.$verifications.each((function(t,r){e.verifier.addVerificationIcon(i(r),{height:15})}))},l=function(){t.$names=t.$el.find("."+t.suffix+"-review-customer-name"),t.$names.removeClass(t.suffix+"-review-customer-name--truncated"),setTimeout((function(){Fera.Util.truncateTextToMaxWidth(t.$names)}),500)},c=function(){t.$dateVals=t.$el.find("."+t.suffix+"-review-date-val"),t.$dateVals.each((function(){var t=i(this),r=new Fera.TimeAgo({language:Fera.i18n.locale||e.language,time:t.data("value")});t.text(r.toString()),t.data("fera-timeAgo",r)}))},u=function(){var e=t.$el.find("."+t.suffix+"-review-heading");e.click((function(){e.css("white-space","normal")}))},d=function(e,r){if("string"==typeof e){var i=t.$el.find("."+e),n=i.text();if(n&&!(n.length<r)){var a='<div class="'+e+'"><div class="truncated-text">"'+n.slice(0,r)+'..." <span class="show-more"> '+Fera.t("Show More")+'</span></div><q class="full-text">'+n+"</q></div>";i.replaceWith(a),(i=t.$el.find("."+e)).find(".show-more").click((function(){i.find(".truncated-text").hide(),i.find(".full-text").show()}))}}},p=function(){var r=t.$el.find("."+t.suffix+"-photo");r.length<=0||e.imageViewer.init(r)},h=function(){var r=t.$el.find("."+t.suffix+"-videoViewer-viewable");r.length<=0||e.videoViewer.init(r)},f=function(e,t){t.customer_display_name=m();var r=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!r)return Fera.logger.error("Template is empty or not valid.",e,t),"";var i=Fera.Liquid.parse(r);return i?i.render(t):(Fera.logger.error("Failed to parse template: ",i,t),"")},m=function(){if(!e.review.customer_name)return Fera.t("Anonymous");if(e.review.customer_name)return Fera.Util.formatFullName(e.review.customer_name,e.options.customer_name_format);var t=e.review.body.replace(/[^a-z]+/gi,"").toLowerCase();return t.slice(3,4).toUpperCase()+"..."+t.slice(5,6)},g=function(){return'{% if options.avatar_images_enabled %}<div class="'+t.suffix+"-review-customer-col "+t.suffix+'-review-customer-avatar-col">    <img src="{{ review.customer_avatar_url }}" onerror="this.src=\''+r+'\'" alt="'+Fera.t("Review author avatar image")+'" class="'+t.suffix+'-review-customer-avatar">'+w()+"</div>{% endif %}"},v=function(){var e="{% if review.product.thumbnail %}{{ review.product.thumbnail }}{% else %}https://cdn.fera.ai/img/products/placeholder.png{% endif %}";return'{% if review.review_type == "product" and (options.product_images_enabled != false and review.product.url != blank) %}<div class="'+t.suffix+'-review-product">    {%- if review.product.url -%}<a href="{{ review.product.url }}">{%- endif -%}        <img src="'+e+'" alt="Product image" class="'+t.suffix+'-review-product-img">    {%- if review.product.url -%}</a>{%- endif -%}</div>{% endif %}'},_=function(){return'<div class="'+t.suffix+"-review-customer-col "+t.suffix+'-review-customer-info-col">    <div class="'+t.suffix+'-review-customer-name-row">        <span class="h3 '+t.suffix+"-review-customer-name "+t.suffix+'-review-customer-name--truncated" itemprop="author">{{ customer_display_name }}</span>        <span class="'+t.suffix+'-review-customer-verification" data-fera-verified="{{ review.verified }}"></span>    </div>    {% if review.customer_location and review.customer_location != review.customer_name %}    <div class="'+t.suffix+'-review-customer-location-row">        <span class="'+t.suffix+'-review-customer-location-marker" data-fera-customerLocation="{{ review.customer_location | replace: \'"\', "\'" }}">            <svg aria-hidden="true" focusable="false" height="9" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"></path></svg>        </span>        <span class="'+t.suffix+'-review-customer-location">{{ review.customer_location }}</span>    </div>    {% endif %}</div>'},w=function(){return'{% if review.integration_icon %}<span class="'+t.suffix+'-review-customer-source" title="This review was originally posted on {{ review.integration_name }}.">  <img class="review-source-image" src="{{ review.integration_icon }}" alt="{{ review.integration_name }} icon"></span>{% elsif review.verified %}<span class="'+t.suffix+'-review-customer-verification" data-fera-verified="{{ review.verified }}"></span>{% endif %}'},b=function(){return'{%- if options.ratings_enabled -%}<div class="'+t.suffix+'-review-rating" itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">    <div class="fera-stars '+t.suffix+"-stars "+t.suffix+'-review-stars" data-rating="{{ review.rating }}">        <span class="fera-srOnly" itemprop="ratingValue">{{ review.rating }}</span>        <div class="fera-stars-rating '+t.suffix+'-stars-rating" style="width: {{ review.rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>        <div class="fera-stars-bg '+t.suffix+'-stars-bg"></div>    </div></div>{%- endif -%}'},y=function(){var e='{%- if options.headings_enabled and review.heading -%}<div class="h3 '+t.suffix+'-review-heading" itemprop="name">';return"grid"===t.viewMode?e+="<span>{{ review.heading }}</span>":e+="{{ review.heading }}",e+="</div>{%- endif -%}"},C=function(){var e="grid"===t.viewMode?"q":"div";return'{%- if options.bodies_enabled and review.body and review.body != "" -%}<'+e+' class="'+t.suffix+'-review-body" itemprop="description">{{ review.body | newline_to_br }}</'+e+">{%- endif -%}"},S=function(){return e.review&&e.review.photos&&e.review.photos.length<1&&e.review.videos&&e.review.videos.length<1?"":'{% if options.customer_uploads_enabled AND ((review.photos AND review.photos.size > 0) OR (review.videos AND review.videos.size > 0)) %}    <div class="'+t.suffix+'-files">        {% for photo_url in review.photos %}            <img class="'+t.suffix+'-photo fera-imageViewer-viewable" src="{{ photo_url }}" itemprop="reviewPhoto" itemscope itemtype="https://schema.org/Photograph" />        {% endfor %}        {% for video_url in review.videos %}           {% if review.is_sample %}               <img class="'+t.suffix+"-videoThumbnail "+t.suffix+'-videoViewer-viewable" src="https://uploads.fera.ai/products/video-placeholder.png" data-video-url="{{ video_url }}" />           {% else %}               <figure class="'+t.suffix+"-videoThumbnailWrapper "+t.suffix+'-thumbnail">                   <div                       class="'+t.suffix+"-videoThumbnail-clickableArea "+t.suffix+'-videoViewer-viewable"                       data-video-url="{{ video_url }}"                   ></div>                   <video class="'+t.suffix+'-videoThumbnail" src="{{ video_url }}#t=0.001" width="100" height="100" itemprop="reviewVideo" itemscope itemtype="https://schema.org/VideoObject"></video>                   <div class="'+t.suffix+'-videoThumbnail-playButtonWrapper">                       <svg class="'+t.suffix+'-videoThumbnail-playButton" width="17" height="17"                           viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">                           <path                               d="M0 15.223V1.77702C0 0.99739 0.852556 0.517624 1.51898 0.922237L12.5921 7.64521C13.2335 8.03461 13.2335 8.96539 12.5921 9.35479L1.51898 16.0778C0.852556 16.4824 0 16.0026 0 15.223Z"                               fill="black" fill-opacity="0.8"/>                       </svg>                   </div>               </figure>           {% endif %}        {% endfor %}    </div>{%- endif -%}'},F=function(){return'<div class="'+t.suffix+'-review-date">    <meta itemprop="datePublished" content="{{ review.date }}">    <span class="'+t.suffix+'-review-date-val" data-value="{{ review.date }}">{{ review.date }}</span></div>'},x=function(r){var i=t.suffix+"-reply";r&&(i+=" "+t.suffix+"-reply--"+r);var n='<span class="'+t.suffix+'-reply-storeName" data-value="{{ review.store_name }}">{{ review.store_name }}</span>',a=Fera.t("{{ store_name }} replied:");a=a.replace(/{{\s*store_name\s*}}/,n);var o='{% if options.show_replies and review.store_reply %}<div class="'+i+'">    <div class="'+t.suffix+'-reply-heading">        {% if review.store_logo %}            <img class="'+t.suffix+'-reply-storeLogo" src="{{ review.store_logo }}" />        {%- endif -%}        <span>'+a+'</span>    </div>    <div class="'+t.suffix+'-reply-body">{{- review.store_reply | newline_to_br -}}</div>    <div class="'+t.suffix+'-reply-date">        <meta itemprop="date" content="{{ review.store_replied_at }}">        <span class="'+t.suffix+'-review-date-val" data-value="{{ review.store_replied_at }}">{{ review.store_replied_at }}</span>    </div></div>{%- endif -%}';return e.review.store_reply&&""===e.review.store_reply.trim()?"":o},k=function(){return 0==e.showProduct?"":'{% if review.review_type == "product" %}<div class="'+t.suffix+'-review-product">'+Fera.t("Product:")+' <a href="{{ review.product.url }}" class="'+t.suffix+'-review-product-link">{{ review.product.name }}</a></div>{% endif %}'},$=function(){return'<div class="'+t.suffix+'-review" data-link="{{ review.link_url }}" itemprop="review" itemscope itemtype="https://schema.org/Review" data-id="{{ review.id }}">    <div class="'+t.suffix+'-review-customer">'+g()+_()+'    </div>    <div class="'+t.suffix+'-review-content">'+b()+y()+C()+k()+S()+F()+x("wide")+"    </div>"+x("thin")+"</div>"},T=function(){return'<div class="'+t.suffix+'-review for-{{ review.review_type }}" data-link="{{ review.link_url }}" itemprop="review" itemscope itemtype="https://schema.org/Review" data-id="{{ review.id }}">'+v()+'    <div class="'+t.suffix+'-review-content {% if (options.product_images_enabled == false && options.avatar_images_enabled == false) or review.product.url == blank %}review-content-wide{% endif %}">'+F()+b()+y()+C()+k()+S()+'       <div class="'+t.suffix+'-review-customer">'+g()+_()+"       </div>"+x()+"    </div></div>"},P=function(){return"grid"===t.viewMode?T():$()};n()},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.List=class extends Fera.Components.Base{constructor(e){super(e),this.$=Fera.Util.$(),this.app=e.app,this.suffix=e.suffix,this.viewMode=e.viewMode||"list",this.singleProduct=void 0!==e.singleProduct&&e.singleProduct,this.paginationMode=e.paginationMode||"show_more",this.totalCount=e.totalReviewCount||0,this.limit=e.pageSize||5,this.currentPage=1,this.sortBy=e.sortBy||"most_recent",this.translatedStrings=e.translatedStrings||{},this._processReviewOptions(e.reviewOptions),this.reviews=[],e.template&&(this.prerendered=!0,this.$el=e.template,this._translateShowMore(),this._initialize())}render(){return this.prerendered||(this.$el=this.$(this._tpl()),this._initialize()),this.$el}clear(){this.$reviewContainer.empty(),"show_more"===this.paginationMode&&this.$showMore.hide()}refresh(){this.currentPage=1,this.reviews=[],this.clear(),this.totalCount>0?(this._showLoading(),this._fetchPage(1)):this.$reviewContainer.append(this.$noReviews)}forceInitialLoad(){this._showLoading(),this._fetchPage(1)}_processReviewOptions(e){this.reviewOptions={},this.reviewOptions.language=e.language||"en",delete e.language,this.reviewOptions.itemProp=void 0===e.itemProp||e.itemProp,delete e.itemProp;var t={avatar_images_enabled:!0,product_images_enabled:!0,customer_uploads_enabled:!0,ratings_enabled:!0,headings_enabled:!0,bodies_enabled:!0,videos_enabled:!0,show_replies:!0};this.reviewOptions.reviewFields=this.$.extend(t,e)}_translateShowMore(){let e=this.$el.find(`.${this.suffix}-footer .${this.suffix}-showMore-btn`),t=e.html(),r=/[sS]how [mM]ore/;if(t&&t.match(r)){let t=e.html().replace(r,Fera.t("Show More"));e.html(t)}}_initialize(){this.$reviewContainer=this.$el.find(`.${this.suffix}-reviews`),this.$showMore=this.$el.find(`.${this.suffix}-showMore`),this.$footer=this.$el.find(`.${this.suffix}-footer`),this.$noReviews=this.$(this._noReviewsTpl()),this.$showMore.hide(),"show_more"===this.paginationMode?this._setupShowMore():this._setupPagination()}_setupShowMore(){this.$showMore.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._fetchNextPage()}))}_setupPagination(){this.paginationComponent=new Fera.Components.Pagination({suffix:this.suffix,hideIfOnePage:!0,currentPage:this.currentPage,totalCount:this.totalCount,pageSize:this.limit,onClick:e=>this._pageChangeHandler(e)}),this.$footer.append(this.paginationComponent.render())}_fetchNextPage(){this.currentPage++,this._fetchPage(this.currentPage)}_pageChangeHandler(e){this._showLoading(),Fera.Util.isScrolledIntoView(this.$reviewContainer)||Fera.Util.scrollToElement(this.$reviewContainer,{duration:200}),this.currentPage=e,this._fetchPage(e)}_fetchPage(e){var t={page:e,limit:this.limit,sort_by:this.sortBy};this.singleProduct&&(t.product_id=this._opts.productId||this.app.getProductId()),this._opts.typesToShow&&(t.review_type=this._opts.typesToShow),"choose"==this._opts.reviewOptions.review_source&&this._opts.reviewOptions.review_ids&&("string"==typeof this._opts.reviewOptions.review_ids?t.ids=JSON.parse(this._opts.reviewOptions.review_ids):t.ids=this._opts.reviewOptions.review_ids||[],t.ids=t.ids.join(",")),this.app.api.getReviews(t,((e,r)=>{this._hideLoading(),this.totalCount=r,this.totalCount<1?(this.clear(),this.$reviewContainer.append(this.$noReviews)):(this.$noReviews.remove(),"pagination"===this.paginationMode&&this.clear(),this._shouldShowRandomReviews(t.product_id)?this._renderReviews(Fera.Util.shuffleArray(e)):this._renderReviews(e)),this._updateFooter(),this.trigger("listUpdate",this.totalCount)}))}_shouldShowRandomReviews(e){let t=this._opts.reviewOptions.when_no_reviews;return("show_from_related"==t||"show_related"==t)&&!e}_renderReviews(e){for(var t=new Fera.ImageViewer,r=new Fera.VideoViewer,i=0;i<e.length;i++){var n=new Fera.CustomerResources.ProductReview({review:e[i],verifier:this.app.verifier,language:this.reviewOptions.language,options:this.reviewOptions.reviewFields,itemProp:this.reviewOptions.itemProp,viewMode:this.viewMode,imageViewer:t,videoViewer:r,translatedStrings:this.translatedStrings,showProduct:this._opts.showProducts});this.reviews.push(n),"store"==e[i].review_type&&(this._hasStoreReviews=!0),"product"==e[i].review_type&&(this._hasProductReviews=!0),this.$reviewContainer.append(n.render())}this.$reviewContainer.toggleClass("hasProductReviews",!!this._hasProductReviews),this.$reviewContainer.toggleClass("hasStoreReviews",!!this._hasStoreReviews),this.$reviewContainer.toggleClass("avatars--visible",!!this.reviewOptions.reviewFields.avatar_images_enabled),this.$reviewContainer.toggleClass("avatars--hidden",!this.reviewOptions.reviewFields.avatar_images_enabled)}_updateFooter(){"pagination"===this.paginationMode?this.paginationComponent.update({currentPage:this.currentPage,totalCount:this.totalCount,pageSize:this.limit}):this.totalCount>this.reviews.length?this.$showMore.show():this.$showMore.hide()}_showLoading(){this.$reviewContainer.toggleClass("loading",!0),this.currentlyLoading=!0}_hideLoading(){this.currentlyLoading&&(this.$reviewContainer.toggleClass("loading",!1),this.currentlyLoading=!1)}_noReviewsTpl(){return`<div class="${this.suffix}-noReviewsText">${Fera.t("No reviews for this product yet.")}</div>`}_showMoreTpl(){return`<div class="${this.suffix}-showMore">\n            <a href="#" class="btn btn-secondary btn--secondary ${this.suffix}-showMore-btn">${Fera.t("Show More")}<span class="${this.suffix}-showMore-count"></span></a>\n        </div>`}_tpl(){return`<div class="${this.suffix}-${"grid"===this.viewMode?"Grid":"List"}">\n            <div class="${this.suffix}-body">\n                <div class="${this.suffix}-reviews"></div>\n            </div>\n            <div class="${this.suffix}-footer">\n                ${this._showMoreTpl()}\n           </div>\n        </div>`}},Fera.Conditions_Comparison=class{constructor(e,t,r){this.stateValue=e,this.ruleValue=t,this.operator=r}isTrue(){return this[this.operator]()}equal(){return this.stateValue==this.ruleValue}not_equal(){return!this.equal()}equal_i(){return this.equal()}not_equal_i(){return!this.equal_i()}contains(){return this.stateValue==this.ruleValue}not_contains(){return!this.contains()}less(){return this.stateValue<this.ruleValue}less_or_equal(){return this.stateValue<=this.ruleValue}greater(){return this.stateValue>this.ruleValue}greater_or_equal(){return this.stateValue>=this.ruleValue}between(){return this.greater()||this.less()}not_between(){return!this.between()}},Fera.Conditions_Comparison_String=class extends Fera.Conditions_Comparison{constructor(e,t,r){super(String(e).trim(),String(t).trim(),r)}equal(){return this.stateValue==this.ruleValue}equal_i(){return this.stateValue.toLowerCase()==this.ruleValue.toLowerCase()}contains(){return-1!==this.stateValue.toLowerCase().indexOf(this.ruleValue.toLowerCase())}less(){return parseFloat(this.stateValue)<parseFloat(this.ruleValue)}less_or_equal(){return parseFloat(this.stateValue)<=parseFloat(this.ruleValue)}greater(){return parseFloat(this.stateValue)>parseFloat(this.ruleValue)}greater_or_equal(){return parseFloat(this.stateValue)>=parseFloat(this.ruleValue)}between(){return-1!==this.ruleValue.indexOf(this.stateValue)}},Fera.Conditions_Comparison_Array=class extends Fera.Conditions_Comparison{constructor(e,t,r){super(e,t,r),"string"!=typeof this.stateValue&&(this.stateValue=String(this.stateValue).split(",")),this.stateValue=this.stateValue.sort()}equal(){let e=this.ruleValue;return"object"!=typeof this.ruleValue&&(e=String(this.ruleValue).split(",")),this.stateValue.join(",")==e.sort().join(",")}contains(){return-1!==this.stateValue.indexOf(this.ruleValue)}less(){return this.stateValue.length<this.ruleValue}less_or_equal(){return this.stateValue.length<=this.ruleValue}greater(){return this.stateValue.length>this.ruleValue}greater_or_equal(){return this.stateValue.length>=this.ruleValue}between(){return this.ruleValue.every((e=>-1!==this.stateValue.indexOf(e)))}},Fera.Conditions_Comparison_Param=class extends Fera.Conditions_Comparison_String{constructor(e,t,r){super(e,t.value,r)}},Fera.Conditions_Rule=class{constructor(e,t={}){this._opts=t,this.rule=e,this.atomic=!0,this.comparisonClass=this._determineComparisonClass()}isTrue(e){let t=e.fetchValue(this.rule.field,this.rule.value);return null!=t&&new this.comparisonClass(t,this.rule.value,this.rule.operator).isTrue()}debug(e){let t=e.fetchValue(this.rule.field,this.rule.value);return`(${this.rule.field}: ${JSON.stringify(t)} ${this.rule.operator} ${JSON.stringify(this.rule.value)})`}_determineComparisonClass(){switch(this.rule.type){case"string":return this.rule.field.match(/_param$/)&&"object"==typeof this.rule.value?Fera.Conditions_Comparison_Param:Fera.Conditions_Comparison_String;case"array":return Fera.Conditions_Comparison_Array}return Fera.Conditions_Comparison}},Fera.Conditions_Group=class{constructor(e,t={}){this._opts=t,this.conditions=e,this.rules=this.conditions.rules.map((e=>e.condition?new this.constructor(e):new Fera.Conditions_Rule(e))),this.separator=this.conditions.condition}isTrue(e){return!this.rules||this.rules.length<1||("AND"==this.separator?this.rules.every((t=>t.isTrue(e))):this.rules.some((t=>t.isTrue(e))))}debug(e){return this.rules.map((t=>t.atomic?`${t.debug(e)}=${t.isTrue(e)}`:`(${t.debug(e)})=${t.isTrue(e)}`)).join(` ${this.separator} `)}},Fera.Conditions_State=class{constructor(e,t={}){this._opts=t,this.data=e,this.data.product=this.data.product||{},this.data.cart=this.data.cart||{}}fetchValue(e,t){let r=this.data.current_page.url.toLowerCase();switch(e){case"shopper_country_code":return this.data.location.country_code;case"shopper_country_name":return this.data.location.country_name;case"shopper_city":return this.data.location.city;case"shopper_region_code":return this.data.location.region_code;case"shopper_region_name":return this.data.location.region_name;case"shopper_time_zone":return this.data.location.time_zone;case"shopper_continent":return this.data.location.continent;case"shopper_from_gdpr":return-1!==this.constructor.GDPR_COUNTRY_CODES.indexOf(this.data.location.country_code);case"shopper_not_from_gdpr":return-1===this.constructor.GDPR_COUNTRY_CODES.indexOf(this.data.location.country_code);case"cart_total":return this.data.cart.total;case"cart_item_count":return this.data.cart.item_count;case"cart_total_weight":return this.data.cart.total_weight;case"cart_item_product_ids":return this.data.cart.items.map((e=>e.product_id));case"cart_item_names":return this.data.cart.items.map((e=>e.name));case"cart_item_variant_ids":return this.data.cart.items.map((e=>e.variant_id));case"request_url":return r;case"request_title":return this.data.current_page.title.toLowerCase();case"request_referrer":return this.data.current_page.referrer.toLowerCase();case"request_url_param":return this._getUrlParamValue(r,t);case"shopper_total_interaction_time":return this.data.interaction_time;case"shopper_time_since_first_seen":return this.data.time_since_first_seen;case"shopper_session_time":return this.data.session_time;case"shopper_time_on_current_page":return this.data.time_on_current_page;case"shopper_inactive_time_on_current_page":return this.data.inactive_time_on_current_page;case"is_mobile":case"is_not_mobile":return this.constructor.isUserAgentMobile()?1:0;case"product_id":return this.data.product_id;case"product_exists":return!!this.data.product_id;case"product_tags":return this.data.product.tags;case"product_name":return this.data.product.name}return null}_getUrlParamValue(e,t){let r=e.split("?")[1]||"";if(void 0===t.value)return r;{let e=r.split("&").find((e=>e.split("=")[0]==t.param));return e?e.split("=")[1]:""}}static isUserAgentMobile(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}static get GDPR_COUNTRY_CODES(){return["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"]}},Fera.Conditions_Evaluator=class{constructor(e,t,r={}){this._opts=r,this.group=new Fera.Conditions_Group(e,this._opts),this.state=new Fera.Conditions_State(t,this._opts)}isTrue(){return this.group.isTrue(this.state)}debug(){return this.group.debug(this.state)}},Fera.AbTests=Fera.AbTests||{},Fera.AbTests.Manager=class{constructor(e){this._opts=e,this._storage=new Fera.LocalStorageJar("Fera.AbTests"),this._changed=!1,this._loadBuckets()}updateBuckets(e){if(e)return Object.keys(e).forEach((t=>{if(void 0!==this.buckets[t])return;let r;r=!!this._opts.app.opts.isAdminMode()||("boolean"==typeof e[t].on?e[t].on:e[t].next_bucket_on),this.updateBucket(t,r)})),this._expireBuckets(),this.save()}reset(){this.buckets={},this._changed=!0,this.save()}updateBucket(e,t){this.buckets[e]={on:t,expires:(new Date).getTime()+9e5},this._changed=!0}onFor(e){return this._expireBuckets(),void 0===this.buckets[e]||this.buckets[e].on}present(){return this._expireBuckets(),Object.keys(this.buckets).length>0}getBuckets(){if(!this.buckets||this.buckets=={}||"object"!=typeof this.buckets)return{};let e={};return Object.keys(this.buckets).forEach((t=>{var r=this.buckets[t];e[t]="boolean"==typeof r?r:r.on})),e}save(){return!!this._changed&&(this._storage.setObject("buckets",this.buckets),this._changed=!1,!0)}_expireBuckets(e=!0){return Object.keys(this.buckets).forEach((e=>{this.buckets[e].expires<(new Date).getTime()&&(delete this.buckets[e],this._changed=!0)})),e&&this._changed&&this.save(),this}_loadBuckets(){return this.buckets=this._storage.getObject("buckets",{}),Object.keys(this.buckets).forEach((e=>{if("object"!=typeof this.buckets[e]){let t=this.buckets[e];this.updateBucket(e,t)}})),this._changed&&this.save(),this.buckets}},Fera.Preview_Api=class extends Fera.Api{checkConfig(){return!0}waitForApiConfig(e){return e(!0)}validConfig(){return!0}checkIn(e,t={}){return t.callback&&t.callback()}mergeShoppers(e,t){return!0}pushEvent(e,t={}){let r=t.callback||t.then||(()=>{});return this._opts.testMode&&this._opts.logger.warn("[TEST MODE] Not pushing event to the api because test mode is enabled, but the rest of the JS will think we did.",e),r(!1)}getContent(e,t,r){this._app.previewer.getContent((r=>{let i=JSON.parse(e.content_requests_json).find((e=>"global_bottom"===e.container_type));if(i)this._globalBottomContainer=this._$.extend({},i);else{if(!this._globalBottomContainer)return t({});i=this._$.extend({},this._globalBottomContainer)}if(!r)return Fera.logger.warn("Fera preview API hit getContent callback without displayerResponse. There may be a problem."),t({});r.isPreview=!0,i.abstract_blocks=[r];let n={compiled_css:r.css,content_responses:[i],store:r.store};t(n)}))}},Fera.Preview_State=class extends Fera.State{getData(e){if(this._app.previewer)this._app.previewer.getState(e);else{let t=setInterval((()=>{this._app.previewer&&(clearInterval(t),this.getData(e))}),100)}}},Fera.ShopifyAdapter=function(e){var t=this,r=Fera.Util.$();e=e||{};var i=[];this.cartAdapter=new Fera.ShopifyCartAdapter(e);var n=function(){e.logger.log("Shopify adapter initialized."),g(),l(),m(),t.variantLoader=new Fera.VariantLoader(e),o()?s():(c(),setInterval((function(){c()}),250)),a()},a=function(){"undefined"!=typeof Shopify&&Shopify.designMode&&e.app.setDesignMode(!0)};this.formatCurrency=function(e){if("undefined"==typeof Shopify||!Shopify||!Shopify.currency||!Shopify.currency.rate||"undefined"==typeof theme||!theme.moneyFormat&&!theme.strings.moneyFormat)return null;var t=parseFloat(Shopify.currency.rate)*e,r=theme.moneyFormat;theme.moneyFormat||(r=theme.strings.moneyFormat);var i=r.replace(/{{[ ]?amount[ ]?}}/,t.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));return i=(i=i.replace(/{{[ ]?amount_no_decimals[ ]?}}/,Math.round(t).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(/^(.+)\.00$/,"$1"))).replace(/{{[ ]?amount_with_comma_separator[ ]?}}/,t.toFixed(2).toString().replace(".",","))};var o=function(){if(-1!==window.location.toString().indexOf("/password"))return!0;var e=r('link[rel="canonical"]').attr("href");return!(!e||-1===e.indexOf("/password"))},s=function(){if(e.app.opts.sandboxMode)return r('a[href="/admin"]').on("click",(function(e){e.preventDefault(),alert("Please enter your storefront password instead. You can find it at YOUR_STORE_URL/admin/online_store/preferences.")})),setTimeout((function(){var e=r('a[href="#LoginModal"],.password__open-modal');e.length<=0||Fera.Util.scrollToElement(e,{callback:function(){e.fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}})}),1e3),!0},l=function(){-1!==window.location.toString().indexOf("/checkouts/")&&r('<div class="banana-container banana-cart-container banana-order-top-container fera-order-top-container" data-container_type="cart"></div>').insertAfter(".breadcrumb")},c=function(){u(),d()},u=function(){r('form[action~="/cart/add"] button[type=submit],form[action~="/cart/add"] input[type=submit],.product-form__cart-submit,.add-to-cart, .addToCart, .add_to_cart, #addToCart, #add-to-cart, #add_to_cart, .add-to-cart input.button,.btn-addtocart').each((function(){var t=r(this);if(t.data("Fera.listenersBound"))return!0;if(t.length<=0)e.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");else{var i=h(t.parents("form"));t.on("click touch",(function(){f(i)})),t.data("Fera.listenersBound",!0)}}))},d=function(){r('form[action~="/cart/add"]').each((function(){var t=r(this);if(t.data("Fera.listenersBound"))return!0;if(t.length<=0)e.logger.warn("Fera did not find the add to cart form.");else{var i=h(t);t.on("submit",(function(){f(i)})),t.data("Fera.listenersBound",!0)}}))},p=function(e){return e&&e.length>0&&!e.match(/\D/)?e:null},h=function(e){var t=p(e.data("productid"))||p(e.data("product-id"))||p(e.find("[data-productid]").data("productid"))||p(e.find("[data-product-id]").data("product-id"));if(!t){var r=e.attr("id");r&&(r=r.split("_").pop()),t=p(r)}var i=p(e.find('[name="id"]').val()),n={};return i&&(n.variant_id=i),t&&(n.product_id=t),n!={}&&Fera.logger.log("Located product/variant event data for click: ",n),n},f=function(t){for(var r=0;r<i.length;r++)if(i[r].variant_id===t.variant_id&&i[r].product_id===t.product_id)return;i.push(t),e.app.pushAddToCartEvent(t),setTimeout((function(){for(var e=0;e<i.length;e++)if(i[e].variant_id===t.variant_id&&i[e].product_id===t.product_id){i.splice(e,1);break}}),1e3)},m=function(){if("undefined"!=typeof Shopify&&Shopify.theme&&Shopify.theme.name){var e=Shopify.theme.name.toLowerCase();-1===e.indexOf("boundless")&&-1===e.indexOf("narrative")||Fera.Util.isHome()&&(r("body").addClass("fera-themeWithFixedHeader fera-themeWithFixedHeader--adjust"),-1!==e.indexOf("narrative")&&r(".site-header--homepage").addClass("fera-themeWithFixedHeader--adjust"))}},g=function(){if("undefined"!=typeof Shopify&&Shopify.locale)e.app.setLocale(Shopify.locale);else{var t=document.getElementById("shopify-features");if(!t)return;(t=JSON.parse(t.innerHTML)).locale&&e.app.setLocale(t.locale)}};n()},Fera.ShopifyAdapter.generateProductDataAttribute=function(e){try{var t={id:e.id,name:e.title,variants:[]};"string"==typeof e.images?t.thumbnail_url=e.images:void 0!==e.image&&("string"==typeof e.image?t.thumbnail_url=e.image:"object"==typeof e.image&&"string"==typeof e.image.src&&(t.thumbnail_url=e.image.src));for(var r=0;r<e.variants.length;r++){var i=e.variants[r],n={name:i.title,stock:i.inventory_quantity,inventory_policy:i.inventory_policy,manages_stock:i.inventory_management&&""!==i.inventory_management};i.image&&i.image.src&&(n.thumbnail_url=i.image.src),t.variants.push(n)}return encodeURI("0617-"+Fera.Util.encode(JSON.stringify(t)))}catch(e){return console.error(e.message,e),null}
},Fera.ShopifyCartAdapter=function(e){var t=this,r=Fera.Util.$(),i=function(){n(),a()},n=function(){r(document).on("ajaxComplete",(function(t,r,i){if(!(r.status>=300)&&e.app.cart)if(i&&-1!==i.url.indexOf("/cart.js"))e.app.cart.loadCartData(JSON.parse(r.responseText));else if(i&&/\/cart\/(add|update|clear|change)/.test(i.url)){var n=JSON.parse(r.responseText);-1===i.url.indexOf("/cart/add")||n.items?e.app.cart.loadCartData(n):e.app.cart.loadItemData(n),e.app.updateAllContainers()}}))},a=function(){-1!==window.location.toString().indexOf("/thank_you")&&e.app.cart&&e.app.cart.reset()};t.startCheckout=function(){var e=Fera.Util.updateURLParameter(window.location.toString(),"ensure_loaded_cart","0");e=Fera.Util.updateURLParameter(e,"go_to_checkout","0"),window.location=e.replace("/cart","/checkout")},t.downloadData=function(e){r.getJSON("/cart.js",(function(t){"function"==typeof e&&e(t)}))},t.clear=function(e){r.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/cart/clear",complete:function(){"function"==typeof e&&e()}})},t.parseCartData=function(e){var t={},r=null;if(!e)return null;r=o(),t.item_count=e.item_count,"string"==typeof e.currency&&(t.currency=e.currency),t.total=e.total_price/r/100,t.total_weight=e.total_weight,t.total_discount=e.total_discount/r/100,t.items=[];for(var i=0;i<e.items.length;i++){var n=e.items[i];t.items.push({price:n.price/r/100,total:n.line_price/r/100,product_id:n.product_id,name:n.product_title,variant_id:n.variant_id,quantity:n.quantity})}return t},t.parseItemData=function(e){var t={},r=null;return e?(r=o(),t.price=e.price/r/100,t.total=e.line_price/r/100,t.product_id=e.product_id||e.id,t.name=e.product_title,t.variant_id=e.variant_id,t.quantity=e.quantity,t.weight=e.grams,t.total_discount=e.total_discount/r,t):null};var o=function(){return Shopify&&Shopify.currency&&Shopify.currency.rate?parseFloat(Shopify.currency.rate):parseFloat("1.0")};t.removeProduct=function(t,i,n){var a={},o=(e.app.cart.getData()||{}).items;if(!o)return!1;var s=0;i&&(s=i.quantity||0);for(var l=0;l<o.length;l++){var c=o[l];if(c.product_id==t){if(i){if(i.variant_id&&c.variant_id!=i.variant_id)continue;if(i.quantity){if(!(s>0))continue;if((s-=c.quantity)<0){a[c.variant_id]=0-s;break}}}a[c.variant_id]=0}}return 0!==Object.keys(a).length&&(r.ajax({method:"POST",type:"POST",data:{updates:a},dataType:"json",url:"/cart/update.js",complete:n.afterAdd||n.then||function(){}}),!0)},t.addProduct=function(e,t,i){var n={id:t.variant_id||t.variant||t.variantId,quantity:t.quantity||1};r.ajax({method:"POST",type:"POST",data:n,dataType:"json",url:"/cart/add.js",complete:function(){var t=arguments;s(e,(function(){(i.afterAdd||i.then||function(){}).apply(this,t)}))}})};var s=function(t,r){if(e.app.cart.getProductQuantity(t)>=1)return r();setTimeout((function(){e.app.cart.update((function(){s(t,r)}),!1)}),500)};i()},Fera.BigcommerceAdapter=function(e){var t=this,r=Fera.Util.$();e=e||{};var i,n=null,a=function(){t.cartAdapter=new Fera.BigcommerceCartAdapter(e),w(),b(),l(),y(),d(),o()},o=function(){if(s())return!0;var t=window.location.toString();if(r("#checkout-app").length>0)return e.app.setSection("checkout"),!0;Fera.Util.isHome()?e.app.setSection("home"):-1!==t.indexOf("cart.php")?e.app.setSection("cart"):-1!==t.indexOf("finishorder")?e.app.setSection("order_complete"):r(".banana-view-container").length>0?e.app.setSection("product_view"):r(".banana-list-container").length>0?e.app.setSection("product_list"):-1!==t.indexOf("checkout")&&e.app.setSection("checkout")},s=function(){var t=r("script").toArray().find((function(e){return e.innerHTML&&-1!==e.innerHTML.indexOf('window.stencilBootstrap("')}));if(t){let r=t.innerHTML.match(/window\.stencilBootstrap\("([a-zA-Z_-]+)"/);if(r){let t={default:"home",cart:"cart",product:"product_view",category:"product_list"}[r[1]];if(t)return e.app.setSection(t),!0}}return!1},l=function(){e.params&&e.params.dynamically_integrate&&(-1!==e.params.dynamically_integrate.indexOf("product_view")&&f(),-1!==e.params.dynamically_integrate.indexOf("product_list")&&u(),-1!==e.params.dynamically_integrate.indexOf("cart_top")&&c())},c=function(){var e='<!-- BEGIN Fera.ai Shopping Cart Top Container --> <div class="banana-container banana-cart-container" data-container_type="cart" ></div> <!-- END -->';if(!(r(".banana-cart-container").length>0))if(-1!==window.location.toString().indexOf("/cart.php")){var t=r(".cart-container");t.length>0?t.each((function(){r(e).prependTo(r(this))})):r(e).insertAfter(r("h1,.page-title,.page-heading").first())}else-1===window.location.toString().indexOf("checkout")&&r(e).prependTo(r(".optimizedCheckout-contentPrimary"))},u=function(){var e='<!-- BEGIN Fera.ai Product List Bottom Container --> <div class="banana-container banana-list-container" data-product_id="#{product_id_code}" data-container_type="list"></div> <!-- END -->';if(h(e))return!0;r(".productGrid article, .product-grid-container article").each((function(){var t=r(this),i=t.find("[data-product-id]").first().data("product-id");if(i&&""!==i||t.find("a").each((function(){var e=r(this).attr("href");e&&-1!==e.indexOf("product_id=")&&(e.match(/.+(product_id|product-id|productId)=(.+).*/i)&&(i=e.match(/.+(product_id|product-id|productId)=(.+).*/i)[2]))})),i&&""!==i){var n=e;n=n.replace("#{product_id_code}",i),r(n).appendTo(t)}}))},d=function(){r(document).on("ajaxComplete",(function(e,t){try{if(!t)return;var r=JSON.parse(t.responseText);t&&r&&r.productListing&&u()}catch(e){}}))},p=function(){return r(".product-grid *").contents().filter((function(){return 8===this.nodeType&&-1!==this.nodeValue.indexOf("snippet location product_rating")}))},h=function(e){var t=p();if(t.length<1)return!1;var i=!1;return t.each((function(){var t=r(this),n=t.parents(".product-item").find("[data-product-id]").data("productId");if(n&&""!==n){var a=e.replace("#{product_id_code}",n);t.after(a),r(a).appendTo(t),i=!0}})),i},f=function(){var e='<!-- BEGIN Fera.ai Product View Container --> <div class="banana-container banana-view-container" data-product_id="#{product_id_code}" data-container_type="view"></div> <!-- END -->';if(g(e))return!0;i.length>0?_(e):v(e)},m=function(){return r(Fera.Util.ie()?"body":"*").contents().filter((function(){return 8===this.nodeType&&-1!==this.nodeValue.indexOf("snippet location product_addtocart")}))},g=function(e){var t=m();if(t.length<1)return!1;var i=!1;return t.each((function(){var t=r(this),n=t.parents("form").find("[data-product-id]").val();if(n&&""!==n){var a=e.replace("#{product_id_code}",n);t.after(a),r(a).appendTo(t),i=!0}})),i},v=function(t){for(var i=0;i<n.length;i++){var a=n[i],o=a.find("input[name=product_id]").val();"product_view"!=e.app.getSection()||e.app.getProductId()||e.app.setProductId(o);var s=t;s=s.replace("#{product_id_code}",o),r(s).appendTo(a)}},_=function(t){for(var n=0;n<i.length;n++){var a=i[n],o=a.attr("action").match(/.*product_id=([0-9]+).*/)[1],s=t;"product_view"!=e.app.getSection()||e.app.getProductId()||e.app.setProductId(o),s=s.replace("#{product_id_code}",o),r(s).insertAfter(a)}},w=function(){return null!=n||(n=[],r("form[action]").each((function(){var e=r(this);-1!==e.attr("action").indexOf("cart.php")&&n.push(e)}))),n},b=function(){return null!=i||(i=[],r("form[action]").each((function(){var e=r(this);-1!==e.attr("action").indexOf("wishlist.php?action=add")&&i.push(e)}))),i},y=function(){for(var t=0;t<n.length;t++){var r=n[0].find('#form-action-addToCart, input[type="submit"]');if(r.length<=0)return void e.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");r.on("click touch",(function(){e.app.pushAddToCartEvent()}))}};a()},Fera.BigcommerceCartAdapter=function(e){var t=this,r=Fera.Util.$(),i=function(){n(),o(),a()},n=function(){r(document).on("ajaxComplete",(function(t,r,i){r.status>=300||i&&-1!==i.url.indexOf("/cart.php")||i&&-1!==i.url.indexOf("/remote/v1/cart/")&&setTimeout((function(){e.app.cart.update()}),500)}))},a=function(){r(window).on("load",(function(){var t=document.querySelector("[data-cart-content]");if(t&&"undefined"!=typeof MutationObserver){var r={attributes:!0,childList:!0,characterData:!0};new MutationObserver((function(){e.app.cart.update(!0)})).observe(t,r)}}))},o=function(){-1!==window.location.toString().indexOf("/order-confirmation")&&e.app.cart.reset()};t.startCheckout=function(){var e=Fera.Util.updateURLParameter(window.location.toString(),"ensure_loaded_cart","0");e=Fera.Util.updateURLParameter(e,"go_to_checkout","0"),window.location=e.replace("/cart","/checkout")},t.removeProduct=function(e,i,n){return r.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/api/storefront/cart",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",u())},complete:function(r){Fera.logger.log("Removing product...",r);var a=JSON.parse(r.responseText)[0];if(a){var o=[],l="",c=0;i&&(c=i.quantity||0);for(var u=0;u<a.lineItems.physicalItems.length;u++){var d=a.lineItems.physicalItems[u];if(d.productId==e)if(i&&i.quantity){if((c-=d.quantity)<=0){c<0&&(l=d.productId),o.push(d.id);break}}else o.push(d.id)}s(a.id,o,l?function(){i.quantity=0-c,t.addProduct(l,i,n)}:n.then)}else"function"==typeof n.then&&n.then()}}),!0},t.clear=function(e){r.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/api/storefront/cart",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",u())},complete:function(t){Fera.logger.log("Clearing cart...",t);var r=JSON.parse(t.responseText)[0];if(r){for(var i=[],n=0;n<r.lineItems.physicalItems.length;n++){var a=r.lineItems.physicalItems[n];i.push(a.id)}s(r.id,i,e)}else"function"==typeof e&&e()}})};var s=function(e,t,r){if(t.length<1)"function"==typeof r&&r();else{var i=t.shift();l(e,i,(function(){setTimeout((function(){return s(e,t,r)}),100)}))}},l=function(e,t,i){r.ajax({method:"DELETE",type:"DELETE",data:{},dataType:"json",url:"/api/storefront/carts/"+e+"/items/"+t,beforeSend:function(e){e.setRequestHeader("x-xsrf-token",u())},complete:i})};t.downloadData=function(e){r.getJSON("/api/storefront/carts",(function(t){t&&t[0]?e(t[0]):e(null)}))},t.parseCartData=function(e){var r={};if(!e)return null;if(e.items)return c(e);!e.lineItems&&e[0]&&e[0].lineItems&&(e=e[0]),r.item_count=e.lineItems.physicalItems.length,r.currency=e.currency.code,r.total=e.cartAmount,r.total_discount=e.discountAmount,r.items=[];for(var i=0;i<e.lineItems.physicalItems.length;i++){var n=e.lineItems.physicalItems[i];r.items.push(t.parseItemData(n))}return r};var c=function(e){var t={};if(!e)return null;t.item_count=e.quantity,t.currency=e.currency,t.total=e.total?e.total.value:0,t.grand_total=e.grand_total?e.grand_total.value:0,t.total_discount=e.discount,t.items=[];for(var r=0;r<e.items.length;r++){for(var i=e.items[r],n=[],a=0;a<i.options.length;a++)n.push(i.options[a].id);t.items.push({price:i.price.value,total:i.total.value,product_id:i.product_id,name:i.name,variant_id:n,quantity:i.quantity})}return t};t.parseItemData=function(e){return e?{price:e.salePrice,total:e.salePrice*e.quantity,product_id:e.productId,name:e.name,variant_id:e.variantId,quantity:e.quantity}:null};var u=function(){var e=("; "+document.cookie).split("; XSRF-TOKEN=").pop().split(";")[0],t="";return BCData&&BCData.csrf_token&&(t=BCData.csrf_token),e||t};t.addProduct=function(e,t,r){var i={action:"add",product_id:e,qty:[1]};if(t){if(t.variant_id&&-1!==t.variant_id.indexOf("=")){i.attribute={};for(var n=t.variant_id.split("&"),a=0;a<n.length;a++){var o=n[a].split("=");i.attribute[o[0]]=o[1]}}i.qty=[t.quantity||1]}d(i,r)};var d=function(e,t){e.attribute?p(e,t):r.ajax({method:"GET",type:"GET",url:"/products.php?productId="+e.product_id,error:function(){p(e,t)},success:function(i){var n=!1;r(i).find('form[action*="cart.php"]').each((function(){var i={};if(r(this).serializeArray().forEach((function(e){"qty[]"!==e.name&&(i[e.name]=e.value)})),n=i.product_id==e.product_id)return p(r.extend(i,e),t),!1})),n||p(e,t)}})},p=function(e,t){t=t||{},r.ajax({method:"POST",type:"POST",data:e,dataType:"json",url:"/remote/v1/cart/add",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",u())},complete:t.afterAdd||t.then||function(){}})};i()},Fera.MagentoAdapter=function(e){var t,r,i=Fera.Util.$();e=e||{};var n=function(){e.debugMode&&console.log("Magento adapter initialized."),t=i('form[action*="cart/add"]'),s(),o(),a()},a=function(){var t=i("html").attr("lang");t&&e.app.setLocale(t)},o=function(){var e='<!-- BEGIN Fera.ai Shopping Cart Top Container --> <div class="banana-container banana-cart-container" data-container_type="cart" ></div> <!-- END -->';if(!(i(".banana-cart-container").length>0)&&-1!==window.location.toString().indexOf("/checkout")){var t=i(".cart-container");t.length>0?t.each((function(){i(e).prependTo(i(this))})):i(e).insertAfter(i("h1,.page-title,.page-heading").first())}},s=function(){(r=t.find('input[type="submit"],.addToCart,.btn-addToCart,.addToCartBtn,.btn-cart,.btn-add,.addToCart-btn,.add-btn,button[class*="add"],a[onclick="productAddToCartForm.submit(this)"],a[onclick="productAddToCartForm.submit(this)"],#product-addtocart-button,button[title*="Add"]')).length<1?e.logger.logWarning("Fera did not find the add to cart button so it will not be enabled for add to cart events."):r.on("click touch",(function(){e.app.pushAddToCartEvent()}))};n()},Fera.CustomAdapter=function(e){Fera.Util.$();e=e||{},e.debugMode&&console.log("Custom adapter initialized.")},Fera.WixAdapter=function(e){var t=this,r=Fera.Util.$();e=e||{};window.location.href;var i=function(){e.logger.log("Wix adapter initialized."),a(),m(),s(),o(),u(),d()},n=function(){m(),o(),"product_view"!=e.app.getSection()&&e.app.setProductId(null),u(),p()},a=function(){try{var r=document.getElementById("wix-viewer-model").textContent,i=JSON.parse(r).language.siteLanguage;i&&e.app.setLocale(i)}catch(e){Fera.logger.log("Failed to determine site language",t,e)}},o=function(){var t=window.location.href;Fera.Util.isHome()?e.app.setSection("home"):-1!==t.indexOf("/cart-page")?e.app.setSection("cart"):-1!==t.indexOf("/product-page/")||r("[data-hook=product-page]").length>0?e.app.setSection("product_view"):-1!==t.indexOf("/shop")||r("[data-hook=product-list]").length>0?e.app.setSection("product_list"):-1!==t.indexOf("/checkout")?e.app.setSection("checkout"):e.app.setSection("other")},s=function(e){-1===window.location.href.indexOf("/product-page/")&&0===r("[data-hook=product-page]").length||l(e)||c(e)},l=function(t){var r,i,n=document.getElementById("wix-warmup-data");if(!n)return!1;try{if(r=JSON.parse(n.textContent).appsWarmupData,Object.keys(r).length<1)return!1}catch(e){return!1}for(var a=0;a<2;a++)r=r[Object.keys(r)[0]];try{i=r.catalog.product.id}catch(e){return!1}return!!i&&(e.app.setProductId(i),t&&t(),!0)},c=function(t){var r={product_handle:window.location.href};e.app.api.getProducts(r,(function(r){var i=r[0];i&&i.platform_product_id&&(e.app.setProductId(i.platform_product_id),e.app.forceRefreshContent()),t&&t()}),(function(e,t,r){Fera.logger.error("Failed to determine Product ID: ",t,r)}))},u=function(){r('button[data-hook="add-to-cart"]').each((function(){var t=r(this);if(t.data("Fera.listenersBound"))return!0;if(t.length<=0)Fera.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");else{var i={product_id:e.app.getProductId()};t.on("click touch",(function(){e.app.pushAddToCartEvent(i)})),t.data("Fera.listenersBound",!0)}}))},d=function(){window.wixDevelopersAnalytics.register("c9064755-5cc8-4faf-a5a6-41a0150a6640",((t,r)=>{if(Fera.logger.log("Got wix event",t,r),"productPageLoaded"==t)e.app.setProductId(r.productId),Fera.logger.log("Set product to",r.productId);else if("AddProductImpression"==t);else{if("PageView"!=t)return;n()}}))},p=Fera.Util.debounce((()=>e.app.forceRefreshContent()),500),h=function(){var e=[];return r('a[data-hook="product-item-container"]').each((function(){var t=r(this).attr("href");e.push(t)})),e},f=function(e){r('[data-hook="product-item-root"]').each((function(){var t=r(this),i=t.find('a[data-hook="product-item-container"]').attr("href"),n=e.find((function(e){return e.url.replace(/^https?:\/\//,"")==i.replace(/^https?:\/\//,"")}));n&&t.attr("data-product-id",n.platform_product_id).attr("data-fera-context",!0)}))},m=function(t){var r=h();if(!(r.length<1)){var i={product_handles:r.join(",")};e.app.api.getProducts(i,(function(e){f(e),t&&t()}),(function(){Fera.logger.error("Failed to fetch Product IDs")}))}};i()},Fera.WixCartAdapter=function(){Fera.Util.$();(function(){})()};try{var loadFera=function(){window.fera&&window.fera.version||(window.fera=window.fera||[],window.__bsio&&(window.fera=window.fera.concat(window.__bsio)),window.fera=window.__bsio=new Fera.App({pushBuffer:window.fera,debugMode:window.feraDebugMode||window.__bsioDebugMode||!1,showErrors:window.feraShowErrors,standaloneMode:window.feraStandaloneMode||window.__bsioStandaloneMode||!1,supportedPlatforms:["shopify","bigcommerce","magento","custom","wix"],parentWindow:window.opener?window.opener:window.parent&&window.parent.length>0&&window!==window.top?window.parent:null}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",loadFera):loadFera()}catch(e){if(window.feraDebugMode||window.__bsioDebugMode||window.feraShowErrors)throw e;window.console&&window.console.error(e)}