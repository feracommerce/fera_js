function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Fera=Fera||{},BananaStand=BananaStand||Fera;Fera.App=function(opts){this.version="2.2.11.0";var self=this,containers,config,api,currProductId,customerId,visitorId,platformAdapter,section,containerAutoUpdateTimer,contentUpdatesStarted=!1,isViewingProductPage=!1,pushedViewEvent=!1,showedDevGreeting=!1,pushMethodReady=!1,currProduct,compiledCss="",variantId;opts=opts||{};var updateRequestInProgress=!1,eventListeners={"timers.reset":[],"feeds.reset":[],"cart.emptied":[],"cart.changed":[],"cart.add":[],"variant.change":[],"product.change":[],"product.set":[],"widget.create":[],"widget.create:before":[],"widget.create:after":[],"widget.update":[],"notification.show":[],init:[],ready:[],"skill.create":[],"skill.create:before":[],"skill.create:after":[],"skill.update":[]},init=function(){(opts.app=self).parentWindow=opts.parentWindow,messageStatusToParent("fera_starting"),self.cookieJar=opts.cookieJar=new Fera.CookieJar,self.localStorage=opts.localStorage=new Fera.LocalStorageJar(opts),self.opts=opts.optionsParser=new Fera.OptionsParser(opts),parseModes(),self.logger=Fera.logger=opts.logger=new Fera.Logger(opts),self.timeTracker=opts.timeTracker=new Fera.TimeTracker(opts),self.engagementTracker=opts.engagementTracker=new Fera.EngagementRegistry(opts),self.abTests=new Fera.AbTests.Manager(opts),opts.optionsParser.hasUrlFlag("clear_cache")&&self.clearCache(),Fera.Util.ie()&&opts.logger.warn("Fera.ai is not optimized for Microsoft Internet Explorer. You should really update to a more modern browser!"),opts.logger.log("~~ Loaded app.js version "+self.version+" ~~"),waitFor$(function e(){self.geo=opts.geo=new Fera.Geo(opts),self.inactivityDetector=opts.inactivityDetector=new Fera.InactivityDetector({logger:opts.logger}),self.geo.getLocationInfo(function r(e){opts.shopperLocation=e,delete opts.shopperLocation.ip,loadSupportModules();var t=opts.sandboxMode?Fera.Admin_Preview_Api:Fera.Api;api=new t(opts),self.api=opts.api=api,loadPushBuffer({only:"configure"}),ensureVisitorId(),opts.visitorId=visitorId,ensureBodyContainersPresent(),loadPushBuffer({only:"loadPlatformAdapter"}),abortLoading()?loadAdmin(!1):(self.i18n=Fera.i18n=new Fera.I18n(opts),Fera.t=function(e){return Fera.i18n.t(e)},Fera.supportedLanguages=function(){return Fera.i18n.supportedLanguages()},Fera.customTranslate=function(e,t){return Fera.i18n.customTranslate(e,t)},self.cart=new Fera.Cart(opts),platformAdapter&&platformAdapter.cartAdapter&&self.cart.setAdapter(platformAdapter.cartAdapter),self.api.checkConfig()?(self.verifier=new Fera.Verifier(opts),loadContainers(),loadPushBuffer({except:["loadPlatformAdapter","configure"]}),api.waitForApiConfig(function n(){api.checkConfig()?(self.clickTracker=opts.clickTracker=new Fera.ClickRegistry(opts),contentUpdatesStarted||waitForSupportModules(function(){setTimeout(startServerUpdating,1)}),self.isReady=!0,self.trigger("init ready"),loadAdmin(!0)):loadAdmin(!1)})):loadAdmin(!1))},!0)})},abortLoading=function(){if(window.location.pathname&&(0===window.location.pathname.indexOf("/password")||"undefined"!=typeof Shopify&&Shopify.Checkout&&Shopify.Checkout.isOrderStatusPage))return Fera.logger.log("Intentionally aborted loading, likely due to a missing API key on the page."),self.aborted=!0;return self.opts.sandboxMode&&self.opts.sandboxError},loadAdmin=function(e){if(opts.adminMode){if((e=void 0===e||e)||opts.api.configure({api_url:decodeURIComponent(opts.cookieJar.getCookie("Fera.Admin.BaseApiUrl")),store_pk:opts.cookieJar.getCookie("Fera.Admin.Store.PublicKey")}),"undefined"!=typeof Fera.AdminPanel)return setupAdmin(e);var t="";-1!==opts.api.baseAppPath.indexOf("app.")?t+=opts.api.baseAppPath.replace("app.","cdn.")+"/js/fera.admin.js?v="+self.version:t=-1!==opts.api.baseAppPath.indexOf("ngrok.")||-1!==opts.api.baseAppPath.indexOf("localhost")||-1!==opts.api.baseAppPath.indexOf("test-")||-1!==opts.api.baseAppPath.indexOf("127.0.0.1")?opts.api.baseAppPath+"/assets/public/fera.admin.js?v="+self.version:"https://cdn.jsdelivr.net/gh/feracommerce/ferajs@"+self.version+"/dist/fera.admin.js";var n=opts.debugMode?1:900;new FeraCachedAsset({name:"Fera.Admin.Js",url:t,expiresIn:n}).load(function(){setupAdmin(e)})}},setupAdmin=function(e){try{opts.sandboxMode&&(messageStatusToParent("fera_admin_starting"),opts.app.previewer=opts.previewer=new Fera.AdminPreviewer(opts,e),self.parentWindow!==window.opener&&null!=self.parentWindow||(opts.adminPanel=new Fera.AdminPanel(opts),opts.adminPanel.managePreviewMode()));var t=opts.optionsParser.parseCheckIntegration();t&&new Fera.AdminIntegrationChecker(opts).check(t)}catch(n){if(opts.debugMode)throw n}},messageStatusToParent=function(e){try{var t=opts.api&&opts.api.baseAppPath?opts.api.baseAppPath:"*";opts.parentWindow&&opts.parentWindow.postMessage(JSON.stringify({methodName:"sandbox_previewer.status.update",params:{status:e}}),t)}catch(n){}};self.push=function(e,t){if(pushMethodReady){if(opts.debugMode)return _push(e,t);try{return _push(e,t)}catch(n){window.console&&!Fera.Util.ie()&&window.console.error(n)}}else opts.pushBuffer=opts.pushBuffer||[],opts.pushBuffer.push(e),t!==undefined&&opts.pushBuffer.push(t)},self.setSection=function(e){return section=e,self},self.getSection=function(){return section},self.dispatchEvent=function(e,t,n){n=n||function(){},containers.dispatchEvent(e,t,n)},self.loadPlatformAdapter=function(code,params){var _opts=opts||{};if(_opts.params=params,_opts.addToCartCallback=self.pushAddToCartEvent,-1!==opts.supportedPlatforms.indexOf(code)){var adapterKlass=eval("Fera."+Fera.Util.capitalizeFirstLetter(code)+"Adapter");platformAdapter=new adapterKlass(_opts)}else{if("function"!=typeof code)return opts.logger.logWarning("Unknown platform code supplied: '"+code+"'. Valid codes are: "+opts.supportedPlatforms.join(",")),self.loadPlatformAdapter("custom",params);platformAdapter=code(_opts)}},self.setProduct=function(e){var t=currProduct;return"undefined"!=typeof(currProduct=e).id&&self.setProductId(currProduct.id),isViewingProductPage=!0,t&&t!=currProduct&&(self.trigger("product.change",{old:t,"new":currProduct}),self.refreshContent()),!t&&currProduct&&self.trigger("product.set"),self},self.setProductId=function(e){var t=currProductId;return isViewingProductPage=!0,t!=(currProductId=e)&&(contentUpdatesStarted&&self.trigger("product.change",{old:{id:t},"new":{id:currProductId}}),self.getVariantId()&&t&&self.setVariantId(null,!1)),!t&&currProductId&&self.trigger("product.set"),self},self.getProductId=function(){return currProductId},self.getProduct=function(){return currProduct},self.setVariantId=function(e){var t=variantId;return variantId=e,t&&t!==variantId&&self.trigger("variant.change",{old:{id:t},"new":{id:variantId}}),self},self.showContentSubmission=function(e){return getContentSubmitter().show(e)},self.showContentSubmitter=self.showContentSubmission,self.showContentSubmit=self.showContentSubmission,self.getVariantId=function(){return variantId},self.setCart=function(e){return self.cart.loadCartData(e),self},self.setShopper=function(e){if(1024<Fera.Util.sizeOfParams(e))opts.logger.error("Error: parameter size is larger than 1024 bytes");else{var t=getShopperAttributes();opts.cookieJar.setCookieObject(shopperAttributesKey(),Object.assign({},t,e),1)}};var getShopperAttributes=function(){return opts.cookieJar.getCookieObject(shopperAttributesKey())},shopperAttributesKey=function(){return"Fera.App.currentShopper"};self.getVisitorId=function(){return visitorId},self.getShopperId=self.getVisitorId,self.pushOrder=function(e,t){var n;"undefined"!=typeof e.data?n=e:(n={type:"order_create"},"undefined"!=typeof e.order?n.data=e:n.data={order:e}),n.data.ab_tests=self.ab_tests,api.pushEvent(n,t)},self.pushConversion=self.pushOrderEvent=self.pushConversionEvent=self.pushOrder,self.setCustomerId=function(e){return customerId=e,self},self.getCustomerId=function(){return customerId},self.configure=function(e){config=e,api.configure(config)},self.pushAddToCartEvent=function(e){var t={type:"product_add_to_cart"};e&&(e.data?t.data=e.data:t.data=e),self.trigger("cart.add",e),self.pushEvent(t)},self.addProductToCart=function(e,t){platformAdapter&&"function"==typeof platformAdapter.addProductToCart&&platformAdapter.addProductToCart(e,t)},self.triggerWidget=function(e,t){containers.triggerSkill(e,t)},self.triggerSkill=self.triggerWidget,self.trigger=function(e,t){e=e.split(" ");for(var n=0;n<e.length;n++){var r=e[n],i=eventListeners[r]||[];/skill.\d+.(create|update)/.test(r)&&i.concat(eventListeners[r.replace(/skill.\d+./,"skill.")||[]]);for(var a=0;a<i.length;a++)i[a](t)}},self.on=function(e,t){e=e.split(" ");for(var n=0;n<e.length;n++){var r=e[n].trim();if(eventListeners[r])eventListeners[r].push(t);else if(/skill.\d+.(create|update)/.test(r))eventListeners[r]=[t];else{var i=Object.keys(eventListeners).join(", ");self.logger.warn("Invalid event code requested: '"+r+"'. Valid event codes are: "+i)}"ready"===r&&self.isReady&&self.trigger("ready")}},self.formatCurrency=function(e){if(!e)return"";if(e=parseFloat(e),platformAdapter&&platformAdapter.formatCurrency){var t=platformAdapter.formatCurrency(e);if(!1!==t&&null!=t)return t}var n=self.storeSettings.currency_template.replace(/{{[ ]?amount[ ]?}}/,e.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));return n=(n=n.replace(/{{[ ]?amount_no_decimals[ ]?}}/,Math.round(e).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(/^(.+)\.00$/,"$1"))).replace(/{{[ ]?amount_with_comma_separator[ ]?}}/,e.toFixed(2).toString().replace(".",","))},self.getState=function(e){if(!self.state){var t=opts.sandboxMode?Fera.Admin_Preview_State:Fera.State;self.state=new t(opts)}return self.state.getData(e)},self.updateContainers=function(n,r,i){var a={};r=r||function(){},void 0===n&&(n=!1);var e=$(".fera-view-container[data-product_id],.banana-view-container[data-product_id]");1===e.length&&e.data("product_id")&&(self.getProductId()||self.setProductId(e.data("product_id")));var t=loadContentRequestContexts();0<Object.keys(t).length&&(a.contexts=JSON.stringify(t)),self.getState(function(e){if(a.state=e,a.push_view_event=n,a.content_requests=void 0===i?containers.getContentRequest({defaultProductId:currProductId}):i,a.content_requests.length<1&&!n)return r();if(a.content_requests_json=JSON.stringify(a.content_requests),delete a.content_requests,pushedViewEvent||(a.push_view_event=!0,isViewingProductPage&&(a.associated_to="product"),pushedViewEvent=!0),updateRequestInProgress=!0,!opts.sandboxMode){var t=getShopperAttributes();t&&(a.shopper_attributes=t),loadCompiledCssFromCache(),!self.storeSettings&&self.localStorage.getObject("storeSettings")&&(self.storeSettings=self.localStorage.getObject("storeSettings",{}),containers.updateContentFromCache())}api.getContent(a,function(e){e&&(updateRequestInProgress=!1,self.displayDevGreeting(),updateCompiledCssFromServer(e),e.store&&(self.storeSettings=e.store,opts.sandboxMode||self.localStorage.setObject("storeSettings",self.storeSettings)),self.abTests.updateBuckets(e.ab_tests),containers.updateContent(e,currProductId,r))},function(){updateRequestInProgress=!1})})},self.clearCache=function(){new Fera.LocalStorageJar({namespace:"Fera.AssetCache"}).clear(),new Fera.LocalStorageJar({namespace:"BananaStand.AssetCache"}).clear(),new Fera.LocalStorageJar({namespace:"Fera.Cache"}).clear(),waitFor$(function e(){Fera.Util.$()('script[src*="fera.js"],script[src*="bananastand.js"]').each(function(){var e=this.src.replace("https://cdn.jsdelivr.net/gh/feracommerce/ferajs@latest/dist/","https://cdn.fera.ai/js/");e+=-1===e.indexOf("?")?"?":"&",e+="v="+self.version+"p",Fera.Util.$().ajax({method:"GET",type:"GET",url:e})})}),Fera.logger.log("CLEARED Fera cache.")};var loadContentRequestContexts=function(){var r={},i=[];$("[data-fera-container]").each(function(){var e=$(this),t=parseInt(e.data("fera-container")),n=e.data("product-id")||e.data("productId")||e.data("product_id");n&&(r[t]=r[t]||[],r[t].push(n),-1===i.indexOf(t)&&i.push(t))}),$(".banana-list-container").each(function(){var e=$(this),t=e.data("product-id")||e.data("productId")||e.data("product_id");t&&(r.list=r.list||[],r.list.push(t))});for(var e=0;e<i.length;e++)r[i[e]]=r[i[e]].sort();return r};self.markAllContainersAsDirty=function(){containers&&containers.markAllContainersAsDirty()};var _refreshContent=function(e){if(containers)return containers.markAllContainersAsDirty(),self.updateContainers(!1,e),self};self.refreshContent=Fera.Util.debounce(_refreshContent,1),self.updateAllContainers=self.refreshContent,self.clearSeenHistory=function(){containers.each(function(e){e.clearSeenHistory&&e.clearSeenHistory()})},self.getContainers=function(){return containers},self.getContainerById=function(e){return containers.getContainerById(e)},self.pushEvent=function(t,n){return self.getState(function(e){t.state=e,t.visitor_id=visitorId,"add_to_cart"===t.type&&(t.type="product_add_to_cart"),t.shopper_attributes=getShopperAttributes(),"function"==typeof t.callback&&n&&"function"!=typeof n.callback&&(n.callback=t.callback,delete t.callback),"object"==typeof t.data&&"function"==typeof t.data.callback&&n&&"function"!=typeof n.callback&&(n.callback=t.data.callback,delete t.data.callback),api.pushEvent(t,n)}),self},self.checkIn=function(e,t){e=e||{};var n={callback:t||e.callback};api.checkIn(e,n)},self.getCurrentShopperId=function(e){return e&&"function"==typeof e.callback?e.callback(visitorId):visitorId},self.displayDevGreeting=function(){return!showedDevGreeting&&(!(!window.console||Fera.Util.ie())&&((!self.opts.feraParams||!self.opts.feraParams.quiet)&&(!self.localStorage.getItem("DevGreeting.shown",!1)&&((opts.debugMode?opts.logger.log:window.console.log)("\ud83d\udc4b Hello developer! We've optimized performance and encapsulated functionality to ensure our system never breaks anything. Shoot a message to dev"+String.fromCharCode(64)+"fera.ai if you've got any questions.\nLearn more about Fera @ https://fera.ai?dev=1\nHappy coding!\ud83d\udc4b"),self.localStorage&&self.localStorage.setItem("DevGreeting.shown",!0,9e5),showedDevGreeting=!0))))},self.getShopper=function(e){api.getShopper(visitorId,e)},self.deleteShopper=function(e){api.deleteShopper(visitorId,e)};var getContentSubmitter=function(){return self.contentSubmitter||(self.contentSubmitter=new Fera.ContentSubmission.Submitter(opts)),self.contentSubmitter},_push=function(e,t){var n,r="function"==typeof(n="object"==typeof e?e:{action:e,data:t,callback:"object"==typeof t?t.callback:undefined}).callback?n.callback:function(){};if("configure"==n.action)self.configure(n.data);else if("setCustomerId"==n.action)"string"==typeof n.customer_id||"number"==typeof n.customer_id?self.setCustomerId(n.customer_id):"string"==typeof n.id||"number"==typeof n.id?self.setCustomerId(n.id):void 0!==t?self.setCustomerId(t.id||t):opts.logger.error("Invalid syntax for method call setCustomerId: ",n);else if("setProduct"==e||"setCurrentProduct"==e)self.setProduct(t);else if("showContentSubmission"==e||"showContentSubmit"==e)self.showContentSubmission(t);else if("setProductId"===n.action)"string"==typeof t||"number"==typeof t?self.setProductId(t):n?"undefined"!=typeof n.product_id?self.setProductId(n.product_id):"undefined"!=typeof n.id?self.setProductId(n.id):"undefined"!=typeof n.data?"undefined"!=typeof n.data.product_id?self.setProductId(n.data.product_id):"undefined"!=typeof n.data.id?self.setProductId(n.data.id):self.setProductId(n.data):self.setProductId(null):opts.logger.error("Invalid syntax for method call setProductId: ",n);else if("setVariantId"===n.action)"string"==typeof t||"number"==typeof t?self.setVariantId(t):n?"undefined"!=typeof n.variant_id?self.setVariantId(n.variant_id):"undefined"!=typeof n.id?self.setVariantId(n.id):"undefined"!=typeof n.data?"undefined"!=typeof n.data.variant_id?self.setVariantId(n.data.variant_id):"undefined"!=typeof n.data.id?self.setVariantId(n.data.id):self.setVariantId(n.data):self.setVariantId(null):opts.logger.error("Invalid syntax for method call setVariantId: ",n);else if("getCurrentShopperId"==n.action||"getShopperId"==n.action)self.getCurrentShopperId(n.data);else if("triggerSkill"==n.action)self.triggerSkill(t.id||t.skill_id||t.widget_id||t.widgetId||t.skillId,t.data||t.optionalData||t.optional_data);else if("setCart"==n.action)self.setCart(n.cart||n.data||t||("object"==typeof t?t.cart:null));else if(-1!==["pushOrder","pushOrderEvent","order","orderEvent","conversion","conversionEvent","pushConversion","pushConversionEvent"].indexOf(e))self.pushOrder(t);else if(-1!==["pushAddToCart","pushAddToCartEvent","addToCart","add_to_cart","product_add_to_cart"].indexOf(e))self.pushAddToCartEvent(t);else if("pushEvent"==n.action||"event"==n.action)self.pushEvent(t);else if("loadPlatformAdapter"==n.action)"string"==typeof e&&"string"==typeof t?self.loadPlatformAdapter(t,{}):self.loadPlatformAdapter(n.code||n.adapter,n);else if("updateContainers"==n.action)self.updateContainers(!1,r);else if("startProductPageViewing"==n.action)self.startProductPageViewing(r);else if("dispatchEvent"==n.action)self.dispatchEvent(n.code,n.data,r);else if("getShopper"==n.action)self.getShopper(r);else if("deleteShopper"==n.action)self.deleteShopper(r);else if("on"===n.action)self.on(n.data.event,n.data.callback);else if("setShopper"==n.action){n.data||n.shopper;self.setShopper(n.data||n.shopper)}else self[n.action],self[n.action](n.data)},$=function(e){return Fera.Util.$()(e)},addBodyContainers=function(){0<document.getElementsByClassName("banana-globalBottom-container").length||$("body").append('<div class="banana-container banana-globalBottom-container" data-container_type="global_bottom" style="display: none;"></div>')},ensureBodyContainersPresent=function(){setInterval(addBodyContainers,10),addBodyContainers()},updateCompiledCssFromServer=function(e){if(e&&e.content_responses){var t=e.compiled_css;t&&(compiledCss.replace(/\s/gi,"").indexOf(t.replace(/\s/gi,""))&&(compiledCss=(compiledCss+" "+t).trim(),updateCompiledCss(compiledCss)),saveCompiledCssToCache(compiledCss))}},saveCompiledCssToCache=function(e){self.localStorage.setItem("Cache.CompiledCss",e,36e5)},loadCompiledCssFromCache=function(){if(self.opts.testMode||self.opts.adminMode||self.opts.previewMode)return!1;var e=self.localStorage.getItem("Cache.CompiledCss","");return!!e&&(updateCompiledCss(e),!0)},updateCompiledCss=function(e){var t=$("#feraCompiledCss");t.length<1&&(t=$('<span id="feraCompiledCss"></span>'),$("body").append(t)),t.html("<style>"+e+"</style>")},startServerUpdating=function(e){opts.logger.log("Starting server update timer..."),e=e||function(){},contentUpdatesStarted?opts.logger.log("startServerUpdating was already called, so returning..."):(startCheckIns(),contentUpdatesStarted=!0,self.updateContainers(!pushedViewEvent,e),self.on("cart.changed",function(){self.markAllContainersAsDirty()}))},startCheckIns=function(){var e=config.page_view_check_interval||3e5,t=e;setInterval(function(){(t-=1e3)<=0&&opts.inactivityDetector.isActive()&&(isViewingProductPage&&currProductId&&self.checkIn(),t=e)},1e3)},parseModes=function(){self.opts.debugMode=opts.debugMode=opts.optionsParser.parseDebugMode(),self.opts.testMode=opts.testMode=opts.optionsParser.parseTestMode(),self.opts.adminMode=opts.adminMode=opts.optionsParser.parseAdminMode(),self.opts.sandboxMode=opts.sandboxMode=opts.optionsParser.parseSandboxMode(),self.opts.showErrors=opts.showErrors=self.opts.debugMode||opts.optionsParser.parseShowErrors()},loadContainers=function(){(containers=new Fera.ContainerCollection(opts)).updateContainers=self.updateContainers,opts.contentUpdater=containers,opts.containers=containers},waitFor$=function(e){var t=0,n=10,r=100,i=!1;if(opts.standaloneMode)Fera.Util.addZepto(opts),i=!0,r+=1e3,n=1;else if(Fera.Util.hasValid$(!0))return e()
;opts.logger.log("Waiting for jQuery or Zepto to load...");var a=setInterval(function(){if(Fera.Util.hasValid$()&&(window.Zepto&&window.Zepto.expr&&window.Zepto.expr[":"]&&!window.Zepto.expr[":"].input&&(Zepto.expr[":"].input=function(){if("disabled"in this||"true"===this.contentEditable)return this}),clearInterval(a),e()),(t+=n)==r){if(i)throw clearInterval(a),"Fera requires jQuery or Zepto and neither or found or able to be dynamically loaded.";r+=1e3,Fera.Util.addZepto(opts),i=!0,opts.logger.log("Loading Zepto library because jQuery was not found within "+r+" milliseconds.")}},n)},loadPushBuffer=function(e){var t="undefined"!=typeof(e=e||{}).except&&e.except,n="undefined"!=typeof e.only&&e.only;if(opts.pushBuffer=opts.pushBuffer||[],pushMethodReady=!0,"object"==typeof opts.pushBuffer&&opts.pushBuffer.length&&0<opts.pushBuffer.length)for(var r=!1,i=0;i<opts.pushBuffer.length;i++)if(r)r=!1;else{var a=opts.pushBuffer[i];if(t){for(var o=!1,s=0;s<e.except.length;s++)if("string"==typeof a){if(a===e.except[s]){r=o=!0;break}}else if(a.action===e.except[s]){o=!0;break}if(o)continue}if("string"==typeof a){if(n&&a!==e.only)continue;self.push(a,opts.pushBuffer[i+1]),r=!0}else{if(n&&a.action!==e.only)continue;self.push(a)}}},ensureVisitorId=function(){self.visitorManager=new Fera.VisitorManager(opts),visitorId=self.visitorManager.ensureVisitorId()},loadSupportModules=function(){self.supportModules={instant_click:new Fera.InstantClickSupport(opts),shogun:new Fera.ShogunSupport(opts)}},allSupportModulesReady=function(){for(var e=Object.keys(self.supportModules),t=0;t<e.length;t++)if(!1===self.supportModules[e[t]].isReady)return!1;return!0},waitForSupportModules=function(e){if(allSupportModulesReady())return e();var t=0,n=setInterval(function(){if(allSupportModulesReady())return clearInterval(n),e();1e3===(t+=10)&&Fera.logger.warn("Support modules too longer than 1s to load and are blocking Fera from loading.")},10)};self.startProductPageViewing=function(){},self.setLocale=function(e){self.locale=e},init()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Api=function(){function n(e){var t=this;_classCallCheck(this,n),this._opts=e||{},this._$=Fera.Util.$(),this._config={},this._app=this._opts.app,this.requestFailCount=0,this._pageLoaded=!1,this._apiClientDescriptor="fera.js-"+this._opts.app.version,this._DEFAULT_BASE_URL="https://app.fera.ai",this._$(document).ready(function(){return t._pageLoaded=!0}),this._requestCache={}}return _createClass(n,[{key:"configure",value:function r(e){this._config=e;var t=this._opts.cookieJar.getCookie("Fera.Api.ServerNum",Math.random()<.5?1:2);this._opts.cookieJar.setCookie("Fera.Api.ServerNum",t,30);var n=1==t?"api.":"api2.";(!this._config.api_url||this._config.api_url.length<=0)&&(this._config.api_url=this._DEFAULT_BASE_URL.replace("//app.","//"+n)),this._config.api_url=this._config.api_url.replace("/api/v1/","/api/"),"/"!==this._config.api_url[this._config.api_url.length-1]&&(this._config.api_url=this._config.api_url+"/"),this.baseApiUrl=this._config.api_url,this.baseAppPath=this._config.api_url.replace(/^(https?:\/\/.*)\/api(\/v[0-9])?/i,"$1").replace(/(https?:\/\/)api[0-9]?\./i,"$1app.").replace(/\/$/,""),this.baseAppPath.match(/https?:\/\/app\./)?(this.baseCdnPath=this.baseAppPath.replace("app.","cdn."),this.baseFrontendPath=this.baseAppPath.replace("app.","www.")):(this._opts.debugMode?this.baseCdnPath=this.baseAppPath+"/cdn":this.baseCdnPath="https://cdn.fera.ai",this.baseFrontendPath="https://www.fera.ai")}},{key:"checkConfig",value:function e(){return!!this.validConfig()||(this._opts.logger.error("Missing Fera API key. This usually means the footer script is missing (usually because your store theme was changed by someone or something).\nTry navigating to "+this._DEFAULT_BASE_URL+"/installation?reinstall=1 to fix this or contact our support team for help."),!1)}},{key:"waitForApiConfig",value:function s(e){var t,n=this,r=1e4,i=0,a=1,o=function o(){return n.validConfig()?(t&&clearInterval(t),e(),!0):((i+=a)===r&&n._opts.logger.warn("Waited more than "+r/1e3+" seconds for Fera api credentials and still don't have them. Please contact our support team for help if this is unexpected."),!1)};o()||(t=setInterval(o,a))}},{key:"validConfig",value:function t(){return!(!this._config||!this._config.store_pk)}},{key:"checkIn",value:function a(e,t){var n=arguments.length<=1||t===undefined?{}:t,r="undefined"==typeof n.callback?function(){}:n.callback,i=JSON.parse(JSON.stringify(e));i.id=this._opts.visitorId,e.productId&&(i.product_id=e.productId,delete i.productId),e.customerId&&(i.customer_id=e.customerId,delete i.customerId),this._opts.testMode?this._opts.logger.warn("[TEST MODE] Not checking in because test mode is enabled, but the rest of the JS will think we did..",i):this._performImageRequest("check.gif",i,r)}},{key:"mergeShoppers",value:function i(e,t){return this._$.ajax({method:"POST",type:"POST",data:{},headers:{"API-CLIENT":this._apiClientDescriptor},dataType:"html",url:this._url("shoppers/"+e+"/merge",{other_id:t})})}},{key:"pushEvent",value:function o(e,t){var n=this,r=arguments.length<=1||t===undefined?{}:t,i=r.callback||r.then||function(){};"view"===e.type&&("undefined"!=typeof e.state.product_id&&(e.associated_to="product"),e.state=e.state||{},e.state.event_history=this._trackAndReturnHistory(e)),this._opts.testMode?this._opts.logger.warn("[TEST MODE] Not pushing event to the api because test mode is enabled, but the rest of the JS will think we did.",e):("object"==typeof e.state&&(e.state_json=JSON.stringify(e.state),delete e.state),"object"==typeof e.data&&(e.data_json=JSON.stringify(e.data),delete e.data),this._pageLoaded?this._sendEventData(e,i):this._$(document).ready(function(){return n._sendEventData(e,i)}))}},{key:"getFeeds",value:function u(t,n,e){var r=this;this._opts.testMode?(t.test_mode=this._opts.testMode,this._cachedTestFeedResponse?n(this._cachedTestFeed(t.types)):this._request("GET",this._url("feeds.json",t),function(e){r._cachedTestFeedResponse=e,n(r._cachedTestFeed(t.types))},e)):this._request("GET",this._url("feeds.json",t),n,e)}},{key:"_cachedTestFeed",value:function c(e){for(var t=[],n=0;n<this._cachedTestFeedResponse.length;n++)e&&!e.includes(this._cachedTestFeedResponse[n].type)||t.push(this._$.extend(!0,{},this._cachedTestFeedResponse[n]));return t}},{key:"getReviews",value:function l(e,i,t){var r=this;if(this._opts.testMode){e.test_mode=this._opts.testMode,e.page=e.page||1,e.limit=e.limit||5;var a=e.page+"x"+e.limit;if(this._cachedTestReviewResponse&&this._cachedTestReviewResponse[a])return i(this._cachedTestReviewResponse[a],this.cachedTestReviewTotalCount);this._request("GET",this._url("reviews.json",e),function(e,t,n){r._cachedTestReviewResponse=r._cachedTestReviewResponse||{},r._cachedTestReviewResponse[a]=e,r.cachedTestReviewTotalCount=parseInt(n.getResponseHeader("Total-Count"))||0,i(r._cachedTestReviewResponse[a],r.cachedTestReviewTotalCount)},t)}else this._request("GET",this._url("reviews.json",e),function(e,t,n){var r=parseInt(n.getResponseHeader("Total-Count"))||0;return i&&i(e,r)},t)}},{key:"getPhotos",value:function d(i,a,e){var o=this,s=this._app.storeSettings.cache_data.last_updated.customer_photo||"0";if(this._requestCache.customer_photos=this._requestCache.customer_photos||{},this._requestCache.customer_photos[s]=this._requestCache.customer_photos[s]||{},this._requestCache.customer_photos[s][i]){var t=this._requestCache.customer_photos[s][i];return a(t.result,t.totalCount)}this._request("GET",this._url("photos.json",i),function(e,t,n){var r=parseInt(n.getResponseHeader("Total-Count"))||0;return o._requestCache.customer_photos[s][i]={totalCount:r,result:e},a&&a(e,r)},e)}},{key:"getTestimonials",value:function f(i,a,e){var o=this,s=this._app.storeSettings.cache_data.last_updated.testimonial||0;if(this._requestCache.testimonials=this._requestCache.testimonials||{},this._requestCache.testimonials[s]=this._requestCache.testimonials[s]||{},this._requestCache.testimonials[s][i]){var t=this._requestCache.testimonials[s][i];return a(t.result,t.totalCount)}this._request("GET",this._url("testimonials.json",i),function(e,t,n){var r=parseInt(n.getResponseHeader("Total-Count"))||0;return o._requestCache.testimonials[s][i]={totalCount:r,result:e},a&&a(e,r)},e)}},{key:"getCustomerMedia",value:function p(a,o,t){var s=this,i=function i(e){return a.only_photos?e.filter(function(e){return"photo"===e.type}):a.only_videos?e.filter(function(e){return"video"===e.type}):e};if(this._opts.testMode){a.test_mode=this._opts.testMode,a.page=a.page||1,a.limit=20;var u=a.page+"x"+a.limit;if(this._cachedTestCustomerMediaResponse&&this._cachedTestCustomerMediaResponse[u]&&!a.media_ids)return o(i(this._cachedTestCustomerMediaResponse[u]),this._cachedTestCustomerMediaTotalCount[u]);this._request("GET",this._url("customer_media.json",a),function(e,t,n){var r=parseInt(n.getResponseHeader("Total-Count"))||0;if(a.media_ids)return o(e,r);s._cachedTestCustomerMediaResponse=s._cachedTestCustomerMediaResponse||{},s._cachedTestCustomerMediaTotalCount=s._cachedTestCustomerMediaTotalCount||{},s._cachedTestCustomerMediaResponse[u]=e,s._cachedTestCustomerMediaTotalCount[u]=r,o(i(s._cachedTestCustomerMediaResponse[u]),s._cachedTestCustomerMediaTotalCount[u])},t)}else{var e=function(){var i=s._app.storeSettings.cache_data.last_updated.customer_photo||"0";if(i+=s._app.storeSettings.cache_data.last_updated.customer_video||"0",s._requestCache.customer_media=s._requestCache.customer_media||{},s._requestCache.customer_media[i]=s._requestCache.customer_media[i]||{},s._requestCache.customer_media[i][a]){var e=s._requestCache.customer_media[i][a];return{v:o(e.result,e.totalCount)}}s._request("GET",s._url("customer_media.json",a),function(e,t,n){var r=parseInt(n.getResponseHeader("Total-Count"))||0;return s._requestCache.customer_media[i][a]={totalCount:r,result:e},o&&o(e,r)},t)}();if("object"==typeof e)return e.v}}},{key:"getContent",value:function h(e,r,t){var i=this;if(r=r||function(){},e.visitor_id=this._opts.visitorId,e.api_client=encodeURIComponent(this._apiClientDescriptor),e.state=e.state||{},e.push_view_event){var n=this._$.extend(e,{type:"view"});e.state.event_history=this._trackAndReturnHistory(n)}this._opts.testMode&&(e.test_mode=this._opts.testMode),this._opts.optionsParser.hasPreviewFilterById()&&(e.fera_preview=this._opts.optionsParser.getPreviewId());var a=this._url("content.json");e.state_json=JSON.stringify(e.state),delete e.state;var o=Fera.Util.sizeOfParams(e)>Fera.Util.maxGetRequestChars()?"POST":"GET";return this._$.ajax({method:o,type:o,data:e,url:a,success:function s(e,t,n){n.getResponseHeader("api-client-outdated")&&i._opts.app.clearCache(),i.requestFailCount=0,r(e,t,n)},error:function u(e){i.requestFailCount+=1,t&&t(e)}})}},{key:"getSection",value:function m(r,t){var i=this,e={visitor_id:this._opts.visitorId,api_client:encodeURIComponent(this._apiClientDescriptor),test_mode:this._opts.testMode};return this._$.ajax({method:"GET",type:"GET",data:e,url:this._url("section.json"),success:function a(e,t,n){n.getResponseHeader("api-client-outdated")&&i._opts.app.clearCache(),r(e.section,t,n)},error:function n(e){t&&t(e)}})}},{key:"contentSubmission",value:function g(e,t){var n=arguments.length<=1||t===undefined?"":t;this._$.ajax({url:this._url("content_submissions"+n,e.params),method:"POST",type:"POST",data:e.data,contentType:!1,processData:!1,success:e.success,error:e.error})}},{key:"requestContentSubmissionTemplate",value:function v(e){var t=this._$.extend({visitor_id:this._opts.app.getVisitorId(),language:this._opts.app.locale},e.params),n=this._url("content_submissions/template",t);this._request("GET",n,e.success,e.error)}},{key:"triggerActions",value:function _(e,t){var n=arguments.length<=0||e===undefined?{}:e,a=arguments.length<=1||t===undefined?{}:t;this._opts.app.getState(function(e){var r=this;return(n=this._$.extend({},e,n)).visitor_id=this._opts.visitorId,this._opts.testMode&&(n.test_mode=this._opts.testMode),this._opts.optionsParser.hasPreviewFilterById()&&(n.fera_preview=this._opts.optionsParser.getPreviewId()),this._$.ajax({method:"POST",type:"POST",data:n,url:this._url("shoppers/"+this._opts.visitorId+"/trigger_skill_actions"),success:function i(e,t,n){r.requestFailCount=0,a.success&&a.success&&a.success(e,t,n)},error:function t(e){r.requestFailCount+=1,a.error&&a.error&&a.error(e)}})})}},{key:"getShopper",value:function y(e,t){return this._request("GET",this._url("shoppers/"+e),t,t)}},{key:"deleteShopper",value:function w(e,t){return this._request("DELETE",this._url("shoppers/"+e),t,t)}},{key:"_url",value:function b(e,t,n){var r=arguments.length<=1||t===undefined?{}:t,i=arguments.length<=2||n===undefined?this.baseApiUrl:n;return r.public_key=this._config.store_pk,this._opts.adminMode&&(r.adminSessionToken&&(r.admin_session_token=this._opts.adminSessionToken),r.admin=this._opts.adminMode),this._opts.debugMode&&(r.debug_mode=!0),this._opts.app.visitorManager.isNew&&(r.first=!0),(this._opts.app.opts.hasUrlFlag("cache")||this._opts.app.opts.hasUrlFlagOff("cache"))&&(r.cache=this._opts.app.opts.hasUrlFlag("cache")),(i+="public/")+(e=e||"")+"?"+this._$.param(r)}},{key:"_trackAndReturnHistory",value:function C(e){var t=this._opts.localStorage.getObject("EventHistory",{}),n=(new Date).getTime(),r=e.associated_to||("undefined"!=typeof e.state.product_id?"product":"any"),i="any"===r?"any":r+"-"+e.state.product_id;return t[e.type]=t[e.type]||{},t[e.type][i]=t[e.type][i]||[],t[e.type][i].push(n/1e3),2<t[e.type][i].length&&t[e.type][i].splice(1,1),this._opts.localStorage.setObject("EventHistory",t),t[e.type][i]}},{key:"_performImageRequest",value:function k(e,t,n){var r=this,i=document.createElement("img");t.api_client=this._apiClientDescriptor,i.src=this._url(e,t),this._$(i).on("load error",function(){return n(r._$(i))})}},{key:"_sendEventData",value:function S(r,i){var a=this;i=i||function(){};var e=this._opts.debugMode?"POST":Fera.Util.httpMethodToUse(r);if("GET"!==e)return this._$.ajax({method:e,type:e,headers:{"API-CLIENT":this._apiClientDescriptor},data:JSON.stringify(r),url:this._url("events.json"),dataType:"html",success:function t(e){a._opts.logger.log("Successfully sent event",r,e)},error:function o(e){if(e.status<300)return i&&i(e);var t="unknown error";try{t=JSON.parse(e.responseText).error_message}catch(n){}a._opts.logger.warn("Event failed to send: "+t,r,e)},complete:i});this._performImageRequest("e.gif",r,i)}},{key:"_request",value:function F(e,t,n,r){this._$.ajax({method:e,type:e,headers:{"API-CLIENT":this._apiClientDescriptor},url:t,success:n,error:r})}}]),n}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.State=function(){function t(e){_classCallCheck(this,t),this._opts=e,this._app=e.app}return _createClass(t,[{key:"getData",value:function n(e){var t={customer_id:this._app.getCustomerId()||"",location:this._opts.shopperLocation||{},interaction_time:this._opts.timeTracker.getTotalInteractionTime(),time_since_first_seen:this._opts.timeTracker.getTimeSinceFirstSeen(),session_time:this._opts.timeTracker.getSessionTime(),time_on_current_page:this._opts.timeTracker.getTimeOnCurrentPage(),inactive_time_on_current_page:this._opts.timeTracker.getInactiveTimeOnPage(),current_page:{url:window.location.toString(),referrer:document.referrer,title:document.title}};return this._app.getSection()&&(t.section=this._app.getSection()),this._app.getProductId()&&(t.product_id=this._app.getProductId()),this._app.getProduct()&&(t.product=this._app.getProduct()),this._app.getVariantId()&&(t.variant_id=this._app.getVariantId()),this._app.cart&&this._app.cart.hasData()&&(this._app.cart.validateData()?t.cart=this._app.cart.getData():Fera.logger.warn("Invalid cart data",this._app.cart)),this._app.abTests.present()&&(t.test_buckets=this._app.abTests.getData()),e(t),t}}]),t}(),Fera.VisitorManager=function(t){var n,r=this,i=(t=t||{}).cookieJar,a=1825,e=function(){};r.ensureVisitorId=function(){return n=r.getId(),o(),n?(r.isNew=!1,s()):(r.isNew=!0,u()),n},r.setId=function(e){-1!==(n=e).indexOf(" path=/")&&(n=n.replace(" path=/","")),i.setCookie("banana_stand_visitor_id",n,a)},r.getId=function(){return i.getCookie("banana_stand_visitor_id")};var o=function(){var e=t.optionsParser.feraParams.shopper;e&&(e=e.toLowerCase(),n?n!==e&&(Fera.logger.log("Shopper (visitor) ID was changed from URL. Merge operation impending.",n,e),t.api.mergeShoppers(n,e)):Fera.logger.log("Shopper (visitor) ID was set from URL.",n),n=e)},s=function(){r.setId(n)},u=function(){var e=Fera.Util.generateUUID();r.setId(e)};e()},Fera.Notification=function(a,o){var t,s,e=this,i=o.app.geo,u=Fera.Util.$(),n=function(){(e.data=a).rendered_html&&(t=a.rendered_html)};this.getId=function(){return parseInt(a.id)},this.getHtml=function(){return t||(f()?t:"")},this.getEl=function(){return s||(s=u(e.getHtml()),r()),s};var c=function(e){if(e.split(",").length<2)return e;if(!i.hasStoredInfo()||!i.ipResult||!i.ipResult.country_name)return e;var t=new RegExp("^(.+,\\s?)?(.+?),\\s?"+i.ipResult.country_code+"$","i");e=e.replace(t,"$1$2");var n=[i.ipResult.country_name];"US"===i.ipResult.country_code&&n.push("U\\.S\\.A","United States","United States of America","U\\.S\\.A\\.","U\\.S","U\\.S\\.","USA","US");var r=new RegExp("^(.+)?,\\s?("+n.join("|")+")$","i");return e=e.replace(r,"$1")},r=function(){s.find(".banana-product-caption, .fera-product-caption").each(function(){var e=u(this),t=e.find(".banana-product-link, .fera-product-link");0===t.length&&(t=e);var n=e.data("max_product_name_length")||30,r=t.text();if(n<3)Fera.logger.warn("Max product name length was entered in as less than 3, so may have been a mistake. Product name was not truncated.",e,n);else if(r.length>n+3){var i,a=r.substr(0,n)+"...";t.text(a),s.on("mouseenter",function(){t.text(r)}),s.on("mouseleave",function(){i&&clearTimeout(i),i=setTimeout(function(){t.text(a)},1e3)})}})},l=function(){var e=u.extend(!0,{},o.settings,a);e.customer_name_display=a.shopper.name,e.show_name=!("Someone"===a.shopper.name||!a.shopper.name)&&o.settings.show_name;var t=o.isPreview&&Math.random()<.3,n="Someone"==e.customer_name_display||!e.show_name||e.customer_name_display==o.settings.string_templates.someone||t;e.cust_profile_img=a.shopper.picture,e.cust_profile_img&&(n&&("female_only"===e.profile_pic_fallback_mode?-1===e.cust_profile_img.indexOf("female")&&(e.cust_profile_img=e.cust_profile_img.replace("male","female")):"male_only"===e.profile_pic_fallback_mode?e.cust_profile_img=e.cust_profile_img.replace("female","male"):"user_defined"===e.profile_pic_fallback_mode?e.cust_profile_img=e.profile_pic_custom_url:"none"===e.profile_pic_fallback_mode&&(e.cust_profile_img="",e.display_picture_html="",e.cust_profile_tag=null)),e.cust_profile_img&&(e.cust_profile_tag='<img src="'+e.cust_profile_img+'" alt="'+(n?"Anonymous profile picture":e.customer_name_display)+'" class="fera-profileImage">',"shopper_profile_pic"===o.settings.picture_mode?e.display_picture_html=e.cust_profile_tag:"product_image"===o.settings.picture_mode&&a.product&&a.product.thumbnail?e.display_picture_html='<img src="'+a.product.thumbnail+'" alt="'+a.product.name+'" class="banana-profile-image banana-profile-image-product fera-profile-image fera-profile-image-product">':e.display_picture_html=""));var r=new Fera.TimeAgo({tpl:o.settings.string_templates.time_ago,time:e.created_at});if("Someone"!==e.customer_name_display&&e.show_name&&(e.customer_name_display=Fera.Util.toTitleCase(e.customer_name_display)),e.location_string=a.shopper.location,e.location_string&&(e.location_string=Fera.Util.toTitleCase(e.location_string),e.location_string=c(e.location_string)),a.shopper.location_details&&(e.shopper.location=a.shopper.location_details),e.seconds_ago=r.toSeconds(),e.product_display=a.product?a.product.name:"",e.event_time=r.toString(),e.use_product_name=!(o.app.getProductId()&&e.product&&o.app.getProductId()==e.product.id),e.action_type="product_order"===a.type?"customer_ordered_product":"customer_added_to_cart",e.event_type=a.type,o.settings.popout&&(e.popout=!0),e.options=o.settings,e.shopper_name=n?o.settings.string_templates.someone||"Someone":'<span class="banana-customer-name fera-customer-name">'+e.customer_name_display+"</span>",e.shopper_location='<span class="banana-location fera-location">'+e.location_string+"</span>",e.product_name='<span class="banana-product-caption fera-product-caption" data-max_product_name_length="'+e.max_product_name_length+'">',e.product&&e.product.name?(e.product.url&&(e.product_name+='<a href="'+e.product.url+'" target="'+e.product.id+'" class="banana-product-link fera-product-link">'),e.product_name+=e.product.name,e.product.url&&(e.product_name+="</a>")):e.product_name+="a product",o.settings.string_templates&&o.settings.string_templates.actions){var i=o.settings.string_templates.actions[e.event_type];e.statement=d(i,e).trim().replace(/\.$/,"")}return e},d=function(e,t){var n=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!n)return Fera.logger.error("Template is empty or not valid.",e,t),"";var r=Fera.Liquid.parse(n);return r?r.render(t):(Fera.logger.error("Failed to parse template: ",r,t),"")},f=function(){var e=l();return""!==(t=d(o.settings.notification_template,e))};n()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Base=function(){function e(){_classCallCheck(this,e),this.$=Fera.Util.$()}return _createClass(e,[{key:"_log",value:function t(){return Fera.logger.log.apply(this,arguments)}},{key:"_warn",value:function n(){return Fera.logger.warn.apply(this,arguments)}},{key:"_error",value:function r(){return Fera.logger.error.apply(this,arguments)}},{key:"_logWarning",value:function i(){return Fera.logger.logWarning.apply(this,arguments)}}]),e}();var FeraCachedAsset=function(r){var n=this;this.version="0.2.3";var i=r.name||r.url.split("?")[0].split("#")[0],a="Fera.AssetCache."+i,o=(new Date).getTime()/1e3,s=r.type||(-1!==r.url.indexOf(".html")?"text/template":-1!==r.url.indexOf(".css")?"text/css":"text/javascript");n.load=function(t){return t=t||function(){},n.content?t(n.content):(e()?t(n.content):c(r.url,function(e){n.content=e,u(e),n.save(e),t(e)}),!0)},n.save=function(e){var t=o+(r.expiresIn||900);if(!l()||!e)return!1;var n={name:i,url:r.url,expires:t,content:e};return window.localStorage.setItem(a,JSON.stringify(n)),!0},n.clear=function(){return window.localStorage.removeItem(a),!1};var e=function(){if(!l())return!1;var e=window.localStorage.getItem(a);if(!e||"string"!=typeof e)return null;var t=JSON.parse(e);return t.expires<o||t.url!==r.url?n.clear():(n.content=t.content,u(n.content),!0)},u=function(e){if(!document.getElementById(a)){var t=document.createElement("text/css"===s?"style":"script");t.type=s,t.id=a,t.async=!0,t.innerHTML=e,document.body.appendChild(t)}},c=function(e,t){var n=new XMLHttpRequest;n.async=!0,n.onreadystatechange=function(){4==n.readyState&&n.status<300&&t(n.responseText)},n.open("GET",e,!0),n.send()},l=function(){var e="test";try{return window.localStorage.setItem(e,"t"),window.localStorage.removeItem(e),1}catch(t){return 0}}},BananaStandCachedAsset=FeraCachedAsset;Fera.Cart=function(i){var a,o,s=this,n=!1,t=!1,r=i.app.localStorage,u=[],c="Cart",e=6048e4,l=function(){p(),setTimeout(function(){t||s.update(!0)},5e3)};s.setAdapter=function(e){o=e},s.addProductIfEmpty=function(e,t,n){s.ifEmpty(function r(){"function"==typeof n.beforeAdd&&n.beforeAdd(),s.addProduct(e,t,n)},n.afterAdd)},s.removeProduct=function(e,t,n){return t=t||{},n=n||{},!!s.containsProduct(e,t)&&o.removeProduct(e,t,n)},s.ifEmpty=function(e,t){s.update(function(){a&&0!==a.item_count?t&&t():e&&e()},!0)},s.containsProducts=function(e){for(var t=0;t<e.length;t++)if(s.containsProduct(e[t]))return!0;return!1},s.containsProduct=function(e){if(!a||!a.items||a.items.length<1)return!1;for(var t=0;t<a.items.length;t++)if(a.items[t].product_id+""==e+"")return!0;return!1},s.getProductQuantity=function(e){if(!a||!a.items||a.items.length<1)return 0;for(var t=0,n=0;n<a.items.length;n++)a.items[n].product_id+""==e+""&&(t+=a.items[n].quantity||0);return t},s.update=function(t,e){if("boolean"==typeof t&&void 0===e&&(e=t,t=null),t=t||function(){},void 0===e&&(e=!1),e&&n||!o)return t();o.downloadData(function(e){s.loadData(e),n=!0,setTimeout(function(){n=!1},5e3),t()})},s.startCheckout=function(){if(!o)throw"No cart adapter specified so checkout cannot be triggered.";return o.startCheckout()},s.hasData=function(){return a},s.getData=function(){return a},s.loadItemData=function(e){var t=o?o.parseItemData(e):e;return s.addItem(t),s},s.loadData=function(e){return a=o?o.parseCartData(e):e,t=!0,d(a)&&(u.push({event:"change",at:(new Date).getTime()}),i.app.trigger("cart.changed")),f(),s},s.loadCartData=s.loadData,s.addProduct=function(e,t,n){if(!o)throw"No cart adapter specified so can't add product to the cart.";if(t=t||{},"function"==typeof(n=n||{})){var r=n;(n={}).afterAdd=r}return o.addProduct(e,t,n)},s.validateData=function(){if(!a)return i.logger.error("Cart data is empty."),!1;a.items||(i.logger.log("cart.items should be an array of items."),a.items=[]),a.total_weight||(a.total_weight=0),a.total_discount||(a.total_discount=0),a.currency||(i.logger.log("Missing cart.currency, assumed USD"),a.currency="USD");for(var e=0,t=0,n=0;n<a.items.length;n++){var r=a.items[n];if((!r.quantity||parseInt(r.quantity)<=0)&&(a.items[n].quantity=1),r.total||(r.price?a.items[n].total=a.items[n].quantity*r.price:a.items[n].total=0),!r.product_id){if(!r.id){i.logger.warn("Missing product_id, cannot track entry in cart",r),a.items.splice(n,1),n--;continue}r.product_id=r.id}r.variant_id||(a.items[n].variant_id=null),e+=a.items[n].quantity,t+=a.items[n].total}return a.item_count||(a.item_count=e),a.total||(a.total=t),a.grand_total||(a.grand_total=a.total),!0},s.addItem=function(e){a.item_count=a.item_count+e.quantity,a.total=a.total+e.total,a.total_weight=a.total_weight+e.weight,a.total_discount=a.total_discount+e.total_discount,delete e.weight,delete e.total_discount,a.items.push(e),u.push({event:"add",at:(new Date).getTime()}),f()},s.isEmpty=function(){return!a||0===Object.keys(a).length&&a.constructor===Object||0===a.item_count},s.getItemsString=function(){for(var e=[],t=0;t<a.items.length;t++)e.push(a.items[t].product_id+"x"+a.items[t].quantity);return e.join(",")},s.getHistory=function(){return u||[]},s.reset=function(){a=null,r&&r.removeItem(c),t=!0,u.push({event:"empty",at:(new Date).getTime()}),f(),i.app.trigger("cart.emptied")},s.clear=function(){o.clear(function(){s.reset()})};var d=function(e){var t=h();if(!t)return!1;if(!e&&t)return!0;if("undefined"!=typeof e.item_count&&e.item_count!=t.item_count)return!0;if("undefined"!=typeof e.total&&e.total!=t.total)return!0;for(var n=0;n<t.items.length;n++)if("undefined"==typeof e.items[n]){if("undefined"!=typeof e.items[n].total&&e.items[n].total!=t.items[n].total)return!0;if("undefined"!=typeof e.items[n].product_id&&e.items[n].product_id!=t.items[n].product_id)return!0;if("undefined"!=typeof e.items[n].variant_id&&e.items[n].variant_id!=t.items[n].variant_id)return!0}return!1},f=function(){r&&r.setObject(c,{data:a,history:u},e)},p=function(){if(r){var e=r.getObject(c,{});a=e.data||e,u=e.history||[]}},h=function(){if(r)return r.getObject(c,{}).data};l()},Fera.CookieJar=function(e){var o=this;e="string"==typeof e?{namespace:e}:e||{};var t=function(){o.namespace=e.prefix||e.namespace||""};o.setCookie=function(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),r="; expires="+i.toUTCString()}var a=o.namespace+e+"="+t+r+"; path=/; SameSite=None";0===window.location.toString().indexOf("https")&&(a+="; Secure"),document.cookie=a},o.getCookie=function(e,t){t=t||null;for(var n=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var a=r[i];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return 0===e.indexOf("Fera.")?o.getCookie(e.replace("Fera.","BananaStand."),t):0===e.indexOf("fera_")?o.getCookie(e.replace("fera_","bs_"),t):0===e.indexOf("fera-")?o.getCookie(e.replace("fera-","banana_stand-"),t):t},o.getCookieObject=function(e,t){var n=o.getCookie(e,t);return"string"==typeof n&&(n=JSON.parse(decodeURIComponent(atob(n)))),n},o.setCookieObject=function(e,t,n){return t=btoa(encodeURIComponent(JSON.stringify(t))),o.setCookie(e,t,n)},t()},Fera.EngagementRegistry=function(t){t=t||{};var n,r=this,i=[],a=[],o=[],e=function(){u()};r.register=function(e){if(!e)throw"Campaign ID can't be blank";s(e)?-1===i.indexOf(e)&&-1===a.indexOf(e)&&a.push(e):i.push(e),o.push(e),l()},r.pushEvent=function(){if(!(i.length<1&&a.length<1)){var e={type:"campaign_engagement",data:{engagements:{first_time:i,recurring:a}}};t.app.pushEvent(e),r.flush()}},r.state=function(){return{firstTime:i,recurring:a,historicalEngagements:o}},r.reset=function(){i=[],a=[],o=[],c()},r.flush=function(){i=[],a=[],c()};var s=function(e){return-1!==o.indexOf(e)},u=function(){o=t.localStorage.getObject("Fera.EngagementRegistry.historicalEngagements")||[]},c=function(){t.localStorage.setObject("Fera.EngagementRegistry.historicalEngagements",o)},l=function(){n&&clearTimeout(n),n=setTimeout(function(){try{r.pushEvent()}catch(e){throw n&&clearTimeout(n),t.logger.warn("Aborted watching for engagements since we got an error: ",e.message),e}},1500)};e()},Fera.ExitIntentDetector=function(t){t=t||{};var n,e=Fera.Util.$(),r=t.sensitivity||300,i=function(){e(window).on("mouseleave",a),e(window).on("mouseenter",o)},a=function(e){0<e.clientY||(n&&clearTimeout(n),r<=0?t.onExitIntent&&(Fera.logger.log("Exit intent detected."),t.onExitIntent()):n=setTimeout(function(){n=null,t.onExitIntent&&(Fera.logger.log("Exit intent detected."),t.onExitIntent())},r))},o=function(){n&&(clearTimeout(n),n=null)};i()},Fera.Geo=function(e){var n=this,r="https://geo.bananastand.io/json/",i=Fera.Util.$(),t=e.localStorage||new Fera.LocalStorageJar(e),a=function(){n.ipResult=null,o()};this.hasStoredInfo=function(){return null!==n.ipResult},this.getLocationInfo=function(e){n.ipResult?e(n.ipResult):n.geolocateIp(e)},this.geolocateIp=function(t,e){t=t||function(){},i.ajax({method:"GET",type:"GET",url:r,success:function(e){s(e),t(n.ipResult)},dataType:window.location.toString().indexOf("/checkouts")?"json":"jsonp",error:function(){e&&t({})}})};var o=function(){if(void 0!==t)try{n.ipResult=t.getObject(u())}catch(e){}},s=function(e){n.ipResult=e,void 0!==t&&t.setObject&&t.setObject(u(),n.ipResult,72e5)},u=function(){return"Geo.geolocateIp.result"};a()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.I18n=function(){function t(e){_classCallCheck(this,t),this.locale=e.app.locale||document.documentElement.lang||"en"}return _createClass(t,[{key:"supportedLanguages",value:function e(){return["en"].concat(_toConsumableArray(Object.keys(this.constructor.TRANSLATIONS)))}},{key:"t",value:function n(e){return this.translations&&this.translations[e]||e}},{key:"customTranslate",value:function i(e,t){var n=this.t(e),r=t[this.supportedLanguages().includes(this.locale)?this.locale:"en"];return r&&r[n]?r[n]:n}},{key:"translations",get:function r(){var e=this.locale.split("-")[0];return this.constructor.TRANSLATIONS[e]}}],[{key:"_getShopifyLocale",value:function a(){var e=document.getElementById("shopify-features");if(e)return(e=JSON.parse(e.innerHTML)).locale}},{key:"TRANSLATIONS",get:function r(){return{fr:{"Real shoppers":"De vrais acheteurs","verified by Fera.ai":"v\xe9rifi\xe9 par Fera.ai","{{ review_count }} review":"{{ review_count }} critique","{{ review_count }} reviews":"{{ review_count }} critiques","Product Reviews":"Avis sur les produits","Write a review":"\xc9crire une critique","Reviews From Similar Products":"Commentaires de produits similaires","show more":"montre plus","No reviews for this product yet.":"Il n'y a pas encore de commentaire pour ce produit.","{{ store_name }} replied:":"{{ store_name }} a r\xe9pondu:",
"We're adding a 2nd item to your cart now!":"Nous ajoutons un deuxi\xe8me article \xe0 votre panier maintenant!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de {{ store.name }}","{{ num }} second ago":"Il y a {{ num }} seconde","{{ num }} minute ago":"il y a {{ num }} minute","{{ num }} hour ago":"Il ya {{ num }} heure","{{ num }} day ago":"il y a {{ num }} jour","{{ num }} week ago":"Il ya {{ num }} semaine","{{ num }} month ago":"Il ya {{ num }} mois","{{ num }} year ago":"il y a {{ num }} an","{{ num }} seconds ago":"Il y a {{ num }} secondes","{{ num }} minutes ago":"Il y a {{ num }} minutes","{{ num }} hours ago":"il y a {{ num }} heures","{{ num }} days ago":"il y a {{ num }} jours","{{ num }} weeks ago":"Il y a {{ num }} semaines","{{ num }} months ago":"il y a {{ num }} mois","{{ num }} years ago":"il y a {{ num }} ans"},pt:{"Real shoppers":"Compradores reais","verified by Fera.ai":"verificado por Fera.ai","{{ review_count }} review":"{{ review_count }} an\xe1lises","{{ review_count }} reviews":"{{ review_count }} an\xe1lises","Product Reviews":"Revis\xe3o de Produtos","Write a review":"Escreva uma cr\xedtica","Reviews From Similar Products":"Avalia\xe7\xf5es de produtos semelhantes","show more":"mostre mais","No reviews for this product yet.":"Ainda n\xe3o h\xe1 coment\xe1rios para este produto.","{{ store_name }} replied:":"{{ store_name }} ","We're adding a 2nd item to your cart now!":"Estamos adicionando um segundo item ao seu carrinho agora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de {{ store.name }}","{{ num }} second ago":"{{ num }} segundo atr\xe1s","{{ num }} minute ago":"{{ num }} minuto atr\xe1s","{{ num }} hour ago":"{{ num }} hora atr\xe1s","{{ num }} day ago":"{{ num }} dia atr\xe1s","{{ num }} week ago":"{{ num }} semana atr\xe1s","{{ num }} month ago":"{{ num }} m\xeas atr\xe1s","{{ num }} year ago":"{{ num }} ano atr\xe1s","{{ num }} seconds ago":"{{ num }} segundos atr\xe1s","{{ num }} minutes ago":"{{ num }} minutos atr\xe1s","{{ num }} hours ago":"{{ num }} horas atr\xe1s","{{ num }} days ago":"{{ num }} dias atr\xe1s","{{ num }} weeks ago":"{{ num }} semanas atr\xe1s","{{ num }} months ago":"{{ num }} meses atr\xe1s","{{ num }} years ago":"{{ num }} anos atr\xe1s"},nl:{"Real shoppers":"Echte kopers","verified by Fera.ai":"geverifieerd door Fera.ai","{{ review_count }} review":"{{ review_count }} productbeoordeling","{{ review_count }} reviews":"{{ review_count }} productbeoordelingen","Product Reviews":"Productrecensies","Write a review":"Schrijf een recensie","Reviews From Similar Products":"Recensies van vergelijkbare producten","show more":"laat meer zien","No reviews for this product yet.":"Er zijn nog geen beoordelingen voor dit product.","{{ store_name }} replied:":"{{ store_name }} respondeu:","We're adding a 2nd item to your cart now!":"We voegen nu een tweede artikel toe aan uw winkelwagen!","{{ user.name }} from {{ store.name }}":"{{ user.name }} van {{ store.name }}","{{ num }} second ago":"{{ num }} seconde geleden","{{ num }} minute ago":"{{ num }} minuut geleden","{{ num }} hour ago":"{{ num }} uur geleden","{{ num }} day ago":"{{ num }} dag geleden","{{ num }} week ago":"{{ num }} week geleden","{{ num }} month ago":"{{ num }} maand geleden","{{ num }} year ago":"{{ num }} jaar geleden","{{ num }} seconds ago":"{{ num }} seconden geleden","{{ num }} minutes ago":"{{ num }} minuten geleden","{{ num }} hours ago":"{{ num }} uur geleden","{{ num }} days ago":"{{ num }} dagen geleden","{{ num }} weeks ago":"{{ num }} weken geleden","{{ num }} months ago":"{{ num }} maanden geleden","{{ num }} years ago":"{{ num }} jaar geleden"},de:{"Real shoppers":"Echte K\xe4ufer","verified by Fera.ai":"verifiziert von Fera.ai","{{ review_count }} review":"{{ review_count }} Produktbewertung","{{ review_count }} reviews":"{{ review_count }} Produktbewertungen","Product Reviews":"Produktrezensionen","Write a review":"Eine Rezension schreiben","Reviews From Similar Products":"Bewertungen von \xe4hnlichen Produkten","show more":"Zeig mehr","No reviews for this product yet.":"Es gibt noch keine Bewertungen f\xfcr dieses Produkt.","{{ store_name }} replied:":"{{ store_name }} antwortete:","We're adding a 2nd item to your cart now!":"Wir legen jetzt einen zweiten Artikel in Ihren Warenkorb!","{{ user.name }} from {{ store.name }}":"{{ user.name }} von {{ store.name }}","{{ num }} second ago":"vor {{ num }} Sekunde","{{ num }} minute ago":"vor {{ num }} Minute","{{ num }} hour ago":"vor {{ num }} Stunde","{{ num }} day ago":"vor {{ num }} Tag","{{ num }} week ago":"vor {{ num }} Woche","{{ num }} month ago":"vor {{ num }} Monat","{{ num }} year ago":"vor {{ num }} Jahr","{{ num }} seconds ago":"vor {{ num }} Sekunden","{{ num }} minutes ago":"vor {{ num }} Minuten","{{ num }} hours ago":"vor {{ num }} Stunden","{{ num }} days ago":"vor {{ num }} Tagen","{{ num }} weeks ago":"vor {{ num }} Wochen","{{ num }} months ago":"vor {{ num }} Monaten","{{ num }} years ago":"vor {{ num }} Jahren"},id:{"Real shoppers":"Pembeli sungguhan","verified by Fera.ai":"diverifikasi oleh Fera.ai","{{ review_count }} review":"{{ review_count }} ulasan","{{ review_count }} reviews":"{{ review_count }} ulasan","Product Reviews":"Ulasan produk","Write a review":"Menulis review","Reviews From Similar Products":"Review Dari Produk Sejenis","show more":"menampilkan lebih banyak","No reviews for this product yet.":"Belum ada review untuk produk ini.","{{ store_name }} replied:":"{{ store_name }} menjawab:","We're adding a 2nd item to your cart now!":"Kami menambahkan item kedua ke keranjang Anda sekarang!","{{ user.name }} from {{ store.name }}":"{{ user.name }} dari {{ store.name }}","{{ num }} second ago":"{{ num }} detik yang lalu","{{ num }} minute ago":"{{ num }} menit yang lalu","{{ num }} hour ago":"{{ num }} jam yang lalu","{{ num }} day ago":"{{ num }} hari yang lalu","{{ num }} week ago":"{{ num }} minggu yang lalu","{{ num }} month ago":"{{ num }} bulan yang lalu","{{ num }} year ago":"{{ num }} tahun yang lalu","{{ num }} seconds ago":"{{ num }} detik yang lalu","{{ num }} minutes ago":"{{ num }} menit yang lalu","{{ num }} hours ago":"{{ num }} jam lalu","{{ num }} days ago":"{{ num }} hari yang lalu","{{ num }} weeks ago":"{{ num }} minggu yang lalu","{{ num }} months ago":"{{ num }} bulan yang lalu","{{ num }} years ago":"{{ num }} tahun yang lalu"},it:{"Real shoppers":"Veri clienti","verified by Fera.ai":"verificato da Fera.ai","{{ review_count }} review":"{{ review_count }} recensione","{{ review_count }} reviews":"{{ review_count }} recensioni","Product Reviews":"Recensioni dei prodotti","Write a review":"Scrivere una recensione","Reviews From Similar Products":"Recensioni di prodotti simili","show more":"mostra di pi\xf9","No reviews for this product yet.":"Nessuna recensione per questo prodotto ancora.","{{ store_name }} replied:":"{{ store_name }} ha risposto:","We're adding a 2nd item to your cart now!":"Stiamo aggiungendo un secondo articolo al tuo carrello ora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} da {{ store.name }}","{{ num }} second ago":"{{ num }} secondo fa","{{ num }} minute ago":"{{ num }} minuto fa","{{ num }} hour ago":"{{ num }} ora fa","{{ num }} day ago":"{{ num }} giorno fa","{{ num }} week ago":"{{ num }} settimana fa","{{ num }} month ago":"{{ num }} mese fa","{{ num }} year ago":"{{ num }} anno fa","{{ num }} seconds ago":"{{ num }} secondi fa","{{ num }} minutes ago":"{{ num }} minuti fa","{{ num }} hours ago":"{{ num }} ore fa","{{ num }} days ago":"{{ num }} giorni fa","{{ num }} weeks ago":"{{ num }} settimane fa","{{ num }} months ago":"{{ num }} mesi fa","{{ num }} years ago":"{{ num }} anni fa"},no:{"Real shoppers":"Ekte shoppere","verified by Fera.ai":"bekreftet av Fera.ai","{{ review_count }} review":"{{ review_count }} produktanmeldelse","{{ review_count }} reviews":"{{ review_count }} produktanmeldelser","Product Reviews":"Produktomtaler","Write a review":"Skrive en omtale","Reviews From Similar Products":"Anmeldelser Fra Lignende Produkter","show more":"vis mer","No reviews for this product yet.":"Ingen anmeldelser for dette produktet enn\xe5.","{{ store_name }} replied:":"{{ store_name }} svarte:","We're adding a 2nd item to your cart now!":"Vi legger til en ny vare i handlekurven din n\xe5!","{{ user.name }} from {{ store.name }}":"{{ user.name }} fra {{ store.name }}","{{ num }} second ago":"For {{ num }} sekund siden","{{ num }} minute ago":"For {{ num }} minutt siden","{{ num }} hour ago":"{{ num }} time siden","{{ num }} day ago":"For {{ num }} dag siden","{{ num }} week ago":"{{ num }} uke siden","{{ num }} month ago":"{{ num }} m\xe5ned siden","{{ num }} year ago":"{{ num }} \xe5r siden","{{ num }} seconds ago":"{{ num }} sekunder siden","{{ num }} minutes ago":"{{ num }} minutter siden","{{ num }} hours ago":"{{ num }} timer siden","{{ num }} days ago":"{{ num }} dager siden","{{ num }} weeks ago":"{{ num }} uker siden","{{ num }} months ago":"{{ num }} m\xe5neder siden","{{ num }} years ago":"{{ num }} \xe5r siden"},ro:{"Real shoppers":"Cump\u0103r\u0103tori adev\u0103ra\u021bi","verified by Fera.ai":"verificat de Fera.ai","{{ review_count }} review":"{{ review_count }} recenzie","{{ review_count }} reviews":"{{ review_count }} recenzii","Product Reviews":"Recenzii despre produs","Write a review":"Scrie o recenzie","Reviews From Similar Products":"Recenzii de la produse similare","show more":"Afi\u0219a\u021bi mai multe","No reviews for this product yet.":"Nu exist\u0103 \xeenc\u0103 recenzii pentru acest produs.","{{ store_name }} replied:":"{{ store_name }} a r\u0103spuns:","We're adding a 2nd item to your cart now!":"Acum ad\u0103ug\u0103m un al doilea articol \xeen co\u0219!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de la {{ store.name }}","{{ num }} second ago":"Acum {{ num }} secund\u0103","{{ num }} minute ago":"Acum {{ num }} minut","{{ num }} hour ago":"{{ num }} or\u0103 \xeen urm\u0103","{{ num }} day ago":"Acum o zi","{{ num }} week ago":"{{ num }} s\u0103pt\u0103m\xe2n\u0103 \xeen urm\u0103","{{ num }} month ago":"Acum o lun\u0103","{{ num }} year ago":"{{ num }} an in urma","{{ num }} seconds ago":"Acum {{ num }} secunde","{{ num }} minutes ago":"acum {{ num }} minute","{{ num }} hours ago":"{{ num }} ore \xeen urm\u0103","{{ num }} days ago":"{{ num }} zile \xeen urm\u0103","{{ num }} weeks ago":"acum {{ num }} saptamani","{{ num }} months ago":"acum {{ num }} luni","{{ num }} years ago":"Acum {{ num }} ani"},ru:{"Real shoppers":"\u041d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0435 \u043f\u043e\u043a\u0443\u043f\u0430\u0442\u0435\u043b\u0438","verified by Fera.ai":"\u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043e Fera.ai","{{ review_count }} review":"{{ review_count }} \u043e\u0442\u0437\u044b\u0432","{{ review_count }} reviews":"{{ review_count }} \u043e\u0442\u0437\u044b\u0432\u043e\u0432","Product Reviews":"\u041e\u0431\u0437\u043e\u0440\u044b \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432","Write a review":"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0440\u0435\u0446\u0435\u043d\u0437\u0438\u044e","Reviews From Similar Products":"\u041e\u0442\u0437\u044b\u0432\u044b \u043e \u043f\u043e\u0445\u043e\u0436\u0438\u0445 \u0442\u043e\u0432\u0430\u0440\u0430\u0445","show more":"\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435","No reviews for this product yet.":"\u041d\u0435\u0442 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043e\u0431 \u044d\u0442\u043e\u043c \u0442\u043e\u0432\u0430\u0440\u0435 \u0435\u0449\u0435.","{{ store_name }} replied:":"{{ store_name }} \u043e\u0442\u0432\u0435\u0442\u0438\u043b:","We're adding a 2nd item to your cart now!":"\u041c\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432 \u0432\u0430\u0448\u0443 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0432\u0442\u043e\u0440\u043e\u0439 \u0442\u043e\u0432\u0430\u0440!","{{ user.name }} from {{ store.name }}":"{{ user.name }} \u0438\u0437 {{ store.name }}","{{ num }} second ago":"{{ num }} \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u043d\u0430\u0437\u0430\u0434","{{ num }} minute ago":"{{ num }} \u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434","{{ num }} hour ago":"{{ num }} \u0447\u0430\u0441 \u043d\u0430\u0437\u0430\u0434","{{ num }} day ago":"{{ num }} \u0434\u0435\u043d\u044c \u043d\u0430\u0437\u0430\u0434","{{ num }} week ago":"{{ num }} \u043d\u0435\u0434\u0435\u043b\u044e \u043d\u0430\u0437\u0430\u0434","{{ num }} month ago":"{{ num }} \u043c\u0435\u0441\u044f\u0446 \u043d\u0430\u0437\u0430\u0434","{{ num }} year ago":"{{ num }} \u0433\u043e\u0434 \u043d\u0430\u0437\u0430\u0434","{{ num }} seconds ago":"{{ num }} \u0441\u0435\u043a\u0443\u043d\u0434\u044b \u043d\u0430\u0437\u0430\u0434","{{ num }} minutes ago":"{{ num }} \u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434","{{ num }} hours ago":"{{ num }} \u0447\u0430\u0441\u0430 \u043d\u0430\u0437\u0430\u0434","{{ num }} days ago":"{{ num }} \u0434\u043d\u044f \u0441\u043f\u0443\u0441\u0442\u044f","{{ num }} weeks ago":"{{ num }} \u043d\u0435\u0434\u0435\u043b\u0438 \u043d\u0430\u0437\u0430\u0434","{{ num }} months ago":"{{ num }} \u043c\u0435\u0441\u044f\u0446\u0430 \u043d\u0430\u0437\u0430\u0434","{{ num }} years ago":"{{ num }} \u0433\u043e\u0434\u0430 \u043d\u0430\u0437\u0430\u0434"},es:{"Real shoppers":"Compradores reales","verified by Fera.ai":"verificat de Fera.ai","{{ review_count }} review":"{{ review_count }} opiniones","{{ review_count }} reviews":"{{ review_count }} opiniones","Product Reviews":"Rese\xf1as de productos","Write a review":"Escribe una rese\xf1a","Reviews From Similar Products":"Rese\xf1as de productos similares","show more":"mostrar m\xe1s","No reviews for this product yet.":"No hay comentarios para este producto todav\xeda.","{{ store_name }} replied:":"{{ store_name }} respondi\xf3:","We're adding a 2nd item to your cart now!":"\xa1Estamos agregando un segundo art\xedculo a su carrito ahora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} para {{ store.name }}","{{ num }} second ago":"hace {{ num }} segundo","{{ num }} minute ago":"Hace {{ num }} minuto","{{ num }} hour ago":"{{ num }} hora antes","{{ num }} day ago":"Hace {{ num }} d\xeda","{{ num }} week ago":"Hace {{ num }} semana","{{ num }} month ago":"Hace {{ num }} mes","{{ num }} year ago":"hace {{ num }} a\xf1o","{{ num }} seconds ago":"Hace {{ num }} segundos","{{ num }} minutes ago":"hace {{ num }} minutos","{{ num }} hours ago":"Hace {{ num }} horas","{{ num }} days ago":"hace {{ num }} d\xedas","{{ num }} weeks ago":"hace {{ num }} semanas","{{ num }} months ago":"hace {{ num }} meses","{{ num }} years ago":"hace {{ num }} a\xf1os"},sk:{"Real shoppers":"Skuto\u010dn\xed kupuj\xfaci","verified by Fera.ai":"overen\xe9 Fera.ai","{{ review_count }} review":"{{ review_count }} recenzia","{{ review_count }} reviews":"{{ review_count }} recenzia","Product Reviews":"Recenzie produktu","Write a review":"Nap\xedsa\u0165 recenziu","Reviews From Similar Products":"Recenzie z podobn\xfdch produktov","show more":"zobrazi\u0165 viac","No reviews for this product yet.":"Zatia\u013e nie s\xfa k tomuto produktu \u017eiadne recenzie.","{{ store_name }} replied:":"{{ store_name }} je odgovoril:","We're adding a 2nd item to your cart now!":"Teraz do v\xe1\u0161ho ko\u0161\xedka prid\xe1vame druh\xfa polo\u017eku!","{{ user.name }} from {{ store.name }}":"{{ user.name }} z {{ store.name }}","{{ num }} second ago":"Pred {{ num }} sekundou","{{ num }} minute ago":"Pred {{ num }} min\xfatou","{{ num }} hour ago":"pred {{ num }} hodinou","{{ num }} day ago":"Pred {{ num }} d\u0148om","{{ num }} week ago":"Pred {{ num }} t\xfd\u017ed\u0148om","{{ num }} month ago":"Pred {{ num }} mesiacom","{{ num }} year ago":"Pred {{ num }} rokom","{{ num }} seconds ago":"Pred {{ num }} sekundami","{{ num }} minutes ago":"Pred {{ num }} min\xfatami","{{ num }} hours ago":"pred {{ num }} hodinami","{{ num }} days ago":"pred {{ num }} d\u0148ami","{{ num }} weeks ago":"Pred {{ num }} tyzdnami","{{ num }} months ago":"Pred {{ num }} mesiacmi","{{ num }} years ago":"Pred {{ num }} rokmi"},sv:{"Real shoppers":"Riktiga shoppare","verified by Fera.ai":"verifierad av Fera.ai","{{ review_count }} review":"{{ review_count }} produktrecension","{{ review_count }} reviews":"{{ review_count }} produktrecensioner","Product Reviews":"Produktrecensioner","Write a review":"Skriva en recension","Reviews From Similar Products":"Recensioner fr\xe5n liknande produkter","show more":"visa mer","No reviews for this product yet.":"Inga recensioner f\xf6r denna produkt \xe4nnu.","{{ store_name }} replied:":"{{ store_name }} svarade:","We're adding a 2nd item to your cart now!":"Vi l\xe4gger till en andra artikel i din kundvagn nu!","{{ user.name }} from {{ store.name }}":"{{ user.name }} fr\xe5n {{ store.name }}","{{ num }} second ago":"{{ num }} sekund sedan","{{ num }} minute ago":"{{ num }} minut sedan","{{ num }} hour ago":"{{ num }} timme sedan","{{ num }} day ago":"{{ num }} dag sedan","{{ num }} week ago":"{{ num }} vecka sedan","{{ num }} month ago":"{{ num }} m\xe5nad sedan","{{ num }} year ago":"{{ num }} \xe5r sedan","{{ num }} seconds ago":"{{ num }} sekunder sedan","{{ num }} minutes ago":"f\xf6r {{ num }} minuter sedan","{{ num }} hours ago":"{{ num }} timmar sedan","{{ num }} days ago":"{{ num }} dagar sedan","{{ num }} weeks ago":"{{ num }} veckor sedan","{{ num }} months ago":"{{ num }} m\xe5nader sedan","{{ num }} years ago":"{{ num }} \xe5r sedan"},th:{"Real shoppers":"\u0e1c\u0e39\u0e49\u0e0b\u0e37\u0e49\u0e2d\u0e08\u0e23\u0e34\u0e07","verified by Fera.ai":"\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e42\u0e14\u0e22 Fera.ai","{{ review_count }} review":"{{ review_count }} \u0e01\u0e32\u0e23\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e1c\u0e25\u0e34\u0e15\u0e20\u0e31\u0e13\u0e11\u0e4c","{{ review_count }} reviews":"{{ review_count }} \u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19\u0e15\u0e48\u0e2d\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32","Product Reviews":"\u0e1a\u0e17\u0e27\u0e34\u0e08\u0e32\u0e23\u0e13\u0e4c\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32","Write a review":"\u0e41\u0e2a\u0e14\u0e07\u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19","Reviews From Similar Products":"\u0e1a\u0e17\u0e27\u0e34\u0e08\u0e32\u0e23\u0e13\u0e4c\u0e08\u0e32\u0e01\u0e1c\u0e25\u0e34\u0e15\u0e20\u0e31\u0e13\u0e11\u0e4c\u0e17\u0e35\u0e48\u0e04\u0e25\u0e49\u0e32\u0e22\u0e04\u0e25\u0e36\u0e07\u0e01\u0e31\u0e19","show more":"\u0e41\u0e2a\u0e14\u0e07\u0e21\u0e32\u0e01\u0e02\u0e36\u0e49\u0e19","No reviews for this product yet.":"\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e21\u0e35\u0e01\u0e32\u0e23\u0e23\u0e35\u0e27\u0e34\u0e27\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32\u0e19\u0e35\u0e49","{{ store_name }} replied:":"{{ store_name }} \u0e15\u0e2d\u0e1a\u0e01\u0e25\u0e31\u0e1a:","We're adding a 2nd item to your cart now!":"\u0e40\u0e23\u0e32\u0e01\u0e33\u0e25\u0e31\u0e07\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32\u0e0a\u0e34\u0e49\u0e19\u0e17\u0e35\u0e48\u0e2a\u0e2d\u0e07\u0e43\u0e19\u0e23\u0e16\u0e40\u0e02\u0e47\u0e19\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13\u0e15\u0e2d\u0e19\u0e19\u0e35\u0e49!","{{ user.name }} from {{ store.name }}":"{{ user.name }} \u0e08\u0e32\u0e01 {{ store.name }}","{{ num }} second ago":"{{ num }} \u0e27\u0e34\u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} minute ago":"{{ num }} \u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} hour ago":"{{ num }} \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} day ago":"{{ num }} \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} week ago":"{{ num }} \u0e2a\u0e31\u0e1b\u0e14\u0e32\u0e2b\u0e4c\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} month ago":"{{ num }} \u0e40\u0e14\u0e37\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} year ago":"{{ num }} \u0e1b\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} seconds ago":"{{ num }} \u0e27\u0e34\u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} minutes ago":"{{ num }} \u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} hours ago":"{{ num }} \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} days ago":"{{ num }} \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} weeks ago":"{{ num }} \u0e2a\u0e31\u0e1b\u0e14\u0e32\u0e2b\u0e4c\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} months ago":"{{ num }} \u0e40\u0e14\u0e37\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} years ago":"{{ num }} \u0e1b\u0e35\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27"},"zh-TW":{"Real shoppers":"\u771f\u6b63\u7684\u8d2d\u7269\u8005","verified by Fera.ai":"\u7531Fera.ai\u9a8c\u8bc1","{{ review_count }} review":"{{ review_count }} \u4e2a\u4ea7\u54c1\u8bc4\u8bba","{{ review_count }} reviews":"{{ review_count }} \u4ef6\u5546\u54c1\u8bc4\u8bba","Product Reviews":"\u7522\u54c1\u8a55\u8ad6","Write a review":"\u5beb\u4e00\u7bc7\u8a55\u8ad6","Reviews From Similar Products":"\u4f86\u81ea\u985e\u4f3c\u7522\u54c1\u7684\u8a55\u8ad6","show more":"\u986f\u793a\u66f4\u591a","No reviews for this product yet.":"\u8fd9\u4ef6\u5546\u54c1\u8fd8\u6ca1\u6709\u4efb\u4f55\u8bc4\u8bba\u3002","{{ store_name }} replied:":"{{ store_name }} \u56de\u7b54\uff1a","We're adding a 2nd item to your cart now!":"\u6211\u5011\u73fe\u5728\u5c07\u7b2c\u4e8c\u4ef6\u5546\u54c1\u6dfb\u52a0\u5230\u60a8\u7684\u8cfc\u7269\u8eca\uff01","{{ user.name }} from {{ store.name }}":"\u4ee3\u8868 {{ store.name }} \u7684 {{ user.name }}","{{ num }} second ago":"{{ num }}\u79d2\u524d","{{ num }} minute ago":"{{ num }}\u5206\u9418\u524d","{{ num }} hour ago":"{{ num }}\u5c0f\u6642\u524d","{{ num }} day ago":"{{ num }}\u5929\u524d","{{ num }} week ago":"{{ num }}\u9031\u524d","{{ num }} month ago":"{{ num }}\u500b\u6708\u524d","{{ num }} year ago":"{{ num }}\u5e74\u524d","{{ num }} seconds ago":"{{ num }}\u79d2\u524d","{{ num }} minutes ago":"{{ num }}\u5206\u9418\u524d","{{ num }} hours ago":"{{ num }}\u5c0f\u6642\u524d","{{ num }} days ago":"{{ num }}\u5929\u524d","{{ num }} weeks ago":"{{ num }}\u500b\u661f\u671f\u524d","{{ num }} months ago":"{{ num }}\u500b\u6708\u524d","{{ num }} years ago":"{{ num }}\u5e74\u524d"}}}}]),t}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.ImageViewer=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function t(e){this.rendered||(this.$=Fera.Util.$(),this._render(),this.$el.find(".fera-imageViewer-container").on("click",this._hide.bind(this)),this.rendered=!0),e.on("click",this._show.bind(this))}},{key:"_show",value:function i(e){var t=this,n=this.$(e.target).clone().removeClass();if(n.data("imageUrl")){var r=n.data("imageUrl");n=$('<img src="'+r+'" />')}this.$el.removeClass("fera-hidden"),this.$el.find(".fera-imageViewer").html(n),this.$("body").addClass("fera-modal--open"),$(document).on("keydown",function(e){27===(e.keyCode||e.which)&&t._hide()})}},{key:"_hide",value:function n(e){if(e&&!this.$(e.target).is(".fera-imageViewer-container"))return;this.$el.addClass("fera-hidden"),this.$("body").removeClass("fera-modal--open")}},{key:"_render",value:function r(){this.$("body").append(this._tpl()).append("<style>"+this._css()+"</style>"),this.$el=this.$(".fera-imageViewer-overlay")}},{key:"_tpl",value:function a(){return'\n<div class="fera-imageViewer-overlay fera-hidden">\n    <div class="fera-imageViewer-container">\n        <div class="fera-imageViewer"></div>\n    </div>\n</div>\n        '}},{key:"_css",value:function o(){return"\n.fera-modal--open {\n    overflow: hidden !important;\n}\n\n.fera-hidden {\n    display: none !important;\n}\n\n.fera-imageViewer-overlay {\n    position: fixed;\n    background: rgba(0,0,0,0.4);\n    z-index: 9999999;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fera-imageViewer-container {\n    height: 100vh;\n    width: 100vw;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.fera-imageViewer {\n    max-width: 900px;\n    margin: 15px;\n    background-color: #ffffff;\n}\n\n.fera-imageViewer img {\n    width: 100% !important;\n}\n\n.fera-imageViewer-viewable {\n    cursor: pointer;\n}\n        "}}]),e}(),Fera.InactivityDetector=function(n){n=n||{};var t,r=this,i=!1,a=Fera.Util.$(),o="undefined"==typeof n.reactToWindowBlurs||n.reactToWindowBlurs,s=[],u=[],c=!0,e=function(){n.timeLimit=n.timeLimit||6e4,f()};r.attachToFrames=function(){for(var e=0;e<window.frames.length;e++)try{p(window.frames[e],window.frames[e].document)}catch(t){n.logger.log("Failed to attach to frame. Likely due to it being of a different origin than the main frame.",e)}},r.addInactivityListener=function(e){s.push(e)},r.addReactivityListener=function(e){u.push(e)},r.isActive=function(){return c};var l=function(){for(var e=0;e<u.length;e++)u[e](r);c=!0},d=function(){for(var e=0;e<s.length;e++)s[e](r);c=!1},f=function(){a(window).on("load",h),p(window,document),r.attachToFrames()},p=function(e,t){a(t).on("mousemove keypress mousedown touchstart click scroll",h),o&&(a(e).on("blur",m),a(e).on("focus",g)),a(e).on("scroll",function(){i&&g()})},h=function(){g(),t=setTimeout(m,n.timeLimit)},m=function(){var e=i;i=!0,e||d()},g=function(){t&&clearTimeout(t);var e=i;i=!1,e&&l()};e()},Fera.Liquid={registerFilters:function(e){Fera.Liquid.Template.registerFilter(e)},parse:function(e){return Fera.Liquid.Template.parse(e)}},Fera.Liquid.extensions={},Fera.Liquid.extensions.object={},Fera.Liquid.extensions.object.update=function(e){for(var t in e)this[t]=e[t];return this},Fera.Liquid.extensions.object.hasKey=function(e){return!!this[e]},Fera.Liquid.extensions.object.hasValue=function(e){for(var t in this)if(this[t]==e)return!0;return!1},Fera.Liquid.extensions.object.isEmpty=function(e){if(!e||""===Fera.Liquid.extensions.stringTools.strip(e.toString()))return!0;if(e.length&&0<e.length)return!1;if("number"==typeof e)return!1;for(var t in e)if(e[t])return!1;return!0},Fera.Liquid.extensions.stringTools={},Fera.Liquid.extensions.stringTools.capitalize=function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},Fera.Liquid.extensions.stringTools.strip=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},Fera.Liquid.extensions.arrayTools={},Fera.Liquid.extensions.arrayTools.last=function(e){return e[e.length-1]},Fera.Liquid.extensions.arrayTools.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return n;return-1},Fera.Liquid.extensions.arrayTools.map=function(e,t,n){var r=e.length;if("function"!=typeof t)throw"Fera.Liquid.extensions.arrayTools.map requires first argument to be a function";for(var i=new Array(r),a=n,o=0;o<r;o++)o in e&&(i[o]=t.call(a,e[o],o,e));return i},Fera.Liquid.extensions.arrayTools.flatten=function(e){for(var t=e.length,n=[],r=0;r<t;r++)e[r]instanceof Array?n=n.concat(e[r]):n.push(e[r]);return n},Fera.Liquid.extensions.arrayTools.each=function(e,t,n){var r=e.length;if("function"!=typeof t)throw"Fera.Liquid.extensions.arrayTools.each requires first argument to be a function";for(var i=n,a=0;a<r;a++)a in e&&t.call(i,e[a],a,e);return null},Fera.Liquid.extensions.arrayTools.include=function(e,t){e.length;return 0<=Fera.Liquid.extensions.arrayTools.indexOf(e,t)},function(){var a=!1,o=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},this.Class.extend=function(e){function t(){!a&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;a=!0;var n=new this;for(var r in a=!1,e)n[r]="function"==typeof e[r]&&"function"==typeof i[r]&&o.test(e[r])?function(n,r){return function(){var e=this._super;this._super=i[n];var t=r.apply(this,arguments);return this._super=e,t}}(r,e[r]):e[r];return t.prototype=n,(t.prototype.constructor=t).extend=arguments.callee,t}}.call(Fera.Liquid),Fera.Liquid.Tag=Fera.Liquid.Class.extend({init:function(e,t,n){this.tagName=e,this.markup=t,this.nodelist=this.nodelist||[],this.parse(n)},parse:function(){},render:function(){return""}}),Fera.Liquid.Block=Fera.Liquid.Tag.extend({init:function(e,t,n){this.blockName=e,this.blockDelimiter="end"+this.blockName,this._super(e,t,n)},parse:function(e){this.nodelist||(this.nodelist=[]),this.nodelist.length=0;var t=e.shift();for(e.push("");e.length;){if(/^\{\%/.test(t)){this.whitespaceHandler(t,e);var n=t.match(/^\{\%-?\s*(\w+)\s*(.*?)-?\%\}$/);if(!n)throw"Tag '"+t+"' was not properly terminated with: %}";if(this.blockDelimiter==n[1])return void this.endTag();n[1]in Fera.Liquid.Template.tags?this.nodelist.push(new Fera.Liquid.Template.tags[n[1]](n[1],n[2],e)):this.unknownTag(n[1],n[2],e)}else/^\{\{/.test(t)?(this.whitespaceHandler(t,e),this.nodelist.push(this.createVariable(t))):this.nodelist.push(t);t=e.shift()}this.assertMissingDelimitation()},endTag:function(){},unknownTag:function(e){switch(e){case"else":throw this.blockName+" tag does not expect else tag";case"end":throw"'end' is not a valid delimiter for "+this.blockName+" tags. use "+this.blockDelimiter;default:throw"Unknown tag: "+e}},createVariable:function(e){var t=e.match(/^\{\{-?(.*?)-?\}\}$/);if(t)return new Fera.Liquid.Variable(t[1]);throw"Variable '"+e+"' was not properly terminated with: }}"},render:function(e){return this.renderAll(this.nodelist,e)},renderAll:function(e,r){return Fera.Liquid.extensions.arrayTools.map(e||[],function(e){var t="";try{t=e.render?e.render(r):e}catch(n){t=r.handleError(n)}return t})},assertMissingDelimitation:function(){throw this.blockName+" tag was never closed"},whitespaceHandler:function(e,t){"-"==e[2]&&0<this.nodelist.length&&""===this.nodelist[this.nodelist.length-1].trim()&&this.nodelist.pop(),"-"===e[e.length-3]&&0<t.length&&""===t[0].trim()&&t.shift()}}),Fera.Liquid.Document=Fera.Liquid.Block.extend({init:function(e){this.blockDelimiter=[],this.parse(e)},assertMissingDelimitation:function(){}}),Fera.Liquid.Strainer=Fera.Liquid.Class.extend({init:function(e){this.context=e},respondTo:function(e){return!(e=e.toString()).match(/^__/)&&(!Fera.Liquid.extensions.arrayTools.include(Fera.Liquid.Strainer.requiredMethods,e)&&e in this)}}),Fera.Liquid.Strainer.filters={},Fera.Liquid.Strainer.globalFilter=function(e){for(var t in e)Fera.Liquid.Strainer.filters[t]=e[t]},Fera.Liquid.Strainer.requiredMethods=["respondTo","context"],Fera.Liquid.Strainer.create=function(e){var t=new Fera.Liquid.Strainer(e);for(var n in Fera.Liquid.Strainer.filters)t[n]=Fera.Liquid.Strainer.filters[n];return t},Fera.Liquid.Context=Fera.Liquid.Class.extend({init:function(e,t,n){this.scopes=[e||{}],this.registers=t||{},this.errors=[],this.rethrowErrors=n,this.strainer=Fera.Liquid.Strainer.create(this)},get:function(e){return this.resolve(e)},set:function(e,t){this.scopes[0][e]=t},hasKey:function(e){return!!this.resolve(e)},push:function(){var e={};return this.scopes.unshift(e),e},merge:function(e){return Fera.Liquid.extensions.object.update.call(this.scopes[0],e)},pop:function(){if(1==this.scopes.length)throw"Context stack error";return this.scopes.shift()},stack:function(e,t){var n=null;this.push();try{n=e.apply(t||this.strainer)}finally{this.pop()}return n},invoke:function(e,t){return this.strainer.respondTo(e)?this.strainer[e].apply(this.strainer,t):0==t.length?null:t[0]},resolve:function(e){switch(e){case null:case"nil":case"null":case"":return null;case"true":return!0;case"false":return!1;case"blank":case"empty":return"";default:if(/^'(.*)'$/.test(e))return e.replace(/^'(.*)'$/,"$1");if(/^"(.*)"$/.test(e))return e.replace(/^"(.*)"$/,"$1");if(/^(\d+)$/.test(e))return parseInt(e.replace(/^(\d+)$/,"$1"));if(/^(\d[\d\.]+)$/.test(e))return parseFloat(e.replace(/^(\d[\d\.]+)$/,"$1"));if(/^\((\S+)\.\.(\S+)\)$/.test(e)){var t=e.match(/^\((\S+)\.\.(\S+)\)$/),n=parseInt(t[1]),r=parseInt(t[2]),i=[];if(isNaN(n)){var a=this.resolve(t[1]);if(n=parseInt(a),isNaN(n))throw new Error("Incorrect param for range: "+e)}if(isNaN(r)){var o=this.resolve(t[2]);if(r=parseInt(o),isNaN(r))throw new Error("Incorrect param for range: "+e)}for(var s=r-n+1,u=0;u<s;u++)i.push(u+n);return i}return this.variable(e)}},findVariable:function(e){for(var t=0;t<this.scopes.length;t++){var n=this.scopes[t];if(n&&"undefined"!=typeof n[e]){var r=n[e];return"function"==typeof r&&(r=r.apply(
this),n[e]=r),r&&this._isObject(r)&&"toFera.Liquid"in r&&(r=r.toFera.Liquid()),r&&this._isObject(r)&&"setContext"in r&&r.setContext(self),r}}return null},variable:function(e){if("string"!=typeof e)return null;var t=e.match(/\[[^\]]+\]|(?:[\w\-]\??)+/g),n=t.shift(),r=n.match(/^\[(.*)\]$/);r&&(n=this.resolve(r[1]));var i=this.findVariable(n),a=this;return i&&Fera.Liquid.extensions.arrayTools.each(t,function(e){var t=e.match(/^\[(.*)\]$/);if(t){e=a.resolve(t[1]);"function"==typeof i[e]&&(i[e]=i[e].apply(this)),i=i[e],a._isObject(i)&&"toFera.Liquid"in i&&(i=i.toFera.Liquid())}else{if((a._isObject(i)||"hash"==typeof i)&&e in i){var n=i[e];"function"==typeof n&&(n=i[e]=n.apply(a)),i=a._isObject(n)&&"toFera.Liquid"in n?n.toFera.Liquid():n}else if(/^\d+$/.test(e)){var r=parseInt(e);"function"==typeof i[r]&&(i[r]=i[r].apply(a)),i=a._isObject(i)&&a._isObject(i[r])&&"toFera.Liquid"in i[r]?i[r].toFera.Liquid():i[r]}else{if(!i||"function"!=typeof i[e]||!Fera.Liquid.extensions.arrayTools.include(["length","size","first","last"],e))return i=null;"toFera.Liquid"in(i=i[e].apply(e))&&(i=i.toFera.Liquid())}a._isObject(i)&&"setContext"in i&&i.setContext(a)}}),i},addFilters:function(e){e=Fera.Liquid.extensions.arrayTools.flatten(e),Fera.Liquid.extensions.arrayTools.each(e,function(e){if(!this._isObject(e))throw"Expected object but got: "+typeof e;this.strainer.addMethods(e)})},handleError:function(e){if(this.errors.push(e),this.rethrowErrors)throw e;return"Fera.Liquid error: "+(e.message?e.message:e.description?e.description:e)},_isObject:function(e){return null!=e&&"object"==typeof e}}),Fera.Liquid.Template=Fera.Liquid.Class.extend({init:function(){this.root=null,this.registers={},this.assigns={},this.errors=[],this.rethrowErrors=!1},parse:function(e){return this.root=new Fera.Liquid.Document(Fera.Liquid.Template.tokenize(e)),this},render:function(e,t,n){if(!this.root)return"";var r={ctx:e,filters:t,registers:n},i=null;r.ctx instanceof Fera.Liquid.Context?(i=r.ctx,this.assigns=i.assigns,this.registers=i.registers):(r.ctx&&Fera.Liquid.extensions.object.update.call(this.assigns,r.ctx),r.registers&&Fera.Liquid.extensions.object.update.call(this.registers,r.registers),i=new Fera.Liquid.Context(this.assigns,this.registers,this.rethrowErrors)),r.filters&&i.addFilters(arg.filters);try{return this.root.render(i).join("")}finally{this.errors=i.errors}},renderWithErrors:function(){var e=this.rethrowErrors;this.rethrowErrors=!0;var t=this.render.apply(this,arguments);return this.rethrowErrors=e,t}}),Fera.Liquid.Template.tags={},Fera.Liquid.Template.registerTag=function(e,t){Fera.Liquid.Template.tags[e]=t},Fera.Liquid.Template.registerFilter=function(e){Fera.Liquid.Strainer.globalFilter(e)},Fera.Liquid.Template.tokenize=function(e){var t=e.split(/(\{\%.*?\%\}|\{\{.*?\}\}?)/);return""==t[0]&&t.shift(),t},Fera.Liquid.Template.parse=function(e){return(new Fera.Liquid.Template).parse(e)},Fera.Liquid.Variable=Fera.Liquid.Class.extend({init:function(e){this.markup=e,this.name=null,this.filters=[];var i=this,t=e.match(/\s*("[^"]+"|'[^']+'|[^\s,|]+)/);if(t){this.name=t[1];var n=e.match(/\|\s*(.*)/);if(n){var r=n[1].split(/\|/);Fera.Liquid.extensions.arrayTools.each(r,function(e){var t=e.match(/\s*(\w+)/);if(t){var n=t[1],r=[];Fera.Liquid.extensions.arrayTools.each(Fera.Liquid.extensions.arrayTools.flatten(e.match(/(?:[:|,]\s*)("[^"]+"|'[^']+'|[^\s,|]+)/g)||[]),function(e){var t=e.match(/^[\s|:|,]*(.*?)[\s]*$/);t&&r.push(t[1])}),i.filters.push([n,r])}})}}},render:function(r){if(null==this.name)return"";var i=r.get(this.name);return Fera.Liquid.extensions.arrayTools.each(this.filters,function(e){var t=e[0],n=Fera.Liquid.extensions.arrayTools.map(e[1]||[],function(e){return r.get(e)});n.unshift(i),i=r.invoke(t,n)}),i}}),Fera.Liquid.Condition=Fera.Liquid.Class.extend({init:function(e,t,n){this.left=e,this.operator=t,this.right=n,this.childRelation=null,this.childCondition=null,this.attachment=null},evaluate:function(e){e=e||new Fera.Liquid.Context;var t=this.interpretCondition(this.left,this.right,this.operator,e);switch(this.childRelation){case"or":return t||this.childCondition.evaluate(e);case"and":return t&&this.childCondition.evaluate(e);default:return t}},or:function(e){this.childRelation="or",this.childCondition=e},and:function(e){this.childRelation="and",this.childCondition=e},attach:function(e){return this.attachment=e,this.attachment},isElse:!1,interpretCondition:function(e,t,n,r){if(!n)return r.get(e);if(e=r.get(e),t=r.get(t),!(n=Fera.Liquid.Condition.operators[n]))throw"Unknown operator "+n;return n(e,t)},toString:function(){return"<Condition "+this.left+" "+this.operator+" "+this.right+">"}}),Fera.Liquid.Condition.operators={"==":function(e,t){return e==t},"=":function(e,t){return e==t},"!=":function(e,t){return e!=t},"<>":function(e,t){return e!=t},"<":function(e,t){return e<t},">":function(e,t){return t<e},"<=":function(e,t){return e<=t},">=":function(e,t){return t<=e},contains:function(e,t){return"[object Array]"===Object.prototype.toString.call(e)?0<=Fera.Liquid.extensions.arrayTools.indexOf(e,t):e.match(t)},hasKey:function(e,t){return Fera.Liquid.extensions.object.hasKey.call(e,t)},hasValue:function(e,t){return Fera.Liquid.extensions.object.hasValue.call(e,t)}},Fera.Liquid.ElseCondition=Fera.Liquid.Condition.extend({isElse:!0,evaluate:function(){return!0},toString:function(){return"<ElseCondition>"}}),Fera.Liquid.Drop=Fera.Liquid.Class.extend({setContext:function(e){this.context=e},beforeMethod:function(){},invokeDrop:function(e){var t=this.beforeMethod();return!t&&e in this&&(t=this[e].apply(this)),t},hasKey:function(){return!0}});var hackObjectEach=function(e,t){if("function"!=typeof e)throw"Object.each requires first argument to be a function";var n=0,r=t;for(var i in this){var a=this[i],o=[i,a];o.key=i,o.value=a,e.call(r,o,n,this),n++}return null},split;Fera.Liquid.Template.registerTag("assign",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)\s*=\s*(.+)/,init:function(e,t,n){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'assign' - Valid syntax: assign [var] = [source]";this.to=r[1],this.from=r[2],this._super(e,t,n)},render:function(e){var t=new Fera.Liquid.Variable(this.from);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to.toString()]=t.render(e),""}})),Fera.Liquid.Template.registerTag("cache",Fera.Liquid.Block.extend({tagSyntax:/(\w+)/,init:function(e,t,n){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'cache' - Valid syntax: cache [var]";this.to=r[1],this._super(e,t,n)},render:function(e){var t=this._super(e);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to]=Fera.Liquid.extensions.arrayTools.flatten([t]).join(""),""}})),Fera.Liquid.Template.registerTag("capture",Fera.Liquid.Block.extend({tagSyntax:/(\w+)/,init:function(e,t,n){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'capture' - Valid syntax: capture [var]";this.to=r[1],this._super(e,t,n)},render:function(e){var t=this._super(e);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to.toString()]=Fera.Liquid.extensions.arrayTools.flatten([t]).join(""),""}})),Fera.Liquid.Template.registerTag("case",Fera.Liquid.Block.extend({tagSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)/,tagWhenSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)(?:(?:\s+or\s+|\s*\,\s*)("[^"]+"|'[^']+'|[^\s,|]+.*))?/,init:function(e,t,n){this.blocks=[],this.nodelist=[];var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'case' - Valid syntax: case [condition]";this.left=r[1],this._super(e,t,n)},unknownTag:function(e,t,n){switch(e){case"when":this.recordWhenCondition(t);break;case"else":this.recordElseCondition(t);break;default:this._super(e,t,n)}},render:function(n){var r=this,i=[],a=!0;return n.stack(function(){for(var e=0;e<r.blocks.length;e++){var t=r.blocks[e];if(t.isElse)return 1==a&&(i=Fera.Liquid.extensions.arrayTools.flatten([i,r.renderAll(t.attachment,n)])),i;t.evaluate(n)&&(a=!1,i=Fera.Liquid.extensions.arrayTools.flatten([i,r.renderAll(t.attachment,n)]))}}),i},recordWhenCondition:function(e){for(;e;){var t=e.match(this.tagWhenSyntax);if(!t)throw"Syntax error in tag 'case' - Valid when condition: {% when [condition] [or condition2...] %} ";e=t[2];var n=new Fera.Liquid.Condition(this.left,"==",t[1]);this.blocks.push(n),this.nodelist=n.attach([])}},recordElseCondition:function(e){if(""!=Fera.Liquid.extensions.stringTools.strip(e||""))throw"Syntax error in tag 'case' - Valid else condition: {% else %} (no parameters) ";var t=new Fera.Liquid.ElseCondition;this.blocks.push(t),this.nodelist=t.attach([])}})),Fera.Liquid.Template.registerTag("comment",Fera.Liquid.Block.extend({render:function(){return""}})),Fera.Liquid.Template.registerTag("cycle",Fera.Liquid.Tag.extend({tagSimpleSyntax:/"[^"]+"|'[^']+'|[^\s,|]+/,tagNamedSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)\s*\:\s*(.*)/,init:function(e,t,n){var r;if(r=t.match(this.tagNamedSyntax))this.variables=this.variablesFromString(r[2]),this.name=r[1];else{if(!(r=t.match(this.tagSimpleSyntax)))throw"Syntax error in 'cycle' - Valid syntax: cycle [name :] var [, var2, var3 ...]";this.variables=this.variablesFromString(t),this.name="'"+this.variables.toString()+"'"}this._super(e,t,n)},render:function(n){var r=this,i=n.get(r.name),a="";return n.registers.cycle||(n.registers.cycle={}),n.registers.cycle[i]||(n.registers.cycle[i]=0),n.stack(function(){var e=n.registers.cycle[i],t=n.get(r.variables[e]);(e+=1)==r.variables.length&&(e=0),n.registers.cycle[i]=e,a=t}),a},variablesFromString:function(e){return Fera.Liquid.extensions.arrayTools.map(e.split(","),function(e){var t=e.match(/\s*("[^"]+"|'[^']+'|[^\s,|]+)\s*/);return t[1]?t[1]:null})}})),Fera.Liquid.Template.registerTag("for",Fera.Liquid.Block.extend({tagSyntax:/(\w+)\s+in\s+((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,n){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'for loop' - Valid syntax: for [item] in [collection]";this.variableName=r[1],this.collectionName=r[2],this.name=this.variableName+"-"+this.collectionName,this.attributes={};t.replace(this.tagSyntax,"");var i=t.match(/(\w*?)\s*\:\s*("[^"]+"|'[^']+'|[^\s,|]+)/g);i&&Fera.Liquid.extensions.arrayTools.each(i,function(e){e=e.split(":"),this.attributes[Fera.Liquid.extensions.stringTools.strip(e[0])]=Fera.Liquid.extensions.stringTools.strip(e[1])},this),this._super(e,t,n)},render:function(r){var i=this,a=[],e=r.get(this.collectionName)||[],t=[0,e.length];if(r.registers["for"]||(r.registers["for"]={}),this.attributes.limit||this.attributes.offset){var n=0,o=0,s=0,u=null;t=[n="continue"==this.attributes.offset?r.registers["for"][this.name]:r.get(this.attributes.offset)||0,(s=(o=r.get(this.attributes.limit))?n+o+1:e.length)-1],r.registers["for"][this.name]=s}return(u=e.slice(t[0],t[1]))&&0!=u.length?(r.stack(function(){var n=u.length;Fera.Liquid.extensions.arrayTools.each(u,function(e,t){r.set(i.variableName,e),r.set("forloop",{name:i.name,length:n,index:t+1,index0:t,rindex:n-t,rindex0:n-t-1,first:0==t,last:t==n-1}),a.push((i.renderAll(i.nodelist,r)||[]).join(""))})}),Fera.Liquid.extensions.arrayTools.flatten([a]).join("")):""}})),Fera.Liquid.Template.registerTag("if",Fera.Liquid.Block.extend({tagSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)\s*([=!<>a-z_]+)?\s*("[^"]+"|'[^']+'|[^\s,|]+)?/,init:function(e,t,n){this.nodelist=[],this.blocks=[],this.pushBlock("if",t),this._super(e,t,n)},unknownTag:function(e,t,n){Fera.Liquid.extensions.arrayTools.include(["elsif","else"],e)?this.pushBlock(e,t):this._super(e,t,n)},render:function(n){var r=this,i="";return n.stack(function(){for(var e=0;e<r.blocks.length;e++){var t=r.blocks[e];if(t.evaluate(n))return void(i=r.renderAll(t.attachment,n))}}),Fera.Liquid.extensions.arrayTools.flatten([i]).join("")},pushBlock:function(e,t){var n;if("else"==e)n=new Fera.Liquid.ElseCondition;else{var r=t.split(/\b(and|or)\b/).reverse();if(!(a=r.shift().match(this.tagSyntax)))throw"Syntax Error in tag '"+e+"' - Valid syntax: "+e+" [expression]";for(var i=new Fera.Liquid.Condition(a[1],a[2],a[3]);0<r.length;){var a,o=r.shift();if(!(a=r.shift().match(this.tagSyntax)))throw"Syntax Error in tag '"+e+"' - Valid syntax: "+e+" [expression]";var s=new Fera.Liquid.Condition(a[1],a[2],a[3]);s[o](i),i=s}n=i}n.attach([]),this.blocks.push(n),this.nodelist=n.attachment}})),Fera.Liquid.Template.registerTag("ifchanged",Fera.Liquid.Block.extend({render:function(t){var n=this,r="";return t.stack(function(){var e=n.renderAll(n.nodelist,t).join("");e!=t.registers.ifchanged&&(r=e,t.registers.ifchanged=r)}),r}})),Fera.Liquid.Template.registerTag("include",Fera.Liquid.Tag.extend({tagSyntax:/((?:"[^"]+"|'[^']+'|[^\s,|]+)+)(\s+(?:with|for)\s+((?:"[^"]+"|'[^']+'|[^\s,|]+)+))?/,init:function(e,t,n){var r=(t||"").match(this.tagSyntax);if(!r)throw"Error in tag 'include' - Valid syntax: include '[template]' (with|for) [object|collection]";this.templateName=r[1],this.templateNameVar=this.templateName.substring(1,this.templateName.length-1),this.variableName=r[3],this.attributes={};var i=t.match(/(\w*?)\s*\:\s*("[^"]+"|'[^']+'|[^\s,|]+)/g);i&&Fera.Liquid.extensions.arrayTools.each(i,function(e){e=e.split(":"),this.attributes[Fera.Liquid.extensions.stringTools.strip(e[0])]=Fera.Liquid.extensions.stringTools.strip(e[1])},this),this._super(e,t,n)},render:function(t){var n=this,e=Fera.Liquid.readTemplateFile(t.get(this.templateName)),r=Fera.Liquid.parse(e),i=t.get(this.variableName||this.templateNameVar),a="";return t.stack(function(){n.attributes.each=hackObjectEach,n.attributes.each(function(e){t.set(e.key,t.get(e.value))}),i instanceof Array?a=Fera.Liquid.extensions.arrayTools.map(i,function(e){return t.set(n.templateNameVar,e),r.render(t)}):(t.set(n.templateNameVar,i),a=r.render(t))}),a=Fera.Liquid.extensions.arrayTools.flatten([a]).join("")}})),Fera.Liquid.Template.registerTag("unless",Fera.Liquid.Template.tags["if"].extend({render:function(n){var r=this,i="";return n.stack(function(){if((t=r.blocks[0]).evaluate(n))for(var e=1;e<r.blocks.length;e++){var t;if((t=r.blocks[e]).evaluate(n))return void(i=r.renderAll(t.attachment,n))}else i=r.renderAll(t.attachment,n)}),Fera.Liquid.extensions.arrayTools.flatten([i]).join("")}})),Fera.Liquid.Template.registerTag("raw",Fera.Liquid.Block.extend({parse:function(e){this.nodelist||(this.nodelist=[]),this.nodelist.length=0;var t=e.shift();for(e.push("");e.length;){if(/^\{\%/.test(t)){var n=t.match(/^\{\%\s*(\w+)\s*(.*)?\%\}$/);if(n&&this.blockDelimiter==n[1])return void this.endTag()}this.nodelist.push(t||""),t=e.shift()}this.assertMissingDelimitation()},render:function(){return this.nodelist.join("")}})),Fera.Liquid.Template.registerTag("increment",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,n){var r=t.match(this.tagSyntax);if(console.log(e,t,n),console.log(r[1]),!r)throw"Syntax error in 'assign' - Valid syntax: increment [var]";this.name=r[1],this._super(e,t,n)},render:function(e){var t=this.name,n="";return e.registers.increment||(e.registers.increment={}),e.registers.increment[t]||(e.registers.increment[t]=0),n=String(e.registers.increment[t]),e.registers.increment[t]++,n}})),Fera.Liquid.Template.registerTag("decrement",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,n){var r=t.match(this.tagSyntax);if(console.log(e,t,n),console.log(r[1]),!r)throw"Syntax error in 'assign' - Valid syntax: decrement [var]";this.name=r[1],this._super(e,t,n)},render:function(e){var t=this.name,n="";return e.registers.decrement||(e.registers.decrement={}),e.registers.decrement[t]||(e.registers.decrement[t]=-1),n=String(e.registers.decrement[t]),e.registers.decrement[t]--,n}})),Fera.Liquid.Template.registerFilter({_HTML_ESCAPE_MAP:{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"},size:function(e){return e.length?e.length:0},downcase:function(e){return e.toString().toLowerCase()},upcase:function(e){return e.toString().toUpperCase()},capitalize:function(e){return Fera.Liquid.extensions.stringTools.capitalize(e.toString())},escape:function(e){var t=this;return e.replace(/[&<>"']/g,function(e){return t._HTML_ESCAPE_MAP[e]})},h:function(e){var t=this;return e.replace(/[&<>"']/g,function(e){return t._HTML_ESCAPE_MAP[e]})},"default":function(e,t){return Fera.Liquid.extensions.object.isEmpty(e)?t:e},truncate:function(e,t,n){if(!e||""==e)return"";t=t||50,n=n||"...";e.slice(0,t);return e.length>t?e.slice(0,t)+n:e},truncatewords:function(e,t,n){if(!e||""==e)return"";t=parseInt(t||15),n=n||"...";var r=e.toString().split(" "),i=Math.max(t,0);return r.length>i?r.slice(0,i).join(" ")+n:e},truncate_words:function(e,t,n){if(!e||""==e)return"";t=parseInt(t||15),n=n||"...";var r=e.toString().split(" "),i=Math.max(t,0);return r.length>i?r.slice(0,i).join(" ")+n:e},strip_html:function(e){return e.toString().replace(/<.*?>/g,"")},strip_newlines:function(e){return e.toString().replace(/\n/g,"")},join:function(e,t){return t=t||" ",e.join(t)},split:function(e,t){return t=t||" ",e.split(t)},sort:function(e){return e.sort()},reverse:function(e){return e.reverse()},replace:function(e,t,n){return n=n||"",e.toString().replace(new RegExp(t,"g"),n)},replace_first:function(e,t,n){return n=n||"",e.toString().replace(new RegExp(t,""),n)},newline_to_br:function(e){return e.toString().replace(/\n/g,"<br/>\n")},date:function(e,t){var n;return e instanceof Date&&(n=e),n instanceof Date||"now"!=e||(n=new Date),n instanceof Date||"number"!=typeof e||(n=new Date(1e3*e)),n instanceof Date||"string"!=typeof e||(n=new Date(Date.parse(e))),n instanceof Date?n.strftime(t):e},first:function(e){return e[0]},last:function(e){return(e=e)[e.length-1]},minus:function(e,t){return(Number(e)||0)-(Number(t)||0)},plus:function(e,t){return(Number(e)||0)+(Number(t)||0)},times:function(e,t){return(Number(e)||0)*(Number(t)||0)},divided_by:function(e,t){return(Number(e)||0)/(Number(t)||0)},modulo:function(e,t){return(Number(e)||0)%(Number(t)||0)},map:function(e,t){e=e||[];for(var n=[],r=0;r<e.length;r++)n.push(e[r][t]);return n},escape_once:function(e){var t=this;return e.replace(/["><']|&(?!([a-zA-Z]+|(#\d+));)/g,function(e){return t._HTML_ESCAPE_MAP[e]})},remove:function(e,t){return e.toString().replace(new RegExp(t,"g"),"")},remove_first:function(e,t){return e.toString().replace(t,"")},prepend:function(e,t){return""+(t||"").toString()+(e||"").toString()},append:function(e,t){return""+(e||"").toString()+(t||"").toString()}}),(new Date).strftime||(Date.ext={},Date.ext.util={},Date.ext.util.xPad=function(e,t,n){for(void 0===n&&(n=10);parseInt(e,10)<n&&1<n;n/=10)e=t.toString()+e;return e.toString()},Date.prototype.locale="en-GB",document.getElementsByTagName("html")&&document.getElementsByTagName("html")[0].lang&&(Date.prototype.locale=document.getElementsByTagName("html")[0].lang),Date.ext.locales={},Date.ext.locales.en={a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a %d %b %Y %T %Z",p:["AM","PM"],P:["am","pm"],x:"%d/%m/%y",X:"%T"},"undefined"!=typeof JSON?Date.ext.locales["en-US"]=JSON.parse(JSON.stringify(Date.ext.locales.en)):Date.ext.locales["en-US"]=Date.ext.locales.en,Date.ext.locales["en-US"].c="%a %d %b %Y %r %Z",Date.ext.locales["en-US"].x="%D",Date.ext.locales["en-US"].X="%r",Date.ext.locales["en-GB"]=Date.ext.locales.en,Date.ext.locales["en-AU"]=Date.ext.locales["en-GB"],Date.ext.formats={a:function(e){return Date.ext.locales[e.locale].a[e.getDay()]},A:function(e){return Date.ext.locales[e.locale].A[e.getDay()]},b:function(e){return Date.ext.locales[e.locale].b[e.getMonth()]},B:function(e){return Date.ext.locales[e.locale].B[e.getMonth()]},c:"toLocaleString",C:function(e){return Date.ext.util.xPad(parseInt(e.getFullYear()/100,10),0)},d:["getDate","0"],e:["getDate"," "],g:function(e){return Date.ext.util.xPad(parseInt(Date.ext.util.G(e)/100,10),0)},G:function(e){var t=e.getFullYear(),n=parseInt(Date.ext.formats.V(e),10),r=parseInt(Date.ext.formats.W(e),10);return n<r?t++:0===r&&52<=n&&t--,t},H:["getHours","0"],I:function(e){var t=e.getHours()%12;return Date.ext.util.xPad(0===t?12:t,0)},j:function(e){var t=e-new Date(e.getFullYear()+"/1/1 GMT");t+=6e4*e.getTimezoneOffset();var n=parseInt(t/6e4/60/24,10)+1;return Date.ext.util.xPad(n,0,100)},m:function(e){return Date.ext.util.xPad(e.getMonth()+1,0)},M:["getMinutes","0"],p:function(e){return Date.ext.locales[e.locale].p[12<=e.getHours()?1:0]},P:function(e){return Date.ext.locales[e.locale].P[12<=e.getHours()?1:0]},S:["getSeconds","0"],u:function(e){var t=e.getDay();return 0===t?7:t},U:function(e){var t=parseInt(Date.ext.formats.j(e),10),n=6-e.getDay(),r=parseInt((t+n)/7,10);return Date.ext.util.xPad(r,0)},V:function(e){var t=parseInt(Date.ext.formats.W(e),10),n=new Date(e.getFullYear()+"/1/1").getDay(),r=t+(4<n||n<=1?0:1);return 53==r&&new Date(e.getFullYear()+"/12/31").getDay()<4?r=1:0===r&&(r=Date.ext.formats.V(new Date(e.getFullYear()-1+"/12/31"))),Date.ext.util.xPad(r,0)},w:"getDay",W:function(e){var t=parseInt(Date.ext.formats.j(e),10),n=7-Date.ext.formats.u(e),r=parseInt((t+n)/7,10);return Date.ext.util.xPad(r,0,10)},y:function(e){return Date.ext.util.xPad(e.getFullYear()%100,0)},Y:"getFullYear",z:function(e){var t=e.getTimezoneOffset();return(0<t?"-":"+")+Date.ext.util.xPad(parseInt(Math.abs(t/60),10),0)+Date.ext.util.xPad(t%60,0)},Z:function(e){return e.toString().replace(/^.*\(([^)]+)\)$/,"$1")},"%":function(){return"%"}},Date.ext.aggregates={c:"locale",D:"%m/%d/%y",h:"%b",n:"\n",r:"%I:%M:%S %p",R:"%H:%M",t:"\t",T:"%H:%M:%S",x:"locale",X:"locale"},Date.ext.aggregates.z=Date.ext.formats.z(new Date),Date.ext.aggregates.Z=Date.ext.formats.Z(new Date),Date.ext.unsupported={},Date.prototype.strftime=function(e){this.locale in Date.ext.locales||(this.locale.replace(/-[a-zA-Z]+$/,"")in Date.ext.locales?this.locale=this.locale.replace(/-[a-zA-Z]+$/,""):this.locale="en-GB");for(var r=this;e.match(/%[cDhnrRtTxXzZ]/);)e=e.replace(/%([cDhnrRtTxXzZ])/g,function(e,t){var n=Date.ext.aggregates[t];return"locale"==n?Date.ext.locales[r.locale][t]:n});var t=e.replace(/%([aAbBCdegGHIjmMpPSuUVwWyY%])/g,function(e,t){var n=Date.ext.formats[t];return"string"==typeof n?r[n]():"function"==typeof n?n.call(r,r):"object"==typeof n&&"string"==typeof n[0]?Date.ext.util.xPad(r[n[0]](),n[1]):t});return r=null,t}),split=split||function(l){var n,d=String.prototype.split,f=/()??/.exec("")[1]===l;return n=function(e,t,n){if("[object RegExp]"!==Object.prototype.toString.call(t))return d.call(e,t,n);var r,i,a,o,s=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),c=0;t=new RegExp(t.source,u+"g");for(e+="",f||(r=new RegExp("^"+t.source+"$(?!\\s)",u)),n=n===l?-1>>>0:n>>>0;(i=t.exec(e))&&!(c<(a=i.index+i[0].length)&&(s.push(e.slice(c,i.index)),!f&&1<i.length&&i[0].replace(r,function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===l&&(i[e]=l)}),1<i.length&&i.index<e.length&&Array.prototype.push.apply(s,i.slice(1)),o=i[0].length,c=a,s.length>=n));)t.lastIndex===i.index&&t.lastIndex++;return c===e.length?!o&&t.test("")||s.push(""):s.push(e.slice(c)),s.length>n?s.slice(0,n):s},String.prototype.split=function(e,t){return n(this,e,t)},n}(),Fera.LocalStorageJar=function(e){var i=this;i.localStorageEnabled=!1,e="string"==typeof e?{namespace:e}:e||{};var t=function(){i.localStorageEnabled=n(),i.cookieJar=e.cookieJar||new Fera.CookieJar,i.namespace=e.namespace||"Fera"};i.clear=function(){if(!i.localStorageEnabled)return!0;for(var e=Object.keys(window.localStorage),t=0;t<e.length;t++)0===e[t].indexOf(i.namespace)&&window.localStorage.removeItem(e[t])},i.setItem=function(e,t,n){i.localStorageEnabled?(e=a(e),t={value:t,timestamp:n?(new Date).getTime()+n:null},t=Fera.Util.encode(JSON.stringify(t)),window.localStorage.setItem(e,t)):n?i.cookieJar.setCookie(e,t,n/24*60*60*1e3):i.cookieJar.setCookie(e,t)},i.getItem=function(e,t){try{if(e=a(e),t=t||null,i.localStorageEnabled){var n=window.localStorage.getItem(e);return!n&&e.match(/widget/i)&&(n=window.localStorage.getItem(e.replace("Widget","Skill").replace("widget","Skill"))),n?(n=JSON.parse(Fera.Util.decode(n))).timestamp?(new Date).getTime()<n.timestamp?n.value:t:n.value:t}return i.cookieJar.getCookie(e)}catch(r){return null}},i.setObject=function(e,t,n){return i.setItem(e,t,n)},i.getObject=function(e,t){return i.getItem(e,t)},i.removeItem=function(e){e=a(e),i.localStorageEnabled&&(window.localStorage.removeItem(e),window.localStorage.removeItem(e.replace("Fera.","BananaStand.")),window.localStorage.removeItem(e.replace("Fera.","Fera-Fera.")),window.localStorage.removeItem(e.replace("Fera.","Fera.Fera.")),window.localStorage.removeItem(e.replace("Skill","Widget")))};var a=function(e){return""!==i.namespace&&(e=i.namespace+"."+e),e},n=function(){var e="Fera.LocalStorageJar.test";try{return window.localStorage.setItem(e,"test"),window.localStorage.removeItem(e),!0}catch(t){return!1}};t()},Fera.Logger=function(t){t=t||{};var e=this,n=function(){};e.info=function(e){!t.optionsParser.hasUrlFlag("fera_quiet")&&t.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof e&&(e="[Fera.ai] "+e),console.info.apply(this,arguments))},e.log=function(e){!t.optionsParser.hasUrlFlag("fera_quiet")&&t.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof e&&(e="[Fera.ai] "+e),console.log.apply(this,arguments))},e.logWarning=function(e){!t.optionsParser.hasUrlFlag("fera_quiet")&&t.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof e&&(e="[Fera.ai] "+e),console.warn.apply(this,arguments))},e.warn=function(e){t.optionsParser.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||("string"==typeof e&&(e="[Fera.ai] "+e),console.warn.apply(this,arguments))},e.error=function(e){window.console&&!Fera.Util.ie()&&("string"==typeof e&&(e="[Fera.ai] "+e),console.error.apply(this,arguments))},n()},Fera.OptionsParser=function(t){t=t||{};var a=this,e=function(){a.urlParams=a.getJsonFromUrl(),a.previewMode=a.hasPreviewFilterById(),a.feraParams=r(),a.urlParams.fera&&t.app.push(a.urlParams.fera,a.getFeraActionParams()),n()};a.getFeraActionParams=function(){for(var e=Object.keys(a.feraParams),t={},n=0;n<e.length;n++){var r=e[n];-1===["debug","test","preview","admin","shopper"].indexOf(r)&&(t[r]=a.feraParams[r])}return t},a.getJsonFromUrl=function(e){var t;if(e){var n=location.href.indexOf("?");if(-1==n)return[];t=location.href.substr(n+1)}else t=location.search.substr(1);var s={};return t.split("&").forEach(function(e){if(e){var t=(e=e.split("+").join(" ")).indexOf("="),n=-1<t?e.substr(0,t):e,r=-1<t?decodeURIComponent(e.substr(t+1)):"",i=n.indexOf("[");if(-1==i)s[decodeURIComponent(n)]=r;else{var a=n.indexOf("]",i),o=decodeURIComponent(n.substring(i+1,a));n=decodeURIComponent(n.substring(0,i)),s[n]||(s[n]=[]),o?s[n][o]=r:s[n].push(r)}}}),s},a.showContainer=function(e,t){var n=a.urlParams.fera_preview||a.urlParams.preview;return!n||(a.hasPreviewFilterById()?parseInt(n)===t:n===e)},a.getPreviewId=function(){return parseInt(a.urlParams.fera_preview||a.urlParams.preview)},a.hasPreviewFilterById=function(){var e=a.urlParams.fera_preview||a.urlParams.preview;return/^[0-9]+$/i.test(e)},a.hasUrlFlag=function(e){var t=new RegExp("((.*)(([?&])"+e+"=)(t|1|y|true|yes|on))(.*)","i");return-1!==window.location.toString().search(t)},a.hasUrlFlagOff=function(e){var t=new RegExp("((.*)(([?&])"+e+"=)(f|0|n|false|no|off))(.*)","i");return-1!==window.location.toString().search(t)},a.parseTestMode=function(){return a.hasUrlFlag("test_mode")||a.hasUrlFlag("fera_test")?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via URL params."),!0):t.testMode?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via initialization options."),!0):"t"===t.cookieJar.getCookie("Fera.SandboxTest.Enabled")&&(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via sandbox cookie."),!0)},a.parseSandboxMode=function(){return a.hasUrlFlag("fera_sandbox")?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("SANDBOX Mode activated via URL params."),a.extendSandboxCookie(),!0):-1!==["yes","true","1","t","on",!0,1].indexOf(t.cookieJar.getCookie("Fera.SandboxTest.Enabled",!1))?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("SANDBOX Mode activated via sandbox cookie."),!0):void 0},a.extendSandboxCookie=function(){t.cookieJar.setCookie("Fera.SandboxTest.Enabled","t",2/24/60)},a.parseShowErrors=function(){return!!window.feraShowErrors||(!!t.cookieJar.getCookie("Fera.ShowErrors",!1)||a.feraParams.show_errors)},a.parseDebugMode=function(){return!(!window.__bsioDebugMode&&!window.feraDebugMode)||(!!t.cookieJar.getCookie("Fera.DebugMode",!1)||(a.hasUrlFlag("debug_mode")||a.hasUrlFlag("fera_debug")?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("DEBUG Mode activated via URL params."),!0):!!t.debugMode&&(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("DEBUG Mode activated via initialization options."),!0)))},a.parseAdminMode=function(){var e=a.isAdminMode();return t.adminSessionToken=a.urlParams.fera_site_com_token||a.urlParams.fera_admin_session,t.adminSessionToken?t.cookieJar.setCookie("Fera.Admin.SessionToken",t.adminSessionToken,30):t.adminSessionToken=t.cookieJar.getCookie("Fera.Admin.SessionToken"),e},a.parseCheckIntegration=function(){return!(!a.urlParams||!a.urlParams.check_integration_type)&&(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("Integration Checking enabled: "+a.urlParams.check_integration_type),a.urlParams.check_integration_type)};var n=function(){a.sandboxMode=a.parseSandboxMode();var e=window.feraAdminSandboxStatus;a.sandboxStatus=e?parseInt(e):200,a.sandboxError=a.sandboxMode&&400<=a.sandboxStatus},r=function(){for(var e=Object.keys(a.urlParams),t={},n=0;n<e.length;n++){var r=e[n];if(0===r.indexOf("fera_")){var i=r.substr(5);t[i]=a.urlParams[r],-1!==["yes","true","1","t","on"].indexOf(t[i])&&(t[i]=!0),-1!==["no","false","","off"].indexOf(t[i])&&(t[i]=!1)}}return t};a.isAdminMode=function(){return!!a.urlParams.show_element_selector||(!!a.urlParams.ensure_loaded_cart||(a.hasUrlFlag("admin_mode")||a.hasUrlFlag("fera_admin")?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode activated via URL params."),t.cookieJar.setCookie("Fera.Admin.Enabled","t",1),!0):a.hasUrlFlagOff("admin_mode")||a.hasUrlFlagOff("fera_admin")?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode DEactivated via URL params."),t.cookieJar.setCookie("Fera.Admin.Enabled","f",1),!1):"t"===t.cookieJar.getCookie("Fera.Admin.Enabled")?(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode active via cookie."),!0):!!t.adminMode&&(a.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode activated via initialization options."),t.cookieJar.setCookie("Fera.Admin.Enabled","t",1),!0)))},e()},Fera.PopupNotification=function(e){var n,i=this,a=e.$,t=!1,r=function(){i.notif=e.notif,i.$el=e.$el,i.$container=e.container,i.$el.on("mouseenter",function(){!0}),i.$el.on("mouseleave",function(){!1})};i.attach=function(){return!(t||!i.$el)&&(i.$el.hide(),i.$container.append(i.$el),t=!0)},i.detach=function(){return!(!t||!i.$el)&&(i.$el.hide(),i.$el.remove(),!(t=!1))},i.destroy=function(){i.detach(),i.$el=null},i.hideAndDetach=function(e,t,n){i.hide(e,t,function(){i.detach(),n&&n()})},i.hide=function(e,t,n){n=n||function(){};var r=-1===t.indexOf("top")?"bottom":"top";"slide_and_fade"===e?(i.$el.css("opacity",1),i.$el.css(r,""),i.$el.css("-webkit-transition",r+" 1s ease, opacity 1s ease"),i.$el.css("opacity",0),i.$el.css(r,o()),setTimeout(n,1e3)):"fade"===e?(i.$el.css("opacity",1),i.$el.css("-webkit-transition","opacity 1s ease"),i.$el.css("opacity",0),setTimeout(n,1e3)):"slide"===e?(i.$el.css(r,""),i.$el.css("-webkit-transition",r+" 1s ease"),i.$el.css(r,o()),setTimeout(n,1e3)):n()},i.attached=function(){return t},i.ensureLoadThenShow=function(e,t,n){var r=i.$el.find("img").attr("src");r&&"string"==typeof r?a("<img>").on("load",function(){s(e,t,n)}).on("error",function(){s(e,t,n)}).attr("src",r):s(e,t,n)},i.initiateCountdown=function(t){n&&clearInterval(n),i.$el.find(".banana-notification-countdown, .fera-notification-countdown").each(function(){var e=a(this);e.data("seconds",t),e.text(t),n=setInterval(function(){e.data("seconds",e.data("seconds")-1),0==e.data("seconds")?(clearInterval(n),e.text("")):e.text(e.data("seconds"))},1e3)})};var o=function(){return-100},s=function(e,t,n){n=n||function(){};var r=-1===t.indexOf("top")?"bottom":"top"
;"slide_and_fade"===e?(i.$el.css(r,o()),i.$el.css("opacity",0),i.$el.css("-webkit-transition",r+" 1s ease, opacity 1s ease"),i.$el.show(),i.$el.css("opacity",1),i.$el.css(r,"")):"fade"===e?(i.$el.css("opacity",0),i.$el.css("-webkit-transition","opacity 1s ease"),i.$el.show(),i.$el.css("opacity",1)):"slide"===e?(i.$el.css(r,o()),i.$el.css("-webkit-transition",r+" 1s ease"),i.$el.show(),i.$el.css(r,"")):i.$el.show(),n()};r()},Fera.SeenNotifTracker=function(e){var t,n=this,r=e.localStorage,i=e.storageKey,a=[],o=e.expireAfter||864e5,s=function(e){return Fera.Util.$()(e)},u=function(){f(),l(),d(),c()&&(n.clear(),e.logger.info("Clear notification history flag was detected, so no seen notifications will be assumed."))};n.getSeenIds=function(){return l(),s(a).map(function(){return this.id}).toArray()},n.updateExpiryTime=function(e){return t!=(o=1e3*e)&&(n.clear(),t=o),n},n.hasSeen=function(e){var t;l(),t="number"==typeof t?e:e.getId();for(var n=0;n<a.length;n++)if(a[n].id===t)return!0;return!1},n.markSeen=function(e){var t;(t="number"==typeof t?e:e.getId())<0||(a.push({id:t,expiresAt:(new Date).getTime()+o}),l(),d())},n.clear=function(){a=[],d()};var c=function(){return-1!==window.location.toString().search(/(.*)((\?|&)clear_notification_history=(t|1|y))/i)},l=function(){for(var e=[],t=0;t<a.length;t++){var n=a[t];n.expiresAt<=(new Date).getTime()||e.push(n)}a=e},d=function(){r.setItem(i,p())},f=function(){var e=r.getItem(i,{notifs:[],expireAfter:o});a=e.notifs,t=e.expireAfter},p=function(){return{notifs:a,expireAfter:o}};u()},Fera.TimeAgo=function(n){var t,r=this,u=n.language||"en",e=function(){t=a()};this.toSeconds=function(){var e=new Date;return Math.floor((e.getTime()-t.getTime())/1e3)},this.toDays=function(){var e=this.toSeconds();return Math.floor(e/60/60/24)},this.toString=function(){var e,t=r.toSeconds();return(e=i(t,31536e3,"year"))?e:(e=i(t,2628e3,"month"))?e:(e=i(t,604800,"week"))?e:(e=i(t,86400,"day"))?e:(e=i(t,3600,"hour"))?e:(e=i(t,60,"minute"))?e:e=i(Math.max(t,1),1,"second")};var i=function(e,t,n){if(1<=e/t){var r=Math.round(e/t);try{var i=new Intl.RelativeTimeFormat(u,{numeric:"always"});return r*=-1,i.format(r,n)}catch(s){var a=1<r?"{{ num }} "+n+"s ago":"{{ num }} "+n+" ago",o=Fera.t(a);return o.replace("{{ num }}",r)}}return!1},a=function(){if("string"!=typeof n.time)return n.time;var e;e=n.time.indexOf("Z")===n.time.length-1?n.time.replace("Z"," GMT").replace("T"," ").replace(".000","").replace(/-/g,"/"):n.time;var t=Date.parse(e);return t||(t=(new Date).getTime()-36e5,Fera.logger.error("Failed to parse time: ",n.time,n,r)),new Date(t)};e()},Fera.TimeTracker=function(n){var r=this;n=n||{};var i=3e4,a=0,o=1e3,s=!1,u=!1,c="default-page-name",l=[],d=[],f=[],p={},h=0,m=null,e=function(){m=n.localStorage;var e=i||30,t=t||window.location.pathname;e=n.idleTimeoutInSeconds||e,t=n.currentPageName||t,g(),R(),A(e),E(t),V(),F(),setInterval(D,1e3)},g=function(){r.data=m.getObject("TimeTracker",{})};r.getTimeOnCurrentPage=function(){return $(O(c))},r.getSessionTime=function(){var e=_()||(new Date).getTime();return Math.round(((new Date).getTime()-e)/1e3)},r.getTotalInteractionTime=function(){return Math.round(parseFloat(v()||0))},r.setTotalInteractionTime=function(e){b(e)},r.getTimeSinceFirstSeen=function(){var e=t();return e?(e=Date.parse(e),Math.round((new Date-e)/1e3)):0},r.reset=function(){x(),m.removeItem("TimeTracker"),p={},F()};var t=function(){var e=new Date;return r.data.timeSinceFirstSeen||e},v=function(){return r.data.totalInteractionTime||0},_=function(){var e=new Date;return r.data.sessionStartTime||e.getTime()},y=function(){var e=new Date;return r.data.sessionLastUpdateTime||e.getTime()},w=function(e){r.data.timeSinceFirstSeen=e,S()},b=function(e){r.data.totalInteractionTime=e,S()},C=function(e){r.data.sessionStartTime=e,S()},k=function(e){r.data.sessionLastUpdateTime=e,S()},S=function(){m.setObject("TimeTracker",r.data)},F=function(e){if(e||(e=c),p[e]===undefined)p[e]=[];else{var t=p[e],n=t[t.length-1];if(n!==undefined&&n.stopTime===undefined)return}p[e].push({startTime:new Date,stopTime:undefined}),s=!0},x=function(){for(var e=Object.keys(p),t=0;t<e.length;t++)T(e[t])},T=function(e){e||(e=c);var t=p[e];t!==undefined&&0!==t.length&&(t[t.length-1].stopTime===undefined&&(t[t.length-1].stopTime=new Date),s=!1)},$=function(e){return e===undefined?undefined:Math.round(e/1e3)},O=function(e){var t=p[e];if(t!==undefined){for(var n=0,r=0;r<t.length;r++){var i=t[r].startTime,a=t[r].stopTime;a===undefined&&(a=new Date),n+=a-i}return Number(n)}};r.getInactiveTimeOnPage=function(){var e=p[c];if(void 0===e||e.length<1)return 0;var t=e[e.length-1].stopTime;return t?$(Number(new Date-t)):0};var P,I,R=function(){t()||w(new Date)},A=function(e){var t=parseFloat(e);if(!1!==isNaN(t))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};return i=1e3*e,r},E=function(e){return c=e,r},j=function(){if(s){var e=r.getTimeOnCurrentPage(),t=e-h;if(!(t<=.1)){var n=r.getTotalInteractionTime();return b(n+=t),h=e,n}}},D=function(){var e=y(),t=(new Date).getTime();3e3<t-e?C(t):864e5<t-(_()||t)&&C(t);k(t)},L=function(){u&&M(),u=!1,a=0},M=function(){if(!s)for(var e=0;e<f.length;e++){var t=f[e],n=t.numberOfTimesToInvoke;(isNaN(n)||n===undefined||0<n)&&(t.numberOfTimesToInvoke-=1,t.callback())}F()},q=function(){if(s)for(var e=0;e<d.length;e++){var t=d[e],n=t.numberOfTimesToInvoke;(isNaN(n)||n===undefined||0<n)&&(t.numberOfTimesToInvoke-=1,t.callback())}x()},U=function(){for(var e=j(),t=0;t<l.length;t++)l[t].pending&&e>l[t].timeInSeconds&&(l[t].callback(),l[t].pending=!1);!1===u&&i<a?(u=!0,q()):a+=o},V=function(){"undefined"!=typeof document.hidden?(I="hidden",P="visibilitychange"):"undefined"!=typeof document.mozHidden?(I="mozHidden",P="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(I="msHidden",P="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(I="webkitHidden",P="webkitvisibilitychange"),document.addEventListener(P,function(){document[I]?q():M()},!1),window.addEventListener("blur",function(){q()}),window.addEventListener("focus",function(){M()}),document.addEventListener("mousemove",function(){L()}),document.addEventListener("keyup",function(){L()}),document.addEventListener("touchstart",function(){L()}),window.addEventListener("scroll",function(){L()}),setInterval(U,o)};r.callAfterTimeElapsedInSeconds=function(e,t){l.push({timeInSeconds:e,callback:t,pending:!0})},r.callWhenUserLeaves=function(e,t){d.push({callback:e,numberOfTimesToInvoke:t})},r.callWhenUserReturns=function(e,t){f.push({callback:e,numberOfTimesToInvoke:t})},e()},Fera.Timer=function(i){var a,o,s,u,n,e,t,c=this,r=(Fera.Util.$(),null),l=null,d=function(){c.timerTemplate=new Fera.TimerTemplate({template:i.timerTemplate,logger:i.logger}),i.padTimes="undefined"==typeof i.padTimes||i.padTimes,t=i.finishCallback||function(){},e=i.countCallback||function(){}};this.setTemplate=function(e){e&&(c.timerTemplate.template=e)},this.getTimeLeft=function(){return r},this.start=function(e,t){n=e,r=parseInt(t)||0==t?t:n,c.resume(),p()},this.reset=function(){r=n,f(),e(h(),r)},this.restart=function(){c.reset(),c.resume()},this.stop=function(){l&&clearInterval(l),!1},this.pause=c.stop,this.resume=function(){l&&clearInterval(l),l=setInterval(p,1e3),!0};var f=function(){a=i.showDays&&c.timerTemplate.templateHasDays()?Math.floor(r/86400):0,o=Math.floor(r/3600-24*a),s=Math.floor(r%3600/60),u=Math.floor(r%60)},p=function(){r-=1,f(),e(h(),r),r<=0&&(r=0,clearInterval(l),t())},h=function(){var e,t,n,r;return e=a<1?"":a,i.sentenceFormat?(e=a<1?"":m(a,"day"),t=o<1?"":m(o,"hour"),n=m(s,"minute"),r=m(u,"second")):i.padTimes?(t=o<10?"0"+o:o,n=s<10?"0"+s:s,r=u<10?"0"+u:u):(t=o,n=s,r=u),c.timerTemplate.render(e,t,n,r)},m=function(e,t){return e+" "+t+(1===e?"":"s")};d()},Fera.TimerTemplate=function(e){e=e||{};var c=this,t="[[%DAYS%:]][[%HOURS%:]]%MINUTES%:%SECONDS%",l=Fera.Util.$(),n=function(){c.template=e.template||t};this.templateHasDays=function(){return-1!==c.template.indexOf("%DAYS%")},this.render=function(e,t,n,r){var i,a,o,s=c.template,u=s.match(/(\[\[.*%DAYS%.*\]\])(\[\[.*%HOURS%.*\]\])(.*)/);return u?(i=u[1],a=u[2],o=u[3]):s.match(/(\[\[.*%HOURS%.*\]\])(.*)/)?(i="",a=(u=s.match(/(\[\[.*%HOURS%.*\]\])(.*)/))[1],o=u[2]):(a=i="",o=s),s=(s=(i=p(i,e))+(a=h(a,t))+o).replace("%DAYS%",e).replace("%HOURS%",t).replace("%MINUTES%",n).replace("%SECONDS%",r),s=d(s,n),s=f(s,r),0<c.template.indexOf(":")&&(s=l(s.split(":")).map(function(e){return 0<e&&this.match(/^[0-9]$/)?"0"+this:this}).toArray().join(":")),s};var d=function(e,t){return e=1==t?e.replace(/\[m\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[m\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")},f=function(e,t){return e=1==t?e.replace(/\[s\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[s\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")},p=function(e,t){return 0==t?e="":(e=e.replace("[[","").replace("]]",""),e=1===t?e.replace(/\[d\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[d\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")),e},h=function(e,t){return 0==t?e="":(e=e.replace("[[","").replace("]]",""),e=1==t?e.replace(/\[h\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,""):e.replace(/\[h\*([a-z\u0391-\u03a9\u03b1-\u03c9\u03af\u03ca\u0390\u03cc\u03ac\u03ad\u03cd\u03cb\u03b0\u03ae\u03ce]+)\]/i,"$1")),e};n()},Fera.TitleBarManager=function(e){e=e||{};var t,n=this,r=function(){t=document.title,t};n.setTitle=function(e){document.title,document.title=e,e},n.resetToOriginal=function(){document.title,document.title=t,t},r()},Fera.Util={toTitleCase:function(e){return e.replace(/\w\S*/g,function(e,t,n){return 0<e.indexOf(".")&&e.indexOf(".")<e.length-1?e.toUpperCase():e.length<=3&&(","===e.trim().substr(-1)||e.length+t===n.length)&&(0<t&&","===n.substr(t-1,1)||1<t&&","===n.substr(t-2,1))?e.toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},truncateTextToMaxWidth:function(e){var r=this.$();e.each(function(){var e=r(this),t=parseFloat(e.css("max-width"));if(e.width()>t)for(var n=e.html().trim();e.width()>t;)n=n.slice(0,-1),e.html(n+"...")})},debounce:function(n,r,i){var a;return function(){var e=this,t=arguments;clearTimeout(a),a=setTimeout(function(){a=null,i||n.apply(e,t)},r),i&&!a&&n.apply(e,t)}},throttle:function(r,i,a){var o,s;return function(){var e=this,t=arguments,n=(new Date).getTime();if(!s||s+i<n)return s=(new Date).getTime(),r.apply(e,t);a&&(o=o||setTimeout(function(){o=null,s=(new Date).getTime(),r.apply(e,t)},i-(n-s)))}},generateUUID:function(){var n=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(n+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})},isFullyVisible:function(e){if(e.data("always_visible"))return!0;if((Object&&Object.getPrototypeOf?Object.getPrototypeOf(e).jquery:$&&$.zepto)&&!e.is(":visible"))return!1;if(!this.isScrolledIntoView(e))return!1;if("none"==e.css("display")||"hidden"==e.css("visibility")||0==e.css("opacity"))return!1;for(var t=e.parent();"BODY"!==t.prop("tagName");){if("hidden"==t.css("visibility")||0==t.css("opacity"))return!1;t=t.parent()}return!0},parseBool:function(e){return void 0!==e&&-1!==[1,"1","true","t","yes",!0,2].indexOf(e)},outerHeight:function(e){var t,n,r=e.get(0);if(navigator&&navigator.appVersion&&-1!==navigator.appVersion.indexOf("MSIE 9.")){var i=r.offsetHeight,a=getComputedStyle(r);return i+parseInt(a.marginTop)+parseInt(a.marginBottom)}return"undefined"!=typeof r.offsetHeight?r.offsetHeight:("number"!=typeof(t=document.defaultView.getComputedStyle(r,"").getPropertyValue("height"))&&(t=0),n=parseInt(document.defaultView.getComputedStyle(r,"").getPropertyValue("margin-top"))+parseInt(document.defaultView.getComputedStyle(r,"").getPropertyValue("margin-bottom")),parseFloat(t)+parseFloat(n))},isHome:function(){return-1===window.location.toString().replace(/^https?:\/\/([a-zA-Z0-9_\-.]+)\/?([?#][#a-z=\-_A-Z0-9&]+)?$/i,"$1").indexOf("/")},updateURLParameter:function(e,t,n){var r="",i=e.split("?"),a=i[0],o=i[1],s="";if(o){i=o.split("&");for(var u=0;u<i.length;u++)i[u].split("=")[0]!=t&&(r+=s+i[u],s="&")}var c=a+"?"+r;return null!==n&&(c+=s+t+"="+n),c===a+"?"?a:c},isFullyInvisible:function(e){return!this.isFullyVisible(e)},isScrolledIntoView:function(e){var t=Fera.Util.$()(window).scrollTop(),n=t+Fera.Util.$()(window).height(),r=e.offset().top;return r+e.height()<=n&&t<=r},scrollToElement:function(r,i){(i="object"==typeof i?i:{}).duration="undefined"==typeof i.duration?200:i.duration,i.callback=i.callback||function(){},i.position="undefined"==typeof i.position?"center":i.position;var a,o=Fera.Util.$()(window),s=i.duration,u=10,c=(new Date).getTime(),l=this,d=function(){var e=r.offset().top,t=window.innerHeight||o.height(),n=l.outerHeight(r);return"center"===i.position&&n<t&&(e-=t/2,e+=n/2),e},f=setInterval(function(){if(a=(new Date).getTime(),s-=u=a-c,!r.offset()||0===r.offset().top)return clearInterval(f),i.callback(r);var e=d();if(s<=0)return o.scrollTop(e),clearInterval(f),i.callback(r);var t,n=o.scrollTop()-e;t=i.duration-s<100?n/(s/u*2):s<100?n/(s/u):n/((s-50)/u),o.scrollTop(o.scrollTop()-t),c=(new Date).getTime()},10)},addZepto:function(e,t){t=t||function(){},new FeraCachedAsset({name:"zepto",version:"1.2.0",expiresIn:(e=e||{}).devMode?15:900,url:"https://cdn.fera.ai/js/lib/zepto"+(e.debugMode?"":".min")+".js"}).load(t)},$:function(){return this._$&&"function"==typeof this._$?this._$:"undefined"!=typeof jQuery&&jQuery.fn&&jQuery.fn.jquery&&!jQuery.fn.jquery.match(/1\.[0-7]\./)?this._$=jQuery:"undefined"!=typeof Zepto?this._$=Zepto:"undefined"!=typeof $&&"undefined"!=typeof $.fn&&"undefined"!=typeof $.fn.jquery?this._$=$:(Fera.logger.warn("Something must have removed jQuery/Zepto because it is no longer present after the application has already started. Zepto will be added in now."),this.addZepto(),null)},hasValid$:function(e){var t=window.Zepto||window.jQuery||window.$;if(t&&t.fn&&t.fn.jquery){if(!t.fn.jquery.match(/1\.[0-7]\./))return"jquery";e&&Fera.logger.warn("You're running an outdated version of jQuery that may cause problems on the site (v "+t.fn.jquery+"). We highly recommend you upgrade to a newer version.")}else if(t)return"zepto";return!1},showWithoutTransform:function(e){e.show().css({"-webkit-transform":"","-moz-transform":"","-ms-transform":"","-o-transform":"",transform:""})},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},shuffleArray:function(e){var t,n,r;for(r=e.length-1;0<r;r--)t=Math.floor(Math.random()*(r+1)),n=e[r],e[r]=e[t],e[t]=n;return e},isNullOrEmpty:function(e){return!e||e===undefined||""===e||0===e.length},detectBrowser:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===n[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))},ie:function(){return 0===this.detectBrowser().indexOf("IE")||-1!==this.detectBrowser().indexOf("MSIE")},maxGetRequestChars:function(){return-1!==this.detectBrowser().indexOf("MSIE")?2e3:6e3},sizeOfParams:function(e){return encodeURI(Fera.Util.$().param(e)).split(/%..|./).length-1},_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,a,o,s,u="",c=0;for(e=this._utf8_encode(e);c<e.length;)i=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(r=e.charCodeAt(c++))>>6,s=63&r,isNaN(n)?o=s=64:isNaN(r)&&(s=64),u=u+this._keyStr.charAt(i)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return u},decode:function(e){var t,n,r,i,a,o,s="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)t=this._keyStr.indexOf(e.charAt(u++))<<2|(i=this._keyStr.indexOf(e.charAt(u++)))>>4,n=(15&i)<<4|(a=this._keyStr.indexOf(e.charAt(u++)))>>2,r=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(u++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(n)),64!=o&&(s+=String.fromCharCode(r));return s=this._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):191<r&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t},jsonHasArray:function(e){for(var t in e)if(e[t]&&"object"==typeof e[t]&&e[t].constructor===Array)return!0;return!1},httpMethodToUse:function(e){return this.sizeOfParams(e)>this.maxGetRequestChars()||this.jsonHasArray(e)?"POST":"GET"},onRemove:function(e,n){var r=Fera.Util.$()(e),i=new MutationObserver(function(){var t=function(e){return e.parentNode!==document&&(null===e.parentNode||e.parentNode===undefined||t(e.parentNode))};t(r[0])&&(i.disconnect(),n(r))});i.observe(document,{childList:!0,subtree:!0});var t=r.data("removeObservers")||[];return t.push(i),r.data("removeObservers",t),i},disconnectRemoveHandlers:function(e){var t=Fera.Util.$()(e),n=t.data("removeObservers");return!!n&&(Fera.Util.$().each(n,function(e,t){t.disconnect()}),t.data("removeObservers",[]),!0)},abbreviateNumber:function(e,t){if(null===e)return null;if(0===e)return"0";t=!t||t<0?0:t;var n=e.toPrecision(2).split("e"),r=1===n.length?0:Math.floor(Math.min(n[1].slice(1),14)/3),i=r<1?e.toFixed(0+t):(e/Math.pow(10,3*r)).toFixed(1+t);return(i<0?i:Math.abs(i))+["","K","M","B","T"][r]},arrayToSentence:function(e){return 0===e.length?"":1===e.length?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},formatFullName:function(e,t){var n=e.trim().split(/\s+/);switch(t){case"first_name":return n[0];case"last_name":return n[n.length-1];case"initials":for(var r=[],i=0;i<n.length;i++)r.push(n[i][0].toUpperCase()+".");return r.join(" ");case"first_name_and_last_initial":var a=n[0];return 1<n.length&&(a+=" "+n[n.length-1][0].toUpperCase()+"."),a;default:return e}}},Fera.VariantLoader=function(n){var r=this;n=n||{};var e=Fera.Util.$(),t=function(){r.$form=e('form[action~="/cart/add"]'),r.variantId=null,r.loadVariant(),r.$form.find("select,input,textarea").on("change",function(){setTimeout(function(){r.loadVariant(!0)},1)}),r.onUrlChange(function(){r.loadVariant(!0)})};r.onUrlChange=function(t){e(window).on("hashchange",t);var n=window.location.toString();setInterval(function(){var e=window.location.toString();e!==n&&(n=e,t())},100)},r.loadVariant=function(e){void 0===e&&(e=!1),r.findVariantId(),n.app.getVariantId()!==r.variantId&&(n.app.setVariantId(r.variantId),e&&n.app.refreshContent())},r.findVariantId=function(){if(r.variantId=i(),r.variantId&&""!==r.variantId)return r.variantId;var e=r.$form.serializeArray().find(function(e){return"id"===e.name});if(e)return r.variantId=e.value,r.variantId;var t=n.app.getProduct();return t?t.variants[0].id:null};var i=function(){var e=/variant=(.*?)(&|$)/,t=window.location.href.match(e);return t?parseInt(t[1]):null};t()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Verifier=function(){function t(e){_classCallCheck(this,t),this._opts=e,this.$=Fera.Util.$(),this._skillSelectorsToVerify=[],this._popovers=[],this.app=this._opts.app,this._opts.app.on("widget.create",this._onSkillCreate.bind(this)),this._opts.app.on("notification.show",this._onNotifShow.bind(this)),this._opts.debugMode&&(window.verifier=this)}return _createClass(t,[{key:"_onSkillCreate",value:function n(e){e.settings&&e.settings.show_verification&&e.$el&&(e.$el.length<1||("product_detail_counter"!=e.type||e.$el.is(".fera-recentOrderCount")?"product_list_counter"==e.type&&this._skillSelectorsToVerify.push(e.$el):this._skillSelectorsToVerify.push(e.$el.find(".banana-sentence,.fera-sentence")),this._attachPopovers()))}},{key:"addVerificationIcon",value:function i(e,t){var n=arguments.length<=1||t===undefined?{}:t,r=this.$(this.constructor._iconTpl(n));return e.append(r),this._attachPopover(e),r}},{key:"_attachPopovers",value:function e(){var n=this;this._skillSelectorsToVerify.forEach(function(e){n.$(e).each(function(e,t){n._attachPopover(n.$(t))})})}},{key:"_onNotifShow",value:function r(e){e.settings.show_verification&&this.addNotifIcon(e.popup.$el)}},{key:"addNotifIcon",value:function a(e){var t=this;this._loadAssets(function(){t._notifIcon=new Fera.Verification.Icon({$target:e.find(".fera-event-time-ago"),iconTpl:t.constructor._iconTpl()}),t._notifIcon.show()})}},{key:"_attachPopover",value:function o(n){var r=this;n.data("fera-verifier-attached")||n.on("mouseenter",function(){r._loadAssets(function(){if(!n.data("fera-verifier-attached")){var e=new Fera.Verification.Popover(n);if(e.show(),r._popovers.push(e),1<r._popovers.length){var t=r._popovers.map(function(e){return e.getInstance()});t=t.filter(function(e){if(e)return e}),r._popovers[0].createOrUpdateSingleton(t)}n.addClass("fera-verified"),n.data("fera-verifier-attached",!0)}})})}},{key:"_setupListeners",value:function s(){var t,n=this;new MutationObserver(function(e){e.forEach(function(e){e.addedNodes&&(t||(t=setTimeout(function(){clearTimeout(t),n._attachPopovers()},10)))})}).observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}},{key:"_loadAssets",value:function u(t){var n=this;if(t=t||function(){},this._loadedAssets)return t();if(this._loadingAssets)return setTimeout(function(){return n._loadAssets(t)},50);this._loadingAssets=!0;var e="";e=-1!==this._opts.api.baseAppPath.indexOf("ngrok.")||-1!==this._opts.api.baseAppPath.indexOf("localhost")||-1!==this._opts.api.baseAppPath.indexOf("test-")?this._opts.api.baseAppPath+"/assets/public/fera.verification.js?v="+this.app.version:"https://cdn.jsdelivr.net/gh/feracommerce/ferajs@"+this.app.version+"/dist/fera.verification.js";var r=this._opts.debugMode?1:900;new FeraCachedAsset({name:"Fera.Verifcation.Js",url:e,expiresIn:r}).load(function(){try{n._setupListeners(),n._loadedAssets=!0,n._loadingAssets=!1,t()}catch(e){if(n._opts.debugMode)throw e}})}}],[{key:"_iconTpl",value:function c(e){return'<svg height="'+((arguments.length<=0||e===undefined?{}:e).height||16)+'" viewBox="0 0 28 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="fera-validation-icon fera-validation-icon--sm">\n            <path d="M8.08787 1.53793C8.08787 2.38731 7.39477 3.07586 6.53979 3.07586C5.68481 3.07586 4.99171 2.38731 4.99171 1.53793C4.99171 0.688554 5.68481 0 6.53979 0C7.39477 0 8.08787 0.688554 8.08787 1.53793Z" fill="#EF4323" class="fera-verification-icon-sm-1"></path>\n            <path d="M16.3635 1.66374C16.3635 2.51312 15.6704 3.20167 14.8155 3.20167C13.9605 3.20167 13.2674 2.51312 13.2674 1.66374C13.2674 0.814365 13.9605 0.125811 14.8155 0.125811C15.6704 0.125811 16.3635 0.814365 16.3635 1.66374Z" fill="#EF4323" class="fera-verification-icon-sm-2"></path>\n            <path d="M20.5 5.54887C20.5 6.39825 19.8069 7.0868 18.9519 7.0868C18.0969 7.0868 17.4038 6.39825 17.4038 5.54887C17.4038 4.69949 18.0969 4.01094 18.9519 4.01094C19.8069 4.01094 20.5 4.69949 20.5 5.54887Z" fill="#EF4323" class="fera-verification-icon-sm-3"></path>\n            <path d="M3.54806 5.44971C3.54806 6.29908 2.85496 6.98763 1.99998 6.98763C1.145 6.98763 0.451904 6.29908 0.451904 5.44971C0.451904 4.60033 1.145 3.91178 1.99998 3.91178C2.85496 3.91178 3.54806 4.60033 3.54806 5.44971Z" fill="#EF4323" class="fera-verification-icon-sm-4"></path>\n            <path d="M12.3526 5.54888C12.3526 6.39826 11.6595 7.08681 10.8045 7.08681C9.94953 7.08681 9.25643 6.39826 9.25643 5.54888C9.25643 4.6995 9.94953 4.01095 10.8045 4.01095C11.6595 4.01095 12.3526 4.6995 12.3526 5.54888Z" fill="#EF4323" class="fera-verification-icon-sm-5"></path>\n            <path d="M6.64421 10.5C6.64421 11.3494 5.95111 12.0379 5.09614 12.0379C4.24116 12.0379 3.54806 11.3494 3.54806 10.5C3.54806 9.65062 4.24116 8.96207 5.09614 8.96207C5.95111 8.96207 6.64421 9.65062 6.64421 10.5Z" fill="#EF4323" class="fera-verification-icon-sm-6"></path>\n            <path d="M12.3526 14.4621C12.3526 15.3115 11.6595 16 10.8045 16C9.94953 16 9.25643 15.3115 9.25643 14.4621C9.25643 13.6127 9.94953 12.9241 10.8045 12.9241C11.6595 12.9241 12.3526 13.6127 12.3526 14.4621Z" fill="#EF4323" class="fera-verification-icon-sm-7"></path>\n            <path d="M19 5.5L14.8155 1.53796L10.8045 6L6.34792 1.53796L2 5.5L5 10.5L10.8045 14.4621" stroke="#EF4323" class="fera-verification-icon-sm-8"></path>\n            <path d="M13.5872 9.66042L18.0438 14.4621L27 5" stroke="#00C48D" stroke-width="2" stroke-linejoin="round" class="fera-verification-icon-sm-9"></path>\n        </svg>'}}]),t}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.VideoViewer=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function t(e){this.rendered||(this.$=Fera.Util.$(),this._render(),this.$el.find(".fera-videoViewer-container").on("click",this._hide.bind(this)),this.rendered=!0),e.on("click",this._show.bind(this))}},{key:"_show",value:function i(e){var t=this,n=this.$(e.target).clone().removeClass();if(n.data("videoUrl")){var r=n.data("videoUrl");n=n.data("videoIsImported")&&"url"!==n.data("videoType")?$(this.setImportedVideoTpl(r,n.data("videoType"))):$('<video src="'+r+'" controls>')}this.$el.removeClass("fera-hidden"),this.$el.find(".fera-videoViewer").html(n.attr("controls",!0)),this.$("body").addClass("fera-modal--open"),$(document).on("keydown",function(e){27===(e.keyCode||e.which)&&t._hide()})}},{key:"setImportedVideoTpl",value:function r(e,t){var n=this._prepareImportedVideoUrl(e,t);return["youtube","vimeo","instagram"].includes(t)?'<iframe src="'+n+'" width="640" height="480"\n                    frameborder="0" allow="accelerometer; autoplay; picture-in-picture"\n                    allowfullscreen></iframe>':'<video src="'+n+'" controls>'}},{key:"_prepareImportedVideoUrl",value:function n(e,t){if("url"===t)return e;({youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9\.]+\/videos\/(?:[a-zA-Z0-9\.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/})[t].test(e);return"youtube"===t?e="https://www.youtube.com/embed/"+RegExp.$5:"vimeo"===t?e="https://player.vimeo.com/video/"+RegExp.$5:"instagram"===t&&(e="https://www.instagram.com/p/"+RegExp.$2+"/embed"),e}},{key:"_hide",value:function a(e){if(e&&!this.$(e.target).is(".fera-videoViewer-container"))return;this.$el.addClass("fera-hidden"),this.$("body").removeClass("fera-modal--open")}},{key:"_render",value:function o(){this.$("body").append(this._tpl()).append("<style>"+this._css()+"</style>"),this.$el=this.$(".fera-videoViewer-overlay")}},{key:"_tpl",value:function s(){return'\n<div class="fera-videoViewer-overlay fera-hidden">\n    <div class="fera-videoViewer-container">\n        <div class="fera-videoViewer"></div>\n    </div>\n</div>\n        '}},{key:"_css",value:function u(){return"\n.fera-modal--open {\n    overflow: hidden !important;\n}\n\n.fera-hidden {\n    display: none !important;\n}\n\n.fera-videoViewer-overlay {\n    position: fixed;\n    background: rgba(0,0,0,0.4);\n    z-index: 9999999;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fera-videoViewer-container {\n    height: 100vh;\n    width: 100vw;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.fera-videoViewer {\n    max-width: 900px;\n    margin: 15px;\n}\n\n.fera-videoViewer video {\n    width: 100% !important;\n    max-height: 100vh;\n}\n\n.fera-videoViewer-viewable {\n    cursor: pointer;\n}\n        "}}]),e}(),Fera.BaseContainer=function(e){e=e||{};var i=this,t=Fera.Util.$();i.id=e.id;var n=function(){i.$container=e.el,i.dataAttr=r(i.$container)};this.dispatchEvent=function(t,n,r){r=r||function(){},i.each(function(e){"function"==typeof e.dispatchEvent&&e.dispatchEvent(t,n,r)})},this.selector=function(){return i.$container},this.hasDataAttr=function(e){return i.dataAttr[e]&&""!=i.dataAttr[e]},this.getDataAttr=function(e){return i.dataAttr[e]};var r=function(e){var r={},i=/^data\-(.+)$/;return t.each(e.get(0).attributes,function(e,t){if(i.test(t.nodeName)){var n=t.nodeName.match(i)[1];r[n]=t.nodeValue}}),r};n()},Fera.ContainerCollection=function(d){d=d||{};var e,f=this,r=Fera.Util.$(),s=[],t=0,n=!1,i=function(){f.locateNewContainers(),a(),setTimeout(function(){m(),o()},100)};this.updateContentFromCache=function(){f.globalBottom&&f.globalBottom.updateContentFromCache()},this.locateNewContainers=function(){var n=[];return r(".banana-container").each(function(){var e=d;if(e.el=r(this),!e.el.data("bsio-container-id")){var t=Fera.ContainerFactory.create(e.el.data("container_type"),e);t&&(s.push(t),n.push(t),t.constructor===Fera.GlobalBottomContainer&&(f.globalBottom=t))}}),f.length=s.length,n},this.triggerWidget=function(t,n){this.each(function(e){"undefined"!=typeof e.triggerWidget&&e.triggerWidget(t,n)})},this.triggerSkill=this.triggerWidget;var a=function(){20<f.length&&(n=!0)};this.size=function(){return s.length},this.updateContent=function(e,t,n){if(n=n||function(){},!e.content_responses)return d.logger.logWarning("Content responses result was empty so content couldn't be updated.",e),n();for(var r=e.content_responses.length,i=0,a=function(){i++},o=setInterval(function(){r<=i&&(clearInterval(o),o=null,n())},1),s=0;s<e.content_responses.length;s++){var u=e.content_responses[s];if(u){var c=f.getContainerById(u.container_id);if(!c){a();continue}try{c.updateContent(u,a)}catch(l){d.logger.error(l),a()}c.needsUpdate=!1}else d.logger.logWarning("Fera did not receive persistent content for container so nothing was displayed for that container.",u),a()}},this.markAllContainersAsDirty=function(){s&&f.each(function(e){e.needsUpdate=!0})},this.getContainerById=function(e){for(var t=0;t<s.length;t++)if(s[t].id==e)return s[t];return null},this.getContentRequest=function(e,t){for(var n=[],r=void 0===t?s:t,i=0;i<r.length;i++){var a=r[i];if(a.needsUpdate){if(u(a))continue;var o=a.getContentRequest(e);if(!o){a.needsUpdate=!1;continue}o.container_id=a.id,n.push(o)}}return n};var u=function(e){return!!n&&(!e.isVisible()&&!e.alwaysVisible&&(t/1e3<(new Date).getTime()/1e3-60&&(t=(new Date).getTime()),!0))};this.each=function(e){for(var t=0;t<s.length;t++)e(s[t],t);return this},this.find=function(e){for(var t=0;t<s.length;t++)if(e(s[t],t))return s[t];return null},this.toArray=function(){return s},this.indexOf=function(e){for(var t="number"==typeof e?e:e.id,n=0;n<s.length;n++)if(s[n].id==t)return n;return-1},this.removeByIndex=function(e){return s[e]?s.splice(e,1):(d.logger.logWarning("Could not remove container at index because it does not exist.",e),null)},this.remove=function(e){return f.removeByIndex(f.indexOf(e))},this.removeAll=function(e){for(var t=0;t<e.length;t++)f.remove(e[t]);return e},this.dispatchEvent=function(t,n,r){r=r||function(){},f.each(function(e){e.dispatchEvent&&e.dispatchEvent(t,n,r)})};var o=function(){f.each(function(e){e.wasVisible=e.isVisible()})},c=function(){var t=[],n=[];f.each(function(e){!e.isVisible()||e.wasVisible||e.alwaysVisible?e.isVisible()||!e.wasVisible||e.alwaysVisible||(n.push(e),e.wasVisible=!1):(t.push(e),e.wasVisible=!0)}),0<t.length&&o();var e=0;for(e=0;e<t.length;e++
)t[e].onBecomeVisible&&t[e].onBecomeVisible();for(e=0;e<n.length;e++)n[e].onBecomeVisible&&n[e].onBecomeInvisible()},l=function(){var e=f.locateNewContainers();if(0<e.length){h();var t=f.getContentRequest({},e);return f.updateContainers(!1,function(){m()},t),!0}return!1},p=function(){var t=[];return f.each(function(e){r.contains(document.documentElement,e.$container[0])||t.push(e)}),f.removeAll(t),t},h=function(){clearInterval(e)},m=function(){e&&clearInterval(e),e=setInterval(function(){p(),l()?o():c()},100)};i()},Fera.ContainerFactory={create:function(e,t){t.id=Fera.ContainerFactory.nextContainerId();var n=!1;return"global_bottom"==e&&(n=new Fera.GlobalBottomContainer(t)),n&&(n.$container.data("bsio-container-id",t.id),n.$container.data("fera-container-id",t.id)),n},nextContainerId:function(){return window.__bsioLastContainerId=window.__bsioLastContainerId||0,window.__bsioLastContainerId++,window.__bsioLastContainerId}},Fera.GlobalBottomContainer=function FeraGlobalBottomContainer(s){s=s||{};var f=this;f.baseContainer=new Fera.BaseContainer(s),f.id=s.id;var r,i=1,n="global_bottom";f.alwaysVisible=!0;var e=[],a=!1,t=function(){f.needsUpdate=!0,(r={container:f,cookieJar:s.cookieJar,debugMode:s.debugMode,testMode:s.testMode,logger:s.logger,localStorage:s.localStorage,adminMode:s.adminMode,optionsParser:s.optionsParser,app:s.app,api:s.api,timeTracker:s.timeTracker}).engagementTracker=s.engagementTracker,f.abstractBlocks={},o()};this.updateContentFromCache=function(){return!(s.app.opts.sandboxMode||s.app.opts.testMode||s.app.opts.adminMode||s.app.opts.previewMode)&&(a=!0,u(e),!(a=!1))},this.triggerWidget=function(n,r){this.each(function(e,t){parseInt(n)===parseInt(t)&&"undefined"!=typeof e.triggerWidget&&(e.triggerWidget(r)||"manual"!==e.settings.trigger||"custom_popup"!==e.type||(e.remove(),f.abstractBlocks[e.skillId]=c(e.lastDisplayerResponse),f.abstractBlocks[e.skillId].triggerWidget(r)))})},this.triggerSkill=this.triggerWidget,this.each=function(e){for(var t=Object.keys(f.abstractBlocks),n=0;n<t.length;n++)e(f.abstractBlocks[t[n]],t[n],n);return f};var p=function(e){if(!s.sandboxMode&&!f.hasPreview&&!a){for(var t=[],n=864e5,r=0;r<e.length;r++){var i=e[r];i.cacheable&&t.push(i)}s.app.localStorage.setObject("Cache.DisplayerResponses",t,n)}},o=function(){if(s.app.opts.sandboxMode||s.app.opts.testMode||s.app.opts.adminMode||s.app.opts.previewMode)return!1;e=s.app.localStorage.getObject("Cache.DisplayerResponses",[])},u=function(e,t,n){t=t||[];var r=!1,i={},a=e.length,o=0;p(e);for(var s=function(){o++},u=setInterval(function(){1,a<=o&&(clearInterval(u),u=null,n&&n(r||f.hasPreview))},1),c=0;c<a;c++){var l=e[c],d=l.campaign_id;f.hasPreview=f.hasPreview||l.isPreview,l.contexts&&0<l.contexts.length?h(i,l,d,s)&&(r=!0):m(i,l,d,s)&&(r=!0)}return g(t),r},h=function(e,t,n,r){for(var i=!1,a=Object.keys(t.html),o=0;o<a.length;o++){var s=a[o],u=$.extend({},t,{html:t.html[s],context:String(s)});u.settings=$.extend({},t.settings),u.settings.integration_selector+="[data-product_id='"+s+"']",m(e,u,[n,s].join("."),r)&&(i=!0)}return i},m=function(e,t,n,r){try{return f.abstractBlocks[n]?(f.abstractBlocks[n].isPreview?(f.abstractBlocks[n].remove(),f.abstractBlocks[n]=c(t,r)):f.abstractBlocks[n].settings&&!f.abstractBlocks[n].settings.needs_updates||f.abstractBlocks[n].update(t,r),e[n]=!0):f.abstractBlocks[n]=c(t,r),Fera.Util.showWithoutTransform(f.$container),!0}catch(i){s.logger.error(i)}return!1},g=function(e){if(f.abstractBlocks)for(var t=Object.keys(f.abstractBlocks),n=0;n<e.length;n++)try{for(var r=e[n],i=0;i<t.length;i++){var a=t[i];a.split(".")[0]==r&&f.abstractBlocks[a].settings&&f.abstractBlocks[a].settings.needs_updates&&(f.abstractBlocks[a].remove(),f.abstractBlocks[a]=null)}}catch(o){s.logger.error(o)}},c=function(e,t){var n=new Fera.CustomContainer(r);return n.id=f.id.toString()+"_"+i++,n.create(e,function(){},t),n};this.updateContent=function(e,t){return t=t||function(){},e.abstract_blocks?u(e.abstract_blocks,e.hidden_blocks,t):(f.$container.hide(),t(!1),!1)},this.getContentRequest=function(e){e=e||{};var t=f.dataAttr;return t.container_type=n,t},this.getDataAttr=f.baseContainer.getDataAttr,this.hasDataAttr=f.baseContainer.hasDataAttr,this.dataAttr=f.baseContainer.dataAttr,this.selector=f.baseContainer.selector,this.$container=f.baseContainer.$container,this.isVisible=function(){return Fera.Util.isFullyVisible(f.$container)},t()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions=Fera.Actions||{},Fera.Actions.Base=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"run",value:function n(){this._error("isStillThere must be implemented by Fera.Actions.CustomBlocks.Base")}},{key:"update",value:function r(){}}]),t}(Fera.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.ChangeBlockAction=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.skill=e,this.action=null}return _inherits(t,e),_createClass(t,[{key:"run",value:function n(){if(this.$target=this.$(this.skill.settings.target_selector),"hide"===this.skill.settings.target_action)this.action=this._createNewAction(this.$target,"hide");else if("move"===this.skill.settings.target_action){this.$destination=this.$(this.skill.settings.integration_selector);var e=this.skill.settings.integration_selector_action;this.action=this._createNewAction(this.$destination,e)}else this.action=this._createNewAction(this.$target,"replace");this.action&&this.action.run(this.skill)}},{key:"update",value:function r(){this.action&&this.action.update(this.skill)}},{key:"_createNewAction",value:function i(e,t){return"insert_after"===t?new Fera.Actions.CustomBlocks.InsertAfterAction(e):"insert_before"===t?new Fera.Actions.CustomBlocks.InsertBeforeAction(e):"append_to"===t?new Fera.Actions.CustomBlocks.AppendAction(e):"prepend_to"===t?new Fera.Actions.CustomBlocks.PrependAction(e):"replace"===t?new Fera.Actions.CustomBlocks.ReplaceAction(e):"hide"===t?new Fera.Actions.CustomBlocks.HideAction(e):(this._error("Unknown integration selector location configured.",this.skill.settings,e),null)}},{key:"remove",value:function a(){this.action&&this.action.remove()}}]),t}(Fera.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks=Fera.Actions.CustomBlocks||{},Fera.Actions.CustomBlocks.Base=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.$targetEl=e}return _inherits(t,e),_createClass(t,[{key:"isStillThere",value:function n(){return this.$.contains(document.documentElement,this.$el.get(0))}},{key:"makeChange",value:function r(){this._error("#makeChange must be implemented by Fera.Actions.CustomBlocks.Base")}},{key:"run",value:function i(e){if(this.$el&&this.isStillThere())return!1;this._setElement(e),this.makeChange()}},{key:"refreshOnTargetChange",value:function a(){return!1}},{key:"_setElement",value:function o(e){"hide"===e.settings.target_action?this.$el=this.$targetEl:"move"===e.settings.target_action?(this.$movePlaceHolder=this.$("<div></div>"),this.$el=this.$(e.settings.target_selector).replaceWith(this.$movePlaceHolder)):(this.$el=this.$(e.html.replace(/<!--[\s\S]*?-->/g,"").trim()),this.$el.attr("data-fera-widget",e.widgetId),this.$el.attr("data-fera-skill",e.widgetId))}},{key:"update",value:function s(e){return this.isStillThere()?this._updateBlock(e):this.run(e),!0}},{key:"remove",value:function u(){this.$el.remove(),this.$movePlaceHolder&&this.$movePlaceHolder.replaceWith(this.$el)}},{key:"_updateBlock",value:function c(e){"move"!==e.settings.target_action&&"hide"!==e.settings.target_action&&this.$el.html(this.$(e.html.replace(/<!--[\s\S]*?-->/g,"").trim()).html())}}]),t}(Fera.Actions.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks.AppendAction=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"makeChange",value:function n(){this.$targetEl.append(this.$el)}},{key:"isStillThere",value:function r(){return this.$.contains(this.$targetEl.get(0),this.$el.get(0))}}]),t}(Fera.Actions.CustomBlocks.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks.HideAction=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"makeChange",value:function n(){this.$targetEl.hide()}},{key:"isStillThere",value:function r(){return"none"==this.$targetEl.css("display")}},{key:"remove",value:function i(){this.$targetEl.show()}}]),t}(Fera.Actions.CustomBlocks.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks.InsertAfterAction=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"makeChange",value:function n(){this.$targetEl.after(this.$el)}},{key:"isStillThere",value:function r(){return this.$.contains(this.$targetEl.parent().get(0),this.$el.get(0))}},{key:"refreshOnTargetChange",value:function i(){return!0}}]),t}(Fera.Actions.CustomBlocks.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks.InsertBeforeAction=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"makeChange",value:function n(){this.$targetEl.before(this.$el)}},{key:"isStillThere",value:function r(){return this.$.contains(this.$targetEl.parent().get(0),this.$el.get(0))}},{key:"refreshOnTargetChange",value:function i(){return!0}}]),t}(Fera.Actions.CustomBlocks.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks.PrependAction=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"makeChange",value:function n(){this.$targetEl.prepend(this.$el)}}]),t}(Fera.Actions.CustomBlocks.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Actions.CustomBlocks.ReplaceAction=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"makeChange",value:function n(){this.$oldElement=this.$targetEl.replaceWith(this.$el)}},{key:"remove",value:function r(){this.$el.replaceWith(this.$oldElement),_get(Object.getPrototypeOf(t.prototype),"remove",this).call(this)}}]),t}(Fera.Actions.CustomBlocks.Base),Fera.CustomContainer=function FeraCustomContainer(opts){opts=opts||{};var self=this,$=Fera.Util.$(),campaignSettings,ran=!1,registeredEngagement=!1,keyNamespace,feraSkill,eventPrefix,actions=new Fera.ActionCollection,triggered=!1,triggerDelay,init=function(){self.$globalTopContainer=opts.container.$container,self.$container=$('<div class="banana-container-row banana-custom-container"></div>'),self.$container.appendTo(self.$globalTopContainer)};this.create=function(jsonResponse,removeCallback,afterCreate){ran=!1;var continueCreate=!0;assignLocalVarsFromServer(jsonResponse),triggerBeforeCreateEvents(eventPrefix),eval(self.lastDisplayerResponse.js),"function"==typeof FeraWidget?feraSkill=new FeraWidget(self):"function"==typeof FeraSkill&&(feraSkill=new FeraSkill(self)),prepare(feraSkill,function then(e,t){if(!self.removed)return!1===e?(Fera.logger.log("Widget hidden by beforeRender",t,self),self.createInProgress=!1):void generateStateVars(function(){if(self.removed)return!1;if(!self.isPreview&&opts.app.storeSettings.use_client_side_processing){if(!checkConditions())return self.createInProgress=!1;if(!checkAbTests())return self.createInProgress=!1}!self.lastDisplayerResponse.html&&self.lastDisplayerResponse.renders_template_client_side&&_renderTemplate(),setupShopperActionTriggers(),setupTriggerDelays(),waitForRun(function e(){if(self.removed)return!1;feraSkill&&feraSkill.run&&(continueCreate=feraSkill.run()),!1!==continueCreate?(campaignSettings.target_selector&&pullElementsFromTarget(),self.isPreview||(markSeen(),self.registerEngagement(jsonResponse.campaign_id)),triggerAfterCreateEvents(eventPrefix),feraSkill&&feraSkill.afterCreate&&feraSkill.afterCreate(),self.$el&&self.$el.each(function(e,t){Fera.Util.onRemove(t,removeCallback||function(){})}),afterCreate&&afterCreate(!0)):(opts.logger.log("Creation blocked by Fera widget returned response.",feraSkill),afterCreate&&afterCreate(!1)),self.createInProgress=!1})})})};var assignLocalVarsFromServer=function(e){self.lastDisplayerResponse=e,campaignSettings=self.lastDisplayerResponse.settings,self.app=opts.app,self.api=opts.api,self.adminMode=opts.adminMode,self.memory=new Fera.SkillsLocalStorage({logger:opts.logger,cookieJar:opts.cookieJar,namespace:keyNamespace}),self.localStorage=self.memory,self.lastDisplayerResponse.html&&(self.html=self.lastDisplayerResponse.html),self.options=self.settings=campaignSettings,self.storeSettings=self.app.storeSettings||self.lastDisplayerResponse.store||self.lastDisplayerResponse.store_settings||{},self.widgetId=self.skillId=self.lastDisplayerResponse.campaign_id,self.isPreview=e.isPreview||opts.optionsParser.getPreviewId()==self.widgetId,self.type=self.lastDisplayerResponse.type,keyNamespace="Fera.Widget."+self.widgetId,eventPrefix="widget."+self.widgetId},triggerBeforeCreateEvents=function(e){triggerFeraEvent(e+".create:before"),triggerFeraEvent("widget.create:before"),triggerEvent("Fera.Skill."+self.widgetId+"-create-before"),triggerEvent("fera-skill-create-before"),triggerFeraEvent(e.replace("widget","skill")+".create:before"),triggerFeraEvent("skill.create:before")},triggerAfterCreateEvents=function(e){triggerFeraEvent(e+".create"),triggerFeraEvent(e+".create:after"),triggerFeraEvent("widget.create"),triggerFeraEvent("widget.create:after"),triggerEvent("Fera.Skill."+self.widgetId+"-create-after"),triggerEvent("fera-skill-create-after"),triggerFeraEvent("skill.create"),triggerFeraEvent("skill.create:after"),triggerFeraEvent(e.replace("widget","skill")+".create"),triggerFeraEvent(e.replace("widget","skill")+".create:after")},prepare=function(e,n){return self.lastDisplayerResponse.renders_template_client_side&&e?e.beforeRender?(self.renderInProgress=new Date,e.beforeRender(function(e,t){delete self.renderInProgress,!1===e?n(!1,t):(self.vars=e,n())})):void n():n()},checkConditions=function(){return!self.lastDisplayerResponse.conditions||new Fera.Conditions_Evaluator(self.lastDisplayerResponse.conditions,self.vars).isTrue()},checkAbTests=function(){return!!self.app.abTests.onFor(self.skillId)||(opts.logger.log("Skill in creation blocked by AB Test",self),!1)},generateStateVars=function(t){opts.app.getState(function(e){self.vars=$.extend({},{options:self.options,store:self.storeSettings,shopper:{location:e.location,customer_id:e.customer_id}},e,self.vars||{}),t(self.vars)})},_renderTemplate=function(){var e=self.options.template;if(!e||""===e.trim())return"";try{var t=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}");self.lastDisplayerResponse.html=self.html=Fera.Liquid.parse(t).render(self.vars)}catch(n){if(DEV_MODE)throw n;console.error(n),self.lastDisplayerResponse.html=self.html=e}};this.registerEngagement=function(e){return e=e||self.widgetId,!registeredEngagement&&!0!==self.skipRegisterEngagement&&!opts.testMode&&(opts.engagementTracker.register(e),registeredEngagement=!0)};var canRunWithoutRepeating=function(){if(self.isPreview)return!0;if(!campaignSettings.trigger_repeat)return!0;var e=self.memory.get("last_seen");if(!e)return!0;var t=parseInt(e)+1e3*parseInt(campaignSettings.trigger_repeat);return(new Date).getTime()>t},markSeen=function(){self.memory.set("last_seen",(new Date).getTime())};this.getState=opts.app.getState,this.update=function(e,t){if(!self.removed)if(ran){self.lastDisplayerResponse=e,campaignSettings=self.lastDisplayerResponse.settings,self.html=self.lastDisplayerResponse.html,self.settings=self.options=campaignSettings,triggerEvent("Fera.Skill."+e.campaign_id+"-update-before"),triggerEvent("fera-skill-update-before");var n=!0;waitForRun(function(){if(self.removed)return!1;generateStateVars(function(){if(self.removed)return!1;if(!self.isPreview&&opts.app.storeSettings.use_client_side_processing){if(!checkConditions())return!1;if(!checkAbTests())return!1}!self.lastDisplayerResponse.html&&self.lastDisplayerResponse.renders_template_client_side&&_renderTemplate(),updateActions(),feraSkill&&feraSkill.update&&(n=feraSkill.update()),!1!==n?(triggerFeraEvent(eventPrefix+".update"),triggerEvent("Fera.Skill."+e.campaign_id+"-update-after"),triggerEvent("fera-skill-update-after"),triggerFeraEvent(eventPrefix.replace("widget","skill")+".update"),feraSkill&&feraSkill.afterUpdate&&feraSkill.afterUpdate(),t&&t(!0)):(opts.logger.log("Update blocked by Fera Widget",feraSkill),t&&t(!1))})})}else t&&t(!1)},this.hide=function(){self.$container&&self.$container.hide()},this.remove=function(){self.removed||(self.removed=!0,self.$el&&self.$el.each(function(e,t){Fera.Util.disconnectRemoveHandlers(t)}),feraSkill&&feraSkill.remove&&feraSkill.remove(),actions.remove(),self.$container.remove())},this.triggerWidget=function(){return!triggered&&(!self.removed&&(triggered=!0))},this.triggerSkill=this.triggerWidget;var setupTriggerDelays=function(){if(campaignSettings.trigger_value&&-1!==["after_time_on_page","after_time_on_site","after_inactive_time_on_page","after_time_since_first_seen"].indexOf(campaignSettings.trigger))if("string"==typeof campaignSettings.trigger_value)if(campaignSettings.trigger_value.match(/^[0-9]+$/))triggerDelay=parseInt(campaignSettings.trigger_value);else{var e=0,t=15;"random_1_to_15_sec"===campaignSettings.trigger_value||("random_15_to_60_sec"===campaignSettings.trigger_value?(e=15,t=60):"random_1_to_5_min"===campaignSettings.trigger_value?(e=60,t=900):Fera.logger.warn("Widget settings for trigger random range are invalid. Fell back on 1-15 seconds range.",campaignSettings)),(triggerDelay=Math.round(Math.random()*t)+e)<1&&(triggerDelay=1)}else triggerDelay=parseInt(campaignSettings.trigger_value)},setupShopperActionTriggers=function(){if("on_exit_intent"===campaignSettings.trigger)new Fera.ExitIntentDetector({onExitIntent:self.triggerWidget});else if(-1!==["on_click","on_mouseenter","on_mouseleave"].indexOf(campaignSettings.trigger)){var e=campaignSettings.trigger.replace("on_","");$(campaignSettings.trigger_value).on(e,self.triggerWidget)}},waitForRun=function(e){if(ran)return e();if("custom_action"==self.type||"change_block"==self.type)return e();if(runActions(),ran)return e();var t=setInterval(function(){if(!self.removed)return runActions(),ran?(clearInterval(t),e()):void 0;clearInterval(t)},10)},updateActions=function(){foreachTargetEl(function(e,t){if(!self.removed){var n=actions.get(t);if(n){if(n.$targetEl.get(0)!==e.get(0)){if(!n.refreshOnTargetChange())return;n.$targetEl=e}n.update(self),e.data("feraFoundExisting",!0)}}}),foreachTargetEl(function(e){if(e.data("feraFoundExisting"));else{var t=createNewAction(e);actions.add(t),t.run(self.lastDisplayerResponse)}e.data("feraFoundExisting",null)}),pullElementsFromActions()},triggerConditionsMet=function(){if(triggered)return!0;if(self.isPreview&&opts.app.sandboxMode)return!0;if(!campaignSettings.trigger||"on_load"===campaignSettings.trigger)return!0;if("after_time_on_page"===campaignSettings.trigger){if(opts.timeTracker.getTimeOnCurrentPage()>=triggerDelay)return!0}else if("after_time_on_site"===campaignSettings.trigger){if(opts.timeTracker.getSessionTime()>=triggerDelay)return!0}else if("after_inactive_time_on_page"===campaignSettings.trigger){if(opts.timeTracker.getInactiveTimeOnPage()>=triggerDelay)return!0}else{if("after_time_since_first_seen"!==campaignSettings.trigger)return-1===["manual","on_click","on_mouseenter","on_mouseleave","on_exit_intent"].indexOf(campaignSettings.trigger)&&(Fera.logger.logWarning("Unknown trigger conditions so triggering now.",campaignSettings,self),!0);if(opts.timeTracker.getTimeSinceFirstSeen()>=triggerDelay)return!0}return!1},runActions=function(){if(triggerConditionsMet()&&canRunWithoutRepeating()){if(campaignSettings.integration_selector&&campaignSettings.integration_selector_action)createActions();else{if(!campaignSettings.has_location_on_page&&"custom_popup"!=self.type&&"custom_push_notif"!=self.type)return;ran=!0}actions.run(self),pullElementsFromActions()}},pullElementsFromActions=function(){self.$el=$([]),actions.each(function(e){e.$el&&(self.$el=self.$el.add(e.$el))}),self.$el.data("fera-preview-container")&&1===self.$el.children().length&&(self.$el=self.$el.children()),self.$el.attr("data-fera-widget",self.widgetId),self.$el.attr("data-fera-skill",self.widgetId)},pullElementsFromTarget=function(){var e=$(campaignSettings.target_selector);e&&(self.$el=self.$el||$([]),self.$el=self.$el.add(e),self.$el.attr("data-fera-widget",self.widgetId),self.$el.attr("data-fera-skill",self.widgetId))},foreachTargetEl=function(n){var e=$(campaignSettings.integration_selector);if(e.length<1)return!1;e.each(function(e){var t=$(this);n(t,e)})},createActions=function(){if(self.lastDisplayerResponse.html){var n=!1;foreachTargetEl(function(e){var t=createNewAction(e);t&&(actions.add(t),n=!0)}),n&&(ran=!0)}},createNewAction=function(e){var t=campaignSettings.integration_selector_action;return"insert_after"===t?new Fera.Actions.CustomBlocks.InsertAfterAction(e):"insert_before"===t?new Fera.Actions.CustomBlocks.InsertBeforeAction(e):"append_to"===t?new Fera.Actions.CustomBlocks.AppendAction(e):"prepend_to"===t?new Fera.Actions.CustomBlocks.PrependAction(e):"replace"===t?new Fera.Actions.CustomBlocks.ReplaceAction(e):(opts.logger.error("Unknown integration selector location configured.",campaignSettings),null)},triggerEvent=function(n){!function(e){try{e(document).trigger(n,self)}catch(t){opts.logger.error(t),opts.adminMode&&opts.optionsParser.hasPreviewFilterById()&&alert("Your custom widget produced an error: "+t.message+" (see console for more info).\n\n**THIS MESSAGE WILL NOT APPEAR TO YOUR SHOPPERS ***")}}($)},triggerFeraEvent=function(e){try{opts.app.trigger(e,self)}catch(t){opts.logger.error(t),opts.adminMode&&opts.optionsParser.hasPreviewFilterById()&&alert("Your custom widget produced an error: "+t.message+" (see console for more info).\n\n**THIS MESSAGE WILL NOT APPEAR TO YOUR SHOPPERS ***")}};init()},Fera.InstantClickSupport=function(r){var i=Fera.Util.$();r=r||{};var e=function(){"undefined"!=typeof InstantClick&&(r.logger.log("Instant Click was detected, so support module was loaded."),t())},t=function(){InstantClick.on("change",function(){var e=i(".banana-view-container").first(),t=r.app.getProductId();if(e&&0<e.length){var n=e.data("product_id");r.app.push("setProductId",{id:n})}else t&&r.app.push("setProductId",{id:null});r.app.refreshContent()})};e()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.ShogunSupport=function(){function t(e){return _classCallCheck(this,t),this._opts=e,this.$=Fera.Util.$(),this.isReady=!1,"undefined"==typeof __shgProductInits?this._ready():(Fera.logger.log("Shogun page was detected, so support module was loaded."),__shgProductInits.length<1?this._ready():(this._shogunProductData=__shgProductInits[0],void this._fetchProductData()))}return _createClass(t,[{key:"_ready",value:function e(){this.isReady=!0}},{key:"_fetchProductData",value:function i(){var t=this;if(!this._shogunProductData)return this._ready();var e="/products/"+this._shogunProductData.productHandle+".js";this.$.ajax({url:e,method:"GET",type:"GET",dataType:"json",success:function n(e){e&&e.id&&(t._opts.app.setProductId(e.id),t._opts.app.setSection("product_view")),t._ready()},error:function r(){t._ready()}})}}]),t}(),Fera.SkillsLocalStorage=function(e){var t,r=this,n=function(){t=new Fera.LocalStorageJar(e),r.memory=t.getObject("memory")||{}};r.set=function(e,t,n){return r.memory[e]={value:t,expiry:s(n)},i(),r},r.get=function(e,t){return r.memory[e]===undefined?t:o(e)?t:r.memory[e].value},r.reset=function(){return r.memory={},i(),a("Local storage was reset.",e.namespace),r};var i=function(){t.setObject("memory",r.memory)},a=function(){e.logger&&e.logger.log&&-1===Fera.Util.detectBrowser().indexOf("MSIE")&&e.logger.log.apply(this,arguments)},o=function(e){return null!==r.memory[e].expiry&&Date.now()>r.memory[e].expiry},s=function(e){return"number"!=typeof e?null:Date.now()+e};n()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.ActionCollection=function(){function e(){_classCallCheck(this,e),this._actions=[]}return _createClass(e,[{key:"add",value:function t(e){this._actions.push(e)}},{key:"run",value:function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._actions.forEach(function(e){e.run&&e.run.apply(e,t)})}},{key:"update",value:function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._actions.forEach(function(e){e.update&&e.update.apply(e,t)})}},{key:"each",value:function n(e){this._actions.forEach(e)}},{key:"remove",value:function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._actions.forEach(function(e){e.remove&&e.remove.apply(e,t)})}},{key:"get",value:function o(e){return this._actions[e]}}]),e}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Components=Fera.Components||{},Fera.Components.Base=function(){function n(e){var t=arguments.length<=0||e===undefined?{}:e;_classCallCheck(this,n),this._opts=t,this._listeners=t.listeners||t.on||{},this.$globalTopContainer=Fera.Util.$()(".banana-globalTop-container")}return _createClass(n,[{key:"on",value:function r(e,t){var n=this;return(-1===e.indexOf(" ")?[e]:e.split(" ")).forEach(function(e){n._listeners[e]=n._listeners[e]||[],n._listeners[e].push(t)}),this}},{key:"render",value:function t(){var e=this;setTimeout(function(){return e._afterRenderComplete()},1)}},{key:"_afterRenderComplete",value:function e(){}},{key:"triggerOnce",value:function i(e,t){this.trigger(e,t),this.clearListeners(e)}},{key:"clearListeners",value:function a(e){this._listeners[e]=[]}},{key:"trigger",value:function o(e,n){var r=this;return(-1===e.indexOf(" ")?[e]:e.split(" ")).forEach(function(e){var t=r._listeners[e];!t||t.length<1||t.forEach(function(e){e(r,n)})}),this}},{key:"_log",value:function s(){Fera.logger.log.apply(this,arguments)}},{key:"_warn",value:function u(){Fera.logger.warn.apply(this,arguments)}},{key:"_error",value:function c(){Fera.logger.error.apply(this,arguments)}},{key:"_logWarning",value:function l(){Fera.logger.logWarning.apply(this,arguments)}}]),n}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a)
;if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Components.BaseModal=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.$=Fera.Util.$(),this.titleCaption=e.titleCaption||"",this.classPrefix=e.classPrefix||"fera",this.$el=this.$(this._tpl()),this.$modal=this.$el.find(".fera-modal"),this.$closeButton=this.$el.find(".fera-modal-close"),this.$modalBody=this.$el.find(".fera-modal-body"),this._setupCloseListeners()}return _inherits(t,e),_createClass(t,[{key:"show",value:function n(){var e=$("body");e.find("."+this.classPrefix+"-fera-modal").length<1&&e.append(this.$el),this.$el.show()}},{key:"hide",value:function r(){this.$el.hide()}},{key:"_setupCloseListeners",value:function i(){var t=this;this.$closeButton.on("click",function(e){e.preventDefault(),t.hide()}),window.onclick=function(e){t.$(e.target).hasClass("fera-modal")&&(e.stopPropagation(),t.hide())}}},{key:"_tpl",value:function a(){return'<div class="fera-modal '+this.classPrefix+'-fera-modal" style="display: none;">\n            <div class="fera-modal-dialog">\n                <div class="fera-modal-content">\n                    <div class="fera-modal-header">\n                        <span class="fera-modal-close" data-dismiss="fera-modal">\xd7</span>\n                        <h2 class="fera-modal-title">'+this.titleCaption+'</h2>\n                    </div>\n                    <div class="fera-modal-body"></div>\n                </div>\n            </div>\n        </div>'}}]),t}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Components.CustomNotif=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.widget=e,this.$=Fera.Util.$(),this.$globalBottomContainer=this.$(".banana-globalBottom-container"),this.campaignSettings=this.widget.settings,this._create(),this.show()}return _inherits(t,e),_createClass(t,[{key:"update",value:function n(){this.campaignSettings=this.widget.settings,this.show()}},{key:"_create",value:function r(){this.$el=this.widget.$el||this.$(this.widget.html.replace(/<!--[\s\S]*?-->/g,"").trim());var e='<div class="banana-container-row fera-customNotif-container fera-notif-popup-container"></div>';this.widget.options.integration_selector?(this.$container=$(e),this.$container=this.$container.appendTo(this.widget.$el.parent())):(this.$globalBottomContainer.append(e),this.$container=this.$globalBottomContainer.find(".fera-customNotif-container"),this.$container.append(this.$el))}},{key:"_adminMode",value:function i(){return this.widget.adminMode}},{key:"show",value:function a(){var e=this;if(this._seen())return!1;this.popup=new Fera.PopupNotification({$el:this.$el,container:this.$container,logger:Fera.logger,$:this.$}),this.popup.attach(),this.popup.ensureLoadThenShow(this.campaignSettings.animation_in,this.campaignSettings.popout_position,function(){e._setUpCountDown()}),this._attachListeners()}},{key:"hide",value:function o(){this.popup&&this.popup.attached()&&this.popup.hideAndDetach(this.campaignSettings.animation_out,this.campaignSettings.popout_position,function(){})}},{key:"remove",value:function s(){var e=this;this.popup&&this.popup.hideAndDetach(this.campaignSettings.animation_out,this.campaignSettings.popout_position,function(){e.$container.remove()})}},{key:"_attachListeners",value:function u(){var e=this;this.popup.$el.find(".fera-notification-close").on("click touch",function(){e.hide()}),this.$el.attr("data-fera-widget",this.widget.widgetId)}},{key:"_getShowTime",value:function c(){var e=5;return this.campaignSettings&&this.campaignSettings.time_to_show_for&&(e=parseInt(this.campaignSettings.time_to_show_for)),e}},{key:"_setUpCountDown",value:function l(){var e=this;this.popup.initiateCountdown(this._getShowTime()),setTimeout(function(){e.hide()},1e3*this._getShowTime())}},{key:"_markSeen",value:function d(){this.widget.memory.set("CustomNotifSeen",!0,6e4)}},{key:"_seen",value:function f(){return!(this.widget.app.timeTracker.getSessionTime()<5||this.widget.memory.get("CustomNotifSeen")===undefined)&&this.widget.memory.get("CustomNotifSeen")}}]),t}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Components.CustomPopup=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.widget=e,this.$=Fera.Util.$(),this.$globalBottomContainer=this.$(".banana-globalBottom-container"),this.campaignSettings=this.widget.settings,this.stringTemplates=this.campaignSettings.string_templates,this._create()}return _inherits(t,e),_createClass(t,[{key:"update",value:function n(){this.campaignSettings=this.widget.settings}},{key:"_create",value:function r(){this.$el=this.widget.$el&&0!==this.widget.$el.length?this.widget.$el:this.$(this.widget.html),this._define$variables(),this.$el.hide(),this.widget.$el&&0!==this.widget.$el.length?this.$container=this.widget.$container:(this.widget.$container&&0!==this.widget.$container.length?this.$container=this.widget.$container:(this.$container=$('<div class="banana-container-row fera-customPopup-container"></div>'),this.$container.appendTo(this.$globalBottomContainer)),this.$container.append(this.$el))}},{key:"show",value:function i(){Fera.Util.showWithoutTransform(this.$el),this._attachListeners()}},{key:"hide",value:function a(){this.$el.hide()}},{key:"remove",value:function o(){this.$el.remove()}},{key:"_define$variables",value:function s(){this.$title=this.$el.find(".fera-popup-header h3.fera-popup-title"),this.$subtitle=this.$el.find(".fera-popup-header h5.fera-popup-title"),this.$body=this.$el.find(".fera-popup-body"),this.$btn=this.$el.find(".fera-popup-footer .fera-popup-btn")}},{key:"_attachListeners",value:function u(){var t=this;this.$el.find('[data-dismiss="fera-popup"]').on("click touch",function(){t.hide()}),this.campaignSettings.close_on_outside_click&&this.$container.find(".fera-popup").on("click",function(e){t.$(e.target).hasClass("fera-popup")&&(e.stopPropagation(),t.hide())}),this.$btn.on("click",function(){t.startLoading()}),this.$el.attr("data-fera-widget",this.widget.widgetId),this.$el.attr("data-fera-skill",this.widget.widgetId)}},{key:"startLoading",value:function c(){this.$btn.animate({opacity:.3}),this.$btn.addClass("fera-btn-loading"),this.originalBtnHtml=this.$btn.html(),this.$btn.html(this.stringTemplates.please_wait)}},{key:"stopLoading",value:function l(){this.$btn.removeClass("fera-btn-loading"),this.$btn.html(this.originalBtnHtml)}}]),t}(Fera.Components.Base),Fera.Feed=function(a){var o,s=this,u=a.settings.use_product_context,n=Fera.Util.$(),e=function(){o=new Fera.SeenNotifTracker({logger:Fera.logger,localStorage:a.app.localStorage,storageKey:"SocialProof.seenTracker"}),a.app.on("feeds.reset",o.clear),s.clearSeen=o.clear,s.items=[],s.notifQueue=[],s.markSeen=o.markSeen};this.load=function(i){a.app.geo.getLocationInfo(function(e){a.app.api.getFeeds(n.extend(t(),{country_code:e.country_code}),function(e){o.updateExpiryTime(parseInt(a.settings.expire_seen_memory_every||86400));for(var t=!1,n=0;n<e.length;n++){var r=new Fera.Notification(e[n],a);o.hasSeen(r)||(c(r),t=!0)}if(t)Fera.Util.shuffleArray(s.notifQueue);else if(u&&"show_others"===a.settings.product_context_fallback)return u=!1,s.load(i);i(t)})})};var c=function(e){s.notifQueue.push(e)},t=function(){var e={not_ids:o.getSeenIds().sort(function(e,t){return parseInt(t)-parseInt(e)}).reverse().slice(0,100).join(",")};if(u){var t=a.app.getProductId();t&&a.settings.use_product_context&&(e.product_id=t)}return a.settings.feed_params?e.feed_params=Fera.Util.encode(JSON.stringify(a.settings.feed_params)):e=n.extend(e,r()),a.settings.max_to_show&&(e.limit=parseInt(a.settings.max_to_show),e.limit<1&&(e.limit=1)),e},r=function(){var e={},t=[];return a.settings.orders_enabled&&(t.push("product_order"),a.settings.order_lookback&&(e.product_order_lookback=a.settings.order_lookback)),a.settings.carts_enabled&&(t.push("product_add_to_cart"),a.settings.cart_lookback&&(e.product_add_to_cart_lookback=a.settings.cart_lookback)),e.types=t.join(","),e};e()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Components.PromoBar=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.skill=e,this.$=BananaStand.Util.$(),this._create(),this.hidden=!1,this._visibleInitially()&&this.show()}return _inherits(t,e),_createClass(t,[{key:"update",value:function n(){this.$el.html(this.$(this.skill.html.replace(/<!--[\s\S]*?-->/g,"").trim()).html()),this._attachListeners(),this._hidden()||this.show()}},{key:"_attachListeners",value:function r(){var e=this;this.$el.find("[data-fera-promo-bar-close],[data-fera-promobar-close]").on("click",function(){e.hide()}),this.$el.attr("data-fera-widget",this.skill.widgetId),this.$el.attr("data-fera-skill",this.skill.widgetId)}},{key:"_create",value:function i(){this.skill.$el&&0<this.skill.$el.length?this.$el=this.skill.$el:(this.$el=this.$(this.skill.html.replace(/<!--[\s\S]*?-->/g,"").trim()),this.$globalTopContainer.append(this.$el)),this.$el.hide(),this._attachListeners()}},{key:"hide",value:function a(){this._adminMode()?alert("Since you're an admin, it will appear again when you refresh the page. For your shoppers, it will be hidden permanently. \n\n NOTE: This message will NOT show to your customers."):this.skill.localStorage.set("hidden","1"),this.$el.hide(),this._unapplyFixedHeaderAdjustments()}},{key:"_visibleInitially",value:function o(){return!!this._adminMode()||!this._hidden()}},{key:"_hidden",value:function s(){return"1"==this.skill.localStorage.get("hidden")}},{key:"_adminMode",value:function u(){return this.skill.adminMode}},{key:"_unapplyFixedHeaderAdjustments",value:function c(){if(!this._$fixedHeaderStyle)return!0;this._$fixedHeaderStyle.remove()}},{key:"_applyFixedHeaderAdjustments",value:function l(){if(this._$fixedHeaderStyle)return!0;this._$fixedHeaderStyle=this.$("<style>.fera-themeWithFixedHeader--adjust { margin-top: "+this.height()+"px; } </style>"),this._$fixedHeaderStyle.appendTo("body")}},{key:"height",value:function d(){return Fera.Util.outerHeight(this.$el)}},{key:"show",value:function f(){this.$globalTopContainer.show(),this.$el.show(),this._applyFixedHeaderAdjustments()}}]),t}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Components.PushNotification=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._skill=e,this.subscriberToken=null,this._loadSubscriberToken()}return _inherits(t,e),_createClass(t,[{key:"run",value:function n(){var e={};if(!this.subscriberToken)return"undefined"==typeof pushowl?(this._warn("Cannot run pushowl integration without pushowl.js installed."),!1):void pushowl.subscribe(!1,null,!1).then(function(){},function(){});(this._skill.isPreview||this._checkIsAllowed())&&(e.skill_id=this._skill.skillId,e.subscriber_token=this.subscriberToken,this._skill.api.triggerActions(e),this._skill.memory.set("last_pushed_at",(new Date).getTime()))}},{key:"_checkIsAllowed",value:function r(){var e=this._skill.settings.max_notif_period;if(!e)return!0;var t=this._skill.memory.get("last_pushed_at"),n=1e3*e+(new Date).getTime();return!(t&&parseInt(t)<n)||(this._log("Skipping push notification because the last one sent was",t),!1)}},{key:"_loadSubscriberToken",value:function i(){"undefined"!=typeof localStorage&&localStorage.pushowl_subscriber_token&&(this.subscriberToken=localStorage.pushowl_subscriber_token)}}]),t}(Fera.Components.Base),Fera.ClickRegistry=function(t){t=t||{};var n=this,r=Fera.Util.$(),i="ClickEvent",a=!0,o=null,s=["iframe","lang","body","!doctype","doctype","applet","article","aside","audio","basefont","body","br","colgroup","frame","frameset","head","header","html","iframe","p","main","meta","ol","param","script","tr","ul"],e=function(){t.sandboxMode||(n.register(),window.onunload=u)};n.register=function(){r(document).on("mousedown","*",function(e){if("undefined"!=typeof e.originalEvent&&2!==e.button&&e.target!==o&&-1===s.indexOf(e.target.tagName.toLowerCase())){var t=r(e.target);t.hasClass("fera-highlight-placeholder")||0<t.find("* > * > * > *").length||(c(n.getEventData(e)),o=e.target)}}),setInterval(l,1),setInterval(function(){o=null},1500)},n.sendElementClick=function(e){t.app.pushEvent({type:"element_click",data:e})},n.getEventData=function(e){var t={};return f(e.target,t),t.client_x=e.pageX,t.client_y=e.pageY,t};var u=function(){a=!1},c=function(e){t.localStorage&&e&&t.localStorage.setObject(i,e)},l=function(){if(a){var e=t.localStorage.getObject(i);e&&(t.localStorage.removeItem(i),n.sendElementClick(e))}},d=function(e){var t=r(e).parents();return!(t.length<1)&&-1!==(t=t.map(function(){return this.tagName}).get()).indexOf("BUTTON")},f=function(e,t){d(e)&&(e=r(e).parents("button")[0]);var n=r(e);g(n,t),t.element_attributes=v(e),t.element_text=y(p(n)),t.element_tag_name=e.tagName,t.element_html=y(h(n)),n.is("select")&&(t.select_options=_(e)),t.element_css_path=m(e)},p=function(e){var t=e.clone();return t.find("style, svg").remove(),t.find(":hidden").remove(),t.text()},h=function(e){var t=e.clone();return t.find(":hidden").remove(),t.html()},m=function(e){var t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0,skipAttributes:!0,skipTags:!0}).getPath();return""!==t?t:""===(t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0,skipAttributes:!0}).getPath())?t:""===(t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0}).getPath())?t:t=new Fera.CssPathGenerator(e).getPath()},g=function(e,t){var n=e.data("fera-widget")||e.data("fera-skill");void 0===n&&(n=(n=e.parents("[data-fera-widget],[data-fera-skill]").data("fera-widget"))||e.parents("[data-fera-widget],[data-fera-skill]").data("fera-skill")),void 0!==n&&(t.campaign_id=n,t.created_by="campaign")},v=function(e){var t={};return r.each(e.attributes,function(){t[y(this.name,50)]=y(this.value)}),t},_=function(e){var t=[];return r.each(e.options,function(){t.push(this.text)}),t},y=function(e,t){return t=t||300,e.replace(/\s\s+/gm," ").trim().substring(0,t)};e()},Fera.CssPathGenerator=function(t,i){var e=this;i=i||{};var a=Fera.Util.$(),n=a(t).parents(),r=[],o=i.maxDataAttrSize||50,s=function(){};e.getPath=function(){r=[];var e=u(t);return e&&""!==e&&r.push(e),n.each(function(){(e=u(this))&&""!==e&&r.push(e)}),r.slice(0,5).join(" > ")};var u=function(e){var t=a(e),n=i.skipTags?"":e.tagName;n+=c(t.attr("id")),n+=l(t.attr("class"));var r=[];return i.skipAttributes||d(e.attributes,r),i.skipDataAttributes||f(t.data(),r),0<r.length&&(n+=r.slice(0,5).join("")),n},c=function(e){return h(e)?"":"#"+e},l=function(e){return h(e)?"":e.replace(/\s\s+/gm," ").trim().split(" ").map(function(e){if(e)return"."+e}).join("")},d=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];p(r.name)&&m(r.value)&&t.push("["+r.name+'="'+r.value+'"]')}},f=function(e,n){a.each(e,function(e,t){m(t)&&n.push("[data-"+e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()+'="'+t+'"]')})},p=function(e){return!e.match(/id|class|style|(data-.*)|(on.+)|(xml:.*)/i)},h=function(e){return null==e||""===e},m=function(e){return!!h(e)||(!e.trim||0!==e.trim().indexOf("{")&&(-1===e.indexOf("\n")&&e.length<=o))};s()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.ContentSubmission=Fera.ContentSubmission||{},Fera.ContentSubmission.Customer=function(){function n(e){var t=arguments.length<=0||e===undefined?{}:e;_classCallCheck(this,n),this.opts=t,this.$=Fera.Util.$(),this.localStorage=t.localStorage,this.$container=t.$container,this._loadFromLocalStorage()}return _createClass(n,[{key:"isPresent",value:function e(){return this.name&&this.email}},{key:"update",value:function r(e,t){this.token=e,this.successCallback=t}},{key:"requestDetails",value:function t(){this.$container.find(".fera-contentSubmission-title").text("Just a couple more things..."),this.$form=this.$container.find("form"),this.$form.html(this._tpl()),this.$form.on("submit",this._handleSubmit.bind(this))}},{key:"_loadFromLocalStorage",value:function i(){if(this.localStorage){var e=this.localStorage.getObject(Fera.ContentSubmission.Customer.KEY,{});this.name=e.name,this.email=e.email}}},{key:"_saveToLocalStorage",value:function a(){if(this.localStorage){var e={name:this.name,email:this.email};this.localStorage.setObject(Fera.ContentSubmission.Customer.KEY,e)}}},{key:"_handleSubmit",value:function o(e){e.preventDefault(),this.$errorContainer=this.$form.find(".fera-errorContainer"),this.$submitBtn=this.$form.find("[data-fera-contentSubmission-submitBtn]"),this.name=this.$form.find('[name="fera-customer-name"]').val(),this.email=this.$form.find('[name="fera-customer-email"]').val(),this.name.trim()&&this.email.trim()?this._submit():this.$errorContainer.text(Fera.t("Your name and email is required")).removeClass("fera-hidden")}},{key:"_submit",value:function s(){var t=this;this.$errorContainer.addClass("fera-hidden"),this.$submitBtn.text("Loading..."),this.$submitBtn.prop("disabled",!0);var e="/update_customer";this.opts.api.contentSubmission({params:{customer_name:this.name,customer_email:this.email,content_submission_token:this.token,visitor_id:this.opts.visitorId},success:this._onCustomerUpdated.bind(this),error:function n(e){t.$errorContainer.text(Fera.t("There was an unexpected error. Please try again")).removeClass("fera-hidden"),$submitBtn.text("Submit"),$submitBtn.prop("disabled",!1),DEV_MODE&&console.error(e)}},e)}},{key:"_onCustomerUpdated",value:function u(e){this.name=e.customer_name,this.email=e.customer_email,this._saveToLocalStorage(),this.successCallback()}},{key:"_tpl",value:function c(){return'\n<div class="fera-contentSubmission-customer">\n    <div class="fera-errorContainer fera-hidden"></div>\n    <div class="fera-contentSubmission-row">\n        <label class="fera-contentSubmission-formControl-label">Name:</label>\n        <input class="fera-contentSubmission-formControl" type="text" placeholder="Name" name="fera-customer-name" required>\n    </div>\n    <div class="fera-contentSubmission-row">\n        <label class="fera-contentSubmission-formControl-label">Email:</label>\n        <input class="fera-contentSubmission-formControl" type="email" placeholder="Email address" name="fera-customer-email" required>\n    </div>\n\n    <input type="submit" class="fera-contentSubmission-submitBtn" data-fera-contentsubmission-submitbtn="" value="Submit" />\n</div>\n        '}}]),n}(),Fera.ContentSubmission.Customer.KEY="ContentSubmission_Customer";var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.ContentSubmission=Fera.ContentSubmission||{},Fera.ContentSubmission.Submitter=function(){function n(e){var t=arguments.length<=0||e===undefined?{}:e;_classCallCheck(this,n),this._opts=t,this.$=Fera.Util.$()}return _createClass(n,[{key:"show",value:function r(e){var t=arguments.length<=0||e===undefined?{}:e;this.customerMessageToken=t.cmt||t.customer_message_token||t.customerMessageToken,this.contentCampaignToken=t.cct||t.content_campaign_token||t.contentCampaignToken,this._showLoadingState(),this.$loadingStateContainer=this.$(".fera-contentSubmission--loading"),this._requestTemplate()}},{key:"hide",value:function t(e){this._closeWindow(e)}},{key:"_requestTemplate",value:function i(){var t=this,e={};this.customerMessageToken||this.contentCampaignToken?(e.customer_message_token=this.customerMessageToken,e.content_campaign_token=this.contentCampaignToken):e.product_id=this._opts.app.getProductId(),this._opts.api.requestContentSubmissionTemplate({params:e,success:function n(e){return t._processTemplateRequest(e)},error:function r(){return t._handleTemplateRequestError()}})}},{key:"_processTemplateRequest",value:function o(e){var t=this;if(e.reviewed){var n=this.$(this._getHtml(e.template)),r=this.$loadingStateContainer.find(".fera-container");return r.html("\n                <div>"+n.data("caption-already-submitted-feedback")+"</div>\n                <button>"+n.data("caption-close-window")+"</button>\n            "),void r.find("button").on("click",function(){return t._hideLoadingState()})}this._html=this._getHtml(e.template);var i=e.compiled_css;this._products=e.products,this._totalCount=this._products.length,this._previewReviewDate=new Date(e.previous_review.date);var a=this._previewReviewDate&&this._previewReviewDate.getTime()>(new Date).getTime()-864e5;this._previousReview=a?e.previous_review:{},this._requestReview=e.request_review,this._requestPhoto=(e.request_media||this._requestReview)&&e.allow_photo,this._requestVideo=(e.request_media||this._requestReview)&&e.allow_video,this._renderTemplate(this._html,i),this._hideLoadingState(!1),this._initElementsAndListeners()}},{key:"_handleTemplateRequestError",value:function a(){var e=this,t=this.$loadingStateContainer.find(".fera-container"),n="We're unable to accept your feedback at this time because of an unexpected error. <br>Our engineers have been notified and we'll have it fixed in no time. Sorry about that! :(";t.html("<div>"+n+"</div><button>Close Window</button>"),t.find("button").on("click",function(){return e._hideLoadingState()})}},{key:"_getHtml",value:function s(e,t){var n=arguments.length<=1||t===undefined?{}:t;if(!e||""===e.trim())return"";try{var r=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}");return Fera.Liquid.parse(r).render(n)}catch(i){if(DEV_MODE)throw i;return console.error(i),e}}},{key:"_renderTemplate",value:function u(e,t){this.$("body").addClass("fera-modal--open"),this.$("body").append(e),this.$("body").append("<style>"+t+"</style>")}},{key:"_initElementsAndListeners",value:function e(){var t=this;this.$submissionFormContainer=this.$(".fera-submissionForm"),this.$submissionRewardContainer=this.$(".fera-submissionReward"),this.$submissionSuccessContainer=this.$(".fera-submissionSuccess"),this.$submissionForm=this.$submissionFormContainer.find("form"),this.$submissionFormTitle=this.$submissionFormContainer.find(".fera-contentSubmission-title"),this.$viewTermContainer=this.$submissionFormContainer.find(".fera-contentSubmission-termPreview"),this.$viewTermTitle=this.$submissionFormContainer.find(".fera-contentSubmission-termTitle"),this.$ratingInput=this.$submissionForm.find('[name="fera-rating"]'),this.$summaryInput=this.$submissionForm.find('[name="fera-summary"]'),this.$agreedTermInput=this.$submissionForm.find('[name="fera-agreed-terms"]'),this.$bodyInput=this.$submissionForm.find('[name="fera-body"]'),this.$filesInput=this.$submissionForm.find('[name="fera-files"]'),this.$errorContainer=this.$submissionForm.find(".fera-errorContainer"),this.$viewTermBtn=this.$submissionForm.find(".fera-viewTerm-Btn"),this.$closeTermBtn=this.$viewTermContainer.find(".fera-contentSubmission-termPreview-closeBtn"),this.$summaryInput.on("change",function(){t.$summaryInput.data("fera-modified",!0)}),this.$agreedTermInput.data("term-enabled")&&this.$agreedTermInput.prop("checked",this.$agreedTermInput.data("checked-by-default")),this.$viewTermBtn.on("click",function(){t.showTermModal()}),this.$closeTermBtn.on("click",function(){t.closeTermModal()}),this.$totalCount=this.$submissionFormContainer.find("[data-fera-contentSubmission-info]"),this.$totalCount.html(this._totalCount-this._products.length+1+" / "+this._totalCount),this._totalCount<=1&&this.$totalCount.hide(),this._initReviewSections(),this._initUploadArea(),this._initSubmitAndReviewNextBtns(),this.customer=new Fera.ContentSubmission.Customer(_extends({},this._opts,{$container:this.$submissionFormContainer})),this.$submissionFormContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",function(e){return t._closeWindow(e)}),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",function(e){return t._closeWindow(e)})}},{key:"_initUploadArea",value:function c(){var t=this;if(this._requestPhoto||this._requestVideo){var e=this.$submissionForm.find(".fera-uploadLabel");this._requestVideo&&this._requestPhoto?e.text(e.data("caption-photos-or-videos")):this._requestPhoto?e.text(e.data("caption-photos")):e.text(e.data("caption-videos")),this.$filesInput.on("change",function(e){return t._onFileChange(e)}),this._initDropArea()}else this.$filesInput.closest(".fera-contentSubmission-formControl-uploadRow").remove()}},{key:"_initDropArea",value:function l(){var n=this,r=this.$submissionForm.find(".fera-contentSubmission-formControl-uploadArea");r.on("dragenter dragover",function(e){e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy",r.addClass("fera-dropzone")}),r.on("dragleave drop",function(e){if(e.preventDefault(),r.removeClass("fera-dropzone"),"drop"===e.type){var t=e.originalEvent.dataTransfer.files;[].concat(_toConsumableArray(t)).every(function(e){return e.type.match(/image|video/)})?(n.$filesInput.prop("files",t).trigger("change"),n.$errorContainer.addClass("fera-hidden")):n.$errorContainer.text(n.$errorContainer.data("caption-only-certain-files-allowed")).removeClass("fera-hidden")}})}},{key:"_onFileChange",value:function d(e){var t="",n=e.target.files;if(1<n.length){var r=this.$filesInput.data("caption-files-selected");t=Fera.Liquid.parse(r).render({count:n.length})}else t=n[0].name;this.$submissionForm.find(".fera-uploadLabel").text(t),this.$(".fera-contentSubmission-termRow").removeClass("fera-hidden")}},{key:"_initReviewSections",value:function f(){var t=this;if(this._requestReview){var e=this._products[0];if(e&&e.name){var n=this._products[0],r='<a class="fera-link" target="_blank" href="'+n.url+'">'+(n.name.length<=27?n.name:n.name.substr(0,27)+"...")+"</a>";this.$submissionForm.find(".fera-productTitle").html(r)}else this.$submissionForm.find(".fera-productTitle").closest(".fera-contentSubmission-row").hide();this.$submissionForm.find("[data-fera-contentsubmission-star]").on("click",function(e){return t._applyRating(e)}),this._previousReview&&this._populatePreviousReview()}else this.$submissionForm.find(".fera-contentSubmission-row").remove()}},{key:"showTermModal",value:function p(){this.$submissionForm.addClass("fera-hidden"),this.$submissionFormTitle.addClass("fera-hidden"),this.$viewTermContainer.removeClass("fera-hidden"),this.$viewTermTitle.removeClass("fera-hidden")}},{key:"closeTermModal",value:function h(){this.$submissionForm.removeClass("fera-hidden"),this.$submissionFormTitle.removeClass("fera-hidden"),this.$viewTermContainer.addClass("fera-hidden"),this.$viewTermTitle.addClass("fera-hidden")}},{key:"_applyRating",value:function m(e,t){var n=this,r=arguments.length<=1||t===undefined?null:t;r=r||this.$(e.target).data("rating"),this.$submissionForm.find('[name="fera-rating"]').val(r),this.$submissionForm.find("[data-fera-contentSubmission-star]").each(function(e,t){e<r?n.$(t).addClass("fera-star--starred"):n.$(t).removeClass("fera-star--starred")}),this.$(".fera-contentSubmission-termRow").removeClass("fera-hidden"),this._prefillDefaultMessages(r),e&&e.preventDefault&&e.preventDefault()}},{key:"_prefillDefaultMessages",value:function g(e){if(!this._previousReview.heading&&!(this.$summaryInput.data("fera-modified")&&this.$summaryInput.val()||this._opts.app.locale&&"en"!=this._opts.app.locale)){var t={1:["Really not happy.","No good.","Pretty bad.","No thanks."],2:["Not happy.","Nah.","Probably not again.","Not the best."],3:["Meh.","Not amazing.","Pretty ok.","It's fine."],4:["Pretty good!","I dig it!","Solid!","Recommended!"],5:["Great!","Fantastic!","Excellent!","Highly recommended!"]};this.$summaryInput.val(t[e][Math.floor(4*Math.random())]),this.$summaryInput.data("fera-modified",!1)}}},{key:"_populatePreviousReview",value:function v(){var e=this._previousReview,t=e.rating,n=e.heading,r=e.body,i=e.agreed_to_terms;t&&this._applyRating(null,t),n&&this.$summaryInput.val(n),r&&this.$bodyInput.val(r),i&&this.$agreedTermInput.prop("checked",i)}},{key:"_initSubmitAndReviewNextBtns",value:function _(){var t=this;this.$submissionForm.find("[data-fera-contentSubmission-submitBtn]").on("click",function(e){return t._submitForm(e)}),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-reviewNextBtn]").on("click",function(){return t._reviewNextProduct()})}},{key:"_submitForm",value:function y(e){var t=this;e.preventDefault(),this.$errorContainer.addClass("fera-hidden");var n=this.$(e.target),r=new FormData,i=Array.from(this.$filesInput.prop("files")||[]),a=this._products[0],o=this.$ratingInput.val(),s=this.$agreedTermInput.data("term-enabled"),u=this.$agreedTermInput.is(":checked"),c=i.filter(function(e){return e.type.match(/video/)});return 10<i.length?this.$errorContainer.text(this.$errorContainer.data("caption-max-files-reached")).removeClass("fera-hidden"):1<c.length?this.$errorContainer.text(this.$errorContainer.data("caption-one-video-allowed")).removeClass("fera-hidden"):this._requestReview&&!o?this.$errorContainer.text(this.$errorContainer.data("caption-rating-required")).removeClass("fera-hidden"):this._requestReview&&s&&!u?this.$errorContainer.text(this.$errorContainer.data("caption-agreed-terms-required")).removeClass("fera-hidden"):!this._requestReview&&(this._requestVideo||this._requestPhoto)&&i.length<=0?this.$errorContainer.text(this.$errorContainer.data("caption-files-required")).removeClass("fera-hidden"):(n.text("Loading..."),n.prop("disabled",!0),r.append("customer_review[rating]",o||""),r.append("customer_review[heading]",this.$summaryInput.val()||""),r.append("customer_review[body]",this.$bodyInput.val()||""),s&&r.append("customer_review[agreed_to_terms]",u),i.forEach(function(e){r.append("customer_review[files][]",e,e.name.replace(/\s+/g,"-"))}),this._opts.testMode?(alert("NOTE:\nThe review will not be submitted since you are in preview mode."),void setTimeout(function(){return t._checkForNextReview()},500)):void this._opts.api.contentSubmission({data:r,params:{
customer_message_token:this.customerMessageToken,content_campaign_token:this.contentCampaignToken,product_id:a?a.id:null,visitor_id:this._opts.visitorId,customer_name:this.customer.name,customer_email:this.customer.email},success:this._onContentSubmitted.bind(this),error:function l(e){e.responseJSON&&e.responseJSON.duration&&"must be longer than 3 seconds"===e.responseJSON.duration?t.$errorContainer.text(t.$errorContainer.data("caption-certain-video-duration-allowed")).removeClass("fera-hidden"):t.$errorContainer.text(t.$errorContainer.data("caption-server-error")).removeClass("fera-hidden"),n.text("Submit"),n.prop("disabled",!1)}}))}},{key:"_onContentSubmitted",value:function w(e){e.has_customer||this.customer.isPresent()?this._checkForNextReview():(this.customer.update(e.content_submission_token,this._checkForNextReview.bind(this)),this.customer.requestDetails())}},{key:"_checkForNextReview",value:function b(){this._products.shift(),0<this._products.length?(this.$submissionFormContainer.fadeOut(),this.$submissionSuccessContainer.removeClass("fera-hidden").fadeIn()):this._closeFormAndShowReward()}},{key:"_closeFormAndShowReward",value:function C(){var t=this;this.$submissionFormContainer.fadeOut(),this.$submissionRewardContainer.removeClass("fera-hidden").fadeIn(),this.$submissionRewardContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",function(e){return t._closeWindow(e)}),this.$submissionRewardContainer.find("[data-fera-contentSubmission-closeWindowBtn]").on("click",function(e){return t._closeWindow(e)})}},{key:"_closeWindow",value:function k(e){this.$submissionFormContainer.remove(),this.$submissionRewardContainer.remove(),this.$submissionSuccessContainer.remove(),this.$loadingStateContainer.remove(),this.$(".fera-contentSubmission--overlay").remove(),this.$("body").removeClass("fera-modal--open"),e&&e.preventDefault&&e.preventDefault()}},{key:"_reviewNextProduct",value:function S(){this.$submissionSuccessContainer.fadeOut(),this.$submissionFormContainer.fadeIn();var e=this.$(this._html).find("form");this.$submissionForm.html(e),this._initElementsAndListeners()}},{key:"_redirectToHomeOrProductPage",value:function F(){var e="/";this._products&&0<this._products.length&&(e=this._products[0].url),location.href=e}},{key:"_showLoadingState",value:function x(){var e='\n      <div class="fera-contentSubmission--overlay"></div>\n      <div class="fera-contentSubmission--loading">\n        <div class="fera-contentSubmission-modal">\n            <div class="fera-contentSubmission-loading">\n                <div class="fera-container">\n                    <div>\n                        <svg aria-hidden="true" height="20" focusable="false" data-prefix="fad" data-icon="spinner-third" class="fera-spinner" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g class="fa-group"><path class="fa-secondary" fill="currentColor" d="M478.71 364.58zm-22 6.11l-27.83-15.9a15.92 15.92 0 0 1-6.94-19.2A184 184 0 1 1 256 72c5.89 0 11.71.29 17.46.83-.74-.07-1.48-.15-2.23-.21-8.49-.69-15.23-7.31-15.23-15.83v-32a16 16 0 0 1 15.34-16C266.24 8.46 261.18 8 256 8 119 8 8 119 8 256s111 248 248 248c98 0 182.42-56.95 222.71-139.42-4.13 7.86-14.23 10.55-22 6.11z" opacity="0.4"></path><path class="fa-primary" fill="currentColor" d="M271.23 72.62c-8.49-.69-15.23-7.31-15.23-15.83V24.73c0-9.11 7.67-16.78 16.77-16.17C401.92 17.18 504 124.67 504 256a246 246 0 0 1-25 108.24c-4 8.17-14.37 11-22.26 6.45l-27.84-15.9c-7.41-4.23-9.83-13.35-6.2-21.07A182.53 182.53 0 0 0 440 256c0-96.49-74.27-175.63-168.77-183.38z"></path></g></svg>\n                    <div>\n                </div>\n            </div>\n        </div>\n      </div>\n    ',t="\n       body.fera-modal--open {\n         overflow: hidden !important;\n       }\n       @keyframes fera-spin {\n         from { transform:rotate(0deg); }\n         to { transform:rotate(360deg); }\n       }\n      .fera-spinner {\n        animation-name: fera-spin;\n        animation-duration: 1500ms;\n        animation-iteration-count: infinite;\n        animation-timing-function: linear;\n      }\n      .fera-contentSubmission-modal {\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 10px;\n      }\n      .fera-contentSubmission-loading,\n      .fera-contentSubmission {\n        position: relative;\n        background-color: white;\n        padding: 50px 45px 50px;\n        border-radius: 5px;\n        box-shadow: 0px 3px 20px rgba(0, 0, 0, 0.2);\n        width: 100%;\n        max-width: 500px;\n        max-height: 90vh;\n        display: flex;\n        justify-content: center;\n        flex-direction: column;\n        z-index: 9999999;\n      }\n      .fera-contentSubmission--overlay,\n      .fera-submissionForm,\n      .fera-submissionReward,\n      .fera-submissionSuccess,\n      .fera-contentSubmission--loading {\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        position: fixed;\n        z-index: 9999999;\n      }\n\n      .fera-contentSubmission-termTitle {\n        font-size: 29px;\n        font-weight: bold;\n        letter-spacing: 1px;\n      }\n\n      .fera-contentSubmission-termPreview-content {\n        overflow-y: scroll;\n        max-height: 45vh;\n      }\n\n      .fera-contentSubmission-termPreview-content h1,\n      .fera-contentSubmission-termPreview-content h2,\n      .fera-contentSubmission-termPreview-content h3,\n      .fera-contentSubmission-termPreview-content h4,\n      .fera-contentSubmission-termPreview-content h5,\n      .fera-contentSubmission-termPreview-content h6,\n      .fera-contentSubmission-termPreview-content p,\n      .fera-contentSubmission-termPreview-content li {\n        margin: 0 0 16px;\n        padding: 0;\n        font-size: 16px;\n      }\n      .fera-contentSubmission-termPreview-content ul {\n        list-style-type: disc;\n        margin: 0 0 16px;\n      }\n\n      .fera-contentSubmission-termPreview-closeBtn {\n        background: #00070c;\n        color: white;\n        margin-top: 32px;\n        width: 112px;\n        height: 40px;\n        outline: none;\n        border: none;\n        border-radius: 3px;\n        text-align: center;\n        font-weight: bold;\n        letter-spacing: 1px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .fera-contentSubmission-termPreview-closeBtn span {\n        margin-left: 6px;\n      }\n\n      .fera-contentSubmission--overlay {\n        background: rgba(0,0,0,0.3);\n        z-index: 9999998;\n      }\n\n      .fera-contentSubmission-loading .fera-container {\n        text-align: center;\n        font-size: 20px;\n      }\n      .fera-contentSubmission-loading button {\n        color: white;\n        border: none;\n        padding: 12px 20px;\n        border-radius: 5px;\n        font-size: 14px;\n        background-color: #1E2139;\n        margin-top: 40px;\n      }\n      .fera-contentSubmission-loading button:hover {\n        background-color: black;\n      }\n      .fera-hidden {\n        display: none !important;\n      }\n      @media(max-width: 480px) {\n        .fera-contentSubmission {\n            width: 100%;\n            margin: 0;\n            max-height: 100%;\n            border-radius: 0;\n            padding: 42px 32px 42px;\n        }\n\n        .fera-contentSubmission-termTitle {\n            font-size: 24px;\n        }\n    }\n    ";this._renderTemplate(e,t)}},{key:"_hideLoadingState",value:function T(e){var t=arguments.length<=0||e===undefined||e;this.$loadingStateContainer.addClass("fera-hidden"),t&&this._redirectToHomeOrProductPage()}}]),n}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.Base=function(e){function n(e){var t=this;_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e),this.app=e.app,this.$=Fera.Util.$(),this.totalReviewCount=e.totalReviewCount||0,this.isSubmitHidden="undefined"!=typeof e.isSubmitHidden&&e.isSubmitHidden,this.pageSize=e.pageSize||5,this.tplVars=e.tplVars||{},this.reviewOptions=e.reviewOptions||{},this.translatedStrings=e.translatedStrings||{},e.template&&(this.prerendered=!0,this.$el=e.template,this._initialize()),this._triggerDebouncedResize=Fera.Util.debounce(function(){return t._updateWidthClass()},100),this.$(window).on("resize",function(){return t._triggerDebouncedResize()}),setInterval(function(){return t._updateWidthClass()},500)}return _inherits(n,e),_createClass(n,[{key:"render",value:function t(){if(this.prerendered)return this.$el;this.tplVars.header&&(this.tplVars.header=this._t(this.tplVars.header));var e=this._renderTpl(this._tpl(),this.tplVars);return this.$el=this.$(e),this._initialize(),this.$el}},{key:"clear",value:function r(){this.reviewList.clear()}},{key:"refresh",value:function i(e){var t=arguments.length<=0||e===undefined||e;this.reviewList.refresh(t)}},{key:"_updateWidthClass",value:function a(){this.$el&&0<this.$el.length&&this.$el.toggleClass("fera-container--thin",this.$el.width()<576)}},{key:"_initialize",value:function o(){this.$totalReviewCount=this.$el.find("."+this._suffix()+"-count-total"),this._setupWriteReview(),this._setupReviewList(),this._updateCountDependentDisplays(this.totalReviewCount),this._updateWidthClass()}},{key:"_setupWriteReview",value:function s(){var t=this;this.$writeReview=this.$el.find('[data-fera-action="showContentSubmission"]'),this.$writeReview.text(this._t(this.$writeReview.text())),this.$writeReview.on("click",function(e){e.preventDefault(),t.app.showContentSubmission()}),this.$el.toggleClass(this._suffix()+"--submitHidden",this.isSubmitHidden)}},{key:"_setupReviewList",value:function u(){var n=this;this.reviewListOpts=this.reviewListOpts||{},this.prerendered&&(this.reviewListOpts.template=this.$el),this.reviewList=new Fera.CustomerResources.CustomerReviews.List(this.reviewListOpts),this.reviewList.on("listUpdate",function(e,t){n._updateCountDependentDisplays(t)}),this.prerendered||(this.$body=this.$el.find("."+this._suffix()+"-content"),this.$body.append(this.reviewList.render()))}},{key:"_updateCountDependentDisplays",value:function c(e){this._updateReviewCountStr(e),this._updateSeoAttributes(e)}},{key:"_updateSeoAttributes",value:function l(){}},{key:"_updateReviewCountStr",value:function d(e){var t;if(!(this.$totalReviewCount.length<1||(this.$countStr?(this.$countStr.remove(),t=this.$countStr.find("."+this._suffix()+'-reviewCount,[itemprop="reviewCount"]')):t=this.$totalReviewCount.find("."+this._suffix()+'-reviewCount,[itemprop="reviewCount"]'),t.length<1))){t.get(0).innerHTML=e;var n=this._t("{{ review_count }} review"+(1==e?"":"s"));this.$countStr=this.$('<span class="'+this._suffix()+'-count-total-str">'+n.replace("{{ review_count }}",t.get(0).outerHTML)+"</span>"),t.remove(),this.$totalReviewCount.append(this.$countStr)}}},{key:"_t",value:function f(e){return Fera.customTranslate(e,this.translatedStrings)}},{key:"_renderTpl",value:function p(e,t){var n=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!n)return Fera.logger.error("Template is empty or not valid.",e,t),"";var r=Fera.Liquid.parse(n);return r?r.render(t):(Fera.logger.error("Failed to parse template: ",r,t),"")}},{key:"_tpl",value:function h(){console.error("Fera.CustomerResources.CustomerReviews.Base template was not implemented.")}},{key:"_suffix",value:function m(){return"fera-productReviews"}}],[{key:"removeSeoAttributes",value:function g(e){var n=Fera.Util.$();e.removeAttr("itemprop").removeAttr("itemtype").removeAttr("itemscope"),e.find("[itemprop],[itemtype],[itemscope]").each(function(e,t){n(t).removeAttr("itemprop").removeAttr("itemtype").removeAttr("itemscope")})}}]),n}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=function(e){function n(e){var t=arguments.length<=0||e===undefined?{}:e;_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,t),this.app=t.app,this.singleProduct=!!t.singleProduct,this.options=t.options,this.imageViewer=new Fera.ImageViewer,this.videoViewer=new Fera.VideoViewer,this.$el=t.$template,this._initialize()}return _inherits(n,e),_createClass(n,[{key:"refresh",value:function t(){this.page=0,this.limit=this.options.max_to_show||6,this.customerMedia=[],this.clear(),this._fetchNextPage()}},{key:"clear",value:function r(){this.$customerMediaContent.empty()}},{key:"_initialize",value:function i(){this._setupHeader(),this._setupCustomerMediaContent(),this._setupLoadMore()}},{key:"_setupHeader",value:function a(){this.$header=this.$el.find(".fera-customerMedia-header"),this.$header.toggleClass("fera-hidden",!this.options.header_enabled),this.options.custom_header_enabled||(this.options.images_enabled&&this.options.videos_enabled?this.$header.text("Customer Photos & Videos"):this.options.images_enabled?this.$header.text("Customer Photos"):this.options.videos_enabled?this.$header.text("Customer Videos"):this.$header.text(""))}},{key:"_setupCustomerMediaContent",value:function o(){this.$customerMediaContent=this.$el.find(".fera-customerMedia-content"),this.$noCustomerMedia=this.$el.find(".fera-customerMedia-noCustomerMedia")}},{key:"_setupLoadMore",value:function s(){var t=this;this.$footer=this.$el.find(".fera-customerMedia-footer"),this.$spinner=this.$el.find(".fera-loading-spinner").clone().removeClass("fera-hidden"),this.$loadMoreBtn=this.$el.find(".fera-customerMedia-loadMoreBtn"),this.$loadMoreBtn.on("click",function(e){e.preventDefault(),t.app.opts.testMode||t._fetchNextPage()})}},{key:"_fetchNextPage",value:function u(){var n=this;this.page++;var e={page:this.page,limit:this.limit,only_photos:this.options.images_enabled&&!this.options.videos_enabled,only_videos:this.options.videos_enabled&&!this.options.images_enabled,media_source:this.options.media_source},t=this.app.getProductId();if(this.singleProduct&&t!==undefined&&0<t.trim().length&&(e.product_id=t),"choose"===this.options.media_source){var r=this.options.media_ids;r=r instanceof Array?r:JSON.parse(r),e.media_ids=0<r.length?r:[-1],e.product_id=null}this.$loadMoreBtn.html(this.$spinner).append("Loading...").prop("disabled",!0),this.app.api.getCustomerMedia(e,function(e,t){n.totalCount=t,n.totalCount<1?(n.clear(),n.$noCustomerMedia.removeClass("fera-hidden"),"hide"!==n.options.when_no_media||n.app.opts.testMode||n.$el.hide()):n._renderCustomerMedia(e),n.$loadMoreBtn.text("Load More").prop("disabled",null),n.$footer.toggleClass("fera-hidden",!n._showLoadMore())})}},{key:"_renderCustomerMedia",value:function c(e){var n=this;e.forEach(function(e){var t=new Fera.CustomerResources.CustomerMedia.Item({caption:e.caption,type:e.type,imageUrl:e.image_url,imageThumbnailUrl:e.image_thumbnail_url,isImported:e.is_imported,integrationType:e.integration_type,videoUrl:e.video_url,videoThumbnailUrl:e.video_thumbnail_url,imageViewer:n.imageViewer,videoViewer:n.videoViewer});n.$customerMediaContent.append(t.render()),n.customerMedia.push(e)})}},{key:"_showLoadMore",value:function l(){return!this.app.opts.testMode&&(!!this.customerMedia&&this.customerMedia.length<this.totalCount)}}]),n}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=Fera.CustomerResources.CustomerMedia||{},Fera.CustomerResources.CustomerMedia.Item=function(e){function n(e){var t=arguments.length<=0||e===undefined?{}:e;_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,t),this.$=Fera.Util.$(),this.caption=t.caption,this.type=t.type,this.isImported=t.isImported,this.isImported&&(this.integrationType=t.integrationType),this.imageViewer=t.imageViewer,this.videoViewer=t.videoViewer,this._isPhoto?(this.imageUrl=t.imageUrl,this.imageThumbnailUrl=t.imageThumbnailUrl):(this.videoUrl=t.videoUrl,this.videoThumbnailUrl=t.videoThumbnailUrl)}return _inherits(n,e),_createClass(n,[{key:"render",value:function t(){return _get(Object.getPrototypeOf(n.prototype),"render",this).call(this),this.$el=this.$(this._tpl()),this.$el}},{key:"_afterRenderComplete",value:function r(){var e=this.$el;this._isPhoto?this.imageViewer.init(e):(e=this.$el.find(".fera-customerMedia-videoThumbnail-clickableArea"),this.videoViewer.init(e))}},{key:"_imageTpl",value:function i(){return'<img class="fera-customerMedia-imageThumbnail fera-customerMedia-thumbnail" src="'+this.imageThumbnailUrl+'" alt="'+this.caption+'" data-image-url="'+this.imageUrl+'" itemscope itemtype="https://schema.org/Photograph" />'}},{key:"videoThumbnailOrPlaceholderTpl",value:function a(){return!this.videoThumbnailUrl&&this.isImported?this._importedVideoTpl(this.integrationType):'\n            <img class="fera-customerMedia-videoThumbnail" src="'+this.videoThumbnailUrl+'" alt="'+this.caption+'" itemscope itemtype="https://schema.org/Photograph" />\n        '}},{key:"_importedVideoTpl",value:function o(e){var t=this._prepareImportedVideoUrl(this.videoUrl,e);return["youtube","vimeo","instagram"].includes(e)?'<iframe class="fera-customerMedia-videoThumbnail fera-customerMedia-video" width="100" height="100" src="'+t+'"\n                    frameborder="0" allow="accelerometer; autoplay; picture-in-picture"\n                    allowfullscreen></iframe>':'<video class="fera-customerMedia-videoThumbnail fera-customerMedia-video" width="100" height="100" src="'+t+'" alt="'+this.caption+'">'}},{key:"_prepareImportedVideoUrl",value:function s(e,t){if("url"===t)return e;({youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|v\/)?)([\w\-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9\.]+\/videos\/(?:[a-zA-Z0-9\.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/})[t].test(e);return"youtube"===t?e="https://www.youtube.com/embed/"+RegExp.$5:"vimeo"===t?e="https://player.vimeo.com/video/"+RegExp.$5:"instagram"===t&&(e="https://www.instagram.com/p/"+RegExp.$2+"/embed"),e}},{key:"_videoTpl",value:function u(){return'\n            <figure class="fera-customerMedia-videoThumbnailWrapper fera-customerMedia-thumbnail">\n                <div\n                    class="fera-customerMedia-videoThumbnail-clickableArea"\n                    data-video-url="'+this.videoUrl+'"\n                    data-video-type="'+this.integrationType+'"\n                    data-video-is-imported="'+this.isImported+'"\n                ></div>\n                '+this.videoThumbnailOrPlaceholderTpl()+'\n                <div class="fera-customerMedia-videoThumbnail-playButtonWrapper">\n                    <svg class="fera-customerMedia-videoThumbnail-playButton" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M0 15.223V1.77702C0 0.99739 0.852556 0.517624 1.51898 0.922237L12.5921 7.64521C13.2335 8.03461 13.2335 8.96539 12.5921 9.35479L1.51898 16.0778C0.852556 16.4824 0 16.0026 0 15.223Z" fill="black" fill-opacity="0.8"/>\n                    </svg>\n                </div>\n            </figure>\n        '}},{key:"_tpl",value:function c(){return"photo"===this.type?this._imageTpl():this._videoTpl()}},{key:"_isPhoto",get:function l(){return"photo"===this.type}}]),n}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.ProductReviews=function(e){function n(e){_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e)}return _inherits(n,e),_createClass(n,[{key:"_setupReviewList",value:function t(){this.reviewListOpts={app:this.app,singleProduct:!0,pageSize:this.pageSize,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings,suffix:"fera-productReviews"},_get(Object.getPrototypeOf(n.prototype),"_setupReviewList",this).call(this)}},{key:"_updateSeoAttributes",value:function r(e){if(_get(Object.getPrototypeOf(n.prototype),"_updateSeoAttributes",this).call(this,e),0<e){var t=this.$el.parents("[itemType]");(t.length<1||!t.first().attr("itemType").match(/\/Product$/))&&this.constructor.copySeoAttributesToProductContext(this.$el),this.constructor.removeDuplicateAggregateRatingSeoAttr()}else Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)}},{key:"_tpl",value:function i(){return'<div class="fera-productReview-block">\n            <div class="fera-productReviews-heading">\n                <div class="fera-productReviews-heading-col1">\n                    <h2 class="fera-productReviews-heading-header">{{ header }}</h2>\n                    <a href="#" class="text-link fera-productReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n                <div class="fera-productReviews-heading-col2" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">\n                    <div class="fera-productReviews-totals-col1">\n                        <div class="fera-productReviews-avgRating">\n                            <span itemprop="ratingValue" class="h1 fera-productReviews-avgRating-val" data-value="{{ average_rating | default: 0.0 }}">{{ average_rating }}</span>\n                        </div>\n                    </div>\n                    <div class="fera-productReviews-totals-col2">\n                        <div class="fera-productReviews-avgRating-stars">\n                            {% if ratings_enabled %}\n                            <div class="fera-stars fera-productReviews-stars"\n                                 data-rating="{{ average_rating | default: 0.0 }}">\n                                <div class="fera-stars-rating fera-productReviews-stars-rating" style="width: {{ average_rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>\n                                <div class="fera-stars-bg fera-productReviews-stars-bg"></div>\n                            </div>\n                            {% endif %}\n                        </div>\n                        <div class="fera-productReviews-count">\n                            <div class="fera-productReviews-count-total" data-value="{{ review_count | default: 0 }}">\n                                <span itemprop="reviewCount" class="fera-productReviews-reviewCount"">{{ review_count | default: 0 }}</span>\n                                <span itemprop="ratingCount" style="display: none;">{{ review_count | default: 0 }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="fera-productReviews-content"></div>\n        </div>'}}],[{key:"copySeoAttributesToProductContext",value:function a(c){var l=Fera.Util.$(),e=l('[itemType*="/Product"]'),t=l('script[type="application/ld+json"]');if(0<e.length){var n=c.clone();n.hide(),n.removeAttr("class").removeAttr("data-fera-skill").removeAttr("data-fera-widget").removeAttr("id"),n.find("[class]").removeAttr("class").removeAttr("id"),e.first().append(n)}else{if(!(0<t.length))return Fera.logger.log("Tried to copy object to optimize for SEO but could not find parent product SEO item type or script definitions."),!1;t.each(function(e,t){var n=l(t),u=undefined;try{u=JSON.parse(n.html())}catch(s){Fera.logger.log("Encountered an error while trying to parse JSON for application/ld+json. Reading will be skipped.",n)}if(u){if(u["@type"]&&u["@type"].match(/Product$/)){u.aggregateRating=u.aggregateRating||{},u.aggregateRating["@type"]="AggregateRating";var r=c.find('[itemprop="aggregateRating"] '),i=r.find('[itemprop="ratingValue"]').text(),a=r.find('[itemprop="ratingCount"]').text(),o=r.find('[itemprop="reviewCount"]').text();i&&(u.aggregateRating.ratingValue=i.trim()),a&&(u.aggregateRating.ratingCount=a.trim()),o&&(u.aggregateRating.reviewCount=o.trim()),Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(r),u.review=u.review||[],c.find('[itemprop="review"]').each(function(e,t){var n=l(t),r=n.find('[itemprop="datePublished"]').attr("content"),i=n.find('[itemprop="author"]').text(),a=n.find('[itemprop="ratingValue"]').text(),o=n.find('[itemprop="description"]').text();if(r&&i&&!u.review.find(function(e){return e.datePublished==r.trim()&&e.author==i.trim()})){var s={"@context":"https://schema.org/","@type":"Review",datePublished:r,author:{"@type":"Person",name:i},reviewBody:o.trim(),reviewRating:{"@type":"Rating"}};a&&(s.reviewRating.ratingValue=a.trim()),Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(n),u.review.push(s)}}),n.html(JSON.stringify(u))}}else Fera.logger.warn("Failed to properly parse your application/ld+json. This could indicate that your site code/theme is not properly handling SEO elements. Contact our team for help.")})}return!0}},{key:"removeDuplicateAggregateRatingSeoAttr",value:function o(){var i,a=Fera.Util.$(),e=a('[itemType*="Product"]').find('[itemType*="AggregateRating"]');return 0<e.length&&(i=undefined,e.each(function(e,t){var n=a(t),r=n.parents("[itemType]").first();r&&r.attr("itemType").match(/\/Product$/)&&!i?i=n:Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(n)}),!0)}}]),n}(Fera.CustomerResources.CustomerReviews.Base);var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources.ProductReviewsModal=function(e){function n(e){_classCallCheck(this,n),_get(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,_extends({classPrefix:"reviews"},e)),this.app=e.app,this.totalReviewCount=e.totalReviewCount,this.tplVars=e.tplVars||{},this.reviewOptions=e.reviewOptions||{},this.translatedStrings=e.translatedStrings||{}}return _inherits(n,e),_createClass(n,[{key:"show",value:function r(e){var t=!(arguments.length<=0||e===undefined)&&e;this._setupReviewBlock(),_get(Object.getPrototypeOf(n.prototype),"show",this).call(this),this.reviewBlock.refresh(t)}},{key:"hide",value:function t(){_get(Object.getPrototypeOf(n.prototype),"hide",this).call(this),this.reviewBlock.clear()}},{key:"_setupReviewBlock",value:function i(){this.reviewBlock||(this.reviewBlock=new Fera.CustomerResources.CustomerReviews.ProductReviews({app:this.app,totalReviewCount:this.totalReviewCount,tplVars:this.tplVars,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings}),this.$modalBody.append(this.reviewBlock.render()))}}]),n}(Fera.Components.BaseModal);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.RelatedReviews=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return _inherits(t,e),_createClass(t,[{key:"_initialize",value:function n(){_get(Object.getPrototypeOf(t.prototype),"_initialize",this).call(this),this.relatedHeader=this._opts.relatedHeader||this._t("Reviews From Similar Products"),this.$header=this.$el.find(".fera-productReviews-heading-header"),this.$header.html(this.relatedHeader),this.$el.toggleClass("fera-productReviews--showingRelated",!0)}},{key:"_setupReviewList",value:function r(){var n=this;this.reviewListOpts={app:this.app,singleProduct:!1,pageSize:this.pageSize,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings,suffix:"fera-productReviews"},_get(Object.getPrototypeOf(t.prototype),"_setupReviewList",this).call(this),this.reviewList.clearListeners("listUpdate"),this.reviewList.on("listUpdate",function(e,t){n._updateCountDependentDisplays(t),1<t&&n.trigger("reviewsFound",!0)})}},{key:"_updateSeoAttributes",value:function i(){Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)}},{key:"_tpl",value:function a(){return'<div class="fera-productReview-block">\n            <div class="fera-productReviews-heading">\n                <div class="fera-productReviews-heading-col1">\n                    <h2 class="fera-productReviews-heading-header"></h2>\n                    <a href="#" class="text-link fera-productReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n            </div>\n            <div class="fera-productReviews-content"></div>\n        </div>'}}]),t}(Fera.CustomerResources.CustomerReviews.Base),Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.ProductReview=function(a){var o=this,n=Fera.Util.$(),e=function(){o.viewMode=a.viewMode||"list",t()},t=function(){"grid"===o.viewMode?o.suffix="fera-storeReviews":o.suffix="fera-productReviews"};this.render=function(){var e=p(T(),a);return o.$el=n(e),i(),s(),u(),
"grid"===o.viewMode&&(a.options&&a.options.headings_enabled&&c(),a.options&&a.options.bodies_enabled&&l("fera-storeReviews-review-body",92),a.options&&a.options.show_replies&&l("fera-storeReviews-reply-body",72)),d(),f(),r(),o.$el};var r=function(){!1===a.itemProp&&(o.$el.removeAttr("itemprop"),o.$el.find("[itemprop],[itemscope],[itemtype]").each(function(){n(this).removeAttr("itemprop"),n(this).removeAttr("itemscope"),n(this).removeAttr("itemtype")}))},i=function(){o.$verifications=o.$el.find('[data-fera-verified="true"].'+o.suffix+"-review-customer-verification"),o.$verifications.each(function(e,t){a.verifier.addVerificationIcon(n(t),{height:15})})},s=function(){o.$names=o.$el.find("."+o.suffix+"-review-customer-name"),o.$names.removeClass(o.suffix+"-review-customer-name--truncated"),setTimeout(function(){Fera.Util.truncateTextToMaxWidth(o.$names)},500)},u=function(){o.$dateVals=o.$el.find("."+o.suffix+"-review-date-val"),o.$dateVals.each(function(){var e=n(this),t=new Fera.TimeAgo({language:Fera.i18n.locale||a.language,time:e.data("value")});e.text(t.toString()),e.data("fera-timeAgo",t)})},c=function(){var e=o.$el.find("."+o.suffix+"-review-heading");e.click(function(){e.css("white-space","normal")})},l=function(e,t){if("string"==typeof e){var n=o.$el.find("."+e),r=n.text();if(r&&!(r.length<t)){var i='<div class="'+e+'"><div class="truncated-text">"'+r.slice(0,t)+'..." <span class="show-more"> '+m("show more")+'</span></div><q class="full-text">'+r+"</q></div>";n.replaceWith(i),(n=o.$el.find("."+e)).find(".show-more").click(function(){n.find(".truncated-text").hide(),n.find(".full-text").show()})}}},d=function(){var e=o.$el.find("."+o.suffix+"-photo");e.length<=0||a.imageViewer.init(e)},f=function(){var e=o.$el.find("."+o.suffix+"-video");e.length<=0||a.videoViewer.init(e)},p=function(e,t){t.customer_display_name=h();var n=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!n)return Fera.logger.error("Template is empty or not valid.",e,t),"";var r=Fera.Liquid.parse(n);return r?r.render(t):(Fera.logger.error("Failed to parse template: ",r,t),"")},h=function(){if(a.review.customer_name)return Fera.Util.formatFullName(a.review.customer_name,a.options.customer_name_format);var e=a.review.body.replace(/[^a-z]+/gi,"").toLowerCase();return e.slice(3,4).toUpperCase()+"..."+e.slice(5,6)},m=function(e){var t=a.translatedStrings||{};return Fera.customTranslate(e,t)},g=function(){return"{% unless options.images_enabled == false or review.image_url == '' %}<div class=\""+o.suffix+"-review-customer-col "+o.suffix+'-review-customer-avatar-col">    <img src="{{ review.image_thumbnail_url }}" onerror="this.src=\'https://cdn.fera.ai/img/shoppers/placeholder2.png\'" alt="Author profile picture" class="'+o.suffix+'-review-customer-avatar"></div>{% endunless %}'},v=function(){var e="{% if review.product.thumbnail %}{{ review.product.thumbnail }}{% else %}https://cdn.fera.ai/img/products/placeholder.png{% endif %}";return'{% unless options.images_enabled == false or review.product.url == blank %}<div class="'+o.suffix+'-review-product">    {%- if review.product.url -%}<a href="{{ review.product.url }}">{%- endif -%}        <img src="'+e+'" alt="Product image" class="'+o.suffix+'-review-product-img">    {%- if review.product.url -%}</a>{%- endif -%}</div>{% endunless %}'},_=function(){return'<div class="'+o.suffix+"-review-customer-col "+o.suffix+'-review-customer-info-col">    <div class="'+o.suffix+'-review-customer-name-row">        <span class="h3 '+o.suffix+"-review-customer-name "+o.suffix+'-review-customer-name--truncated" itemprop="author">{{ customer_display_name }}</span>        <span class="'+o.suffix+'-review-customer-verification" data-fera-verified="{{ review.verified }}"></span>    </div>    {% if review.customer_location and review.customer_location != review.customer_name %}    <div class="'+o.suffix+'-review-customer-location-row">        <span class="'+o.suffix+'-review-customer-location-marker" data-fera-customerLocation="{{ review.customer_location | replace: \'"\', "\'" }}">            <svg aria-hidden="true" focusable="false" height="9" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"></path></svg>        </span>        <span class="'+o.suffix+'-review-customer-location">{{ review.customer_location }}</span>    </div>    {% endif %}</div>'},y=function(){return'{%- if options.ratings_enabled -%}<div class="'+o.suffix+'-review-rating" itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">    <div class="fera-stars '+o.suffix+"-stars "+o.suffix+'-review-stars" data-rating="{{ review.rating }}">        <span class="fera-srOnly" itemprop="ratingValue">{{ review.rating }}</span>        <div class="fera-stars-rating '+o.suffix+'-stars-rating" style="width: {{ review.rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>        <div class="fera-stars-bg '+o.suffix+'-stars-bg"></div>    </div></div>{%- endif -%}'},w=function(){var e='{%- if options.headings_enabled -%}<div class="h3 '+o.suffix+'-review-heading" itemprop="name">';return"grid"===o.viewMode?e+="<span>{{ review.heading }}</span>":e+="{{ review.heading }}",e+="</div>{%- endif -%}"},b=function(){var e="grid"===o.viewMode?"q":"div";return"{%- if options.bodies_enabled -%}<"+e+' class="'+o.suffix+'-review-body" itemprop="description">{{ review.body }}</'+e+">{%- endif -%}"},C=function(){return a.review&&a.review.photos&&a.review.photos.length<1&&a.review.videos&&a.review.videos.length<1?"":'{% if options.images_enabled %}    <div class="'+o.suffix+'-files">        {% for photo_url in review.photos %}            <img class="'+o.suffix+'-photo fera-imageViewer-viewable" src="{{ photo_url }}" itemprop="reviewPhoto" itemscope itemtype="https://schema.org/Photograph" />        {% endfor %}        {% for video_url in review.videos %}           {% if review.is_sample %}               <img class="'+o.suffix+'-video fera-videoViewer-viewable" src="https://uploads.fera.ai/products/video-placeholder.png" data-video-url="{{ video_url }}" />           {% else %}               <video class="'+o.suffix+'-video fera-videoViewer-viewable" src="{{ video_url }}" itemprop="reviewVideo" itemscope itemtype="https://schema.org/VideoObject" />           {% endif %}        {% endfor %}    </div>{%- endif -%}'},k=function(){return'<div class="'+o.suffix+'-review-date">    <meta itemprop="datePublished" content="{{ review.date }}">    <span class="'+o.suffix+'-review-date-val" data-value="{{ review.date }}">{{ review.date }}</span></div>'},S=function(e){var t=o.suffix+"-reply";e&&(t+=" "+o.suffix+"-reply--"+e);var n='<span class="'+o.suffix+'-reply-storeName" data-value="{{ review.store_name }}">{{ review.store_name }}</span>',r=m("{{ store_name }} replied:");r=r.replace(/{{\s*store_name\s*}}/,n);var i='{% if options.show_replies and review.store_reply %}<div class="'+t+'">    <div class="'+o.suffix+'-reply-heading">        {% if review.store_logo %}            <img class="'+o.suffix+'-reply-storeLogo" src="{{ review.store_logo }}" />        {%- endif -%}        <span>'+r+'</span>    </div>    <div class="'+o.suffix+'-reply-body">{{- review.store_reply -}}</div>    <div class="'+o.suffix+'-reply-date">        <meta itemprop="date" content="{{ review.store_replied_at }}">        <span class="'+o.suffix+'-review-date-val" data-value="{{ review.store_replied_at }}">{{ review.store_replied_at }}</span>    </div></div>{%- endif -%}';return a.review.store_reply&&""===a.review.store_reply.trim()?"":i},F=function(){return'<div class="item '+o.suffix+'-review" data-link="{{ review.link_url }}" itemprop="review" itemscope itemtype="https://schema.org/Review">    <div class="'+o.suffix+'-review-customer">'+g()+_()+'    </div>    <div class="'+o.suffix+'-review-content">'+y()+w()+b()+C()+k()+S("wide")+"    </div>"+S("thin")+"</div>"},x=function(){return'<div class="item '+o.suffix+'-review" data-link="{{ review.link_url }}" itemprop="review" itemscope itemtype="https://schema.org/Review">'+v()+'    <div class="'+o.suffix+'-review-content {% if options.images_enabled == false or review.product.url == blank %}review-content-wide{% endif %}">'+k()+y()+w()+b()+C()+_()+S()+"    </div></div>"},T=function(){return"grid"===o.viewMode?x():F()};e()};var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.List=function(e){function r(e){if(_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e),this.$=Fera.Util.$(),this.app=e.app,this.suffix=e.suffix,this.viewMode=e.viewMode||"list",this.singleProduct="undefined"!=typeof e.singleProduct&&e.singleProduct,this.totalCount=e.totalReviewCount||0,this.limit=e.pageSize||5,this.pagesShown=0,this.translatedStrings=e.translatedStrings||{},this._processReviewOptions(e.reviewOptions),this.reviews=[],e.template){this.prerendered=!0,this.$el=e.template;var t=this.$el.find("."+this.suffix+"-footer ."+this.suffix+"-showMore-btn");if(-1!==t.html().indexOf("show more")){var n=t.html().replace("show more",this._t("show more"));t.html(n)}this._initialize()}}return _inherits(r,e),_createClass(r,[{key:"render",value:function t(){return this.prerendered||(this.$el=this.$(this._tpl()),this._initialize()),this.$el}},{key:"clear",value:function n(){this.$reviewContainer.empty(),this.$showMore.hide()}},{key:"refresh",value:function i(e){var t=arguments.length<=0||e===undefined||e;this.pagesShown=0,this.reviews=[],this.clear(),t?(this.$reviewContainer.append(this._loadingTpl()),this._fetchNextPage()):this.$reviewContainer.append(this.$noReviews)}},{key:"_processReviewOptions",value:function a(e){this.reviewOptions={},this.reviewOptions.language=e.language||"en",delete e.language,this.reviewOptions.itemProp="undefined"==typeof e.itemProp||e.itemProp,delete e.itemProp;var t={images_enabled:!0,ratings_enabled:!0,headings_enabled:!0,bodies_enabled:!0,videos_enabled:!0,show_replies:!0};this.reviewOptions.reviewFields=this.$.extend(t,e)}},{key:"_initialize",value:function o(){this.$reviewContainer=this.$el.find("."+this.suffix+"-reviews"),this.$showMore=this.$el.find("."+this.suffix+"-showMore"),this.$noReviews=this.$(this._noReviewsTpl()),this._setupShowMore()}},{key:"_setupShowMore",value:function s(){var t=this;this.$showMore.on("click",function(e){e.preventDefault(),t._fetchNextPage()}),this.$showMore.hide()}},{key:"_fetchNextPage",value:function u(){var n=this,e=this.pagesShown+1;this.pagesShown++;var t={page:e,limit:this.limit};this.singleProduct&&(t.product_id=this.app.getProductId()),this.app.api.getReviews(t,function(e,t){1===n.pagesShown&&n.clear(),n.totalCount=t,n.totalCount<1?(n.clear(),n.$reviewContainer.append(n.$noReviews)):(n.$noReviews.remove(),n._renderReviews(e)),n._toggleShowMore(),n.trigger("listUpdate",n.totalCount)})}},{key:"_renderReviews",value:function c(e){for(var t=new Fera.ImageViewer,n=new Fera.VideoViewer,r=0;r<e.length;r++){var i=new Fera.CustomerResources.ProductReview({review:e[r],verifier:this.app.verifier,language:this.reviewOptions.language,options:this.reviewOptions.reviewFields,itemProp:this.reviewOptions.itemProp,viewMode:this.viewMode,imageViewer:t,videoViewer:n,translatedStrings:this.translatedStrings});this.reviews.push(i),this.$reviewContainer.append(i.render())}}},{key:"_toggleShowMore",value:function l(){this.totalCount>this.reviews.length?this.$showMore.show():this.$showMore.hide()}},{key:"_t",value:function d(e){return Fera.customTranslate(e,this.translatedStrings)}},{key:"_loadingTpl",value:function f(){return"loading..."}},{key:"_noReviewsTpl",value:function p(){return'<div class="'+this.suffix+'-noReviewsText">'+this._t("No reviews for this product yet.")+"</div>"}},{key:"_tpl",value:function h(){return'<div class="'+this.suffix+"-"+("grid"===this.viewMode?"Grid":"List")+'">\n            <div class="'+this.suffix+'-body">\n                <div class="'+this.suffix+'-reviews"></div>\n            </div>\n            <div class="'+this.suffix+'-footer">\n               <div class="'+this.suffix+'-showMore">\n                   <a href="#" class="btn btn-secondary btn--secondary '+this.suffix+'-showMore-btn">'+this._t("show more")+'<span class="'+this.suffix+'-showMore-count"></span></a>\n               </div>\n           </div>\n        </div>'}}]),r}(Fera.Components.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.StoreReviews=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.pageSize=e.pageSize||6}return _inherits(t,e),_createClass(t,[{key:"_setupReviewList",value:function n(){this.reviewListOpts={app:this.app,singleProduct:!1,viewMode:"grid",pageSize:this.pageSize,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,translatedStrings:this.translatedStrings,suffix:"fera-storeReviews"},_get(Object.getPrototypeOf(t.prototype),"_setupReviewList",this).call(this)}},{key:"_suffix",value:function r(){return"fera-storeReviews"}},{key:"_tpl",value:function i(){return'<div class="fera-storeReview-block">\n            <div class="fera-storeReviews-heading">\n                <div class="fera-storeReviews-heading-col1">\n                    <h2 class="fera-storeReviews-heading-header">{{ header }}</h2>\n                </div>\n                <div class="fera-storeReviews-heading-col2" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">\n                    <div class="fera-storeReviews-totals-col1">\n                        <div class="fera-storeReviews-avgRating">\n                            <span itemprop="ratingValue" class="h1 fera-storeReviews-avgRating-val" data-value="{{ average_rating }}">{{ average_rating }}</span>\n                        </div>\n                    </div>\n                    <div class="fera-storeReviews-totals-col2">\n                        <div class="fera-storeReviews-avgRating-stars">\n                            {% if ratings_enabled %}\n                            <div class="fera-stars fera-storeReviews-stars"\n                                 data-rating="{{ average_rating }}">\n                                <div class="fera-stars-rating fera-storeReviews-stars-rating" style="width: {{ average_rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>\n                                <div class="fera-stars-bg fera-storeReviews-stars-bg"></div>\n                            </div>\n                            {% endif %}\n                        </div>\n                        <div class="fera-storeReviews-count">\n                            <div class="fera-storeReviews-count-total" data-value="{{ review_count }}">\n                                <span itemprop="reviewCount">{{ review_count || 0 }}</span>\n                                <span itemprop="ratingCount" style="display: none;">{{ review_count || 0 }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="fera-storeReviews-content"></div>\n        </div>'}}]),t}(Fera.CustomerResources.CustomerReviews.Base);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Conditions_Comparison=function(){function r(e,t,n){_classCallCheck(this,r),this.stateValue=e,this.ruleValue=t,this.operator=n}return _createClass(r,[{key:"isTrue",value:function e(){return this[this.operator]()}},{key:"equal",value:function t(){return this.stateValue==this.ruleValue}},{key:"not_equal",value:function n(){return!this.equal()}},{key:"equal_i",value:function i(){return this.equal()}},{key:"not_equal_i",value:function a(){return!this.equal_i()}},{key:"contains",value:function o(){return this.stateValue==this.ruleValue}},{key:"not_contains",value:function s(){return!this.contains()}},{key:"less",value:function u(){return this.stateValue<this.ruleValue}},{key:"less_or_equal",value:function c(){return this.stateValue<=this.ruleValue}},{key:"greater",value:function l(){return this.stateValue>this.ruleValue}},{key:"greater_or_equal",value:function d(){return this.stateValue>=this.ruleValue}},{key:"between",value:function f(){return this.greater()||this.less()}},{key:"not_between",value:function p(){return!this.between()}}]),r}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Conditions_Comparison_String=function(e){function r(e,t,n){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,String(e).trim(),String(t).trim(),n)}return _inherits(r,e),_createClass(r,[{key:"equal",value:function t(){return this.stateValue==this.ruleValue}},{key:"equal_i",value:function n(){return this.stateValue.toLowerCase()==this.ruleValue.toLowerCase()}},{key:"contains",value:function i(){return-1!==this.stateValue.toLowerCase().indexOf(this.ruleValue.toLowerCase())}},{key:"less",value:function a(){return parseFloat(this.stateValue)<parseFloat(this.ruleValue)}},{key:"less_or_equal",value:function o(){return parseFloat(this.stateValue)<=parseFloat(this.ruleValue)}},{key:"greater",value:function s(){return parseFloat(this.stateValue)>parseFloat(this.ruleValue)}},{key:"greater_or_equal",value:function u(){return parseFloat(this.stateValue)>=parseFloat(this.ruleValue)}},{key:"between",value:function c(){return-1!==this.ruleValue.indexOf(this.stateValue)}}]),r}(Fera.Conditions_Comparison);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Conditions_Comparison_Array=function(e){function r(e,t,n){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e,t,n),"string"!=typeof this.stateValue&&(this.stateValue=String(this.stateValue).split(",")),this.stateValue=this.stateValue.sort()}return _inherits(r,e),_createClass(r,[{key:"equal",value:function t(){var e=this.ruleValue;return"object"!=typeof this.ruleValue&&(e=String(this.ruleValue).split(",")),this.stateValue.join(",")==e.sort().join(",")}},{key:"contains",value:function n(){return-1!==this.stateValue.indexOf(this.ruleValue)}},{key:"less",value:function i(){return this.stateValue.length<this.ruleValue}},{key:"less_or_equal",value:function a(){return this.stateValue.length<=this.ruleValue}},{key:"greater",value:function o(){return this.stateValue.length>this.ruleValue}},{key:"greater_or_equal",value:function s(){return this.stateValue.length>=this.ruleValue}},{key:"between",value:function u(){var t=this;return this.ruleValue.every(function(e){return-1!==t.stateValue.indexOf(e)})}}]),r}(Fera.Conditions_Comparison);var _get=function get(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(s!==undefined){if("value"in s)return s.value;var u=s.get;return u===undefined?undefined:u.call(o)}var c=Object.getPrototypeOf(i);if(null===c)return undefined;e=c,t=a,n=o,r=!0,s=c=undefined}};Fera.Conditions_Comparison_Param=function(e){function r(e,t,n){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,e,t.value,n)}return _inherits(r,e),r}(Fera.Conditions_Comparison_String);var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Conditions_Rule=function(){function r(e,t){var n=arguments.length<=1||t===undefined?{}:t;_classCallCheck(this,r),this._opts=n,this.rule=e,this.atomic=!0,this.comparisonClass=this._determineComparisonClass()}return _createClass(r,[{key:"isTrue",value:function n(e){var t=e.fetchValue(this.rule.field,this.rule.value);return null!=t&&new this.comparisonClass(t,this.rule.value,this.rule.operator).isTrue()}},{key:"debug",value:function i(e){var t=e.fetchValue(this.rule.field,this.rule.value);return"("+this.rule.field+": "+JSON.stringify(t)+" "+this.rule.operator+" "+JSON.stringify(this.rule.value)+")"}},{key:"_determineComparisonClass",value:function e(){switch(this.rule.type){case"string":return this.rule.field.match(/_param$/)&&"object"==typeof this.rule.value?Fera.Conditions_Comparison_Param:Fera.Conditions_Comparison_String;case"array":return Fera.Conditions_Comparison_Array}return Fera.Conditions_Comparison}}]),r}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Conditions_Group=function(){function i(e,t){var n=this,r=arguments.length<=1||t===undefined?{}:t;_classCallCheck(this,i),this._opts=r,this.conditions=e,this.rules=this.conditions.rules.map(function(e){return e.condition?new n.constructor(e):new Fera.Conditions_Rule(e)}),this.separator=this.conditions.condition}return _createClass(i,[{key:"isTrue",value:function e(t){return this.rules["AND"==this.separator?"every":"some"](function(e){return e.isTrue(t)})}},{key:"debug",value:function n(t){return this.rules.map(function(e){return e.atomic?e.debug(t)+"="+e.isTrue(t):"("+e.debug(t)+")="+e.isTrue(t)}).join(" "+this.separator+" ")}}]),i}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Conditions_State=function(){function r(e,t){var n=arguments.length<=1||t===undefined?{}:t;_classCallCheck(this,r),this._opts=n,this.data=e,this.data.product=this.data.product||{},this.data.cart=this.data.cart||{}}return _createClass(r,[{key:"fetchValue",value:function i(e,t){var n=this.data.current_page.url.toLowerCase();switch(e){case"shopper_country_code":return this.data.location.country_code;case"shopper_country_name":return this.data.location.country_name;case"shopper_city":return this.data.location.city;case"shopper_region_code":return this.data.location.region_code;case"shopper_region_name":return this.data.location.region_name;case"shopper_time_zone":return this.data.location.time_zone;case"shopper_continent":return this.data.location.continent;case"shopper_from_gdpr":return-1!==this.constructor.GDPR_COUNTRY_CODES.indexOf(this.data.location.country_code);case"shopper_not_from_gdpr":return-1===this.constructor.GDPR_COUNTRY_CODES.indexOf(this.data.location.country_code);case"cart_total":return this.data.cart.total;case"cart_item_count":return this.data.cart.item_count;case"cart_total_weight":return this.data.cart.total_weight;case"cart_item_product_ids":return this.data.cart.items.map(function(e){return e.product_id});case"cart_item_names":return this.data.cart.items.map(function(e){return e.name});case"cart_item_variant_ids":return this.data.cart.items.map(function(e){return e.variant_id});case"request_url":return n;case"request_title":return this.data.current_page.title.toLowerCase();case"request_referrer":return this.data.current_page.referrer.toLowerCase();case"request_url_param":return this._getUrlParamValue(n,t);case"shopper_total_interaction_time":return this.data.interaction_time;case"shopper_time_since_first_seen":return this.data.time_since_first_seen;case"shopper_session_time":return this.data.session_time;case"shopper_time_on_current_page":return this.data.time_on_current_page;case"shopper_inactive_time_on_current_page":return this.data.inactive_time_on_current_page;case"is_mobile":case"is_not_mobile":return this.constructor.isUserAgentMobile()?1:0;case"product_id":return this.data.product_id;case"product_exists":return!!this.data.product_id;case"product_tags":return this.data.product.tags;case"product_name":return this.data.product.name}return null}},{key:"_getUrlParamValue",value:function a(e,t){var n=e.split("?")[1]||"";if("undefined"==typeof t.value)return n;var r=n.split("&").find(function(e){return e.split("=")[0]==t.param});return r?r.split("=")[1]:""}}],[{key:"isUserAgentMobile",value:function e(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}},{key:"GDPR_COUNTRY_CODES",get:function t(){return["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"]}}]),r}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.Conditions_Evaluator=function(){function i(e,t,n){var r=arguments.length<=2||n===undefined?{}:n;_classCallCheck(this,i),this._opts=r,this.group=new Fera.Conditions_Group(e,this._opts),this.state=new Fera.Conditions_State(t,this._opts)}return _createClass(i,[{key:"isTrue",value:function e(){return this.group.isTrue(this.state)}},{key:"debug",value:function t(){return this.group.debug(this.state)}}]),i}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Fera.AbTests=Fera.AbTests||{},Fera.AbTests.Manager=function(){function t(e){_classCallCheck(this,t),this._opts=e,this._storage=new Fera.LocalStorageJar("Fera.AbTests"),this._changed=!1,this.buckets=this._storage.getObject("buckets",{})}return _createClass(t,[{key:"updateBuckets",value:function e(n){var r=this;if(n)return Object.keys(n).forEach(function(e){if("undefined"==typeof r.buckets[e]){var t=undefined;t="boolean"==typeof n[e].on?n[e].on:!!r._opts.app.opts.isAdminMode()||n[e].next_bucket_on,r.updateBucket(e,t)}}),this.save()}},{key:"updateBucket",value:function n(e,t){this.buckets[e]=t,this._changed=!0}},{key:"onFor",value:function r(e){return"boolean"!=typeof this.buckets[e]||this.buckets[e]}},{key:"present",value:function i(){return 0<Object.keys(this.buckets).length}},{key:"getData",value:function a(){return this.buckets}},{key:"save",value:function o(){return!!this._changed&&(this._storage.setObject("buckets",this.buckets),!(this._changed=!1))}}]),t}(),Fera.ShopifyAdapter=function(n){var e=this,r=Fera.Util.$();n=n||{};var i=[];this.cartAdapter=new Fera.ShopifyCartAdapter(n);var t=function(){n.logger.log("Shopify adapter initialized."),m(),s(),h(),e.variantLoader=new Fera.VariantLoader(n),a()?o():(u(),setInterval(function(){u()},250))};this.formatCurrency=function(e){if(!(Shopify&&Shopify.currency&&Shopify.currency.rate&&"undefined"!=typeof theme&&theme.moneyFormat))return null;var t=parseFloat(Shopify.currency.rate)*e,n=theme.moneyFormat.replace(/{{[ ]?amount[ ]?}}/,t.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));return n=(n=n.replace(/{{[ ]?amount_no_decimals[ ]?}}/,Math.round(t).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(/^(.+)\.00$/,"$1"))).replace(/{{[ ]?amount_with_comma_separator[ ]?}}/,t.toFixed(2).toString().replace(".",","))};var a=function(){if(-1!==window.location.toString().indexOf("/password"))return!0;var e=r('link[rel="canonical"]').attr("href");return!(!e||-1===e.indexOf("/password"))},o=function(){if(n.app.opts.sandboxMode)return r('a[href="/admin"]').on("click",function(e){e.preventDefault(),alert("Please enter your storefront password instead. You can find it at YOUR_STORE_URL/admin/online_store/preferences.")}),setTimeout(function(){var e=r('a[href="#LoginModal"],.password__open-modal');e.length<=0||Fera.Util.scrollToElement(e,{callback:function(){e.fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}})},1e3),!0},s=function(){-1!==window.location.toString().indexOf("/checkouts/")&&r(
'<div class="banana-container banana-cart-container banana-order-top-container fera-order-top-container" data-container_type="cart"></div>').insertAfter(".breadcrumb")},u=function(){c(),l()},c=function(){r('form[action~="/cart/add"] button[type=submit],form[action~="/cart/add"] input[type=submit],.product-form__cart-submit,.add-to-cart, .addToCart, .add_to_cart, #addToCart, #add-to-cart, #add_to_cart, .add-to-cart input.button,.btn-addtocart').each(function(){var e=r(this);if(e.data("Fera.listenersBound"))return!0;if(e.length<=0)n.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");else{var t=f(e.parents("form"));e.on("click touch",function(){p(t)}),e.data("Fera.listenersBound",!0)}})},l=function(){r('form[action~="/cart/add"]').each(function(){var e=r(this);if(e.data("Fera.listenersBound"))return!0;if(e.length<=0)n.logger.warn("Fera did not find the add to cart form.");else{var t=f(e);e.on("submit",function(){p(t)}),e.data("Fera.listenersBound",!0)}})},d=function(e){return e&&0<e.length&&!e.match(/\D/)?e:null},f=function(e){var t=d(e.data("productid"))||d(e.data("product-id"))||d(e.find("[data-productid]").data("productid"))||d(e.find("[data-product-id]").data("product-id"));if(!t){var n=e.attr("id");n&&(n=n.split("_").pop()),t=d(n)}var r=d(e.find('[name="id"]').val()),i={};return r&&(i.variant_id=r),t&&(i.product_id=t),i!={}&&Fera.logger.log("Located product/variant event data for click: ",i),i},p=function(t){for(var e=0;e<i.length;e++)if(i[e].variant_id===t.variant_id&&i[e].product_id===t.product_id)return;i.push(t),n.app.pushAddToCartEvent(t),setTimeout(function(){for(var e=0;e<i.length;e++)if(i[e].variant_id===t.variant_id&&i[e].product_id===t.product_id){i.splice(e,1);break}},1e3)},h=function(){if("undefined"!=typeof Shopify&&Shopify.theme&&Shopify.theme.name){var e=Shopify.theme.name.toLowerCase();-1===e.indexOf("boundless")&&-1===e.indexOf("narrative")||Fera.Util.isHome()&&(r("body").addClass("fera-themeWithFixedHeader fera-themeWithFixedHeader--adjust"),-1!==e.indexOf("narrative")&&r(".site-header--homepage").addClass("fera-themeWithFixedHeader--adjust"))}},m=function(){if(Shopify&&Shopify.locale)n.app.setLocale(Shopify.locale);else{var e=document.getElementById("shopify-features");if(!e)return;(e=JSON.parse(e.innerHTML)).locale&&n.app.setLocale(e.locale)}};t()},Fera.ShopifyAdapter.generateProductDataAttribute=function(e){try{var t={id:e.id,name:e.title,variants:[]};"string"==typeof e.images?t.thumbnail_url=e.images:"undefined"!=typeof e.image&&("string"==typeof e.image?t.thumbnail_url=e.image:"object"==typeof e.image&&"string"==typeof e.image.src&&(t.thumbnail_url=e.image.src));for(var n=0;n<e.variants.length;n++){var r=e.variants[n],i={name:r.title,stock:r.inventory_quantity,inventory_policy:r.inventory_policy,manages_stock:r.inventory_management&&""!==r.inventory_management};r.image&&r.image.src&&(i.thumbnail_url=r.image.src),t.variants.push(i)}return encodeURI("0617-"+Fera.Util.encode(JSON.stringify(t)))}catch(a){return console.error(a.message,a),null}},Fera.ShopifyCartAdapter=function(u){var e=this,c=Fera.Util.$(),t=function(){n(),r()},n=function(){c(document).on("ajaxComplete",function(e,t,n){if(!(300<=t.status)&&u.app.cart)if(n&&-1!==n.url.indexOf("/cart.js"))u.app.cart.loadCartData(JSON.parse(t.responseText));else if(n&&/\/cart\/(add|update|clear|change)/.test(n.url)){var r=JSON.parse(t.responseText);-1===n.url.indexOf("/cart/add")||r.items?u.app.cart.loadCartData(r):u.app.cart.loadItemData(r),u.app.updateAllContainers()}})},r=function(){-1!==window.location.toString().indexOf("/thank_you")&&u.app.cart&&u.app.cart.reset()};e.startCheckout=function(){var e=Fera.Util.updateURLParameter(window.location.toString(),"ensure_loaded_cart","0");e=Fera.Util.updateURLParameter(e,"go_to_checkout","0"),window.location=e.replace("/cart","/checkout")},e.downloadData=function(t){c.getJSON("/cart.js",function(e){"function"==typeof t&&t(e)})},e.clear=function(e){c.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/cart/clear",complete:function(){"function"==typeof e&&e()}})},e.parseCartData=function(e){var t={},n=null;if(!e)return null;n=a(),t.item_count=e.item_count,"string"==typeof e.currency&&(t.currency=e.currency),t.total=e.total_price/n/100,t.total_weight=e.total_weight,t.total_discount=e.total_discount/n/100,t.items=[];for(var r=0;r<e.items.length;r++){var i=e.items[r];t.items.push({price:i.price/n/100,total:i.line_price/n/100,product_id:i.product_id,name:i.product_title,variant_id:i.variant_id,quantity:i.quantity})}return t},e.parseItemData=function(e){var t={},n=null;return e?(n=a(),t.price=e.price/n/100,t.total=e.line_price/n/100,t.product_id=e.product_id||e.id,t.name=e.product_title,t.variant_id=e.variant_id,t.quantity=e.quantity,t.weight=e.grams,t.total_discount=e.total_discount/n,t):null};var a=function(){return Shopify&&Shopify.currency&&Shopify.currency.rate?parseFloat(Shopify.currency.rate):parseFloat("1.0")};e.removeProduct=function(e,t,n){var r={},i=(u.app.cart.getData()||{}).items;if(!i)return!1;var a=0;t&&(a=t.quantity||0);for(var o=0;o<i.length;o++){var s=i[o];if(s.product_id==e){if(t){if(t.variant_id&&s.variant_id!=t.variant_id)continue;if(t.quantity){if(!(0<a))continue;if((a-=s.quantity)<0){r[s.variant_id]=0-a;break}}}r[s.variant_id]=0}}return 0!==Object.keys(r).length&&(c.ajax({method:"POST",type:"POST",data:{updates:r},dataType:"json",url:"/cart/update.js",complete:n.afterAdd||n.then||function(){}}),!0)},e.addProduct=function(t,e,n){var r={id:e.variant_id||e.variant||e.variantId,quantity:e.quantity||1};c.ajax({method:"POST",type:"POST",data:r,dataType:"json",url:"/cart/add.js",complete:function(){var e=arguments;i(t,function(){(n.afterAdd||n.then||function(){}).apply(this,e)})}})};var i=function(e,t){if(1<=u.app.cart.getProductQuantity(e))return t();setTimeout(function(){u.app.cart.update(function(){i(e,t)},!1)},500)};t()},Fera.BigcommerceAdapter=function(a){var e=this,o=Fera.Util.$();a=a||{};var s,u=null,t=function(){e.cartAdapter=new Fera.BigcommerceCartAdapter(a),_(),y(),r(),w(),l(),n()},n=function(){var e=window.location.toString();Fera.Util.isHome()?a.app.setSection("home"):-1!==e.indexOf("cart.php")?a.app.setSection("cart"):0<o(".banana-view-container").length?a.app.setSection("product_view"):0<o(".banana-list-container").length?a.app.setSection("product_list"):-1!==e.indexOf("checkout")&&a.app.setSection("checkout")},r=function(){a.params&&a.params.dynamically_integrate&&(-1!==a.params.dynamically_integrate.indexOf("product_view")&&p(),-1!==a.params.dynamically_integrate.indexOf("product_list")&&c(),-1!==a.params.dynamically_integrate.indexOf("cart_top")&&i())},i=function(){var e='<!-- BEGIN Fera.ai Shopping Cart Top Container --> <div class="banana-container banana-cart-container" data-container_type="cart" ></div> <!-- END -->';if(!(0<o(".banana-cart-container").length))if(-1!==window.location.toString().indexOf("/cart.php")){var t=o(".cart-container");0<t.length?t.each(function(){o(e).prependTo(o(this))}):o(e).insertAfter(o("h1,.page-title,.page-heading").first())}else-1===window.location.toString().indexOf("checkout")&&o(e).prependTo(o(".optimizedCheckout-contentPrimary"))},c=function(){var r='<!-- BEGIN Fera.ai Product List Bottom Container --> <div class="banana-container banana-list-container" data-product_id="#{product_id_code}" data-container_type="list"></div> <!-- END -->';if(f(r))return!0;o(".productGrid article, .product-grid-container article").each(function(){var e=o(this),t=e.find("[data-product-id]").first().data("product-id");if(t&&""!==t||e.find("a").each(function(){var e=o(this).attr("href");e&&-1!==e.indexOf("product_id=")&&(e.match(/.+(product_id|product-id|productId)=(.+).*/i)&&(t=e.match(/.+(product_id|product-id|productId)=(.+).*/i)[2]))}),t&&""!==t){var n=r;n=n.replace("#{product_id_code}",t),o(n).appendTo(e)}})},l=function(){o(document).on("ajaxComplete",function(e,t){try{if(!t)return;var n=JSON.parse(t.responseText);t&&n&&n.productListing&&c()}catch(r){}})},d=function(){return o(".product-grid *").contents().filter(function(){return 8===this.nodeType&&-1!==this.nodeValue.indexOf("snippet location product_rating")})},f=function(r){var e=d();if(e.length<1)return!1;var i=!1;return e.each(function(){var e=o(this),t=e.parents(".product-item").find("[data-product-id]").data("productId");if(t&&""!==t){var n=r.replace("#{product_id_code}",t);e.after(n),o(n).appendTo(e),i=!0}}),i},p=function(){var e='<!-- BEGIN Fera.ai Product View Container --> <div class="banana-container banana-view-container" data-product_id="#{product_id_code}" data-container_type="view"></div> <!-- END -->';if(m(e))return!0;0<s.length?v(e):g(e)},h=function(){return o(Fera.Util.ie()?"body":"*").contents().filter(function(){return 8===this.nodeType&&-1!==this.nodeValue.indexOf("snippet location product_addtocart")})},m=function(r){var e=h();if(e.length<1)return!1;var i=!1;return e.each(function(){var e=o(this),t=e.parents("form").find("[data-product-id]").val();if(t&&""!==t){a.app.getProductId()||a.app.setProductId(t);var n=r.replace("#{product_id_code}",t);e.after(n),o(n).appendTo(e),i=!0}}),i},g=function(e){for(var t=0;t<u.length;t++){var n=u[t],r=n.find("input[name=product_id]").val();a.app.getProductId()||a.app.setProductId(r);var i=e;i=i.replace("#{product_id_code}",r),o(i).appendTo(n)}},v=function(e){for(var t=0;t<s.length;t++){var n=s[t],r=n.attr("action").match(/.*product_id=([0-9]+).*/)[1],i=e;a.app.getProductId()||a.app.setProductId(r),i=i.replace("#{product_id_code}",r),o(i).insertAfter(n)}},_=function(){return null!=u||(u=[],o("form[action]").each(function(){var e=o(this);-1!==e.attr("action").indexOf("cart.php")&&u.push(e)})),u},y=function(){return null!=s||(s=[],o("form[action]").each(function(){var e=o(this);-1!==e.attr("action").indexOf("wishlist.php?action=add")&&s.push(e)})),s},w=function(){for(var e=0;e<u.length;e++){var t=u[0].find('#form-action-addToCart, input[type="submit"]');if(t.length<=0)return void a.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");t.on("click touch",function(){a.app.pushAddToCartEvent()})}};t()},Fera.BigcommerceCartAdapter=function(r){var l=this,o=Fera.Util.$(),e=function(){t(),i(),n()},t=function(){o(document).on("ajaxComplete",function(e,t,n){300<=t.status||n&&-1!==n.url.indexOf("/cart.php")||n&&-1!==n.url.indexOf("/remote/v1/cart/")&&setTimeout(function(){r.app.cart.update()},500)})},n=function(){o(window).on("load",function(){var e=document.querySelector("[data-cart-content]");if(e&&"undefined"!=typeof MutationObserver){var t={attributes:!0,childList:!0,characterData:!0};new MutationObserver(function(){r.app.cart.update(!0)}).observe(e,t)}})},i=function(){-1!==window.location.toString().indexOf("/order-confirmation")&&r.app.cart.reset()};l.startCheckout=function(){var e=Fera.Util.updateURLParameter(window.location.toString(),"ensure_loaded_cart","0");e=Fera.Util.updateURLParameter(e,"go_to_checkout","0"),window.location=e.replace("/cart","/checkout")},l.removeProduct=function(s,u,c){return o.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/api/storefront/cart",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",f())},complete:function(e){Fera.logger.log("Removing product...",e);var t=JSON.parse(e.responseText)[0];if(t){var n=[],r="",i=0;u&&(i=u.quantity||0);for(var a=0;a<t.lineItems.physicalItems.length;a++){var o=t.lineItems.physicalItems[a];if(o.productId==s)if(u&&u.quantity){if((i-=o.quantity)<=0){i<0&&(r=o.productId),n.push(o.id);break}}else n.push(o.id)}d(t.id,n,r?function(){u.quantity=0-i,l.addProduct(r,u,c)}:c.then)}else"function"==typeof c.then&&c.then()}}),!0},l.clear=function(a){o.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/api/storefront/cart",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",f())},complete:function(e){Fera.logger.log("Clearing cart...",e);var t=JSON.parse(e.responseText)[0];if(t){for(var n=[],r=0;r<t.lineItems.physicalItems.length;r++){var i=t.lineItems.physicalItems[r];n.push(i.id)}d(t.id,n,a)}else"function"==typeof a&&a()}})};var d=function(e,t,n){if(t.length<1)"function"==typeof n&&n();else{var r=t.shift();a(e,r,function(){setTimeout(function(){return d(e,t,n)},100)})}},a=function(e,t,n){o.ajax({method:"DELETE",type:"DELETE",data:{},dataType:"json",url:"/api/storefront/carts/"+e+"/items/"+t,beforeSend:function(e){e.setRequestHeader("x-xsrf-token",f())},complete:n})};l.downloadData=function(t){o.getJSON("/api/storefront/carts",function(e){e&&e[0]?t(e[0]):t(null)})},l.parseCartData=function(e){var t={};if(!e)return null;if(e.items)return s(e);!e.lineItems&&e[0]&&e[0].lineItems&&(e=e[0]),t.item_count=e.lineItems.physicalItems.length,t.currency=e.currency.code,t.total=e.cartAmount,t.total_discount=e.discountAmount,t.items=[];for(var n=0;n<e.lineItems.physicalItems.length;n++){var r=e.lineItems.physicalItems[n];t.items.push(l.parseItemData(r))}return t};var s=function(e){var t={};if(!e)return null;t.item_count=e.quantity,t.currency=e.currency,t.total=e.total?e.total.value:0,t.grand_total=e.grand_total?e.grand_total.value:0,t.total_discount=e.discount,t.items=[];for(var n=0;n<e.items.length;n++){for(var r=e.items[n],i=[],a=0;a<r.options.length;a++)i.push(r.options[a].id);t.items.push({price:r.price.value,total:r.total.value,product_id:r.product_id,name:r.name,variant_id:i,quantity:r.quantity})}return t};l.parseItemData=function(e){return e?{price:e.salePrice,total:e.salePrice*e.quantity,product_id:e.productId,name:e.name,variant_id:e.variantId,quantity:e.quantity}:null};var f=function(){var e=("; "+document.cookie).split("; XSRF-TOKEN=").pop().split(";")[0],t="";return BCData&&BCData.csrf_token&&(t=BCData.csrf_token),e||t};l.addProduct=function(e,t,n){var r={action:"add",product_id:e,qty:[1]};if(t){if(t.variant_id&&-1!==t.variant_id.indexOf("=")){r.attribute={};for(var i=t.variant_id.split("&"),a=0;a<i.length;a++){var o=i[a].split("=");r.attribute[o[0]]=o[1]}}r.qty=[t.quantity||1]}u(r,n)};var u=function(r,i){r.attribute?c(r,i):o.ajax({method:"GET",type:"GET",url:"/products.php?productId="+r.product_id,error:function(){c(r,i)},success:function(e){var n=!1;o(e).find('form[action*="cart.php"]').each(function(){var t={};if(o(this).serializeArray().forEach(function(e){"qty[]"!==e.name&&(t[e.name]=e.value)}),n=t.product_id==r.product_id)return c(o.extend(t,r),i),!1}),n||c(r,i)}})},c=function(e,t){t=t||{},o.ajax({method:"POST",type:"POST",data:e,dataType:"json",url:"/remote/v1/cart/add",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",f())},complete:t.afterAdd||t.then||function(){}})};e()},Fera.MagentoAdapter=function(e){var t,n,r=Fera.Util.$();e=e||{};var i=function(){e.debugMode&&console.log("Magento adapter initialized."),t=r('form[action*="cart/add"]'),o(),a()},a=function(){var e='<!-- BEGIN Fera.ai Shopping Cart Top Container --> <div class="banana-container banana-cart-container" data-container_type="cart" ></div> <!-- END -->';if(!(0<r(".banana-cart-container").length)&&-1!==window.location.toString().indexOf("/checkout")){var t=r(".cart-container");0<t.length?t.each(function(){r(e).prependTo(r(this))}):r(e).insertAfter(r("h1,.page-title,.page-heading").first())}},o=function(){(n=t.find('button:contains("Add")')).length<1&&(n=t.find('input[type="submit"],button[onclick="productAddToCartForm.submit(this)"],a[onclick="productAddToCartForm.submit(this)"],#product-addtocart-button,button[title*="Add"],')),n.length<1?e.logger.logWarning("Fera did not find the add to cart button so it will not be enabled for add to cart events."):n.on("click touch",function(){e.app.pushAddToCartEvent()})};i()},Fera.CustomAdapter=function(e){Fera.Util.$();e=e||{},e.debugMode&&console.log("Custom adapter initialized.")};try{var loadFera=function(){window.fera&&window.fera.version||(window.fera=window.fera||[],window.__bsio&&(window.fera=window.fera.concat(window.__bsio)),window.fera=window.__bsio=new Fera.App({pushBuffer:window.fera,debugMode:window.feraDebugMode||window.__bsioDebugMode||!1,showErrors:window.feraShowErrors,standaloneMode:window.feraStandaloneMode||window.__bsioStandaloneMode||!1,supportedPlatforms:["shopify","bigcommerce","magento","custom"],parentWindow:window.opener?window.opener:window.parent&&0<window.parent.length&&window!==window.top?window.parent:null}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",loadFera):loadFera()}catch(e){if(window.feraDebugMode||window.__bsioDebugMode||window.feraShowErrors)throw e;window.console&&window.console.error(e)}